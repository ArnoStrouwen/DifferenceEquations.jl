<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.009413540091627644]
 [0.05848863843649331, 0.0142754392654829]
 [0.14468680854015434, -0.0005635150801056475]
 [0.13387180717450076, -0.00019927920191959364]
 [0.12585921932494826, 0.0016906367207866783]
 [0.12999004227705246, 0.006071518037629501]
 [0.16122071586834885, 0.0016475553886282212]
 [0.16331744993632755, -0.0013093519186569418]
 [0.1469410246154559, 0.011510298445693486]
 ⋮
 [0.016091275459119384, 0.012111327734397723]
 [0.0907702610796427, 0.0006276811896401306]
 [0.09004854137149466, 0.012278201248134907]
 [0.16213665025344656, 0.016318795448327726]
 [0.25613312180049264, 0.0033559848311511386]
 [0.26413511323805183, 0.005335519854545307]
 [0.2840999245020126, -0.007934969396086327]
 [0.22065010661268808, -0.009204348739661552]
 [0.1525921804989823, 0.008794804060213539]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip610">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip610)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip611">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip610)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip612">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip610)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1413.19 2352.76,1413.19 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1180.05 2352.76,1180.05 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,946.917 2352.76,946.917 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,713.78 2352.76,713.78 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,480.644 2352.76,480.644 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,247.507 2352.76,247.507 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1413.19 105.89,1413.19 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1180.05 105.89,1180.05 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,946.917 105.89,946.917 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,713.78 105.89,713.78 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,480.644 105.89,480.644 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,247.507 105.89,247.507 
  "/>
<path clip-path="url(#clip610)" d="M-36.3454 1398.99 Q-39.9565 1398.99 -41.7852 1402.55 Q-43.5907 1406.09 -43.5907 1413.22 Q-43.5907 1420.33 -41.7852 1423.9 Q-39.9565 1427.44 -36.3454 1427.44 Q-32.7111 1427.44 -30.9056 1423.9 Q-29.0769 1420.33 -29.0769 1413.22 Q-29.0769 1406.09 -30.9056 1402.55 Q-32.7111 1398.99 -36.3454 1398.99 M-36.3454 1395.28 Q-30.5352 1395.28 -27.4797 1399.89 Q-24.401 1404.47 -24.401 1413.22 Q-24.401 1421.95 -27.4797 1426.56 Q-30.5352 1431.14 -36.3454 1431.14 Q-42.1555 1431.14 -45.2342 1426.56 Q-48.2897 1421.95 -48.2897 1413.22 Q-48.2897 1404.47 -45.2342 1399.89 Q-42.1555 1395.28 -36.3454 1395.28 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-16.1834 1424.59 L-11.2992 1424.59 L-11.2992 1430.47 L-16.1834 1430.47 L-16.1834 1424.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M8.88587 1398.99 Q5.27478 1398.99 3.44608 1402.55 Q1.64054 1406.09 1.64054 1413.22 Q1.64054 1420.33 3.44608 1423.9 Q5.27478 1427.44 8.88587 1427.44 Q12.5201 1427.44 14.3257 1423.9 Q16.1543 1420.33 16.1543 1413.22 Q16.1543 1406.09 14.3257 1402.55 Q12.5201 1398.99 8.88587 1398.99 M8.88587 1395.28 Q14.696 1395.28 17.7516 1399.89 Q20.8303 1404.47 20.8303 1413.22 Q20.8303 1421.95 17.7516 1426.56 Q14.696 1431.14 8.88587 1431.14 Q3.07572 1431.14 -0.00297114 1426.56 Q-3.05851 1421.95 -3.05851 1413.22 Q-3.05851 1404.47 -0.00297114 1399.89 Q3.07572 1395.28 8.88587 1395.28 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M39.0477 1398.99 Q35.4367 1398.99 33.608 1402.55 Q31.8024 1406.09 31.8024 1413.22 Q31.8024 1420.33 33.608 1423.9 Q35.4367 1427.44 39.0477 1427.44 Q42.682 1427.44 44.4875 1423.9 Q46.3162 1420.33 46.3162 1413.22 Q46.3162 1406.09 44.4875 1402.55 Q42.682 1398.99 39.0477 1398.99 M39.0477 1395.28 Q44.8579 1395.28 47.9134 1399.89 Q50.9921 1404.47 50.9921 1413.22 Q50.9921 1421.95 47.9134 1426.56 Q44.8579 1431.14 39.0477 1431.14 Q33.2376 1431.14 30.1589 1426.56 Q27.1034 1421.95 27.1034 1413.22 Q27.1034 1404.47 30.1589 1399.89 Q33.2376 1395.28 39.0477 1395.28 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-35.35 1165.85 Q-38.9611 1165.85 -40.7898 1169.42 Q-42.5953 1172.96 -42.5953 1180.09 Q-42.5953 1187.19 -40.7898 1190.76 Q-38.9611 1194.3 -35.35 1194.3 Q-31.7158 1194.3 -29.9102 1190.76 Q-28.0815 1187.19 -28.0815 1180.09 Q-28.0815 1172.96 -29.9102 1169.42 Q-31.7158 1165.85 -35.35 1165.85 M-35.35 1162.15 Q-29.5398 1162.15 -26.4843 1166.75 Q-23.4056 1171.34 -23.4056 1180.09 Q-23.4056 1188.81 -26.4843 1193.42 Q-29.5398 1198 -35.35 1198 Q-41.1602 1198 -44.2388 1193.42 Q-47.2944 1188.81 -47.2944 1180.09 Q-47.2944 1171.34 -44.2388 1166.75 Q-41.1602 1162.15 -35.35 1162.15 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-15.1881 1191.45 L-10.3038 1191.45 L-10.3038 1197.33 L-15.1881 1197.33 L-15.1881 1191.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M9.88124 1165.85 Q6.27014 1165.85 4.44145 1169.42 Q2.6359 1172.96 2.6359 1180.09 Q2.6359 1187.19 4.44145 1190.76 Q6.27014 1194.3 9.88124 1194.3 Q13.5155 1194.3 15.321 1190.76 Q17.1497 1187.19 17.1497 1180.09 Q17.1497 1172.96 15.321 1169.42 Q13.5155 1165.85 9.88124 1165.85 M9.88124 1162.15 Q15.6914 1162.15 18.7469 1166.75 Q21.8256 1171.34 21.8256 1180.09 Q21.8256 1188.81 18.7469 1193.42 Q15.6914 1198 9.88124 1198 Q4.07108 1198 0.992394 1193.42 Q-2.06315 1188.81 -2.06315 1180.09 Q-2.06315 1171.34 0.992394 1166.75 Q4.07108 1162.15 9.88124 1162.15 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M30.0895 1162.77 L48.4458 1162.77 L48.4458 1166.71 L34.3718 1166.71 L34.3718 1175.18 Q35.3904 1174.83 36.4089 1174.67 Q37.4274 1174.49 38.4459 1174.49 Q44.2329 1174.49 47.6125 1177.66 Q50.9921 1180.83 50.9921 1186.25 Q50.9921 1191.82 47.5199 1194.93 Q44.0477 1198 37.7283 1198 Q35.5524 1198 33.2839 1197.63 Q31.0385 1197.26 28.6311 1196.52 L28.6311 1191.82 Q30.7145 1192.96 32.9367 1193.51 Q35.1589 1194.07 37.6357 1194.07 Q41.6403 1194.07 43.9783 1191.96 Q46.3162 1189.86 46.3162 1186.25 Q46.3162 1182.63 43.9783 1180.53 Q41.6403 1178.42 37.6357 1178.42 Q35.7607 1178.42 33.8857 1178.84 Q32.0339 1179.25 30.0895 1180.13 L30.0895 1162.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-36.3454 932.715 Q-39.9565 932.715 -41.7852 936.28 Q-43.5907 939.822 -43.5907 946.951 Q-43.5907 954.058 -41.7852 957.623 Q-39.9565 961.164 -36.3454 961.164 Q-32.7111 961.164 -30.9056 957.623 Q-29.0769 954.058 -29.0769 946.951 Q-29.0769 939.822 -30.9056 936.28 Q-32.7111 932.715 -36.3454 932.715 M-36.3454 929.012 Q-30.5352 929.012 -27.4797 933.618 Q-24.401 938.201 -24.401 946.951 Q-24.401 955.678 -27.4797 960.285 Q-30.5352 964.868 -36.3454 964.868 Q-42.1555 964.868 -45.2342 960.285 Q-48.2897 955.678 -48.2897 946.951 Q-48.2897 938.201 -45.2342 933.618 Q-42.1555 929.012 -36.3454 929.012 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-16.1834 958.317 L-11.2992 958.317 L-11.2992 964.197 L-16.1834 964.197 L-16.1834 958.317 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-0.303895 960.262 L7.33495 960.262 L7.33495 933.896 L-0.975188 935.563 L-0.975188 931.303 L7.28866 929.637 L11.9646 929.637 L11.9646 960.262 L19.6034 960.262 L19.6034 964.197 L-0.303895 964.197 L-0.303895 960.262 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M39.0477 932.715 Q35.4367 932.715 33.608 936.28 Q31.8024 939.822 31.8024 946.951 Q31.8024 954.058 33.608 957.623 Q35.4367 961.164 39.0477 961.164 Q42.682 961.164 44.4875 957.623 Q46.3162 954.058 46.3162 946.951 Q46.3162 939.822 44.4875 936.28 Q42.682 932.715 39.0477 932.715 M39.0477 929.012 Q44.8579 929.012 47.9134 933.618 Q50.9921 938.201 50.9921 946.951 Q50.9921 955.678 47.9134 960.285 Q44.8579 964.868 39.0477 964.868 Q33.2376 964.868 30.1589 960.285 Q27.1034 955.678 27.1034 946.951 Q27.1034 938.201 30.1589 933.618 Q33.2376 929.012 39.0477 929.012 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-35.35 699.579 Q-38.9611 699.579 -40.7898 703.144 Q-42.5953 706.685 -42.5953 713.815 Q-42.5953 720.921 -40.7898 724.486 Q-38.9611 728.028 -35.35 728.028 Q-31.7158 728.028 -29.9102 724.486 Q-28.0815 720.921 -28.0815 713.815 Q-28.0815 706.685 -29.9102 703.144 Q-31.7158 699.579 -35.35 699.579 M-35.35 695.875 Q-29.5398 695.875 -26.4843 700.482 Q-23.4056 705.065 -23.4056 713.815 Q-23.4056 722.542 -26.4843 727.148 Q-29.5398 731.732 -35.35 731.732 Q-41.1602 731.732 -44.2388 727.148 Q-47.2944 722.542 -47.2944 713.815 Q-47.2944 705.065 -44.2388 700.482 Q-41.1602 695.875 -35.35 695.875 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-15.1881 725.181 L-10.3038 725.181 L-10.3038 731.06 L-15.1881 731.06 L-15.1881 725.181 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M0.69147 727.125 L8.33032 727.125 L8.33032 700.76 L0.0201769 702.426 L0.0201769 698.167 L8.28402 696.5 L12.9599 696.5 L12.9599 727.125 L20.5988 727.125 L20.5988 731.06 L0.69147 731.06 L0.69147 727.125 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M30.0895 696.5 L48.4458 696.5 L48.4458 700.435 L34.3718 700.435 L34.3718 708.908 Q35.3904 708.56 36.4089 708.398 Q37.4274 708.213 38.4459 708.213 Q44.2329 708.213 47.6125 711.384 Q50.9921 714.556 50.9921 719.972 Q50.9921 725.551 47.5199 728.653 Q44.0477 731.732 37.7283 731.732 Q35.5524 731.732 33.2839 731.361 Q31.0385 730.991 28.6311 730.25 L28.6311 725.551 Q30.7145 726.685 32.9367 727.241 Q35.1589 727.796 37.6357 727.796 Q41.6403 727.796 43.9783 725.69 Q46.3162 723.583 46.3162 719.972 Q46.3162 716.361 43.9783 714.255 Q41.6403 712.148 37.6357 712.148 Q35.7607 712.148 33.8857 712.565 Q32.0339 712.982 30.0895 713.861 L30.0895 696.5 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-36.3454 466.443 Q-39.9565 466.443 -41.7852 470.007 Q-43.5907 473.549 -43.5907 480.679 Q-43.5907 487.785 -41.7852 491.35 Q-39.9565 494.891 -36.3454 494.891 Q-32.7111 494.891 -30.9056 491.35 Q-29.0769 487.785 -29.0769 480.679 Q-29.0769 473.549 -30.9056 470.007 Q-32.7111 466.443 -36.3454 466.443 M-36.3454 462.739 Q-30.5352 462.739 -27.4797 467.345 Q-24.401 471.929 -24.401 480.679 Q-24.401 489.405 -27.4797 494.012 Q-30.5352 498.595 -36.3454 498.595 Q-42.1555 498.595 -45.2342 494.012 Q-48.2897 489.405 -48.2897 480.679 Q-48.2897 471.929 -45.2342 467.345 Q-42.1555 462.739 -36.3454 462.739 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-16.1834 492.044 L-11.2992 492.044 L-11.2992 497.924 L-16.1834 497.924 L-16.1834 492.044 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M2.91368 493.989 L19.233 493.989 L19.233 497.924 L-2.71129 497.924 L-2.71129 493.989 Q-0.0492672 491.234 4.53404 486.604 Q9.1405 481.952 10.321 480.609 Q12.5664 478.086 13.446 476.35 Q14.3488 474.591 14.3488 472.901 Q14.3488 470.146 12.4044 468.41 Q10.4831 466.674 7.38125 466.674 Q5.18219 466.674 2.7285 467.438 Q0.297953 468.202 -2.47981 469.753 L-2.47981 465.03 Q0.344249 463.896 2.79794 463.318 Q5.25163 462.739 7.28866 462.739 Q12.659 462.739 15.8534 465.424 Q19.0479 468.109 19.0479 472.6 Q19.0479 474.73 18.2377 476.651 Q17.4506 478.549 15.3442 481.142 Q14.7655 481.813 11.6636 485.03 Q8.5618 488.225 2.91368 493.989 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M39.0477 466.443 Q35.4367 466.443 33.608 470.007 Q31.8024 473.549 31.8024 480.679 Q31.8024 487.785 33.608 491.35 Q35.4367 494.891 39.0477 494.891 Q42.682 494.891 44.4875 491.35 Q46.3162 487.785 46.3162 480.679 Q46.3162 473.549 44.4875 470.007 Q42.682 466.443 39.0477 466.443 M39.0477 462.739 Q44.8579 462.739 47.9134 467.345 Q50.9921 471.929 50.9921 480.679 Q50.9921 489.405 47.9134 494.012 Q44.8579 498.595 39.0477 498.595 Q33.2376 498.595 30.1589 494.012 Q27.1034 489.405 27.1034 480.679 Q27.1034 471.929 30.1589 467.345 Q33.2376 462.739 39.0477 462.739 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-35.35 233.306 Q-38.9611 233.306 -40.7898 236.871 Q-42.5953 240.413 -42.5953 247.542 Q-42.5953 254.649 -40.7898 258.213 Q-38.9611 261.755 -35.35 261.755 Q-31.7158 261.755 -29.9102 258.213 Q-28.0815 254.649 -28.0815 247.542 Q-28.0815 240.413 -29.9102 236.871 Q-31.7158 233.306 -35.35 233.306 M-35.35 229.602 Q-29.5398 229.602 -26.4843 234.209 Q-23.4056 238.792 -23.4056 247.542 Q-23.4056 256.269 -26.4843 260.875 Q-29.5398 265.459 -35.35 265.459 Q-41.1602 265.459 -44.2388 260.875 Q-47.2944 256.269 -47.2944 247.542 Q-47.2944 238.792 -44.2388 234.209 Q-41.1602 229.602 -35.35 229.602 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M-15.1881 258.908 L-10.3038 258.908 L-10.3038 264.787 L-15.1881 264.787 L-15.1881 258.908 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M3.90904 260.852 L20.2284 260.852 L20.2284 264.787 L-1.71592 264.787 L-1.71592 260.852 Q0.946098 258.098 5.52941 253.468 Q10.1359 248.815 11.3164 247.473 Q13.5618 244.95 14.4414 243.213 Q15.3442 241.454 15.3442 239.764 Q15.3442 237.01 13.3997 235.274 Q11.4784 233.538 8.37661 233.538 Q6.17755 233.538 3.72386 234.301 Q1.29332 235.065 -1.48444 236.616 L-1.48444 231.894 Q1.33961 230.76 3.7933 230.181 Q6.247 229.602 8.28402 229.602 Q13.6544 229.602 16.8488 232.288 Q20.0432 234.973 20.0432 239.463 Q20.0432 241.593 19.233 243.514 Q18.446 245.412 16.3395 248.005 Q15.7608 248.676 12.659 251.894 Q9.55716 255.088 3.90904 260.852 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip610)" d="M30.0895 230.227 L48.4458 230.227 L48.4458 234.163 L34.3718 234.163 L34.3718 242.635 Q35.3904 242.288 36.4089 242.125 Q37.4274 241.94 38.4459 241.94 Q44.2329 241.94 47.6125 245.112 Q50.9921 248.283 50.9921 253.699 Q50.9921 259.278 47.5199 262.38 Q44.0477 265.459 37.7283 265.459 Q35.5524 265.459 33.2839 265.088 Q31.0385 264.718 28.6311 263.977 L28.6311 259.278 Q30.7145 260.412 32.9367 260.968 Q35.1589 261.524 37.6357 261.524 Q41.6403 261.524 43.9783 259.417 Q46.3162 257.311 46.3162 253.699 Q46.3162 250.088 43.9783 247.982 Q41.6403 245.875 37.6357 245.875 Q35.7607 245.875 33.8857 246.292 Q32.0339 246.709 30.0895 247.588 L30.0895 230.227 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip612)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1413.19 162.518,1413.55 238.043,1140.47 313.569,738.554 389.094,788.982 464.619,826.342 540.145,807.081 615.67,661.461 691.196,651.685 766.721,728.043 
  842.247,427.472 917.772,340.431 993.298,137.14 1068.82,193.119 1144.35,566.739 1219.87,923.339 1295.4,1096.08 1370.92,1112.11 1446.45,1015.98 1521.98,1318.18 
  1597.5,1223.29 1673.03,1363.62 1748.55,1338.16 1824.08,989.952 1899.6,993.318 1975.13,657.19 2050.65,218.91 2126.18,181.599 2201.7,88.5087 2277.23,384.358 
  2352.76,701.694 
  "/>
<polyline clip-path="url(#clip612)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1413.19 162.518,1369.3 238.043,1346.63 313.569,1415.82 389.094,1414.12 464.619,1405.31 540.145,1384.88 615.67,1405.51 691.196,1419.29 766.721,1359.52 
  842.247,1391.24 917.772,1371.97 993.298,1411.86 1068.82,1463.68 1144.35,1464 1219.87,1437.07 1295.4,1413.16 1370.92,1395.24 1446.45,1458.85 1521.98,1397.09 
  1597.5,1434.27 1673.03,1408.63 1748.55,1356.72 1824.08,1410.26 1899.6,1355.94 1975.13,1337.1 2050.65,1397.54 2126.18,1388.31 2201.7,1450.19 2277.23,1456.11 
  2352.76,1372.18 
  "/>
<path clip-path="url(#clip610)" d="
M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip610)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 
  "/>
<polyline clip-path="url(#clip610)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  187.693,147.685 338.744,147.685 
  "/>
<path clip-path="url(#clip610)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip610)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  187.693,199.525 338.744,199.525 
  "/>
<path clip-path="url(#clip610)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.941354  1.23927  -0.34186  -0.00865762  …  -0.900207  -0.761735  1.06357</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip670">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip670)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip671">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip670)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip672">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip670)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1273.91 2352.76,1273.91 
  "/>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1022.69 2352.76,1022.69 
  "/>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,771.465 2352.76,771.465 
  "/>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,520.245 2352.76,520.245 
  "/>
<polyline clip-path="url(#clip672)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,269.024 2352.76,269.024 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1273.91 105.89,1273.91 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1022.69 105.89,1022.69 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,771.465 105.89,771.465 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,520.245 105.89,520.245 
  "/>
<polyline clip-path="url(#clip670)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,269.024 105.89,269.024 
  "/>
<path clip-path="url(#clip670)" d="M39.0477 1259.71 Q35.4367 1259.71 33.608 1263.27 Q31.8024 1266.81 31.8024 1273.94 Q31.8024 1281.05 33.608 1284.61 Q35.4367 1288.15 39.0477 1288.15 Q42.682 1288.15 44.4875 1284.61 Q46.3162 1281.05 46.3162 1273.94 Q46.3162 1266.81 44.4875 1263.27 Q42.682 1259.71 39.0477 1259.71 M39.0477 1256 Q44.8579 1256 47.9134 1260.61 Q50.9921 1265.19 50.9921 1273.94 Q50.9921 1282.67 47.9134 1287.28 Q44.8579 1291.86 39.0477 1291.86 Q33.2376 1291.86 30.1589 1287.28 Q27.1034 1282.67 27.1034 1273.94 Q27.1034 1265.19 30.1589 1260.61 Q33.2376 1256 39.0477 1256 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M30.0895 1005.41 L48.4458 1005.41 L48.4458 1009.34 L34.3718 1009.34 L34.3718 1017.81 Q35.3904 1017.47 36.4089 1017.3 Q37.4274 1017.12 38.4459 1017.12 Q44.2329 1017.12 47.6125 1020.29 Q50.9921 1023.46 50.9921 1028.88 Q50.9921 1034.46 47.5199 1037.56 Q44.0477 1040.64 37.7283 1040.64 Q35.5524 1040.64 33.2839 1040.27 Q31.0385 1039.9 28.6311 1039.16 L28.6311 1034.46 Q30.7145 1035.59 32.9367 1036.15 Q35.1589 1036.7 37.6357 1036.7 Q41.6403 1036.7 43.9783 1034.6 Q46.3162 1032.49 46.3162 1028.88 Q46.3162 1025.27 43.9783 1023.16 Q41.6403 1021.05 37.6357 1021.05 Q35.7607 1021.05 33.8857 1021.47 Q32.0339 1021.89 30.0895 1022.77 L30.0895 1005.41 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M-0.303895 784.81 L7.33495 784.81 L7.33495 758.445 L-0.975188 760.111 L-0.975188 755.852 L7.28866 754.185 L11.9646 754.185 L11.9646 784.81 L19.6034 784.81 L19.6034 788.745 L-0.303895 788.745 L-0.303895 784.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M39.0477 757.264 Q35.4367 757.264 33.608 760.829 Q31.8024 764.371 31.8024 771.5 Q31.8024 778.607 33.608 782.171 Q35.4367 785.713 39.0477 785.713 Q42.682 785.713 44.4875 782.171 Q46.3162 778.607 46.3162 771.5 Q46.3162 764.371 44.4875 760.829 Q42.682 757.264 39.0477 757.264 M39.0477 753.561 Q44.8579 753.561 47.9134 758.167 Q50.9921 762.75 50.9921 771.5 Q50.9921 780.227 47.9134 784.833 Q44.8579 789.417 39.0477 789.417 Q33.2376 789.417 30.1589 784.833 Q27.1034 780.227 27.1034 771.5 Q27.1034 762.75 30.1589 758.167 Q33.2376 753.561 39.0477 753.561 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M0.69147 533.59 L8.33032 533.59 L8.33032 507.224 L0.0201769 508.891 L0.0201769 504.631 L8.28402 502.965 L12.9599 502.965 L12.9599 533.59 L20.5988 533.59 L20.5988 537.525 L0.69147 537.525 L0.69147 533.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M30.0895 502.965 L48.4458 502.965 L48.4458 506.9 L34.3718 506.9 L34.3718 515.372 Q35.3904 515.025 36.4089 514.863 Q37.4274 514.678 38.4459 514.678 Q44.2329 514.678 47.6125 517.849 Q50.9921 521.02 50.9921 526.437 Q50.9921 532.015 47.5199 535.117 Q44.0477 538.196 37.7283 538.196 Q35.5524 538.196 33.2839 537.826 Q31.0385 537.455 28.6311 536.715 L28.6311 532.015 Q30.7145 533.15 32.9367 533.705 Q35.1589 534.261 37.6357 534.261 Q41.6403 534.261 43.9783 532.154 Q46.3162 530.048 46.3162 526.437 Q46.3162 522.826 43.9783 520.719 Q41.6403 518.613 37.6357 518.613 Q35.7607 518.613 33.8857 519.029 Q32.0339 519.446 30.0895 520.326 L30.0895 502.965 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M2.91368 282.369 L19.233 282.369 L19.233 286.304 L-2.71129 286.304 L-2.71129 282.369 Q-0.0492672 279.614 4.53404 274.985 Q9.1405 270.332 10.321 268.989 Q12.5664 266.466 13.446 264.73 Q14.3488 262.971 14.3488 261.281 Q14.3488 258.526 12.4044 256.79 Q10.4831 255.054 7.38125 255.054 Q5.18219 255.054 2.7285 255.818 Q0.297953 256.582 -2.47981 258.133 L-2.47981 253.411 Q0.344249 252.276 2.79794 251.698 Q5.25163 251.119 7.28866 251.119 Q12.659 251.119 15.8534 253.804 Q19.0479 256.489 19.0479 260.98 Q19.0479 263.11 18.2377 265.031 Q17.4506 266.929 15.3442 269.522 Q14.7655 270.193 11.6636 273.41 Q8.5618 276.605 2.91368 282.369 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip670)" d="M39.0477 254.823 Q35.4367 254.823 33.608 258.387 Q31.8024 261.929 31.8024 269.059 Q31.8024 276.165 33.608 279.73 Q35.4367 283.272 39.0477 283.272 Q42.682 283.272 44.4875 279.73 Q46.3162 276.165 46.3162 269.059 Q46.3162 261.929 44.4875 258.387 Q42.682 254.823 39.0477 254.823 M39.0477 251.119 Q44.8579 251.119 47.9134 255.725 Q50.9921 260.309 50.9921 269.059 Q50.9921 277.785 47.9134 282.392 Q44.8579 286.975 39.0477 286.975 Q33.2376 286.975 30.1589 282.392 Q27.1034 277.785 27.1034 269.059 Q27.1034 260.309 30.1589 255.725 Q33.2376 251.119 39.0477 251.119 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip672)" d="
M151.118 1360.52 L222.368 1431.71 L293.618 1476.15 L364.869 1479.3 L436.119 1469.61 L507.37 1457.3 L578.62 1448.12 L649.871 1441.74 L721.121 1438.32 L792.371 1431.01 
  L863.622 1423.04 L934.872 1417.76 L1006.12 1412.84 L1077.37 1409.22 L1148.62 1407.48 L1219.87 1401.42 L1291.12 1397.29 L1362.37 1389.69 L1433.63 1384.1 L1504.88 1378.29 
  L1576.13 1373.76 L1647.38 1368.74 L1718.63 1367.76 L1789.88 1363.09 L1861.13 1356.32 L1932.38 1350.35 L2003.63 1346.2 L2074.88 1339.27 L2146.13 1337.46 L2217.38 1335.49 
  L2288.63 1332.08 L2288.63 983.306 L2217.38 965.953 L2146.13 950.84 L2074.88 935.683 L2003.63 919.13 L1932.38 899.583 L1861.13 881.249 L1789.88 859.792 L1718.63 841.521 
  L1647.38 814.919 L1576.13 787.631 L1504.88 762.308 L1433.63 736.385 L1362.37 710.062 L1291.12 679.58 L1219.87 647.983 L1148.62 612.192 L1077.37 578.776 L1006.12 538.788 
  L934.872 501.283 L863.622 458.902 L792.371 417.899 L721.121 375.963 L649.871 329.27 L578.62 281.325 L507.37 230.51 L436.119 177.214 L364.869 121.655 L293.618 88.9544 
  L222.368 184.993 L151.118 1227.06  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip672)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1269.64 222.368,1294.59 293.618,1292.61 364.869,1293.73 436.119,1292.41 507.37,1291.29 578.62,1291.27 649.871,1291.65 721.121,1293.67 792.371,1293.37 
  863.622,1295.26 934.872,1294.71 1006.12,1294.22 1077.37,1293.23 1148.62,1290.59 1219.87,1287.23 1291.12,1282.48 1362.37,1282.45 1433.63,1282.76 1504.88,1282.31 
  1576.13,1281.97 1647.38,1281.21 1718.63,1279.58 1789.88,1281.11 1861.13,1280.08 1932.38,1280.09 2003.63,1277.03 2074.88,1278.05 2146.13,1275.56 2217.38,1276.92 
  2288.63,1278.65 
  "/>
<path clip-path="url(#clip672)" d="
M151.118 1354.65 L222.368 1290.86 L293.618 1276.93 L364.869 1274.98 L436.119 1274.52 L507.37 1274.5 L578.62 1274.71 L649.871 1274.72 L721.121 1274.67 L792.371 1274.69 
  L863.622 1274.72 L934.872 1274.57 L1006.12 1274.8 L1077.37 1275.04 L1148.62 1274.75 L1219.87 1274.74 L1291.12 1274.53 L1362.37 1274.63 L1433.63 1274.61 L1504.88 1274.51 
  L1576.13 1274.6 L1647.38 1274.86 L1718.63 1274.56 L1789.88 1274.42 L1861.13 1274.46 L1932.38 1274.6 L2003.63 1275.01 L2074.88 1274.77 L2146.13 1274.69 L2217.38 1274.68 
  L2288.63 1274.72 L2288.63 1272.97 L2217.38 1272.85 L2146.13 1273.16 L2074.88 1273.09 L2003.63 1273.34 L1932.38 1273.36 L1861.13 1273.18 L1789.88 1273.04 L1718.63 1273.08 
  L1647.38 1272.74 L1576.13 1273.15 L1504.88 1273.19 L1433.63 1273.07 L1362.37 1272.94 L1291.12 1273.08 L1219.87 1272.94 L1148.62 1273.2 L1077.37 1273.01 L1006.12 1273.24 
  L934.872 1273.06 L863.622 1273.24 L792.371 1273.02 L721.121 1273.08 L649.871 1273.17 L578.62 1272.95 L507.37 1272.85 L436.119 1272.89 L364.869 1272.91 L293.618 1270.05 
  L222.368 1255.21 L151.118 1180.9  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip672)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1287.29 222.368,1276.55 293.618,1274.33 364.869,1273.92 436.119,1273.86 507.37,1274.02 578.62,1273.95 649.871,1273.86 721.121,1273.98 792.371,1273.92 
  863.622,1273.88 934.872,1273.91 1006.12,1273.98 1077.37,1273.95 1148.62,1273.8 1219.87,1273.92 1291.12,1273.85 1362.37,1273.81 1433.63,1273.89 1504.88,1273.93 
  1576.13,1273.78 1647.38,1273.95 1718.63,1273.82 1789.88,1273.87 1861.13,1273.84 1932.38,1273.9 2003.63,1273.95 2074.88,1273.91 2146.13,1273.83 2217.38,1273.83 
  2288.63,1273.79 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">55.09685251172109</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([486.96594739592757, 3399.4468644795784], [52.097293101903404 0.4430794251659938; 421.18147018192644 2.3522388044856504], [7.970789868288967 -0.051393408949162556; 74.81829949498142 -0.5049248154222614;;; -0.051393408949162556 0.020965978363917313; -0.5049248154222614 0.1239132283577315], [88.61256852525476; 320.8142248609688;;], [58.282315401693936, 61.75745624258376], [10.881763410040048 0.4914341658335676; 1.7977864535301264 0.5081318657633536], [2.919654304820588 0.028620509890901466; -0.44086355528973276 0.031999371072481075;;; 0.028620509890901466 0.006228303486229405; 0.031999371072481075 0.005646353472444231], [3.046441336106277 3.2299885150961867 … -1.0950286869024002 0.0009329575991968757])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 5 January 2023 04:03">Thursday 5 January 2023</span>. Using Julia version 1.8.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
