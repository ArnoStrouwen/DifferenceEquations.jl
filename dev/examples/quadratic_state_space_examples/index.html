<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.000500148987281277]
 [0.0029491207935461337, -0.009206109716011884]
 [-0.05409120011925624, -0.002299704593290574]
 [-0.06569870507093091, -0.006329795176903834]
 [-0.10158422189071929, -0.0034513822058888756]
 [-0.11792297827885043, 0.006895580732824599]
 [-0.0692613034466497, 0.019486097176355348]
 [0.05603343167504779, 0.005794970542590944]
 [0.08920827118484997, -0.0020222481591688247]
 ⋮
 [0.24248824550526368, 0.010170799637928862]
 [0.2938215361486825, 0.008535948162501451]
 [0.3323538155090162, 0.00015356431184296174]
 [0.3165916952471359, -0.022637990653454402]
 [0.16143244563859088, 0.011477266866697937]
 [0.22497124083122252, -0.00539982045115428]
 [0.18016633644336538, 0.0121445896581078]
 [0.24697632620821075, 0.0017154229714237217]
 [0.2452103844474901, 0.009789502360828596]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip690">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip690)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip691">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip690)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip692">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip690)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1409.24 2352.76,1409.24 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1103.77 2352.76,1103.77 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,798.293 2352.76,798.293 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,492.818 2352.76,492.818 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,187.342 2352.76,187.342 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1409.24 105.89,1409.24 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1103.77 105.89,1103.77 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,798.293 105.89,798.293 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,492.818 105.89,492.818 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,187.342 105.89,187.342 "/>
<path clip-path="url(#clip690)" d="M-54.7249 1409.7 L-25.0491 1409.7 L-25.0491 1413.63 L-54.7249 1413.63 L-54.7249 1409.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-4.95665 1395.04 Q-8.56774 1395.04 -10.3964 1398.61 Q-12.202 1402.15 -12.202 1409.28 Q-12.202 1416.39 -10.3964 1419.95 Q-8.56774 1423.49 -4.95665 1423.49 Q-1.32241 1423.49 0.483137 1419.95 Q2.31183 1416.39 2.31183 1409.28 Q2.31183 1402.15 0.483137 1398.61 Q-1.32241 1395.04 -4.95665 1395.04 M-4.95665 1391.34 Q0.853506 1391.34 3.90904 1395.95 Q6.98773 1400.53 6.98773 1409.28 Q6.98773 1418.01 3.90904 1422.61 Q0.853506 1427.2 -4.95665 1427.2 Q-10.7668 1427.2 -13.8455 1422.61 Q-16.901 1418.01 -16.901 1409.28 Q-16.901 1400.53 -13.8455 1395.95 Q-10.7668 1391.34 -4.95665 1391.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M15.2053 1420.65 L20.0895 1420.65 L20.0895 1426.52 L15.2053 1426.52 L15.2053 1420.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M31.0848 1422.59 L38.7237 1422.59 L38.7237 1396.22 L30.4135 1397.89 L30.4135 1393.63 L38.6774 1391.96 L43.3533 1391.96 L43.3533 1422.59 L50.9921 1422.59 L50.9921 1426.52 L31.0848 1426.52 L31.0848 1422.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-6.18349 1089.57 Q-9.79459 1089.57 -11.6233 1093.13 Q-13.4288 1096.67 -13.4288 1103.8 Q-13.4288 1110.91 -11.6233 1114.48 Q-9.79459 1118.02 -6.18349 1118.02 Q-2.54925 1118.02 -0.743708 1114.48 Q1.08499 1110.91 1.08499 1103.8 Q1.08499 1096.67 -0.743708 1093.13 Q-2.54925 1089.57 -6.18349 1089.57 M-6.18349 1085.86 Q-0.37334 1085.86 2.6822 1090.47 Q5.76089 1095.05 5.76089 1103.8 Q5.76089 1112.53 2.6822 1117.14 Q-0.37334 1121.72 -6.18349 1121.72 Q-11.9936 1121.72 -15.0723 1117.14 Q-18.1279 1112.53 -18.1279 1103.8 Q-18.1279 1095.05 -15.0723 1090.47 Q-11.9936 1085.86 -6.18349 1085.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M13.9784 1115.17 L18.8627 1115.17 L18.8627 1121.05 L13.9784 1121.05 L13.9784 1115.17 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M39.0477 1089.57 Q35.4367 1089.57 33.608 1093.13 Q31.8024 1096.67 31.8024 1103.8 Q31.8024 1110.91 33.608 1114.48 Q35.4367 1118.02 39.0477 1118.02 Q42.682 1118.02 44.4875 1114.48 Q46.3162 1110.91 46.3162 1103.8 Q46.3162 1096.67 44.4875 1093.13 Q42.682 1089.57 39.0477 1089.57 M39.0477 1085.86 Q44.8579 1085.86 47.9134 1090.47 Q50.9921 1095.05 50.9921 1103.8 Q50.9921 1112.53 47.9134 1117.14 Q44.8579 1121.72 39.0477 1121.72 Q33.2376 1121.72 30.1589 1117.14 Q27.1034 1112.53 27.1034 1103.8 Q27.1034 1095.05 30.1589 1090.47 Q33.2376 1085.86 39.0477 1085.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-4.95665 784.092 Q-8.56774 784.092 -10.3964 787.657 Q-12.202 791.198 -12.202 798.328 Q-12.202 805.434 -10.3964 808.999 Q-8.56774 812.541 -4.95665 812.541 Q-1.32241 812.541 0.483137 808.999 Q2.31183 805.434 2.31183 798.328 Q2.31183 791.198 0.483137 787.657 Q-1.32241 784.092 -4.95665 784.092 M-4.95665 780.388 Q0.853506 780.388 3.90904 784.995 Q6.98773 789.578 6.98773 798.328 Q6.98773 807.055 3.90904 811.661 Q0.853506 816.245 -4.95665 816.245 Q-10.7668 816.245 -13.8455 811.661 Q-16.901 807.055 -16.901 798.328 Q-16.901 789.578 -13.8455 784.995 Q-10.7668 780.388 -4.95665 780.388 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M15.2053 809.694 L20.0895 809.694 L20.0895 815.573 L15.2053 815.573 L15.2053 809.694 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M31.0848 811.638 L38.7237 811.638 L38.7237 785.273 L30.4135 786.939 L30.4135 782.68 L38.6774 781.013 L43.3533 781.013 L43.3533 811.638 L50.9921 811.638 L50.9921 815.573 L31.0848 815.573 L31.0848 811.638 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-4.58628 478.616 Q-8.19737 478.616 -10.0261 482.181 Q-11.8316 485.723 -11.8316 492.852 Q-11.8316 499.959 -10.0261 503.524 Q-8.19737 507.065 -4.58628 507.065 Q-0.95204 507.065 0.853506 503.524 Q2.6822 499.959 2.6822 492.852 Q2.6822 485.723 0.853506 482.181 Q-0.95204 478.616 -4.58628 478.616 M-4.58628 474.913 Q1.22387 474.913 4.27941 479.519 Q7.3581 484.102 7.3581 492.852 Q7.3581 501.579 4.27941 506.186 Q1.22387 510.769 -4.58628 510.769 Q-10.3964 510.769 -13.4751 506.186 Q-16.5307 501.579 -16.5307 492.852 Q-16.5307 484.102 -13.4751 479.519 Q-10.3964 474.913 -4.58628 474.913 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M15.5756 504.218 L20.4599 504.218 L20.4599 510.098 L15.5756 510.098 L15.5756 504.218 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M34.6728 506.162 L50.9921 506.162 L50.9921 510.098 L29.0478 510.098 L29.0478 506.162 Q31.7098 503.408 36.2931 498.778 Q40.8996 494.125 42.0801 492.783 Q44.3255 490.26 45.2051 488.524 Q46.1079 486.764 46.1079 485.075 Q46.1079 482.32 44.1635 480.584 Q42.2422 478.848 39.1403 478.848 Q36.9413 478.848 34.4876 479.612 Q32.057 480.375 29.2793 481.926 L29.2793 477.204 Q32.1033 476.07 34.557 475.491 Q37.0107 474.913 39.0477 474.913 Q44.4181 474.913 47.6125 477.598 Q50.8069 480.283 50.8069 484.774 Q50.8069 486.903 49.9968 488.825 Q49.2097 490.723 47.1033 493.315 Q46.5246 493.987 43.4227 497.204 Q40.3209 500.399 34.6728 506.162 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-5.53535 173.14 Q-9.14644 173.14 -10.9751 176.705 Q-12.7807 180.247 -12.7807 187.376 Q-12.7807 194.483 -10.9751 198.048 Q-9.14644 201.589 -5.53535 201.589 Q-1.90111 201.589 -0.0955632 198.048 Q1.73313 194.483 1.73313 187.376 Q1.73313 180.247 -0.0955632 176.705 Q-1.90111 173.14 -5.53535 173.14 M-5.53535 169.437 Q0.274805 169.437 3.33034 174.043 Q6.40903 178.627 6.40903 187.376 Q6.40903 196.103 3.33034 200.71 Q0.274805 205.293 -5.53535 205.293 Q-11.3455 205.293 -14.4242 200.71 Q-17.4797 196.103 -17.4797 187.376 Q-17.4797 178.627 -14.4242 174.043 Q-11.3455 169.437 -5.53535 169.437 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M14.6266 198.742 L19.5108 198.742 L19.5108 204.622 L14.6266 204.622 L14.6266 198.742 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip690)" d="M43.8625 185.988 Q47.219 186.705 49.094 188.974 Q50.9921 191.242 50.9921 194.576 Q50.9921 199.691 47.4736 202.492 Q43.9551 205.293 37.4737 205.293 Q35.2978 205.293 32.983 204.853 Q30.6913 204.437 28.2376 203.58 L28.2376 199.066 Q30.1821 200.2 32.4969 200.779 Q34.8117 201.358 37.3348 201.358 Q41.7329 201.358 44.0246 199.622 Q46.3394 197.886 46.3394 194.576 Q46.3394 191.52 44.1866 189.807 Q42.057 188.071 38.2376 188.071 L34.2098 188.071 L34.2098 184.228 L38.4227 184.228 Q41.8718 184.228 43.7005 182.863 Q45.5292 181.474 45.5292 178.881 Q45.5292 176.219 43.6311 174.807 Q41.7561 173.372 38.2376 173.372 Q36.3163 173.372 34.1172 173.789 Q31.9182 174.205 29.2793 175.085 L29.2793 170.918 Q31.9413 170.178 34.2561 169.807 Q36.5941 169.437 38.6542 169.437 Q43.9783 169.437 47.0801 171.867 Q50.1819 174.275 50.1819 178.395 Q50.1819 181.265 48.5384 183.256 Q46.8949 185.224 43.8625 185.988 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip692)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1103.77 162.518,1104.01 238.043,1094.76 313.569,1269 389.094,1304.46 464.619,1414.08 540.145,1464 615.67,1315.35 691.196,932.601 766.721,831.259 842.247,883.427 917.772,1012.39 993.298,787.108 1068.82,757.373 1144.35,810.758 1219.87,585.882 1295.4,432.967 1370.92,583.947 1446.45,616.756 1521.98,497.677 1597.5,313.121 1673.03,509.258 1748.55,363.026 1824.08,206.215 1899.6,88.5087 1975.13,136.658 2050.65,610.632 2126.18,416.536 2201.7,553.405 2277.23,349.316 2352.76,354.711 "/>
<polyline clip-path="url(#clip692)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1103.77 162.518,1102.24 238.043,1131.89 313.569,1110.79 389.094,1123.11 464.619,1114.31 540.145,1082.7 615.67,1044.24 691.196,1086.07 766.721,1109.95 842.247,1122.8 917.772,1066.89 993.298,1096.4 1068.82,1109.54 1144.35,1065.38 1219.87,1075.08 1295.4,1122.68 1370.92,1104.83 1446.45,1080.72 1521.98,1069.34 1597.5,1129.02 1673.03,1075.54 1748.55,1072.7 1824.08,1077.69 1899.6,1103.3 1975.13,1172.92 2050.65,1068.71 2126.18,1120.26 2201.7,1066.67 2277.23,1098.53 2352.76,1073.86 "/>
<path clip-path="url(#clip690)" d="M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 "/>
<polyline clip-path="url(#clip690)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,147.685 338.744,147.685 "/>
<path clip-path="url(#clip690)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip690)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,199.525 338.744,199.525 "/>
<path clip-path="url(#clip690)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.0500149  -0.930614  -0.0458483  …  1.32246  -0.0713495  0.944642</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip750">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip750)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip751">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip750)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip752">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip750)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1501 2352.76,1501 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1134.49 2352.76,1134.49 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,767.971 2352.76,767.971 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,401.458 2352.76,401.458 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1501 105.89,1501 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1134.49 105.89,1134.49 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,767.971 105.89,767.971 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,401.458 105.89,401.458 "/>
<path clip-path="url(#clip750)" d="M-9.72514 1501.45 L19.9506 1501.45 L19.9506 1505.39 L-9.72514 1505.39 L-9.72514 1501.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 1483.72 L48.4458 1483.72 L48.4458 1487.65 L34.3718 1487.65 L34.3718 1496.13 Q35.3904 1495.78 36.4089 1495.62 Q37.4274 1495.43 38.4459 1495.43 Q44.2329 1495.43 47.6125 1498.6 Q50.9921 1501.77 50.9921 1507.19 Q50.9921 1512.77 47.5199 1515.87 Q44.0477 1518.95 37.7283 1518.95 Q35.5524 1518.95 33.2839 1518.58 Q31.0385 1518.21 28.6311 1517.47 L28.6311 1512.77 Q30.7145 1513.9 32.9367 1514.46 Q35.1589 1515.02 37.6357 1515.02 Q41.6403 1515.02 43.9783 1512.91 Q46.3162 1510.8 46.3162 1507.19 Q46.3162 1503.58 43.9783 1501.47 Q41.6403 1499.37 37.6357 1499.37 Q35.7607 1499.37 33.8857 1499.78 Q32.0339 1500.2 30.0895 1501.08 L30.0895 1483.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 1120.28 Q35.4367 1120.28 33.608 1123.85 Q31.8024 1127.39 31.8024 1134.52 Q31.8024 1141.63 33.608 1145.19 Q35.4367 1148.73 39.0477 1148.73 Q42.682 1148.73 44.4875 1145.19 Q46.3162 1141.63 46.3162 1134.52 Q46.3162 1127.39 44.4875 1123.85 Q42.682 1120.28 39.0477 1120.28 M39.0477 1116.58 Q44.8579 1116.58 47.9134 1121.19 Q50.9921 1125.77 50.9921 1134.52 Q50.9921 1143.25 47.9134 1147.85 Q44.8579 1152.44 39.0477 1152.44 Q33.2376 1152.44 30.1589 1147.85 Q27.1034 1143.25 27.1034 1134.52 Q27.1034 1125.77 30.1589 1121.19 Q33.2376 1116.58 39.0477 1116.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 750.691 L48.4458 750.691 L48.4458 754.626 L34.3718 754.626 L34.3718 763.099 Q35.3904 762.751 36.4089 762.589 Q37.4274 762.404 38.4459 762.404 Q44.2329 762.404 47.6125 765.575 Q50.9921 768.747 50.9921 774.163 Q50.9921 779.742 47.5199 782.844 Q44.0477 785.923 37.7283 785.923 Q35.5524 785.923 33.2839 785.552 Q31.0385 785.182 28.6311 784.441 L28.6311 779.742 Q30.7145 780.876 32.9367 781.432 Q35.1589 781.987 37.6357 781.987 Q41.6403 781.987 43.9783 779.881 Q46.3162 777.774 46.3162 774.163 Q46.3162 770.552 43.9783 768.446 Q41.6403 766.339 37.6357 766.339 Q35.7607 766.339 33.8857 766.756 Q32.0339 767.173 30.0895 768.052 L30.0895 750.691 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-0.303895 414.802 L7.33495 414.802 L7.33495 388.437 L-0.975188 390.103 L-0.975188 385.844 L7.28866 384.178 L11.9646 384.178 L11.9646 414.802 L19.6034 414.802 L19.6034 418.738 L-0.303895 418.738 L-0.303895 414.802 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 387.256 Q35.4367 387.256 33.608 390.821 Q31.8024 394.363 31.8024 401.492 Q31.8024 408.599 33.608 412.163 Q35.4367 415.705 39.0477 415.705 Q42.682 415.705 44.4875 412.163 Q46.3162 408.599 46.3162 401.492 Q46.3162 394.363 44.4875 390.821 Q42.682 387.256 39.0477 387.256 M39.0477 383.553 Q44.8579 383.553 47.9134 388.159 Q50.9921 392.742 50.9921 401.492 Q50.9921 410.219 47.9134 414.826 Q44.8579 419.409 39.0477 419.409 Q33.2376 419.409 30.1589 414.826 Q27.1034 410.219 27.1034 401.492 Q27.1034 392.742 30.1589 388.159 Q33.2376 383.553 39.0477 383.553 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip752)" d="M151.118 1273.92 L222.368 1411.29 L293.618 1477.84 L364.869 1479.3 L436.119 1467.97 L507.37 1459.12 L578.62 1445.29 L649.871 1430.18 L721.121 1412.42 L792.371 1397.91 L863.622 1387.26 L934.872 1375.4 L1006.12 1360.09 L1077.37 1345.96 L1148.62 1341.77 L1219.87 1333.82 L1291.12 1319.9 L1362.37 1311.24 L1433.63 1305.96 L1504.88 1296.15 L1576.13 1284.36 L1647.38 1279.31 L1718.63 1275.64 L1789.88 1268.62 L1861.13 1262.85 L1932.38 1253.82 L2003.63 1244.58 L2074.88 1237.37 L2146.13 1229.45 L2217.38 1220.3 L2288.63 1217.77 L2288.63 872.083 L2217.38 860.766 L2146.13 840.802 L2074.88 825.684 L2003.63 803.082 L1932.38 785.737 L1861.13 764.955 L1789.88 749.07 L1718.63 727.456 L1647.38 705.613 L1576.13 688.024 L1504.88 662.916 L1433.63 642.662 L1362.37 618.931 L1291.12 599.01 L1219.87 570.667 L1148.62 546.737 L1077.37 523.577 L1006.12 492.277 L934.872 460.695 L863.622 423.633 L792.371 388.743 L721.121 357.124 L649.871 315.808 L578.62 269.47 L507.37 222.355 L436.119 172.065 L364.869 120.822 L293.618 88.9544 L222.368 168.157 L151.118 1023.59  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip752)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1160.16 222.368,1107.45 293.618,1090.8 364.869,1088.57 436.119,1089.03 507.37,1081.45 578.62,1079.09 649.871,1084.84 721.121,1082.71 792.371,1088.12 863.622,1088.79 934.872,1093.99 1006.12,1100.89 1077.37,1104.75 1148.62,1108.83 1219.87,1112.1 1291.12,1111.5 1362.37,1109.53 1433.63,1108.87 1504.88,1105.34 1576.13,1103.55 1647.38,1107.56 1718.63,1111.57 1789.88,1111.73 1861.13,1114.22 1932.38,1114.36 2003.63,1112.23 2074.88,1113.55 2146.13,1117.29 2217.38,1121.05 2288.63,1125.49 "/>
<path clip-path="url(#clip752)" d="M151.118 1241.4 L222.368 1155.79 L293.618 1139.36 L364.869 1135.67 L436.119 1135.58 L507.37 1135.27 L578.62 1135.74 L649.871 1135.57 L721.121 1135.27 L792.371 1135.86 L863.622 1135.36 L934.872 1135.83 L1006.12 1135.94 L1077.37 1135.9 L1148.62 1135.56 L1219.87 1135.32 L1291.12 1135.66 L1362.37 1135.95 L1433.63 1135.42 L1504.88 1135.57 L1576.13 1135.56 L1647.38 1135.89 L1718.63 1135.68 L1789.88 1135.48 L1861.13 1135.59 L1932.38 1135.54 L2003.63 1135.82 L2074.88 1135.55 L2146.13 1135.91 L2217.38 1135.51 L2288.63 1135.45 L2288.63 1133.08 L2217.38 1133.41 L2146.13 1133.08 L2074.88 1133.63 L2003.63 1133.05 L1932.38 1133.15 L1861.13 1133.48 L1789.88 1133.47 L1718.63 1133.66 L1647.38 1133.26 L1576.13 1133.75 L1504.88 1133.32 L1433.63 1133.33 L1362.37 1133.2 L1291.12 1133.35 L1219.87 1133.44 L1148.62 1133.33 L1077.37 1133.3 L1006.12 1133.69 L934.872 1132.95 L863.622 1133.02 L792.371 1133.32 L721.121 1133.21 L649.871 1133.15 L578.62 1133.59 L507.37 1133.38 L436.119 1133.38 L364.869 1133.56 L293.618 1131.28 L222.368 1116.53 L151.118 1043.29  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip752)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1131.69 222.368,1133.4 293.618,1134.11 364.869,1134.52 436.119,1134.53 507.37,1134.22 578.62,1134.55 649.871,1134.43 721.121,1134.45 792.371,1134.52 863.622,1134.43 934.872,1134.74 1006.12,1134.52 1077.37,1134.75 1148.62,1134.59 1219.87,1134.27 1291.12,1134.48 1362.37,1134.42 1433.63,1134.36 1504.88,1134.37 1576.13,1134.39 1647.38,1134.45 1718.63,1134.71 1789.88,1134.41 1861.13,1134.42 1932.38,1134.44 2003.63,1134.54 2074.88,1134.59 2146.13,1134.37 2217.38,1134.49 2288.63,1134.66 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">55.986380327542584</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-198.09035968927103, -1346.156307076546], [18.67502558308455 0.40520626209068483; 123.26035380358492 3.8382172350132553], [0.5992639994573732 0.09536009393380462; -0.33193655271953193 0.5343717445591247;;; 0.09536009393380462 -0.014937643496103643; 0.5343717445591247 -0.0629287695731991], [80.4790195172923; 241.92190397840466;;], [-77.43025969896789, -27.31915452194256], [-0.3149689530312647 -0.0038698724313913947; 2.5096644415091385 0.5022908717271188], [-0.10851489016189726 -0.03832654670289098; 0.5304401906903397 0.12436577557168556;;; -0.03832654670289098 -0.0051360542153886385; 0.12436577557168556 0.0008707362192533079], [-2.1942496181210944 -2.8651980529965515 … 0.7650912271493725 -0.05116627614668698])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 11 September 2023 10:48">Monday 11 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
