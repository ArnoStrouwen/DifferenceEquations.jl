<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.0005103155584744515]
 [-0.003315727246048348, -0.0025892220659390996]
 [-0.019259839551623765, -0.007297566034974023]
 [-0.0634440712000588, 0.009894803985706307]
 [0.0012609674814508566, -0.010314784722778827]
 [-0.062499895746402856, -0.00818327513731388]
 [-0.1099460465965705, -0.008725807385136855]
 [-0.15832624570447104, -0.007872567039678795]
 [-0.1990248519709703, -0.011927568053017586]
 ⋮
 [0.03950972633864999, 0.004012129716646927]
 [0.062391523771183885, -0.02461547428029151]
 [-0.09162805322178476, -0.006722566269002269]
 [-0.12862225216120216, 0.018790038303171976]
 [-0.004836701356391784, 0.008483556332408356]
 [0.04814517521125374, -0.0008240441353259563]
 [0.040549858952107005, 0.0012686679338420378]
 [0.046317788688919365, 0.002144341033018429]
 [0.05723880675928618, -0.014118872708909762]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip800">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip800)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip801">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip800)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip802">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip800)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1411.05 2352.76,1411.05 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1199.37 2352.76,1199.37 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,987.693 2352.76,987.693 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,776.012 2352.76,776.012 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,564.331 2352.76,564.331 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,352.65 2352.76,352.65 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,140.97 2352.76,140.97 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1411.05 105.89,1411.05 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1199.37 105.89,1199.37 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,987.693 105.89,987.693 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,776.012 105.89,776.012 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,564.331 105.89,564.331 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,352.65 105.89,352.65 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,140.97 105.89,140.97 
  "/>
<path clip-path="url(#clip800)" d="M-85.1183 1411.51 L-55.4425 1411.51 L-55.4425 1415.44 L-85.1183 1415.44 L-85.1183 1411.51 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-35.35 1396.85 Q-38.9611 1396.85 -40.7898 1400.42 Q-42.5953 1403.96 -42.5953 1411.09 Q-42.5953 1418.2 -40.7898 1421.76 Q-38.9611 1425.3 -35.35 1425.3 Q-31.7158 1425.3 -29.9102 1421.76 Q-28.0815 1418.2 -28.0815 1411.09 Q-28.0815 1403.96 -29.9102 1400.42 Q-31.7158 1396.85 -35.35 1396.85 M-35.35 1393.15 Q-29.5398 1393.15 -26.4843 1397.76 Q-23.4056 1402.34 -23.4056 1411.09 Q-23.4056 1419.82 -26.4843 1424.42 Q-29.5398 1429.01 -35.35 1429.01 Q-41.1602 1429.01 -44.2388 1424.42 Q-47.2944 1419.82 -47.2944 1411.09 Q-47.2944 1402.34 -44.2388 1397.76 Q-41.1602 1393.15 -35.35 1393.15 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-15.1881 1422.45 L-10.3038 1422.45 L-10.3038 1428.33 L-15.1881 1428.33 L-15.1881 1422.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M3.90904 1424.4 L20.2284 1424.4 L20.2284 1428.33 L-1.71592 1428.33 L-1.71592 1424.4 Q0.946098 1421.64 5.52941 1417.01 Q10.1359 1412.36 11.3164 1411.02 Q13.5618 1408.5 14.4414 1406.76 Q15.3442 1405 15.3442 1403.31 Q15.3442 1400.56 13.3997 1398.82 Q11.4784 1397.08 8.37661 1397.08 Q6.17755 1397.08 3.72386 1397.85 Q1.29332 1398.61 -1.48444 1400.16 L-1.48444 1395.44 Q1.33961 1394.31 3.7933 1393.73 Q6.247 1393.15 8.28402 1393.15 Q13.6544 1393.15 16.8488 1395.83 Q20.0432 1398.52 20.0432 1403.01 Q20.0432 1405.14 19.233 1407.06 Q18.446 1408.96 16.3395 1411.55 Q15.7608 1412.22 12.659 1415.44 Q9.55716 1418.64 3.90904 1424.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M30.0895 1393.77 L48.4458 1393.77 L48.4458 1397.71 L34.3718 1397.71 L34.3718 1406.18 Q35.3904 1405.83 36.4089 1405.67 Q37.4274 1405.49 38.4459 1405.49 Q44.2329 1405.49 47.6125 1408.66 Q50.9921 1411.83 50.9921 1417.25 Q50.9921 1422.82 47.5199 1425.93 Q44.0477 1429.01 37.7283 1429.01 Q35.5524 1429.01 33.2839 1428.64 Q31.0385 1428.26 28.6311 1427.52 L28.6311 1422.82 Q30.7145 1423.96 32.9367 1424.51 Q35.1589 1425.07 37.6357 1425.07 Q41.6403 1425.07 43.9783 1422.96 Q46.3162 1420.86 46.3162 1417.25 Q46.3162 1413.64 43.9783 1411.53 Q41.6403 1409.42 37.6357 1409.42 Q35.7607 1409.42 33.8857 1409.84 Q32.0339 1410.26 30.0895 1411.14 L30.0895 1393.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-86.1136 1199.82 L-56.4379 1199.82 L-56.4379 1203.76 L-86.1136 1203.76 L-86.1136 1199.82 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-36.3454 1185.17 Q-39.9565 1185.17 -41.7852 1188.74 Q-43.5907 1192.28 -43.5907 1199.41 Q-43.5907 1206.51 -41.7852 1210.08 Q-39.9565 1213.62 -36.3454 1213.62 Q-32.7111 1213.62 -30.9056 1210.08 Q-29.0769 1206.51 -29.0769 1199.41 Q-29.0769 1192.28 -30.9056 1188.74 Q-32.7111 1185.17 -36.3454 1185.17 M-36.3454 1181.47 Q-30.5352 1181.47 -27.4797 1186.07 Q-24.401 1190.66 -24.401 1199.41 Q-24.401 1208.13 -27.4797 1212.74 Q-30.5352 1217.32 -36.3454 1217.32 Q-42.1555 1217.32 -45.2342 1212.74 Q-48.2897 1208.13 -48.2897 1199.41 Q-48.2897 1190.66 -45.2342 1186.07 Q-42.1555 1181.47 -36.3454 1181.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-16.1834 1210.77 L-11.2992 1210.77 L-11.2992 1216.65 L-16.1834 1216.65 L-16.1834 1210.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M2.91368 1212.72 L19.233 1212.72 L19.233 1216.65 L-2.71129 1216.65 L-2.71129 1212.72 Q-0.0492672 1209.96 4.53404 1205.33 Q9.1405 1200.68 10.321 1199.34 Q12.5664 1196.82 13.446 1195.08 Q14.3488 1193.32 14.3488 1191.63 Q14.3488 1188.88 12.4044 1187.14 Q10.4831 1185.4 7.38125 1185.4 Q5.18219 1185.4 2.7285 1186.17 Q0.297953 1186.93 -2.47981 1188.48 L-2.47981 1183.76 Q0.344249 1182.63 2.79794 1182.05 Q5.25163 1181.47 7.28866 1181.47 Q12.659 1181.47 15.8534 1184.15 Q19.0479 1186.84 19.0479 1191.33 Q19.0479 1193.46 18.2377 1195.38 Q17.4506 1197.28 15.3442 1199.87 Q14.7655 1200.54 11.6636 1203.76 Q8.5618 1206.95 2.91368 1212.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M39.0477 1185.17 Q35.4367 1185.17 33.608 1188.74 Q31.8024 1192.28 31.8024 1199.41 Q31.8024 1206.51 33.608 1210.08 Q35.4367 1213.62 39.0477 1213.62 Q42.682 1213.62 44.4875 1210.08 Q46.3162 1206.51 46.3162 1199.41 Q46.3162 1192.28 44.4875 1188.74 Q42.682 1185.17 39.0477 1185.17 M39.0477 1181.47 Q44.8579 1181.47 47.9134 1186.07 Q50.9921 1190.66 50.9921 1199.41 Q50.9921 1208.13 47.9134 1212.74 Q44.8579 1217.32 39.0477 1217.32 Q33.2376 1217.32 30.1589 1212.74 Q27.1034 1208.13 27.1034 1199.41 Q27.1034 1190.66 30.1589 1186.07 Q33.2376 1181.47 39.0477 1181.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-85.1183 988.144 L-55.4425 988.144 L-55.4425 992.079 L-85.1183 992.079 L-85.1183 988.144 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-35.35 973.491 Q-38.9611 973.491 -40.7898 977.056 Q-42.5953 980.598 -42.5953 987.727 Q-42.5953 994.834 -40.7898 998.399 Q-38.9611 1001.94 -35.35 1001.94 Q-31.7158 1001.94 -29.9102 998.399 Q-28.0815 994.834 -28.0815 987.727 Q-28.0815 980.598 -29.9102 977.056 Q-31.7158 973.491 -35.35 973.491 M-35.35 969.788 Q-29.5398 969.788 -26.4843 974.394 Q-23.4056 978.977 -23.4056 987.727 Q-23.4056 996.454 -26.4843 1001.06 Q-29.5398 1005.64 -35.35 1005.64 Q-41.1602 1005.64 -44.2388 1001.06 Q-47.2944 996.454 -47.2944 987.727 Q-47.2944 978.977 -44.2388 974.394 Q-41.1602 969.788 -35.35 969.788 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-15.1881 999.093 L-10.3038 999.093 L-10.3038 1004.97 L-15.1881 1004.97 L-15.1881 999.093 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M0.69147 1001.04 L8.33032 1001.04 L8.33032 974.672 L0.0201769 976.339 L0.0201769 972.079 L8.28402 970.413 L12.9599 970.413 L12.9599 1001.04 L20.5988 1001.04 L20.5988 1004.97 L0.69147 1004.97 L0.69147 1001.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M30.0895 970.413 L48.4458 970.413 L48.4458 974.348 L34.3718 974.348 L34.3718 982.82 Q35.3904 982.473 36.4089 982.311 Q37.4274 982.126 38.4459 982.126 Q44.2329 982.126 47.6125 985.297 Q50.9921 988.468 50.9921 993.885 Q50.9921 999.463 47.5199 1002.57 Q44.0477 1005.64 37.7283 1005.64 Q35.5524 1005.64 33.2839 1005.27 Q31.0385 1004.9 28.6311 1004.16 L28.6311 999.463 Q30.7145 1000.6 32.9367 1001.15 Q35.1589 1001.71 37.6357 1001.71 Q41.6403 1001.71 43.9783 999.602 Q46.3162 997.496 46.3162 993.885 Q46.3162 990.274 43.9783 988.167 Q41.6403 986.061 37.6357 986.061 Q35.7607 986.061 33.8857 986.477 Q32.0339 986.894 30.0895 987.774 L30.0895 970.413 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-86.1136 776.463 L-56.4379 776.463 L-56.4379 780.398 L-86.1136 780.398 L-86.1136 776.463 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-36.3454 761.811 Q-39.9565 761.811 -41.7852 765.375 Q-43.5907 768.917 -43.5907 776.047 Q-43.5907 783.153 -41.7852 786.718 Q-39.9565 790.26 -36.3454 790.26 Q-32.7111 790.26 -30.9056 786.718 Q-29.0769 783.153 -29.0769 776.047 Q-29.0769 768.917 -30.9056 765.375 Q-32.7111 761.811 -36.3454 761.811 M-36.3454 758.107 Q-30.5352 758.107 -27.4797 762.713 Q-24.401 767.297 -24.401 776.047 Q-24.401 784.773 -27.4797 789.38 Q-30.5352 793.963 -36.3454 793.963 Q-42.1555 793.963 -45.2342 789.38 Q-48.2897 784.773 -48.2897 776.047 Q-48.2897 767.297 -45.2342 762.713 Q-42.1555 758.107 -36.3454 758.107 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-16.1834 787.412 L-11.2992 787.412 L-11.2992 793.292 L-16.1834 793.292 L-16.1834 787.412 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-0.303895 789.357 L7.33495 789.357 L7.33495 762.991 L-0.975188 764.658 L-0.975188 760.399 L7.28866 758.732 L11.9646 758.732 L11.9646 789.357 L19.6034 789.357 L19.6034 793.292 L-0.303895 793.292 L-0.303895 789.357 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M39.0477 761.811 Q35.4367 761.811 33.608 765.375 Q31.8024 768.917 31.8024 776.047 Q31.8024 783.153 33.608 786.718 Q35.4367 790.26 39.0477 790.26 Q42.682 790.26 44.4875 786.718 Q46.3162 783.153 46.3162 776.047 Q46.3162 768.917 44.4875 765.375 Q42.682 761.811 39.0477 761.811 M39.0477 758.107 Q44.8579 758.107 47.9134 762.713 Q50.9921 767.297 50.9921 776.047 Q50.9921 784.773 47.9134 789.38 Q44.8579 793.963 39.0477 793.963 Q33.2376 793.963 30.1589 789.38 Q27.1034 784.773 27.1034 776.047 Q27.1034 767.297 30.1589 762.713 Q33.2376 758.107 39.0477 758.107 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-85.1183 564.783 L-55.4425 564.783 L-55.4425 568.718 L-85.1183 568.718 L-85.1183 564.783 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-35.35 550.13 Q-38.9611 550.13 -40.7898 553.695 Q-42.5953 557.236 -42.5953 564.366 Q-42.5953 571.472 -40.7898 575.037 Q-38.9611 578.579 -35.35 578.579 Q-31.7158 578.579 -29.9102 575.037 Q-28.0815 571.472 -28.0815 564.366 Q-28.0815 557.236 -29.9102 553.695 Q-31.7158 550.13 -35.35 550.13 M-35.35 546.426 Q-29.5398 546.426 -26.4843 551.033 Q-23.4056 555.616 -23.4056 564.366 Q-23.4056 573.093 -26.4843 577.699 Q-29.5398 582.282 -35.35 582.282 Q-41.1602 582.282 -44.2388 577.699 Q-47.2944 573.093 -47.2944 564.366 Q-47.2944 555.616 -44.2388 551.033 Q-41.1602 546.426 -35.35 546.426 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-15.1881 575.732 L-10.3038 575.732 L-10.3038 581.611 L-15.1881 581.611 L-15.1881 575.732 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M9.88124 550.13 Q6.27014 550.13 4.44145 553.695 Q2.6359 557.236 2.6359 564.366 Q2.6359 571.472 4.44145 575.037 Q6.27014 578.579 9.88124 578.579 Q13.5155 578.579 15.321 575.037 Q17.1497 571.472 17.1497 564.366 Q17.1497 557.236 15.321 553.695 Q13.5155 550.13 9.88124 550.13 M9.88124 546.426 Q15.6914 546.426 18.7469 551.033 Q21.8256 555.616 21.8256 564.366 Q21.8256 573.093 18.7469 577.699 Q15.6914 582.282 9.88124 582.282 Q4.07108 582.282 0.992394 577.699 Q-2.06315 573.093 -2.06315 564.366 Q-2.06315 555.616 0.992394 551.033 Q4.07108 546.426 9.88124 546.426 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M30.0895 547.051 L48.4458 547.051 L48.4458 550.986 L34.3718 550.986 L34.3718 559.458 Q35.3904 559.111 36.4089 558.949 Q37.4274 558.764 38.4459 558.764 Q44.2329 558.764 47.6125 561.935 Q50.9921 565.107 50.9921 570.523 Q50.9921 576.102 47.5199 579.204 Q44.0477 582.282 37.7283 582.282 Q35.5524 582.282 33.2839 581.912 Q31.0385 581.542 28.6311 580.801 L28.6311 576.102 Q30.7145 577.236 32.9367 577.792 Q35.1589 578.347 37.6357 578.347 Q41.6403 578.347 43.9783 576.241 Q46.3162 574.134 46.3162 570.523 Q46.3162 566.912 43.9783 564.806 Q41.6403 562.699 37.6357 562.699 Q35.7607 562.699 33.8857 563.116 Q32.0339 563.533 30.0895 564.412 L30.0895 547.051 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-36.3454 338.449 Q-39.9565 338.449 -41.7852 342.014 Q-43.5907 345.556 -43.5907 352.685 Q-43.5907 359.792 -41.7852 363.356 Q-39.9565 366.898 -36.3454 366.898 Q-32.7111 366.898 -30.9056 363.356 Q-29.0769 359.792 -29.0769 352.685 Q-29.0769 345.556 -30.9056 342.014 Q-32.7111 338.449 -36.3454 338.449 M-36.3454 334.745 Q-30.5352 334.745 -27.4797 339.352 Q-24.401 343.935 -24.401 352.685 Q-24.401 361.412 -27.4797 366.018 Q-30.5352 370.602 -36.3454 370.602 Q-42.1555 370.602 -45.2342 366.018 Q-48.2897 361.412 -48.2897 352.685 Q-48.2897 343.935 -45.2342 339.352 Q-42.1555 334.745 -36.3454 334.745 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-16.1834 364.051 L-11.2992 364.051 L-11.2992 369.93 L-16.1834 369.93 L-16.1834 364.051 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M8.88587 338.449 Q5.27478 338.449 3.44608 342.014 Q1.64054 345.556 1.64054 352.685 Q1.64054 359.792 3.44608 363.356 Q5.27478 366.898 8.88587 366.898 Q12.5201 366.898 14.3257 363.356 Q16.1543 359.792 16.1543 352.685 Q16.1543 345.556 14.3257 342.014 Q12.5201 338.449 8.88587 338.449 M8.88587 334.745 Q14.696 334.745 17.7516 339.352 Q20.8303 343.935 20.8303 352.685 Q20.8303 361.412 17.7516 366.018 Q14.696 370.602 8.88587 370.602 Q3.07572 370.602 -0.00297114 366.018 Q-3.05851 361.412 -3.05851 352.685 Q-3.05851 343.935 -0.00297114 339.352 Q3.07572 334.745 8.88587 334.745 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M39.0477 338.449 Q35.4367 338.449 33.608 342.014 Q31.8024 345.556 31.8024 352.685 Q31.8024 359.792 33.608 363.356 Q35.4367 366.898 39.0477 366.898 Q42.682 366.898 44.4875 363.356 Q46.3162 359.792 46.3162 352.685 Q46.3162 345.556 44.4875 342.014 Q42.682 338.449 39.0477 338.449 M39.0477 334.745 Q44.8579 334.745 47.9134 339.352 Q50.9921 343.935 50.9921 352.685 Q50.9921 361.412 47.9134 366.018 Q44.8579 370.602 39.0477 370.602 Q33.2376 370.602 30.1589 366.018 Q27.1034 361.412 27.1034 352.685 Q27.1034 343.935 30.1589 339.352 Q33.2376 334.745 39.0477 334.745 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-35.35 126.768 Q-38.9611 126.768 -40.7898 130.333 Q-42.5953 133.875 -42.5953 141.004 Q-42.5953 148.111 -40.7898 151.676 Q-38.9611 155.217 -35.35 155.217 Q-31.7158 155.217 -29.9102 151.676 Q-28.0815 148.111 -28.0815 141.004 Q-28.0815 133.875 -29.9102 130.333 Q-31.7158 126.768 -35.35 126.768 M-35.35 123.065 Q-29.5398 123.065 -26.4843 127.671 Q-23.4056 132.254 -23.4056 141.004 Q-23.4056 149.731 -26.4843 154.338 Q-29.5398 158.921 -35.35 158.921 Q-41.1602 158.921 -44.2388 154.338 Q-47.2944 149.731 -47.2944 141.004 Q-47.2944 132.254 -44.2388 127.671 Q-41.1602 123.065 -35.35 123.065 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M-15.1881 152.37 L-10.3038 152.37 L-10.3038 158.25 L-15.1881 158.25 L-15.1881 152.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M9.88124 126.768 Q6.27014 126.768 4.44145 130.333 Q2.6359 133.875 2.6359 141.004 Q2.6359 148.111 4.44145 151.676 Q6.27014 155.217 9.88124 155.217 Q13.5155 155.217 15.321 151.676 Q17.1497 148.111 17.1497 141.004 Q17.1497 133.875 15.321 130.333 Q13.5155 126.768 9.88124 126.768 M9.88124 123.065 Q15.6914 123.065 18.7469 127.671 Q21.8256 132.254 21.8256 141.004 Q21.8256 149.731 18.7469 154.338 Q15.6914 158.921 9.88124 158.921 Q4.07108 158.921 0.992394 154.338 Q-2.06315 149.731 -2.06315 141.004 Q-2.06315 132.254 0.992394 127.671 Q4.07108 123.065 9.88124 123.065 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip800)" d="M30.0895 123.69 L48.4458 123.69 L48.4458 127.625 L34.3718 127.625 L34.3718 136.097 Q35.3904 135.75 36.4089 135.588 Q37.4274 135.403 38.4459 135.403 Q44.2329 135.403 47.6125 138.574 Q50.9921 141.745 50.9921 147.162 Q50.9921 152.74 47.5199 155.842 Q44.0477 158.921 37.7283 158.921 Q35.5524 158.921 33.2839 158.551 Q31.0385 158.18 28.6311 157.439 L28.6311 152.74 Q30.7145 153.875 32.9367 154.43 Q35.1589 154.986 37.6357 154.986 Q41.6403 154.986 43.9783 152.879 Q46.3162 150.773 46.3162 147.162 Q46.3162 143.551 43.9783 141.444 Q41.6403 139.338 37.6357 139.338 Q35.7607 139.338 33.8857 139.754 Q32.0339 140.171 30.0895 141.051 L30.0895 123.69 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip802)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,352.65 162.518,352.982 238.043,366.688 313.569,434.189 389.094,621.248 464.619,347.312 540.145,617.251 615.67,818.12 691.196,1022.94 766.721,1195.25 
  842.247,1464 917.772,1050.87 993.298,908.648 1068.82,888.149 1144.35,700.954 1219.87,503.623 1295.4,634.07 1370.92,641.592 1446.45,867.297 1521.98,406.414 
  1597.5,546.364 1673.03,285.252 1748.55,185.381 1824.08,88.5087 1899.6,740.568 1975.13,897.188 2050.65,373.127 2126.18,148.822 2201.7,180.978 2277.23,156.559 
  2352.76,110.323 
  "/>
<polyline clip-path="url(#clip802)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,352.65 162.518,354.811 238.043,363.612 313.569,383.545 389.094,310.76 464.619,396.319 540.145,387.295 615.67,389.592 691.196,385.98 766.721,403.147 
  842.247,295.146 917.772,335.289 993.298,353.774 1068.82,326.764 1144.35,323.651 1219.87,374.922 1295.4,356.083 1370.92,391.54 1446.45,282.896 1521.98,375.67 
  1597.5,312.218 1673.03,335.981 1748.55,335.665 1824.08,456.863 1899.6,381.111 1975.13,273.101 2050.65,316.734 2126.18,356.139 2201.7,347.279 2277.23,343.572 
  2352.76,412.424 
  "/>
<path clip-path="url(#clip800)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip800)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip800)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip800)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip800)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip800)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -0.0510316  -0.248716  -0.677972  1.13543  …  0.143348  0.189061  -1.45477</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip860">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip860)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip861">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip860)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip862">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip860)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1345.5 2352.76,1345.5 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1139.66 2352.76,1139.66 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,933.826 2352.76,933.826 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,727.987 2352.76,727.987 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,522.149 2352.76,522.149 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,316.31 2352.76,316.31 
  "/>
<polyline clip-path="url(#clip862)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,110.472 2352.76,110.472 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1345.5 105.89,1345.5 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1139.66 105.89,1139.66 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,933.826 105.89,933.826 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,727.987 105.89,727.987 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,522.149 105.89,522.149 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,316.31 105.89,316.31 
  "/>
<polyline clip-path="url(#clip860)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,110.472 105.89,110.472 
  "/>
<path clip-path="url(#clip860)" d="M-54.9564 1345.95 L-25.2806 1345.95 L-25.2806 1349.89 L-54.9564 1349.89 L-54.9564 1345.95 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-11.1603 1358.85 L5.15904 1358.85 L5.15904 1362.78 L-16.7853 1362.78 L-16.7853 1358.85 Q-14.1233 1356.09 -9.53996 1351.46 Q-4.9335 1346.81 -3.75295 1345.47 Q-1.50759 1342.95 -0.627968 1341.21 Q0.274805 1339.45 0.274805 1337.76 Q0.274805 1335.01 -1.66963 1333.27 Q-3.59091 1331.53 -6.69275 1331.53 Q-8.89181 1331.53 -11.3455 1332.3 Q-13.776 1333.06 -16.5538 1334.61 L-16.5538 1329.89 Q-13.7297 1328.76 -11.2761 1328.18 Q-8.82237 1327.6 -6.78534 1327.6 Q-1.415 1327.6 1.77943 1330.28 Q4.97385 1332.97 4.97385 1337.46 Q4.97385 1339.59 4.16367 1341.51 Q3.37664 1343.41 1.27017 1346 Q0.69147 1346.67 -2.41037 1349.89 Q-5.5122 1353.08 -11.1603 1358.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M14.9738 1356.9 L19.858 1356.9 L19.858 1362.78 L14.9738 1362.78 L14.9738 1356.9 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M30.0895 1328.22 L48.4458 1328.22 L48.4458 1332.16 L34.3718 1332.16 L34.3718 1340.63 Q35.3904 1340.28 36.4089 1340.12 Q37.4274 1339.94 38.4459 1339.94 Q44.2329 1339.94 47.6125 1343.11 Q50.9921 1346.28 50.9921 1351.69 Q50.9921 1357.27 47.5199 1360.38 Q44.0477 1363.45 37.7283 1363.45 Q35.5524 1363.45 33.2839 1363.08 Q31.0385 1362.71 28.6311 1361.97 L28.6311 1357.27 Q30.7145 1358.41 32.9367 1358.96 Q35.1589 1359.52 37.6357 1359.52 Q41.6403 1359.52 43.9783 1357.41 Q46.3162 1355.31 46.3162 1351.69 Q46.3162 1348.08 43.9783 1345.98 Q41.6403 1343.87 37.6357 1343.87 Q35.7607 1343.87 33.8857 1344.29 Q32.0339 1344.7 30.0895 1345.58 L30.0895 1328.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-6.18349 1125.46 Q-9.79459 1125.46 -11.6233 1129.03 Q-13.4288 1132.57 -13.4288 1139.7 Q-13.4288 1146.81 -11.6233 1150.37 Q-9.79459 1153.91 -6.18349 1153.91 Q-2.54925 1153.91 -0.743708 1150.37 Q1.08499 1146.81 1.08499 1139.7 Q1.08499 1132.57 -0.743708 1129.03 Q-2.54925 1125.46 -6.18349 1125.46 M-6.18349 1121.76 Q-0.37334 1121.76 2.6822 1126.37 Q5.76089 1130.95 5.76089 1139.7 Q5.76089 1148.43 2.6822 1153.03 Q-0.37334 1157.62 -6.18349 1157.62 Q-11.9936 1157.62 -15.0723 1153.03 Q-18.1279 1148.43 -18.1279 1139.7 Q-18.1279 1130.95 -15.0723 1126.37 Q-11.9936 1121.76 -6.18349 1121.76 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M13.9784 1151.06 L18.8627 1151.06 L18.8627 1156.94 L13.9784 1156.94 L13.9784 1151.06 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M39.0477 1125.46 Q35.4367 1125.46 33.608 1129.03 Q31.8024 1132.57 31.8024 1139.7 Q31.8024 1146.81 33.608 1150.37 Q35.4367 1153.91 39.0477 1153.91 Q42.682 1153.91 44.4875 1150.37 Q46.3162 1146.81 46.3162 1139.7 Q46.3162 1132.57 44.4875 1129.03 Q42.682 1125.46 39.0477 1125.46 M39.0477 1121.76 Q44.8579 1121.76 47.9134 1126.37 Q50.9921 1130.95 50.9921 1139.7 Q50.9921 1148.43 47.9134 1153.03 Q44.8579 1157.62 39.0477 1157.62 Q33.2376 1157.62 30.1589 1153.03 Q27.1034 1148.43 27.1034 1139.7 Q27.1034 1130.95 30.1589 1126.37 Q33.2376 1121.76 39.0477 1121.76 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-11.1603 947.171 L5.15904 947.171 L5.15904 951.106 L-16.7853 951.106 L-16.7853 947.171 Q-14.1233 944.416 -9.53996 939.786 Q-4.9335 935.134 -3.75295 933.791 Q-1.50759 931.268 -0.627968 929.532 Q0.274805 927.773 0.274805 926.083 Q0.274805 923.328 -1.66963 921.592 Q-3.59091 919.856 -6.69275 919.856 Q-8.89181 919.856 -11.3455 920.62 Q-13.776 921.384 -16.5538 922.935 L-16.5538 918.213 Q-13.7297 917.078 -11.2761 916.5 Q-8.82237 915.921 -6.78534 915.921 Q-1.415 915.921 1.77943 918.606 Q4.97385 921.291 4.97385 925.782 Q4.97385 927.912 4.16367 929.833 Q3.37664 931.731 1.27017 934.324 Q0.69147 934.995 -2.41037 938.212 Q-5.5122 941.407 -11.1603 947.171 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M14.9738 945.226 L19.858 945.226 L19.858 951.106 L14.9738 951.106 L14.9738 945.226 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M30.0895 916.546 L48.4458 916.546 L48.4458 920.481 L34.3718 920.481 L34.3718 928.953 Q35.3904 928.606 36.4089 928.444 Q37.4274 928.259 38.4459 928.259 Q44.2329 928.259 47.6125 931.43 Q50.9921 934.601 50.9921 940.018 Q50.9921 945.597 47.5199 948.698 Q44.0477 951.777 37.7283 951.777 Q35.5524 951.777 33.2839 951.407 Q31.0385 951.036 28.6311 950.296 L28.6311 945.597 Q30.7145 946.731 32.9367 947.286 Q35.1589 947.842 37.6357 947.842 Q41.6403 947.842 43.9783 945.736 Q46.3162 943.629 46.3162 940.018 Q46.3162 936.407 43.9783 934.3 Q41.6403 932.194 37.6357 932.194 Q35.7607 932.194 33.8857 932.611 Q32.0339 933.027 30.0895 933.907 L30.0895 916.546 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-16.1371 710.707 L2.21924 710.707 L2.21924 714.643 L-11.8548 714.643 L-11.8548 723.115 Q-10.8362 722.768 -9.81773 722.605 Q-8.79922 722.42 -7.78071 722.42 Q-1.9937 722.42 1.38591 725.592 Q4.76552 728.763 4.76552 734.179 Q4.76552 739.758 1.29332 742.86 Q-2.17889 745.939 -8.4983 745.939 Q-10.6742 745.939 -12.9427 745.568 Q-15.1881 745.198 -17.5955 744.457 L-17.5955 739.758 Q-15.5121 740.892 -13.2899 741.448 Q-11.0677 742.004 -8.59089 742.004 Q-4.58628 742.004 -2.24833 739.897 Q0.089621 737.791 0.089621 734.179 Q0.089621 730.568 -2.24833 728.462 Q-4.58628 726.355 -8.59089 726.355 Q-10.4659 726.355 -12.3409 726.772 Q-14.1927 727.189 -16.1371 728.068 L-16.1371 710.707 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M13.9784 739.388 L18.8627 739.388 L18.8627 745.267 L13.9784 745.267 L13.9784 739.388 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M39.0477 713.786 Q35.4367 713.786 33.608 717.351 Q31.8024 720.893 31.8024 728.022 Q31.8024 735.129 33.608 738.693 Q35.4367 742.235 39.0477 742.235 Q42.682 742.235 44.4875 738.693 Q46.3162 735.129 46.3162 728.022 Q46.3162 720.893 44.4875 717.351 Q42.682 713.786 39.0477 713.786 M39.0477 710.082 Q44.8579 710.082 47.9134 714.689 Q50.9921 719.272 50.9921 728.022 Q50.9921 736.749 47.9134 741.355 Q44.8579 745.939 39.0477 745.939 Q33.2376 745.939 30.1589 741.355 Q27.1034 736.749 27.1034 728.022 Q27.1034 719.272 30.1589 714.689 Q33.2376 710.082 39.0477 710.082 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-16.3686 504.869 L5.85348 504.869 L5.85348 506.86 L-6.69275 539.429 L-11.577 539.429 L0.228509 508.804 L-16.3686 508.804 L-16.3686 504.869 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M14.9738 533.549 L19.858 533.549 L19.858 539.429 L14.9738 539.429 L14.9738 533.549 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M30.0895 504.869 L48.4458 504.869 L48.4458 508.804 L34.3718 508.804 L34.3718 517.276 Q35.3904 516.929 36.4089 516.767 Q37.4274 516.582 38.4459 516.582 Q44.2329 516.582 47.6125 519.753 Q50.9921 522.924 50.9921 528.341 Q50.9921 533.92 47.5199 537.021 Q44.0477 540.1 37.7283 540.1 Q35.5524 540.1 33.2839 539.73 Q31.0385 539.359 28.6311 538.619 L28.6311 533.92 Q30.7145 535.054 32.9367 535.609 Q35.1589 536.165 37.6357 536.165 Q41.6403 536.165 43.9783 534.059 Q46.3162 531.952 46.3162 528.341 Q46.3162 524.73 43.9783 522.623 Q41.6403 520.517 37.6357 520.517 Q35.7607 520.517 33.8857 520.934 Q32.0339 521.35 30.0895 522.23 L30.0895 504.869 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-45.5351 329.655 L-37.8963 329.655 L-37.8963 303.29 L-46.2064 304.956 L-46.2064 300.697 L-37.9426 299.03 L-33.2667 299.03 L-33.2667 329.655 L-25.6278 329.655 L-25.6278 333.59 L-45.5351 333.59 L-45.5351 329.655 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-6.18349 302.109 Q-9.79459 302.109 -11.6233 305.674 Q-13.4288 309.216 -13.4288 316.345 Q-13.4288 323.452 -11.6233 327.016 Q-9.79459 330.558 -6.18349 330.558 Q-2.54925 330.558 -0.743708 327.016 Q1.08499 323.452 1.08499 316.345 Q1.08499 309.216 -0.743708 305.674 Q-2.54925 302.109 -6.18349 302.109 M-6.18349 298.405 Q-0.37334 298.405 2.6822 303.012 Q5.76089 307.595 5.76089 316.345 Q5.76089 325.072 2.6822 329.678 Q-0.37334 334.262 -6.18349 334.262 Q-11.9936 334.262 -15.0723 329.678 Q-18.1279 325.072 -18.1279 316.345 Q-18.1279 307.595 -15.0723 303.012 Q-11.9936 298.405 -6.18349 298.405 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M13.9784 327.711 L18.8627 327.711 L18.8627 333.59 L13.9784 333.59 L13.9784 327.711 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M39.0477 302.109 Q35.4367 302.109 33.608 305.674 Q31.8024 309.216 31.8024 316.345 Q31.8024 323.452 33.608 327.016 Q35.4367 330.558 39.0477 330.558 Q42.682 330.558 44.4875 327.016 Q46.3162 323.452 46.3162 316.345 Q46.3162 309.216 44.4875 305.674 Q42.682 302.109 39.0477 302.109 M39.0477 298.405 Q44.8579 298.405 47.9134 303.012 Q50.9921 307.595 50.9921 316.345 Q50.9921 325.072 47.9134 329.678 Q44.8579 334.262 39.0477 334.262 Q33.2376 334.262 30.1589 329.678 Q27.1034 325.072 27.1034 316.345 Q27.1034 307.595 30.1589 303.012 Q33.2376 298.405 39.0477 298.405 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-44.5398 123.817 L-36.9009 123.817 L-36.9009 97.4511 L-45.2111 99.1178 L-45.2111 94.8586 L-36.9472 93.1919 L-32.2713 93.1919 L-32.2713 123.817 L-24.6325 123.817 L-24.6325 127.752 L-44.5398 127.752 L-44.5398 123.817 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M-11.1603 123.817 L5.15904 123.817 L5.15904 127.752 L-16.7853 127.752 L-16.7853 123.817 Q-14.1233 121.062 -9.53996 116.433 Q-4.9335 111.78 -3.75295 110.437 Q-1.50759 107.914 -0.627968 106.178 Q0.274805 104.419 0.274805 102.729 Q0.274805 99.9743 -1.66963 98.2382 Q-3.59091 96.5021 -6.69275 96.5021 Q-8.89181 96.5021 -11.3455 97.266 Q-13.776 98.0298 -16.5538 99.5808 L-16.5538 94.8586 Q-13.7297 93.7243 -11.2761 93.1456 Q-8.82237 92.5669 -6.78534 92.5669 Q-1.415 92.5669 1.77943 95.2521 Q4.97385 97.9372 4.97385 102.428 Q4.97385 104.558 4.16367 106.479 Q3.37664 108.377 1.27017 110.97 Q0.69147 111.641 -2.41037 114.858 Q-5.5122 118.053 -11.1603 123.817 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M14.9738 121.872 L19.858 121.872 L19.858 127.752 L14.9738 127.752 L14.9738 121.872 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip860)" d="M30.0895 93.1919 L48.4458 93.1919 L48.4458 97.1271 L34.3718 97.1271 L34.3718 105.599 Q35.3904 105.252 36.4089 105.09 Q37.4274 104.905 38.4459 104.905 Q44.2329 104.905 47.6125 108.076 Q50.9921 111.247 50.9921 116.664 Q50.9921 122.243 47.5199 125.345 Q44.0477 128.423 37.7283 128.423 Q35.5524 128.423 33.2839 128.053 Q31.0385 127.682 28.6311 126.942 L28.6311 122.243 Q30.7145 123.377 32.9367 123.932 Q35.1589 124.488 37.6357 124.488 Q41.6403 124.488 43.9783 122.382 Q46.3162 120.275 46.3162 116.664 Q46.3162 113.053 43.9783 110.946 Q41.6403 108.84 37.6357 108.84 Q35.7607 108.84 33.8857 109.257 Q32.0339 109.673 30.0895 110.553 L30.0895 93.1919 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip862)" d="
M151.118 1236.68 L222.368 1404.03 L293.618 1479.3 L364.869 1478.24 L436.119 1467.58 L507.37 1452.76 L578.62 1438.47 L649.871 1425.36 L721.121 1408.68 L792.371 1396.62 
  L863.622 1388.12 L934.872 1381.14 L1006.12 1371.96 L1077.37 1357.43 L1148.62 1345.46 L1219.87 1329.3 L1291.12 1311.6 L1362.37 1309.8 L1433.63 1302.98 L1504.88 1288.72 
  L1576.13 1284.14 L1647.38 1277.76 L1718.63 1269.67 L1789.88 1264.07 L1861.13 1254.45 L1932.38 1251.57 L2003.63 1246.75 L2074.88 1241.63 L2146.13 1239.84 L2217.38 1235.16 
  L2288.63 1225.45 L2288.63 875.552 L2217.38 863.31 L2146.13 850.429 L2074.88 838.294 L2003.63 825.21 L1932.38 806.557 L1861.13 788.619 L1789.88 778.418 L1718.63 753.658 
  L1647.38 731.686 L1576.13 714.631 L1504.88 690.256 L1433.63 670.213 L1362.37 649.942 L1291.12 624.64 L1219.87 597.927 L1148.62 565.723 L1077.37 534.268 L1006.12 500.467 
  L934.872 470.885 L863.622 436.222 L792.371 397.741 L721.121 360.954 L649.871 314.082 L578.62 267.551 L507.37 223.573 L436.119 170.605 L364.869 115.337 L293.618 88.9544 
  L222.368 184.429 L151.118 1025.76  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip862)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1145.12 222.368,1079.93 293.618,1073.65 364.869,1075.35 436.119,1073.45 507.37,1079.59 578.62,1078.6 649.871,1085.69 721.121,1091.55 792.371,1098.19 
  863.622,1096.72 934.872,1095.51 1006.12,1102.23 1077.37,1105.78 1148.62,1114.35 1219.87,1111.03 1291.12,1104.1 1362.37,1100.96 1433.63,1099.53 1504.88,1107.25 
  1576.13,1104.17 1647.38,1109.52 1718.63,1107.91 1789.88,1107.4 1861.13,1108.13 1932.38,1108.53 2003.63,1105.88 2074.88,1112.43 2146.13,1113.84 2217.38,1118.11 
  2288.63,1122.81 
  "/>
<path clip-path="url(#clip862)" d="
M151.118 1230.68 L222.368 1157.9 L293.618 1143.28 L364.869 1141.07 L436.119 1141.12 L507.37 1140.79 L578.62 1140.82 L649.871 1141.03 L721.121 1140.97 L792.371 1141.05 
  L863.622 1140.74 L934.872 1140.98 L1006.12 1140.8 L1077.37 1141.05 L1148.62 1140.89 L1219.87 1140.95 L1291.12 1141 L1362.37 1140.61 L1433.63 1140.81 L1504.88 1141 
  L1576.13 1140.66 L1647.38 1140.9 L1718.63 1141.45 L1789.88 1140.89 L1861.13 1140.87 L1932.38 1140.99 L2003.63 1140.62 L2074.88 1140.83 L2146.13 1140.63 L2217.38 1140.94 
  L2288.63 1140.91 L2288.63 1138.21 L2217.38 1138.17 L2146.13 1138.49 L2074.88 1138.13 L2003.63 1138.61 L1932.38 1138.19 L1861.13 1137.91 L1789.88 1138.25 L1718.63 1138.28 
  L1647.38 1138.28 L1576.13 1138.59 L1504.88 1138.36 L1433.63 1138.34 L1362.37 1138.15 L1291.12 1137.89 L1219.87 1138.4 L1148.62 1138.72 L1077.37 1138.68 L1006.12 1138.39 
  L934.872 1138.36 L863.622 1138.13 L792.371 1138.46 L721.121 1138.03 L649.871 1138.17 L578.62 1137.87 L507.37 1138.27 L436.119 1138.75 L364.869 1138.08 L293.618 1135.37 
  L222.368 1120.05 L151.118 1041.05  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip862)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1137.33 222.368,1139.4 293.618,1139.61 364.869,1139.79 436.119,1139.73 507.37,1139.44 578.62,1139.64 649.871,1139.6 721.121,1139.6 792.371,1139.73 
  863.622,1139.67 934.872,1139.69 1006.12,1139.64 1077.37,1139.67 1148.62,1139.67 1219.87,1139.76 1291.12,1139.46 1362.37,1139.52 1433.63,1139.41 1504.88,1139.64 
  1576.13,1139.57 1647.38,1139.69 1718.63,1139.97 1789.88,1139.53 1861.13,1139.59 1932.38,1139.4 2003.63,1139.74 2074.88,1139.52 2146.13,1139.53 2217.38,1139.62 
  2288.63,1139.68 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">52.49695085715804</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-154.02569327403387, -1012.6634809738853], [-2.6101545643312147 0.8400000057860502; -34.607718393714975 1.9083708950719114], [0.924060458824891 0.03129628179449361; 10.829235639928639 0.1760469396108743;;; 0.03129628179449361 -0.01848134774029574; 0.1760469396108743 -0.0973243982791548], [66.17879655461046; 532.6104746455924;;], [12.393450506015279, -24.99629028636683], [2.3701822170101647 0.35679483839866766; 4.949248201474749 0.0009931486036552173], [0.3149944344790106 -0.006890067079554934; -0.41399517849512685 -0.03690124172926733;;; -0.006890067079554934 -0.011765332316389475; -0.03690124172926733 -0.010735577484406313], [-1.542201765390344 -1.043860920830714 … 0.7114732929912468 0.09483985271231755])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 25 October 2022 22:53">Tuesday 25 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
