<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.005846885534673143]
 [-0.03629630774436645, -0.016434113037185442]
 [-0.135566271103866, -0.006512580505789725]
 [-0.16905536878525138, -0.00697658775909575]
 [-0.20370928241449332, -0.016713547192070768]
 [-0.2961298347424428, 0.003284570575983948]
 [-0.26108724422735696, 0.0036860529362291033]
 [-0.2252941836259793, -0.001909816141028193]
 [-0.22591826505336104, -0.013280372897145449]
 ⋮
 [-0.11667791754138114, 0.0038884480712201197]
 [-0.0868002462693028, 0.005523691799505298]
 [-0.04823037402322659, -0.009330458166731634]
 [-0.10344307960416999, 0.004988148270602102]
 [-0.06738215512181837, 0.004385282009778537]
 [-0.03686354125672681, 0.0007751414578014231]
 [-0.030293118878230864, -0.017588451095341275]
 [-0.13690042725437362, -0.004838585218346313]
 [-0.1600182622022654, -0.009164231948994038]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip440">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip440)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip441">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip440)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip442">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip440)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1480.37 2352.76,1480.37 
  "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1038.65 2352.76,1038.65 
  "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,596.937 2352.76,596.937 
  "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,155.223 2352.76,155.223 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1480.37 105.89,1480.37 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1038.65 105.89,1038.65 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,596.937 105.89,596.937 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,155.223 105.89,155.223 
  "/>
<path clip-path="url(#clip440)" d="M-55.3036 1480.82 L-25.6278 1480.82 L-25.6278 1484.75 L-55.3036 1484.75 L-55.3036 1480.82 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-5.53535 1466.16 Q-9.14644 1466.16 -10.9751 1469.73 Q-12.7807 1473.27 -12.7807 1480.4 Q-12.7807 1487.51 -10.9751 1491.07 Q-9.14644 1494.61 -5.53535 1494.61 Q-1.90111 1494.61 -0.0955632 1491.07 Q1.73313 1487.51 1.73313 1480.4 Q1.73313 1473.27 -0.0955632 1469.73 Q-1.90111 1466.16 -5.53535 1466.16 M-5.53535 1462.46 Q0.274805 1462.46 3.33034 1467.07 Q6.40903 1471.65 6.40903 1480.4 Q6.40903 1489.13 3.33034 1493.73 Q0.274805 1498.32 -5.53535 1498.32 Q-11.3455 1498.32 -14.4242 1493.73 Q-17.4797 1489.13 -17.4797 1480.4 Q-17.4797 1471.65 -14.4242 1467.07 Q-11.3455 1462.46 -5.53535 1462.46 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M14.6266 1491.77 L19.5108 1491.77 L19.5108 1497.65 L14.6266 1497.65 L14.6266 1491.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M43.8625 1479.01 Q47.219 1479.73 49.094 1482 Q50.9921 1484.27 50.9921 1487.6 Q50.9921 1492.71 47.4736 1495.52 Q43.9551 1498.32 37.4737 1498.32 Q35.2978 1498.32 32.983 1497.88 Q30.6913 1497.46 28.2376 1496.6 L28.2376 1492.09 Q30.1821 1493.22 32.4969 1493.8 Q34.8117 1494.38 37.3348 1494.38 Q41.7329 1494.38 44.0246 1492.65 Q46.3394 1490.91 46.3394 1487.6 Q46.3394 1484.54 44.1866 1482.83 Q42.057 1481.09 38.2376 1481.09 L34.2098 1481.09 L34.2098 1477.25 L38.4227 1477.25 Q41.8718 1477.25 43.7005 1475.89 Q45.5292 1474.5 45.5292 1471.9 Q45.5292 1469.24 43.6311 1467.83 Q41.7561 1466.4 38.2376 1466.4 Q36.3163 1466.4 34.1172 1466.81 Q31.9182 1467.23 29.2793 1468.11 L29.2793 1463.94 Q31.9413 1463.2 34.2561 1462.83 Q36.5941 1462.46 38.6542 1462.46 Q43.9783 1462.46 47.0801 1464.89 Q50.1819 1467.3 50.1819 1471.42 Q50.1819 1474.29 48.5384 1476.28 Q46.8949 1478.25 43.8625 1479.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-54.3545 1039.1 L-24.6788 1039.1 L-24.6788 1043.04 L-54.3545 1043.04 L-54.3545 1039.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-4.58628 1024.45 Q-8.19737 1024.45 -10.0261 1028.01 Q-11.8316 1031.56 -11.8316 1038.69 Q-11.8316 1045.79 -10.0261 1049.36 Q-8.19737 1052.9 -4.58628 1052.9 Q-0.95204 1052.9 0.853506 1049.36 Q2.6822 1045.79 2.6822 1038.69 Q2.6822 1031.56 0.853506 1028.01 Q-0.95204 1024.45 -4.58628 1024.45 M-4.58628 1020.75 Q1.22387 1020.75 4.27941 1025.35 Q7.3581 1029.94 7.3581 1038.69 Q7.3581 1047.41 4.27941 1052.02 Q1.22387 1056.6 -4.58628 1056.6 Q-10.3964 1056.6 -13.4751 1052.02 Q-16.5307 1047.41 -16.5307 1038.69 Q-16.5307 1029.94 -13.4751 1025.35 Q-10.3964 1020.75 -4.58628 1020.75 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M15.5756 1050.05 L20.4599 1050.05 L20.4599 1055.93 L15.5756 1055.93 L15.5756 1050.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M34.6728 1052 L50.9921 1052 L50.9921 1055.93 L29.0478 1055.93 L29.0478 1052 Q31.7098 1049.24 36.2931 1044.61 Q40.8996 1039.96 42.0801 1038.62 Q44.3255 1036.09 45.2051 1034.36 Q46.1079 1032.6 46.1079 1030.91 Q46.1079 1028.15 44.1635 1026.42 Q42.2422 1024.68 39.1403 1024.68 Q36.9413 1024.68 34.4876 1025.45 Q32.057 1026.21 29.2793 1027.76 L29.2793 1023.04 Q32.1033 1021.9 34.557 1021.32 Q37.0107 1020.75 39.0477 1020.75 Q44.4181 1020.75 47.6125 1023.43 Q50.8069 1026.12 50.8069 1030.61 Q50.8069 1032.74 49.9968 1034.66 Q49.2097 1036.56 47.1033 1039.15 Q46.5246 1039.82 43.4227 1043.04 Q40.3209 1046.23 34.6728 1052 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-54.7249 597.388 L-25.0491 597.388 L-25.0491 601.323 L-54.7249 601.323 L-54.7249 597.388 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-4.95665 582.736 Q-8.56774 582.736 -10.3964 586.3 Q-12.202 589.842 -12.202 596.972 Q-12.202 604.078 -10.3964 607.643 Q-8.56774 611.184 -4.95665 611.184 Q-1.32241 611.184 0.483137 607.643 Q2.31183 604.078 2.31183 596.972 Q2.31183 589.842 0.483137 586.3 Q-1.32241 582.736 -4.95665 582.736 M-4.95665 579.032 Q0.853506 579.032 3.90904 583.638 Q6.98773 588.222 6.98773 596.972 Q6.98773 605.698 3.90904 610.305 Q0.853506 614.888 -4.95665 614.888 Q-10.7668 614.888 -13.8455 610.305 Q-16.901 605.698 -16.901 596.972 Q-16.901 588.222 -13.8455 583.638 Q-10.7668 579.032 -4.95665 579.032 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M15.2053 608.337 L20.0895 608.337 L20.0895 614.217 L15.2053 614.217 L15.2053 608.337 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M31.0848 610.282 L38.7237 610.282 L38.7237 583.916 L30.4135 585.583 L30.4135 581.324 L38.6774 579.657 L43.3533 579.657 L43.3533 610.282 L50.9921 610.282 L50.9921 614.217 L31.0848 614.217 L31.0848 610.282 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-6.18349 141.021 Q-9.79459 141.021 -11.6233 144.586 Q-13.4288 148.128 -13.4288 155.257 Q-13.4288 162.364 -11.6233 165.929 Q-9.79459 169.47 -6.18349 169.47 Q-2.54925 169.47 -0.743708 165.929 Q1.08499 162.364 1.08499 155.257 Q1.08499 148.128 -0.743708 144.586 Q-2.54925 141.021 -6.18349 141.021 M-6.18349 137.318 Q-0.37334 137.318 2.6822 141.924 Q5.76089 146.507 5.76089 155.257 Q5.76089 163.984 2.6822 168.591 Q-0.37334 173.174 -6.18349 173.174 Q-11.9936 173.174 -15.0723 168.591 Q-18.1279 163.984 -18.1279 155.257 Q-18.1279 146.507 -15.0723 141.924 Q-11.9936 137.318 -6.18349 137.318 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M13.9784 166.623 L18.8627 166.623 L18.8627 172.503 L13.9784 172.503 L13.9784 166.623 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip440)" d="M39.0477 141.021 Q35.4367 141.021 33.608 144.586 Q31.8024 148.128 31.8024 155.257 Q31.8024 162.364 33.608 165.929 Q35.4367 169.47 39.0477 169.47 Q42.682 169.47 44.4875 165.929 Q46.3162 162.364 46.3162 155.257 Q46.3162 148.128 44.4875 144.586 Q42.682 141.021 39.0477 141.021 M39.0477 137.318 Q44.8579 137.318 47.9134 141.924 Q50.9921 146.507 50.9921 155.257 Q50.9921 163.984 47.9134 168.591 Q44.8579 173.174 39.0477 173.174 Q33.2376 173.174 30.1589 168.591 Q27.1034 163.984 27.1034 155.257 Q27.1034 146.507 30.1589 141.924 Q33.2376 137.318 39.0477 137.318 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip442)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,155.223 162.518,155.568 238.043,315.549 313.569,754.038 389.094,901.964 464.619,1055.04 540.145,1463.27 615.67,1308.48 691.196,1150.38 766.721,1153.14 
  842.247,1464 917.772,983.543 993.298,836.939 1068.82,584.882 1144.35,615.923 1219.87,491.314 1295.4,252.873 1370.92,298.068 1446.45,396.418 1521.98,605.193 
  1597.5,564.175 1673.03,717.916 1748.55,670.606 1824.08,538.632 1899.6,368.263 1975.13,612.145 2050.65,452.859 2126.18,318.054 2201.7,289.032 2277.23,759.931 
  2352.76,862.046 
  "/>
<polyline clip-path="url(#clip442)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,155.223 162.518,181.049 238.043,227.814 313.569,183.99 389.094,186.039 464.619,229.049 540.145,140.714 615.67,138.941 691.196,163.659 766.721,213.884 
  842.247,88.5087 917.772,138.194 993.298,120.088 1068.82,163.654 1144.35,138.794 1219.87,119.534 1295.4,163.253 1370.92,172.221 1446.45,190.952 1521.98,152.176 
  1597.5,183.38 1673.03,152.068 1748.55,138.047 1824.08,130.824 1899.6,196.437 1975.13,133.189 2050.65,135.852 2126.18,151.799 2201.7,232.913 2277.23,176.595 
  2352.76,195.702 
  "/>
<path clip-path="url(#clip440)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip440)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip440)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip440)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip440)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -0.584689  -1.52647  -0.322576  -0.567407  …  -1.77435  -0.132089  -0.819651</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip500">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip500)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip501">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip500)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip502">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip500)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1354.58 2352.76,1354.58 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1155.66 2352.76,1155.66 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,956.734 2352.76,956.734 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,757.809 2352.76,757.809 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,558.885 2352.76,558.885 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,359.96 2352.76,359.96 
  "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,161.036 2352.76,161.036 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1354.58 105.89,1354.58 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1155.66 105.89,1155.66 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,956.734 105.89,956.734 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,757.809 105.89,757.809 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,558.885 105.89,558.885 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,359.96 105.89,359.96 
  "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,161.036 105.89,161.036 
  "/>
<path clip-path="url(#clip500)" d="M-54.9564 1355.03 L-25.2806 1355.03 L-25.2806 1358.97 L-54.9564 1358.97 L-54.9564 1355.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-11.1603 1367.93 L5.15904 1367.93 L5.15904 1371.86 L-16.7853 1371.86 L-16.7853 1367.93 Q-14.1233 1365.17 -9.53996 1360.54 Q-4.9335 1355.89 -3.75295 1354.55 Q-1.50759 1352.03 -0.627968 1350.29 Q0.274805 1348.53 0.274805 1346.84 Q0.274805 1344.09 -1.66963 1342.35 Q-3.59091 1340.61 -6.69275 1340.61 Q-8.89181 1340.61 -11.3455 1341.38 Q-13.776 1342.14 -16.5538 1343.69 L-16.5538 1338.97 Q-13.7297 1337.84 -11.2761 1337.26 Q-8.82237 1336.68 -6.78534 1336.68 Q-1.415 1336.68 1.77943 1339.36 Q4.97385 1342.05 4.97385 1346.54 Q4.97385 1348.67 4.16367 1350.59 Q3.37664 1352.49 1.27017 1355.08 Q0.69147 1355.75 -2.41037 1358.97 Q-5.5122 1362.16 -11.1603 1367.93 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M14.9738 1365.98 L19.858 1365.98 L19.858 1371.86 L14.9738 1371.86 L14.9738 1365.98 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M30.0895 1337.3 L48.4458 1337.3 L48.4458 1341.24 L34.3718 1341.24 L34.3718 1349.71 Q35.3904 1349.36 36.4089 1349.2 Q37.4274 1349.02 38.4459 1349.02 Q44.2329 1349.02 47.6125 1352.19 Q50.9921 1355.36 50.9921 1360.78 Q50.9921 1366.35 47.5199 1369.46 Q44.0477 1372.53 37.7283 1372.53 Q35.5524 1372.53 33.2839 1372.16 Q31.0385 1371.79 28.6311 1371.05 L28.6311 1366.35 Q30.7145 1367.49 32.9367 1368.04 Q35.1589 1368.6 37.6357 1368.6 Q41.6403 1368.6 43.9783 1366.49 Q46.3162 1364.39 46.3162 1360.78 Q46.3162 1357.16 43.9783 1355.06 Q41.6403 1352.95 37.6357 1352.95 Q35.7607 1352.95 33.8857 1353.37 Q32.0339 1353.78 30.0895 1354.66 L30.0895 1337.3 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-6.18349 1141.46 Q-9.79459 1141.46 -11.6233 1145.02 Q-13.4288 1148.56 -13.4288 1155.69 Q-13.4288 1162.8 -11.6233 1166.36 Q-9.79459 1169.91 -6.18349 1169.91 Q-2.54925 1169.91 -0.743708 1166.36 Q1.08499 1162.8 1.08499 1155.69 Q1.08499 1148.56 -0.743708 1145.02 Q-2.54925 1141.46 -6.18349 1141.46 M-6.18349 1137.75 Q-0.37334 1137.75 2.6822 1142.36 Q5.76089 1146.94 5.76089 1155.69 Q5.76089 1164.42 2.6822 1169.03 Q-0.37334 1173.61 -6.18349 1173.61 Q-11.9936 1173.61 -15.0723 1169.03 Q-18.1279 1164.42 -18.1279 1155.69 Q-18.1279 1146.94 -15.0723 1142.36 Q-11.9936 1137.75 -6.18349 1137.75 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M13.9784 1167.06 L18.8627 1167.06 L18.8627 1172.94 L13.9784 1172.94 L13.9784 1167.06 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M39.0477 1141.46 Q35.4367 1141.46 33.608 1145.02 Q31.8024 1148.56 31.8024 1155.69 Q31.8024 1162.8 33.608 1166.36 Q35.4367 1169.91 39.0477 1169.91 Q42.682 1169.91 44.4875 1166.36 Q46.3162 1162.8 46.3162 1155.69 Q46.3162 1148.56 44.4875 1145.02 Q42.682 1141.46 39.0477 1141.46 M39.0477 1137.75 Q44.8579 1137.75 47.9134 1142.36 Q50.9921 1146.94 50.9921 1155.69 Q50.9921 1164.42 47.9134 1169.03 Q44.8579 1173.61 39.0477 1173.61 Q33.2376 1173.61 30.1589 1169.03 Q27.1034 1164.42 27.1034 1155.69 Q27.1034 1146.94 30.1589 1142.36 Q33.2376 1137.75 39.0477 1137.75 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-11.1603 970.079 L5.15904 970.079 L5.15904 974.014 L-16.7853 974.014 L-16.7853 970.079 Q-14.1233 967.324 -9.53996 962.695 Q-4.9335 958.042 -3.75295 956.699 Q-1.50759 954.176 -0.627968 952.44 Q0.274805 950.681 0.274805 948.991 Q0.274805 946.236 -1.66963 944.5 Q-3.59091 942.764 -6.69275 942.764 Q-8.89181 942.764 -11.3455 943.528 Q-13.776 944.292 -16.5538 945.843 L-16.5538 941.121 Q-13.7297 939.986 -11.2761 939.408 Q-8.82237 938.829 -6.78534 938.829 Q-1.415 938.829 1.77943 941.514 Q4.97385 944.199 4.97385 948.69 Q4.97385 950.82 4.16367 952.741 Q3.37664 954.639 1.27017 957.232 Q0.69147 957.903 -2.41037 961.121 Q-5.5122 964.315 -11.1603 970.079 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M14.9738 968.134 L19.858 968.134 L19.858 974.014 L14.9738 974.014 L14.9738 968.134 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M30.0895 939.454 L48.4458 939.454 L48.4458 943.389 L34.3718 943.389 L34.3718 951.861 Q35.3904 951.514 36.4089 951.352 Q37.4274 951.167 38.4459 951.167 Q44.2329 951.167 47.6125 954.338 Q50.9921 957.51 50.9921 962.926 Q50.9921 968.505 47.5199 971.607 Q44.0477 974.685 37.7283 974.685 Q35.5524 974.685 33.2839 974.315 Q31.0385 973.945 28.6311 973.204 L28.6311 968.505 Q30.7145 969.639 32.9367 970.195 Q35.1589 970.75 37.6357 970.75 Q41.6403 970.75 43.9783 968.644 Q46.3162 966.537 46.3162 962.926 Q46.3162 959.315 43.9783 957.209 Q41.6403 955.102 37.6357 955.102 Q35.7607 955.102 33.8857 955.519 Q32.0339 955.935 30.0895 956.815 L30.0895 939.454 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-16.1371 740.529 L2.21924 740.529 L2.21924 744.465 L-11.8548 744.465 L-11.8548 752.937 Q-10.8362 752.59 -9.81773 752.428 Q-8.79922 752.242 -7.78071 752.242 Q-1.9937 752.242 1.38591 755.414 Q4.76552 758.585 4.76552 764.002 Q4.76552 769.58 1.29332 772.682 Q-2.17889 775.761 -8.4983 775.761 Q-10.6742 775.761 -12.9427 775.39 Q-15.1881 775.02 -17.5955 774.279 L-17.5955 769.58 Q-15.5121 770.714 -13.2899 771.27 Q-11.0677 771.826 -8.59089 771.826 Q-4.58628 771.826 -2.24833 769.719 Q0.089621 767.613 0.089621 764.002 Q0.089621 760.39 -2.24833 758.284 Q-4.58628 756.178 -8.59089 756.178 Q-10.4659 756.178 -12.3409 756.594 Q-14.1927 757.011 -16.1371 757.89 L-16.1371 740.529 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M13.9784 769.21 L18.8627 769.21 L18.8627 775.089 L13.9784 775.089 L13.9784 769.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M39.0477 743.608 Q35.4367 743.608 33.608 747.173 Q31.8024 750.715 31.8024 757.844 Q31.8024 764.951 33.608 768.515 Q35.4367 772.057 39.0477 772.057 Q42.682 772.057 44.4875 768.515 Q46.3162 764.951 46.3162 757.844 Q46.3162 750.715 44.4875 747.173 Q42.682 743.608 39.0477 743.608 M39.0477 739.904 Q44.8579 739.904 47.9134 744.511 Q50.9921 749.094 50.9921 757.844 Q50.9921 766.571 47.9134 771.177 Q44.8579 775.761 39.0477 775.761 Q33.2376 775.761 30.1589 771.177 Q27.1034 766.571 27.1034 757.844 Q27.1034 749.094 30.1589 744.511 Q33.2376 739.904 39.0477 739.904 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-16.3686 541.605 L5.85348 541.605 L5.85348 543.596 L-6.69275 576.165 L-11.577 576.165 L0.228509 545.54 L-16.3686 545.54 L-16.3686 541.605 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M14.9738 570.285 L19.858 570.285 L19.858 576.165 L14.9738 576.165 L14.9738 570.285 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M30.0895 541.605 L48.4458 541.605 L48.4458 545.54 L34.3718 545.54 L34.3718 554.012 Q35.3904 553.665 36.4089 553.503 Q37.4274 553.318 38.4459 553.318 Q44.2329 553.318 47.6125 556.489 Q50.9921 559.66 50.9921 565.077 Q50.9921 570.656 47.5199 573.757 Q44.0477 576.836 37.7283 576.836 Q35.5524 576.836 33.2839 576.466 Q31.0385 576.095 28.6311 575.355 L28.6311 570.656 Q30.7145 571.79 32.9367 572.345 Q35.1589 572.901 37.6357 572.901 Q41.6403 572.901 43.9783 570.795 Q46.3162 568.688 46.3162 565.077 Q46.3162 561.466 43.9783 559.359 Q41.6403 557.253 37.6357 557.253 Q35.7607 557.253 33.8857 557.67 Q32.0339 558.086 30.0895 558.966 L30.0895 541.605 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-45.5351 373.305 L-37.8963 373.305 L-37.8963 346.94 L-46.2064 348.606 L-46.2064 344.347 L-37.9426 342.68 L-33.2667 342.68 L-33.2667 373.305 L-25.6278 373.305 L-25.6278 377.24 L-45.5351 377.24 L-45.5351 373.305 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-6.18349 345.759 Q-9.79459 345.759 -11.6233 349.324 Q-13.4288 352.865 -13.4288 359.995 Q-13.4288 367.101 -11.6233 370.666 Q-9.79459 374.208 -6.18349 374.208 Q-2.54925 374.208 -0.743708 370.666 Q1.08499 367.101 1.08499 359.995 Q1.08499 352.865 -0.743708 349.324 Q-2.54925 345.759 -6.18349 345.759 M-6.18349 342.055 Q-0.37334 342.055 2.6822 346.662 Q5.76089 351.245 5.76089 359.995 Q5.76089 368.722 2.6822 373.328 Q-0.37334 377.912 -6.18349 377.912 Q-11.9936 377.912 -15.0723 373.328 Q-18.1279 368.722 -18.1279 359.995 Q-18.1279 351.245 -15.0723 346.662 Q-11.9936 342.055 -6.18349 342.055 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M13.9784 371.361 L18.8627 371.361 L18.8627 377.24 L13.9784 377.24 L13.9784 371.361 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M39.0477 345.759 Q35.4367 345.759 33.608 349.324 Q31.8024 352.865 31.8024 359.995 Q31.8024 367.101 33.608 370.666 Q35.4367 374.208 39.0477 374.208 Q42.682 374.208 44.4875 370.666 Q46.3162 367.101 46.3162 359.995 Q46.3162 352.865 44.4875 349.324 Q42.682 345.759 39.0477 345.759 M39.0477 342.055 Q44.8579 342.055 47.9134 346.662 Q50.9921 351.245 50.9921 359.995 Q50.9921 368.722 47.9134 373.328 Q44.8579 377.912 39.0477 377.912 Q33.2376 377.912 30.1589 373.328 Q27.1034 368.722 27.1034 359.995 Q27.1034 351.245 30.1589 346.662 Q33.2376 342.055 39.0477 342.055 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-44.5398 174.381 L-36.9009 174.381 L-36.9009 148.015 L-45.2111 149.682 L-45.2111 145.422 L-36.9472 143.756 L-32.2713 143.756 L-32.2713 174.381 L-24.6325 174.381 L-24.6325 178.316 L-44.5398 178.316 L-44.5398 174.381 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-11.1603 174.381 L5.15904 174.381 L5.15904 178.316 L-16.7853 178.316 L-16.7853 174.381 Q-14.1233 171.626 -9.53996 166.996 Q-4.9335 162.344 -3.75295 161.001 Q-1.50759 158.478 -0.627968 156.742 Q0.274805 154.983 0.274805 153.293 Q0.274805 150.538 -1.66963 148.802 Q-3.59091 147.066 -6.69275 147.066 Q-8.89181 147.066 -11.3455 147.83 Q-13.776 148.594 -16.5538 150.145 L-16.5538 145.422 Q-13.7297 144.288 -11.2761 143.709 Q-8.82237 143.131 -6.78534 143.131 Q-1.415 143.131 1.77943 145.816 Q4.97385 148.501 4.97385 152.992 Q4.97385 155.121 4.16367 157.043 Q3.37664 158.941 1.27017 161.533 Q0.69147 162.205 -2.41037 165.422 Q-5.5122 168.617 -11.1603 174.381 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M14.9738 172.436 L19.858 172.436 L19.858 178.316 L14.9738 178.316 L14.9738 172.436 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip500)" d="M30.0895 143.756 L48.4458 143.756 L48.4458 147.691 L34.3718 147.691 L34.3718 156.163 Q35.3904 155.816 36.4089 155.654 Q37.4274 155.469 38.4459 155.469 Q44.2329 155.469 47.6125 158.64 Q50.9921 161.811 50.9921 167.228 Q50.9921 172.806 47.5199 175.908 Q44.0477 178.987 37.7283 178.987 Q35.5524 178.987 33.2839 178.617 Q31.0385 178.246 28.6311 177.506 L28.6311 172.806 Q30.7145 173.941 32.9367 174.496 Q35.1589 175.052 37.6357 175.052 Q41.6403 175.052 43.9783 172.945 Q46.3162 170.839 46.3162 167.228 Q46.3162 163.617 43.9783 161.51 Q41.6403 159.404 37.6357 159.404 Q35.7607 159.404 33.8857 159.82 Q32.0339 160.237 30.0895 161.117 L30.0895 143.756 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip502)" d="
M151.118 1284.47 L222.368 1418.82 L293.618 1479.3 L364.869 1479.28 L436.119 1463.18 L507.37 1451.66 L578.62 1442.38 L649.871 1433.71 L721.121 1418.95 L792.371 1406.25 
  L863.622 1396.49 L934.872 1383.76 L1006.12 1369.4 L1077.37 1363.53 L1148.62 1351.48 L1219.87 1340.04 L1291.12 1325.02 L1362.37 1319.84 L1433.63 1320.32 L1504.88 1314.85 
  L1576.13 1303.19 L1647.38 1296.73 L1718.63 1288.03 L1789.88 1277.69 L1861.13 1267.73 L1932.38 1259.01 L2003.63 1255.49 L2074.88 1253.61 L2146.13 1244.41 L2217.38 1247.22 
  L2288.63 1244.72 L2288.63 881.041 L2217.38 864.114 L2146.13 856.505 L2074.88 850.23 L2003.63 840.465 L1932.38 827.915 L1861.13 810.919 L1789.88 794.92 L1718.63 777.666 
  L1647.38 751.396 L1576.13 730.782 L1504.88 706.754 L1433.63 683.55 L1362.37 655.62 L1291.12 628.606 L1219.87 598.247 L1148.62 568.502 L1077.37 535.449 L1006.12 497.485 
  L934.872 464.642 L863.622 425.417 L792.371 391.308 L721.121 344.301 L649.871 301.31 L578.62 251.231 L507.37 203.455 L436.119 158.627 L364.869 120.962 L293.618 88.9544 
  L222.368 179.088 L151.118 1041.49  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip502)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1165.91 222.368,1192.83 293.618,1190.43 364.869,1187.04 436.119,1182.37 507.37,1177.57 578.62,1178.05 649.871,1181.22 721.121,1182.76 792.371,1182.15 
  863.622,1181.24 934.872,1177.85 1006.12,1175.23 1077.37,1173.69 1148.62,1167.82 1219.87,1170.74 1291.12,1171.08 1362.37,1168.9 1433.63,1169.33 1504.88,1164.12 
  1576.13,1167.18 1647.38,1164.87 1718.63,1168.2 1789.88,1171.96 1861.13,1168.7 1932.38,1168.56 2003.63,1172.83 2074.88,1174.54 2146.13,1175.84 2217.38,1172.94 
  2288.63,1174.67 
  "/>
<path clip-path="url(#clip502)" d="
M151.118 1255.55 L222.368 1175.45 L293.618 1159.35 L364.869 1157.63 L436.119 1156.87 L507.37 1157.01 L578.62 1156.97 L649.871 1156.84 L721.121 1156.95 L792.371 1157.04 
  L863.622 1156.87 L934.872 1156.83 L1006.12 1157.04 L1077.37 1157.23 L1148.62 1157.08 L1219.87 1156.77 L1291.12 1157.33 L1362.37 1156.91 L1433.63 1156.71 L1504.88 1156.92 
  L1576.13 1157.07 L1647.38 1156.87 L1718.63 1157.1 L1789.88 1156.97 L1861.13 1156.91 L1932.38 1156.96 L2003.63 1156.85 L2074.88 1156.66 L2146.13 1156.97 L2217.38 1156.98 
  L2288.63 1156.56 L2288.63 1154.23 L2217.38 1154.38 L2146.13 1154.41 L2074.88 1153.95 L2003.63 1154.56 L1932.38 1153.99 L1861.13 1154.43 L1789.88 1154.34 L1718.63 1154.45 
  L1647.38 1154.23 L1576.13 1154.39 L1504.88 1154.33 L1433.63 1154.31 L1362.37 1154.57 L1291.12 1154 L1219.87 1154.27 L1148.62 1154.28 L1077.37 1154.66 L1006.12 1154.53 
  L934.872 1154.14 L863.622 1154.44 L792.371 1154.49 L721.121 1154.15 L649.871 1154.38 L578.62 1154.64 L507.37 1153.88 L436.119 1154 L364.869 1154.07 L293.618 1151.71 
  L222.368 1135.73 L151.118 1057.82  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip502)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1159.3 222.368,1156.12 293.618,1155.4 364.869,1155.55 436.119,1155.7 507.37,1155.81 578.62,1155.75 649.871,1155.76 721.121,1155.82 792.371,1155.79 
  863.622,1155.6 934.872,1155.47 1006.12,1155.75 1077.37,1155.62 1148.62,1155.74 1219.87,1155.62 1291.12,1155.77 1362.37,1155.63 1433.63,1155.44 1504.88,1155.57 
  1576.13,1155.48 1647.38,1155.6 1718.63,1155.62 1789.88,1155.45 1861.13,1155.42 1932.38,1155.69 2003.63,1155.74 2074.88,1155.47 2146.13,1155.69 2217.38,1155.81 
  2288.63,1155.59 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">53.77624660220883</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-602.6343875595245, -4630.227024504445], [86.33604124179593 0.1588640977307033; 662.8878939970655 5.521101727862541], [-17.342108774449404 0.1575945627775193; -132.7278462333056 -0.15403761690995282;;; 0.1575945627775193 -0.04150464208763377; -0.15403761690995282 -0.2985208504535143], [0.8101219196101341; 35.12781765299673;;], [31.715278507510906, -32.05183487305429], [-6.418341129908693 -0.5791121296025399; 1.4767151805831649 -0.05607262309040219], [1.4776982150101639 0.05261013633903349; 0.9517828351059657 -0.035818069677291633;;; 0.05261013633903349 0.005058308909830442; -0.035818069677291633 0.0020817794171752594], [-0.8460346237313381 -0.3955401944954546 … -0.18614170147197429 0.029622230904936663])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 13 August 2022 15:21">Saturday 13 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
