<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.013504865970633773]
 [-0.08331208324589334, -0.011127737420148645]
 [-0.14776785061856387, 0.00285852871402456]
 [-0.12274229162655546, 0.005551060759261929]
 [-0.08221964014977873, -0.006625718389009493]
 [-0.11909339249970095, -0.003024929154683457]
 [-0.13192135670345734, 0.006990733517854769]
 [-0.08197402049767484, -0.0014033793872446159]
 [-0.08664191358200872, -0.009614259488596578]
 ⋮
 [-0.09832203852973115, 0.014597282656877463]
 [-0.002414643674480932, -0.013190163653261509]
 [-0.08360283443904262, 0.0034000757164938744]
 [-0.058405489676992925, 0.013200255040089062]
 [0.026768657819473435, 0.008206975390005108]
 [0.07645926805855238, -0.017546867597307475]
 [-0.03535763597164918, 0.010036753244051979]
 [0.028848680631523935, 0.016751777514610936]
 [0.1320958404791379, 0.015346425762356643]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip400">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip400)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip401">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip400)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip402">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip400)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1245.92 2352.76,1245.92 "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,978.058 2352.76,978.058 "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,710.199 2352.76,710.199 "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,442.339 2352.76,442.339 "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,174.48 2352.76,174.48 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1245.92 105.89,1245.92 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,978.058 105.89,978.058 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,710.199 105.89,710.199 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,442.339 105.89,442.339 "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,174.48 105.89,174.48 "/>
<path clip-path="url(#clip400)" d="M-55.3036 1246.37 L-25.6278 1246.37 L-25.6278 1250.3 L-55.3036 1250.3 L-55.3036 1246.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-5.53535 1231.72 Q-9.14644 1231.72 -10.9751 1235.28 Q-12.7807 1238.82 -12.7807 1245.95 Q-12.7807 1253.06 -10.9751 1256.62 Q-9.14644 1260.16 -5.53535 1260.16 Q-1.90111 1260.16 -0.0955632 1256.62 Q1.73313 1253.06 1.73313 1245.95 Q1.73313 1238.82 -0.0955632 1235.28 Q-1.90111 1231.72 -5.53535 1231.72 M-5.53535 1228.01 Q0.274805 1228.01 3.33034 1232.62 Q6.40903 1237.2 6.40903 1245.95 Q6.40903 1254.68 3.33034 1259.28 Q0.274805 1263.87 -5.53535 1263.87 Q-11.3455 1263.87 -14.4242 1259.28 Q-17.4797 1254.68 -17.4797 1245.95 Q-17.4797 1237.2 -14.4242 1232.62 Q-11.3455 1228.01 -5.53535 1228.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M14.6266 1257.32 L19.5108 1257.32 L19.5108 1263.2 L14.6266 1263.2 L14.6266 1257.32 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M43.8625 1244.56 Q47.219 1245.28 49.094 1247.55 Q50.9921 1249.82 50.9921 1253.15 Q50.9921 1258.27 47.4736 1261.07 Q43.9551 1263.87 37.4737 1263.87 Q35.2978 1263.87 32.983 1263.43 Q30.6913 1263.01 28.2376 1262.16 L28.2376 1257.64 Q30.1821 1258.78 32.4969 1259.35 Q34.8117 1259.93 37.3348 1259.93 Q41.7329 1259.93 44.0246 1258.2 Q46.3394 1256.46 46.3394 1253.15 Q46.3394 1250.09 44.1866 1248.38 Q42.057 1246.65 38.2376 1246.65 L34.2098 1246.65 L34.2098 1242.8 L38.4227 1242.8 Q41.8718 1242.8 43.7005 1241.44 Q45.5292 1240.05 45.5292 1237.46 Q45.5292 1234.79 43.6311 1233.38 Q41.7561 1231.95 38.2376 1231.95 Q36.3163 1231.95 34.1172 1232.36 Q31.9182 1232.78 29.2793 1233.66 L29.2793 1229.49 Q31.9413 1228.75 34.2561 1228.38 Q36.5941 1228.01 38.6542 1228.01 Q43.9783 1228.01 47.0801 1230.44 Q50.1819 1232.85 50.1819 1236.97 Q50.1819 1239.84 48.5384 1241.83 Q46.8949 1243.8 43.8625 1244.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-54.3545 978.509 L-24.6788 978.509 L-24.6788 982.444 L-54.3545 982.444 L-54.3545 978.509 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-4.58628 963.856 Q-8.19737 963.856 -10.0261 967.421 Q-11.8316 970.963 -11.8316 978.092 Q-11.8316 985.199 -10.0261 988.764 Q-8.19737 992.305 -4.58628 992.305 Q-0.95204 992.305 0.853506 988.764 Q2.6822 985.199 2.6822 978.092 Q2.6822 970.963 0.853506 967.421 Q-0.95204 963.856 -4.58628 963.856 M-4.58628 960.153 Q1.22387 960.153 4.27941 964.759 Q7.3581 969.342 7.3581 978.092 Q7.3581 986.819 4.27941 991.426 Q1.22387 996.009 -4.58628 996.009 Q-10.3964 996.009 -13.4751 991.426 Q-16.5307 986.819 -16.5307 978.092 Q-16.5307 969.342 -13.4751 964.759 Q-10.3964 960.153 -4.58628 960.153 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M15.5756 989.458 L20.4599 989.458 L20.4599 995.338 L15.5756 995.338 L15.5756 989.458 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M34.6728 991.402 L50.9921 991.402 L50.9921 995.338 L29.0478 995.338 L29.0478 991.402 Q31.7098 988.648 36.2931 984.018 Q40.8996 979.365 42.0801 978.023 Q44.3255 975.5 45.2051 973.764 Q46.1079 972.004 46.1079 970.315 Q46.1079 967.56 44.1635 965.824 Q42.2422 964.088 39.1403 964.088 Q36.9413 964.088 34.4876 964.852 Q32.057 965.616 29.2793 967.166 L29.2793 962.444 Q32.1033 961.31 34.557 960.731 Q37.0107 960.153 39.0477 960.153 Q44.4181 960.153 47.6125 962.838 Q50.8069 965.523 50.8069 970.014 Q50.8069 972.143 49.9968 974.065 Q49.2097 975.963 47.1033 978.555 Q46.5246 979.227 43.4227 982.444 Q40.3209 985.639 34.6728 991.402 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-54.7249 710.65 L-25.0491 710.65 L-25.0491 714.585 L-54.7249 714.585 L-54.7249 710.65 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-4.95665 695.997 Q-8.56774 695.997 -10.3964 699.562 Q-12.202 703.104 -12.202 710.233 Q-12.202 717.34 -10.3964 720.904 Q-8.56774 724.446 -4.95665 724.446 Q-1.32241 724.446 0.483137 720.904 Q2.31183 717.34 2.31183 710.233 Q2.31183 703.104 0.483137 699.562 Q-1.32241 695.997 -4.95665 695.997 M-4.95665 692.294 Q0.853506 692.294 3.90904 696.9 Q6.98773 701.483 6.98773 710.233 Q6.98773 718.96 3.90904 723.567 Q0.853506 728.15 -4.95665 728.15 Q-10.7668 728.15 -13.8455 723.567 Q-16.901 718.96 -16.901 710.233 Q-16.901 701.483 -13.8455 696.9 Q-10.7668 692.294 -4.95665 692.294 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M15.2053 721.599 L20.0895 721.599 L20.0895 727.479 L15.2053 727.479 L15.2053 721.599 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M31.0848 723.543 L38.7237 723.543 L38.7237 697.178 L30.4135 698.844 L30.4135 694.585 L38.6774 692.919 L43.3533 692.919 L43.3533 723.543 L50.9921 723.543 L50.9921 727.479 L31.0848 727.479 L31.0848 723.543 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-6.18349 428.138 Q-9.79459 428.138 -11.6233 431.703 Q-13.4288 435.245 -13.4288 442.374 Q-13.4288 449.481 -11.6233 453.045 Q-9.79459 456.587 -6.18349 456.587 Q-2.54925 456.587 -0.743708 453.045 Q1.08499 449.481 1.08499 442.374 Q1.08499 435.245 -0.743708 431.703 Q-2.54925 428.138 -6.18349 428.138 M-6.18349 424.434 Q-0.37334 424.434 2.6822 429.041 Q5.76089 433.624 5.76089 442.374 Q5.76089 451.101 2.6822 455.707 Q-0.37334 460.291 -6.18349 460.291 Q-11.9936 460.291 -15.0723 455.707 Q-18.1279 451.101 -18.1279 442.374 Q-18.1279 433.624 -15.0723 429.041 Q-11.9936 424.434 -6.18349 424.434 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M13.9784 453.74 L18.8627 453.74 L18.8627 459.619 L13.9784 459.619 L13.9784 453.74 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M39.0477 428.138 Q35.4367 428.138 33.608 431.703 Q31.8024 435.245 31.8024 442.374 Q31.8024 449.481 33.608 453.045 Q35.4367 456.587 39.0477 456.587 Q42.682 456.587 44.4875 453.045 Q46.3162 449.481 46.3162 442.374 Q46.3162 435.245 44.4875 431.703 Q42.682 428.138 39.0477 428.138 M39.0477 424.434 Q44.8579 424.434 47.9134 429.041 Q50.9921 433.624 50.9921 442.374 Q50.9921 451.101 47.9134 455.707 Q44.8579 460.291 39.0477 460.291 Q33.2376 460.291 30.1589 455.707 Q27.1034 451.101 27.1034 442.374 Q27.1034 433.624 30.1589 429.041 Q33.2376 424.434 39.0477 424.434 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-4.95665 160.279 Q-8.56774 160.279 -10.3964 163.844 Q-12.202 167.385 -12.202 174.515 Q-12.202 181.621 -10.3964 185.186 Q-8.56774 188.728 -4.95665 188.728 Q-1.32241 188.728 0.483137 185.186 Q2.31183 181.621 2.31183 174.515 Q2.31183 167.385 0.483137 163.844 Q-1.32241 160.279 -4.95665 160.279 M-4.95665 156.575 Q0.853506 156.575 3.90904 161.182 Q6.98773 165.765 6.98773 174.515 Q6.98773 183.242 3.90904 187.848 Q0.853506 192.432 -4.95665 192.432 Q-10.7668 192.432 -13.8455 187.848 Q-16.901 183.242 -16.901 174.515 Q-16.901 165.765 -13.8455 161.182 Q-10.7668 156.575 -4.95665 156.575 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M15.2053 185.881 L20.0895 185.881 L20.0895 191.76 L15.2053 191.76 L15.2053 185.881 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M31.0848 187.825 L38.7237 187.825 L38.7237 161.46 L30.4135 163.126 L30.4135 158.867 L38.6774 157.2 L43.3533 157.2 L43.3533 187.825 L50.9921 187.825 L50.9921 191.76 L31.0848 191.76 L31.0848 187.825 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip402)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,442.339 162.518,442.549 238.043,665.498 313.569,838.149 389.094,771.116 464.619,662.572 540.145,761.342 615.67,795.703 691.196,661.914 766.721,674.418 842.247,821.768 917.772,1093.43 993.298,1281.01 1068.82,1415.14 1144.35,1464 1219.87,1244.9 1295.4,1167.07 1370.92,899.255 1446.45,909.686 1521.98,826.139 1597.5,782.118 1673.03,665.275 1748.55,705.704 1824.08,448.807 1899.6,666.277 1975.13,598.784 2050.65,370.637 2126.18,237.536 2201.7,537.048 2277.23,365.066 2352.76,88.5087 "/>
<polyline clip-path="url(#clip402)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,442.339 162.518,478.513 238.043,472.146 313.569,434.683 389.094,427.47 464.619,460.087 540.145,450.442 615.67,423.614 691.196,446.099 766.721,468.092 842.247,489.676 917.772,478.142 993.298,470.947 1068.82,458.13 1144.35,415.22 1219.87,436.203 1295.4,405.098 1370.92,447.686 1446.45,432.596 1521.98,438.295 1597.5,426.225 1673.03,450.644 1748.55,403.239 1824.08,477.67 1899.6,433.232 1975.13,406.981 2050.65,420.356 2126.18,489.34 2201.7,415.455 2277.23,397.468 2352.76,401.233 "/>
<path clip-path="url(#clip400)" d="M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 "/>
<polyline clip-path="url(#clip400)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,147.685 338.744,147.685 "/>
<path clip-path="url(#clip400)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip400)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,199.525 338.744,199.525 "/>
<path clip-path="url(#clip400)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -1.35049  -0.842676  0.508408  …  -1.91883  1.35461  1.47444  1.19961</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip460">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip460)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip461">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip460)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip462">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip460)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1514.38 2352.76,1514.38 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1239.93 2352.76,1239.93 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,965.481 2352.76,965.481 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,691.033 2352.76,691.033 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,416.585 2352.76,416.585 "/>
<polyline clip-path="url(#clip462)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,142.138 2352.76,142.138 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1514.38 105.89,1514.38 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1239.93 105.89,1239.93 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,965.481 105.89,965.481 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,691.033 105.89,691.033 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,416.585 105.89,416.585 "/>
<polyline clip-path="url(#clip460)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,142.138 105.89,142.138 "/>
<path clip-path="url(#clip460)" d="M-9.72514 1514.83 L19.9506 1514.83 L19.9506 1518.76 L-9.72514 1518.76 L-9.72514 1514.83 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M30.0895 1497.1 L48.4458 1497.1 L48.4458 1501.03 L34.3718 1501.03 L34.3718 1509.5 Q35.3904 1509.16 36.4089 1508.99 Q37.4274 1508.81 38.4459 1508.81 Q44.2329 1508.81 47.6125 1511.98 Q50.9921 1515.15 50.9921 1520.57 Q50.9921 1526.15 47.5199 1529.25 Q44.0477 1532.33 37.7283 1532.33 Q35.5524 1532.33 33.2839 1531.96 Q31.0385 1531.59 28.6311 1530.85 L28.6311 1526.15 Q30.7145 1527.28 32.9367 1527.84 Q35.1589 1528.39 37.6357 1528.39 Q41.6403 1528.39 43.9783 1526.29 Q46.3162 1524.18 46.3162 1520.57 Q46.3162 1516.96 43.9783 1514.85 Q41.6403 1512.74 37.6357 1512.74 Q35.7607 1512.74 33.8857 1513.16 Q32.0339 1513.58 30.0895 1514.46 L30.0895 1497.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M39.0477 1225.73 Q35.4367 1225.73 33.608 1229.29 Q31.8024 1232.83 31.8024 1239.96 Q31.8024 1247.07 33.608 1250.63 Q35.4367 1254.18 39.0477 1254.18 Q42.682 1254.18 44.4875 1250.63 Q46.3162 1247.07 46.3162 1239.96 Q46.3162 1232.83 44.4875 1229.29 Q42.682 1225.73 39.0477 1225.73 M39.0477 1222.02 Q44.8579 1222.02 47.9134 1226.63 Q50.9921 1231.21 50.9921 1239.96 Q50.9921 1248.69 47.9134 1253.3 Q44.8579 1257.88 39.0477 1257.88 Q33.2376 1257.88 30.1589 1253.3 Q27.1034 1248.69 27.1034 1239.96 Q27.1034 1231.21 30.1589 1226.63 Q33.2376 1222.02 39.0477 1222.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M30.0895 948.201 L48.4458 948.201 L48.4458 952.136 L34.3718 952.136 L34.3718 960.608 Q35.3904 960.261 36.4089 960.099 Q37.4274 959.914 38.4459 959.914 Q44.2329 959.914 47.6125 963.085 Q50.9921 966.256 50.9921 971.673 Q50.9921 977.252 47.5199 980.354 Q44.0477 983.432 37.7283 983.432 Q35.5524 983.432 33.2839 983.062 Q31.0385 982.692 28.6311 981.951 L28.6311 977.252 Q30.7145 978.386 32.9367 978.942 Q35.1589 979.497 37.6357 979.497 Q41.6403 979.497 43.9783 977.391 Q46.3162 975.284 46.3162 971.673 Q46.3162 968.062 43.9783 965.956 Q41.6403 963.849 37.6357 963.849 Q35.7607 963.849 33.8857 964.266 Q32.0339 964.682 30.0895 965.562 L30.0895 948.201 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M-0.303895 704.378 L7.33495 704.378 L7.33495 678.012 L-0.975188 679.679 L-0.975188 675.42 L7.28866 673.753 L11.9646 673.753 L11.9646 704.378 L19.6034 704.378 L19.6034 708.313 L-0.303895 708.313 L-0.303895 704.378 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M39.0477 676.832 Q35.4367 676.832 33.608 680.397 Q31.8024 683.938 31.8024 691.068 Q31.8024 698.174 33.608 701.739 Q35.4367 705.281 39.0477 705.281 Q42.682 705.281 44.4875 701.739 Q46.3162 698.174 46.3162 691.068 Q46.3162 683.938 44.4875 680.397 Q42.682 676.832 39.0477 676.832 M39.0477 673.128 Q44.8579 673.128 47.9134 677.735 Q50.9921 682.318 50.9921 691.068 Q50.9921 699.795 47.9134 704.401 Q44.8579 708.985 39.0477 708.985 Q33.2376 708.985 30.1589 704.401 Q27.1034 699.795 27.1034 691.068 Q27.1034 682.318 30.1589 677.735 Q33.2376 673.128 39.0477 673.128 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M0.69147 429.93 L8.33032 429.93 L8.33032 403.565 L0.0201769 405.231 L0.0201769 400.972 L8.28402 399.305 L12.9599 399.305 L12.9599 429.93 L20.5988 429.93 L20.5988 433.865 L0.69147 433.865 L0.69147 429.93 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M30.0895 399.305 L48.4458 399.305 L48.4458 403.241 L34.3718 403.241 L34.3718 411.713 Q35.3904 411.366 36.4089 411.204 Q37.4274 411.018 38.4459 411.018 Q44.2329 411.018 47.6125 414.19 Q50.9921 417.361 50.9921 422.778 Q50.9921 428.356 47.5199 431.458 Q44.0477 434.537 37.7283 434.537 Q35.5524 434.537 33.2839 434.166 Q31.0385 433.796 28.6311 433.055 L28.6311 428.356 Q30.7145 429.491 32.9367 430.046 Q35.1589 430.602 37.6357 430.602 Q41.6403 430.602 43.9783 428.495 Q46.3162 426.389 46.3162 422.778 Q46.3162 419.166 43.9783 417.06 Q41.6403 414.954 37.6357 414.954 Q35.7607 414.954 33.8857 415.37 Q32.0339 415.787 30.0895 416.666 L30.0895 399.305 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M2.91368 155.483 L19.233 155.483 L19.233 159.418 L-2.71129 159.418 L-2.71129 155.483 Q-0.0492672 152.728 4.53404 148.098 Q9.1405 143.446 10.321 142.103 Q12.5664 139.58 13.446 137.844 Q14.3488 136.084 14.3488 134.395 Q14.3488 131.64 12.4044 129.904 Q10.4831 128.168 7.38125 128.168 Q5.18219 128.168 2.7285 128.932 Q0.297953 129.696 -2.47981 131.247 L-2.47981 126.524 Q0.344249 125.39 2.79794 124.811 Q5.25163 124.233 7.28866 124.233 Q12.659 124.233 15.8534 126.918 Q19.0479 129.603 19.0479 134.094 Q19.0479 136.223 18.2377 138.145 Q17.4506 140.043 15.3442 142.635 Q14.7655 143.307 11.6636 146.524 Q8.5618 149.719 2.91368 155.483 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip460)" d="M39.0477 127.936 Q35.4367 127.936 33.608 131.501 Q31.8024 135.043 31.8024 142.172 Q31.8024 149.279 33.608 152.844 Q35.4367 156.385 39.0477 156.385 Q42.682 156.385 44.4875 152.844 Q46.3162 149.279 46.3162 142.172 Q46.3162 135.043 44.4875 131.501 Q42.682 127.936 39.0477 127.936 M39.0477 124.233 Q44.8579 124.233 47.9134 128.839 Q50.9921 133.422 50.9921 142.172 Q50.9921 150.899 47.9134 155.506 Q44.8579 160.089 39.0477 160.089 Q33.2376 160.089 30.1589 155.506 Q27.1034 150.899 27.1034 142.172 Q27.1034 133.422 30.1589 128.839 Q33.2376 124.233 39.0477 124.233 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip462)" d="M151.118 1325.75 L222.368 1446.93 L293.618 1477.1 L364.869 1479.3 L436.119 1472.87 L507.37 1461.68 L578.62 1445.76 L649.871 1433.46 L721.121 1428.64 L792.371 1420.99 L863.622 1410.07 L934.872 1401.35 L1006.12 1391.43 L1077.37 1383.9 L1148.62 1378.76 L1219.87 1372.19 L1291.12 1364.33 L1362.37 1358.58 L1433.63 1355.28 L1504.88 1349.1 L1576.13 1340.64 L1647.38 1338.57 L1718.63 1333.31 L1789.88 1328.51 L1861.13 1325.29 L1932.38 1326.65 L2003.63 1324.74 L2074.88 1324.35 L2146.13 1324.1 L2217.38 1322.04 L2288.63 1322.19 L2288.63 955.116 L2217.38 941.542 L2146.13 921.899 L2074.88 909.493 L2003.63 892.202 L1932.38 878.404 L1861.13 856.225 L1789.88 836.976 L1718.63 815.258 L1647.38 792.991 L1576.13 768.443 L1504.88 745.889 L1433.63 719.72 L1362.37 692.337 L1291.12 662.687 L1219.87 634.54 L1148.62 608.222 L1077.37 574.041 L1006.12 541.268 L934.872 502.981 L863.622 458.809 L792.371 415.803 L721.121 371.74 L649.871 326.151 L578.62 279.824 L507.37 231.16 L436.119 176.335 L364.869 119.663 L293.618 88.9544 L222.368 177.644 L151.118 1162.73  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip462)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1232.01 222.368,1152.84 293.618,1142.09 364.869,1149.47 436.119,1151.97 507.37,1156.14 578.62,1160.21 649.871,1164.29 721.121,1169.18 792.371,1172.97 863.622,1174.53 934.872,1176.25 1006.12,1182.1 1077.37,1186.89 1148.62,1189.76 1219.87,1191.85 1291.12,1194.74 1362.37,1194.44 1433.63,1193.01 1504.88,1198.01 1576.13,1198.59 1647.38,1201.5 1718.63,1205.38 1789.88,1205.76 1861.13,1209 1932.38,1211.23 2003.63,1209.71 2074.88,1215.03 2146.13,1217.24 2217.38,1216.6 2288.63,1218.44 "/>
<path clip-path="url(#clip462)" d="M151.118 1309.53 L222.368 1253.3 L293.618 1242.92 L364.869 1240.91 L436.119 1241.12 L507.37 1240.7 L578.62 1240.72 L649.871 1240.6 L721.121 1240.76 L792.371 1240.84 L863.622 1240.98 L934.872 1240.75 L1006.12 1240.73 L1077.37 1240.64 L1148.62 1240.56 L1219.87 1240.76 L1291.12 1240.87 L1362.37 1240.82 L1433.63 1240.93 L1504.88 1240.8 L1576.13 1240.76 L1647.38 1240.87 L1718.63 1240.93 L1789.88 1240.8 L1861.13 1241.1 L1932.38 1240.83 L2003.63 1240.99 L2074.88 1241.01 L2146.13 1240.94 L2217.38 1240.97 L2288.63 1240.77 L2288.63 1239.22 L2217.38 1239.22 L2146.13 1239.32 L2074.88 1238.9 L2003.63 1238.87 L1932.38 1238.82 L1861.13 1239.07 L1789.88 1239.18 L1718.63 1239.23 L1647.38 1239.08 L1576.13 1239.35 L1504.88 1239.14 L1433.63 1239.11 L1362.37 1239.26 L1291.12 1239.12 L1219.87 1238.89 L1148.62 1238.99 L1077.37 1239.06 L1006.12 1238.86 L934.872 1239.16 L863.622 1238.93 L792.371 1239.17 L721.121 1238.88 L649.871 1238.94 L578.62 1238.95 L507.37 1239.06 L436.119 1239.12 L364.869 1238.61 L293.618 1236.35 L222.368 1221.94 L151.118 1149.08  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip462)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1230.39 222.368,1238.41 293.618,1239.91 364.869,1239.95 436.119,1239.93 507.37,1239.94 578.62,1239.82 649.871,1239.87 721.121,1239.84 792.371,1239.87 863.622,1239.93 934.872,1239.93 1006.12,1239.9 1077.37,1239.87 1148.62,1239.93 1219.87,1239.98 1291.12,1239.8 1362.37,1239.86 1433.63,1240.03 1504.88,1239.87 1576.13,1239.89 1647.38,1239.87 1718.63,1239.9 1789.88,1239.89 1861.13,1239.99 1932.38,1239.92 2003.63,1239.95 2074.88,1239.9 2146.13,1240.02 2217.38,1240.11 2288.63,1239.91 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">55.3212721747659</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-764.199164642422, -5276.5404619412975], [96.07046686319335 0.9849643184326008; 697.2394406028932 12.739305808845927], [-22.318644643510027 0.11015646139343861; -175.78211639639454 0.039262436430426095;;; 0.11015646139343861 -0.06095418534022015; 0.039262436430426095 -0.4376134176999318], [55.078372048656966; 605.0459872297953;;], [-78.07103114517004, -100.83520395808908], [9.277426147894108 0.4845518990015936; 5.135848662502642 -0.22736062557818967], [-2.1950570954327784 -0.050746321630196684; 0.21225498989232292 -0.0007268028134467764;;; -0.050746321630196684 -0.010667806839587663; -0.0007268028134467764 -0.0005424890408613472], [-5.6538442836170155 -5.309088551700666 … -0.7693387555550514 -0.007453926060457741])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 14 March 2023 00:40">Tuesday 14 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
