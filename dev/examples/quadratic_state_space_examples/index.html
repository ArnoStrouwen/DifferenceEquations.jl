<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.01020579836501478]
 [-0.06310262412282358, 0.018176070725057124]
 [0.05362130478531857, -0.002302695383091905]
 [0.03659315700675026, -0.009959436660273633]
 [-0.026777091625241927, -0.017289097709573598]
 [-0.13174128566946527, 0.008167789188193563]
 [-0.07446058593018332, -0.012006623950324645]
 [-0.14474519241965722, 0.010576866724518456]
 [-0.0717686502457728, 0.00835556907704815]
 ⋮
 [-0.11337904111002489, 0.0006295338765209702]
 [-0.1038916570684579, -0.02340738676413986]
 [-0.2420203671437365, -0.01543473205559005]
 [-0.32470306527799586, -0.020413203123713065]
 [-0.4333718735605767, -0.004853746373174716]
 [-0.4416958034689155, 0.002395166681077535]
 [-0.40493380480523183, 0.00922471748555039]
 [-0.32759511514457607, -0.014211984045463926]
 [-0.3984789601194667, -0.0004748718495781348]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip990">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip990)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip991">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip990)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip992">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip990)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1355.4 2352.76,1355.4 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1094.95 2352.76,1094.95 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,834.509 2352.76,834.509 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,574.063 2352.76,574.063 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,313.617 2352.76,313.617 "/>
<polyline clip-path="url(#clip992)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,53.1711 2352.76,53.1711 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1355.4 105.89,1355.4 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1094.95 105.89,1094.95 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,834.509 105.89,834.509 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,574.063 105.89,574.063 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,313.617 105.89,313.617 "/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,53.1711 105.89,53.1711 "/>
<path clip-path="url(#clip990)" d="M-56.4379 1355.85 L-26.7621 1355.85 L-26.7621 1359.79 L-56.4379 1359.79 L-56.4379 1355.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-6.6696 1341.2 Q-10.2807 1341.2 -12.1094 1344.76 Q-13.9149 1348.31 -13.9149 1355.43 Q-13.9149 1362.54 -12.1094 1366.11 Q-10.2807 1369.65 -6.6696 1369.65 Q-3.03536 1369.65 -1.22982 1366.11 Q0.598877 1362.54 0.598877 1355.43 Q0.598877 1348.31 -1.22982 1344.76 Q-3.03536 1341.2 -6.6696 1341.2 M-6.6696 1337.5 Q-0.859448 1337.5 2.19609 1342.1 Q5.27478 1346.69 5.27478 1355.43 Q5.27478 1364.16 2.19609 1368.77 Q-0.859448 1373.35 -6.6696 1373.35 Q-12.4798 1373.35 -15.5584 1368.77 Q-18.614 1364.16 -18.614 1355.43 Q-18.614 1346.69 -15.5584 1342.1 Q-12.4798 1337.5 -6.6696 1337.5 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M13.4923 1366.8 L18.3766 1366.8 L18.3766 1372.68 L13.4923 1372.68 L13.4923 1366.8 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M41.4088 1342.19 L29.6034 1360.64 L41.4088 1360.64 L41.4088 1342.19 M40.182 1338.12 L46.0616 1338.12 L46.0616 1360.64 L50.9921 1360.64 L50.9921 1364.53 L46.0616 1364.53 L46.0616 1372.68 L41.4088 1372.68 L41.4088 1364.53 L25.8071 1364.53 L25.8071 1360.02 L40.182 1338.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-55.3036 1095.41 L-25.6278 1095.41 L-25.6278 1099.34 L-55.3036 1099.34 L-55.3036 1095.41 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-5.53535 1080.75 Q-9.14644 1080.75 -10.9751 1084.32 Q-12.7807 1087.86 -12.7807 1094.99 Q-12.7807 1102.1 -10.9751 1105.66 Q-9.14644 1109.2 -5.53535 1109.2 Q-1.90111 1109.2 -0.0955632 1105.66 Q1.73313 1102.1 1.73313 1094.99 Q1.73313 1087.86 -0.0955632 1084.32 Q-1.90111 1080.75 -5.53535 1080.75 M-5.53535 1077.05 Q0.274805 1077.05 3.33034 1081.66 Q6.40903 1086.24 6.40903 1094.99 Q6.40903 1103.72 3.33034 1108.32 Q0.274805 1112.91 -5.53535 1112.91 Q-11.3455 1112.91 -14.4242 1108.32 Q-17.4797 1103.72 -17.4797 1094.99 Q-17.4797 1086.24 -14.4242 1081.66 Q-11.3455 1077.05 -5.53535 1077.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M14.6266 1106.35 L19.5108 1106.35 L19.5108 1112.23 L14.6266 1112.23 L14.6266 1106.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M43.8625 1093.6 Q47.219 1094.32 49.094 1096.59 Q50.9921 1098.85 50.9921 1102.19 Q50.9921 1107.3 47.4736 1110.1 Q43.9551 1112.91 37.4737 1112.91 Q35.2978 1112.91 32.983 1112.47 Q30.6913 1112.05 28.2376 1111.19 L28.2376 1106.68 Q30.1821 1107.81 32.4969 1108.39 Q34.8117 1108.97 37.3348 1108.97 Q41.7329 1108.97 44.0246 1107.23 Q46.3394 1105.5 46.3394 1102.19 Q46.3394 1099.13 44.1866 1097.42 Q42.057 1095.68 38.2376 1095.68 L34.2098 1095.68 L34.2098 1091.84 L38.4227 1091.84 Q41.8718 1091.84 43.7005 1090.48 Q45.5292 1089.09 45.5292 1086.49 Q45.5292 1083.83 43.6311 1082.42 Q41.7561 1080.98 38.2376 1080.98 Q36.3163 1080.98 34.1172 1081.4 Q31.9182 1081.82 29.2793 1082.7 L29.2793 1078.53 Q31.9413 1077.79 34.2561 1077.42 Q36.5941 1077.05 38.6542 1077.05 Q43.9783 1077.05 47.0801 1079.48 Q50.1819 1081.89 50.1819 1086.01 Q50.1819 1088.88 48.5384 1090.87 Q46.8949 1092.84 43.8625 1093.6 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-54.3545 834.96 L-24.6788 834.96 L-24.6788 838.895 L-54.3545 838.895 L-54.3545 834.96 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-4.58628 820.307 Q-8.19737 820.307 -10.0261 823.872 Q-11.8316 827.414 -11.8316 834.543 Q-11.8316 841.65 -10.0261 845.215 Q-8.19737 848.756 -4.58628 848.756 Q-0.95204 848.756 0.853506 845.215 Q2.6822 841.65 2.6822 834.543 Q2.6822 827.414 0.853506 823.872 Q-0.95204 820.307 -4.58628 820.307 M-4.58628 816.604 Q1.22387 816.604 4.27941 821.21 Q7.3581 825.793 7.3581 834.543 Q7.3581 843.27 4.27941 847.877 Q1.22387 852.46 -4.58628 852.46 Q-10.3964 852.46 -13.4751 847.877 Q-16.5307 843.27 -16.5307 834.543 Q-16.5307 825.793 -13.4751 821.21 Q-10.3964 816.604 -4.58628 816.604 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M15.5756 845.909 L20.4599 845.909 L20.4599 851.789 L15.5756 851.789 L15.5756 845.909 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M34.6728 847.853 L50.9921 847.853 L50.9921 851.789 L29.0478 851.789 L29.0478 847.853 Q31.7098 845.099 36.2931 840.469 Q40.8996 835.816 42.0801 834.474 Q44.3255 831.951 45.2051 830.215 Q46.1079 828.455 46.1079 826.766 Q46.1079 824.011 44.1635 822.275 Q42.2422 820.539 39.1403 820.539 Q36.9413 820.539 34.4876 821.303 Q32.057 822.067 29.2793 823.617 L29.2793 818.895 Q32.1033 817.761 34.557 817.182 Q37.0107 816.604 39.0477 816.604 Q44.4181 816.604 47.6125 819.289 Q50.8069 821.974 50.8069 826.465 Q50.8069 828.594 49.9968 830.516 Q49.2097 832.414 47.1033 835.006 Q46.5246 835.678 43.4227 838.895 Q40.3209 842.09 34.6728 847.853 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-54.7249 574.514 L-25.0491 574.514 L-25.0491 578.449 L-54.7249 578.449 L-54.7249 574.514 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-4.95665 559.861 Q-8.56774 559.861 -10.3964 563.426 Q-12.202 566.968 -12.202 574.097 Q-12.202 581.204 -10.3964 584.769 Q-8.56774 588.31 -4.95665 588.31 Q-1.32241 588.31 0.483137 584.769 Q2.31183 581.204 2.31183 574.097 Q2.31183 566.968 0.483137 563.426 Q-1.32241 559.861 -4.95665 559.861 M-4.95665 556.158 Q0.853506 556.158 3.90904 560.764 Q6.98773 565.348 6.98773 574.097 Q6.98773 582.824 3.90904 587.431 Q0.853506 592.014 -4.95665 592.014 Q-10.7668 592.014 -13.8455 587.431 Q-16.901 582.824 -16.901 574.097 Q-16.901 565.348 -13.8455 560.764 Q-10.7668 556.158 -4.95665 556.158 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M15.2053 585.463 L20.0895 585.463 L20.0895 591.343 L15.2053 591.343 L15.2053 585.463 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M31.0848 587.408 L38.7237 587.408 L38.7237 561.042 L30.4135 562.709 L30.4135 558.449 L38.6774 556.783 L43.3533 556.783 L43.3533 587.408 L50.9921 587.408 L50.9921 591.343 L31.0848 591.343 L31.0848 587.408 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-6.18349 299.416 Q-9.79459 299.416 -11.6233 302.98 Q-13.4288 306.522 -13.4288 313.652 Q-13.4288 320.758 -11.6233 324.323 Q-9.79459 327.865 -6.18349 327.865 Q-2.54925 327.865 -0.743708 324.323 Q1.08499 320.758 1.08499 313.652 Q1.08499 306.522 -0.743708 302.98 Q-2.54925 299.416 -6.18349 299.416 M-6.18349 295.712 Q-0.37334 295.712 2.6822 300.318 Q5.76089 304.902 5.76089 313.652 Q5.76089 322.378 2.6822 326.985 Q-0.37334 331.568 -6.18349 331.568 Q-11.9936 331.568 -15.0723 326.985 Q-18.1279 322.378 -18.1279 313.652 Q-18.1279 304.902 -15.0723 300.318 Q-11.9936 295.712 -6.18349 295.712 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M13.9784 325.017 L18.8627 325.017 L18.8627 330.897 L13.9784 330.897 L13.9784 325.017 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M39.0477 299.416 Q35.4367 299.416 33.608 302.98 Q31.8024 306.522 31.8024 313.652 Q31.8024 320.758 33.608 324.323 Q35.4367 327.865 39.0477 327.865 Q42.682 327.865 44.4875 324.323 Q46.3162 320.758 46.3162 313.652 Q46.3162 306.522 44.4875 302.98 Q42.682 299.416 39.0477 299.416 M39.0477 295.712 Q44.8579 295.712 47.9134 300.318 Q50.9921 304.902 50.9921 313.652 Q50.9921 322.378 47.9134 326.985 Q44.8579 331.568 39.0477 331.568 Q33.2376 331.568 30.1589 326.985 Q27.1034 322.378 27.1034 313.652 Q27.1034 304.902 30.1589 300.318 Q33.2376 295.712 39.0477 295.712 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M-4.95665 38.9698 Q-8.56774 38.9698 -10.3964 42.5346 Q-12.202 46.0762 -12.202 53.2058 Q-12.202 60.3123 -10.3964 63.877 Q-8.56774 67.4187 -4.95665 67.4187 Q-1.32241 67.4187 0.483137 63.877 Q2.31183 60.3123 2.31183 53.2058 Q2.31183 46.0762 0.483137 42.5346 Q-1.32241 38.9698 -4.95665 38.9698 M-4.95665 35.2661 Q0.853506 35.2661 3.90904 39.8725 Q6.98773 44.4559 6.98773 53.2058 Q6.98773 61.9326 3.90904 66.5391 Q0.853506 71.1224 -4.95665 71.1224 Q-10.7668 71.1224 -13.8455 66.5391 Q-16.901 61.9326 -16.901 53.2058 Q-16.901 44.4559 -13.8455 39.8725 Q-10.7668 35.2661 -4.95665 35.2661 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M15.2053 64.5715 L20.0895 64.5715 L20.0895 70.4511 L15.2053 70.4511 L15.2053 64.5715 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip990)" d="M31.0848 66.5159 L38.7237 66.5159 L38.7237 40.1503 L30.4135 41.817 L30.4135 37.5577 L38.6774 35.8911 L43.3533 35.8911 L43.3533 66.5159 L50.9921 66.5159 L50.9921 70.4511 L31.0848 70.4511 L31.0848 66.5159 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip992)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,313.617 162.518,313.821 238.043,477.965 313.569,173.962 389.094,218.312 464.619,383.357 540.145,656.732 615.67,507.546 691.196,690.6 766.721,500.535 842.247,356.013 917.772,178.022 993.298,88.5087 1068.82,350.231 1144.35,469.528 1219.87,346.161 1295.4,472.983 1370.92,351.111 1446.45,135.305 1521.98,133.61 1597.5,389.399 1673.03,409.279 1748.55,608.908 1824.08,584.198 1899.6,943.949 1975.13,1159.29 2050.65,1442.32 2126.18,1464 2201.7,1368.25 2277.23,1166.82 2352.76,1351.44 "/>
<polyline clip-path="url(#clip992)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,313.617 162.518,340.197 238.043,266.278 313.569,319.614 389.094,339.556 464.619,358.646 540.145,292.344 615.67,344.888 691.196,286.07 766.721,291.855 842.247,285.367 917.772,298.108 993.298,354.264 1068.82,333.199 1144.35,294.998 1219.87,334.389 1295.4,295.265 1370.92,279.301 1446.45,311.874 1521.98,353.67 1597.5,317.406 1673.03,346.781 1748.55,311.977 1824.08,374.58 1899.6,353.816 1975.13,366.782 2050.65,326.258 2126.18,307.379 2201.7,289.592 2277.23,350.631 2352.76,314.854 "/>
<path clip-path="url(#clip990)" d="M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip990)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 "/>
<polyline clip-path="url(#clip990)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1352.98 338.744,1352.98 "/>
<path clip-path="url(#clip990)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip990)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1404.82 338.744,1404.82 "/>
<path clip-path="url(#clip990)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -1.02058  2.02172  -0.593791  -0.94989  …  0.874568  -1.60569  0.236752</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip050">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip050)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip051">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip050)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip052">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip050)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1203.03 2352.76,1203.03 "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,880.705 2352.76,880.705 "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,558.379 2352.76,558.379 "/>
<polyline clip-path="url(#clip052)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,236.054 2352.76,236.054 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1203.03 105.89,1203.03 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,880.705 105.89,880.705 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,558.379 105.89,558.379 "/>
<polyline clip-path="url(#clip050)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,236.054 105.89,236.054 "/>
<path clip-path="url(#clip050)" d="M39.0477 1188.83 Q35.4367 1188.83 33.608 1192.39 Q31.8024 1195.94 31.8024 1203.06 Q31.8024 1210.17 33.608 1213.74 Q35.4367 1217.28 39.0477 1217.28 Q42.682 1217.28 44.4875 1213.74 Q46.3162 1210.17 46.3162 1203.06 Q46.3162 1195.94 44.4875 1192.39 Q42.682 1188.83 39.0477 1188.83 M39.0477 1185.13 Q44.8579 1185.13 47.9134 1189.73 Q50.9921 1194.32 50.9921 1203.06 Q50.9921 1211.79 47.9134 1216.4 Q44.8579 1220.98 39.0477 1220.98 Q33.2376 1220.98 30.1589 1216.4 Q27.1034 1211.79 27.1034 1203.06 Q27.1034 1194.32 30.1589 1189.73 Q33.2376 1185.13 39.0477 1185.13 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M30.0895 863.425 L48.4458 863.425 L48.4458 867.36 L34.3718 867.36 L34.3718 875.832 Q35.3904 875.485 36.4089 875.323 Q37.4274 875.138 38.4459 875.138 Q44.2329 875.138 47.6125 878.309 Q50.9921 881.48 50.9921 886.897 Q50.9921 892.475 47.5199 895.577 Q44.0477 898.656 37.7283 898.656 Q35.5524 898.656 33.2839 898.286 Q31.0385 897.915 28.6311 897.175 L28.6311 892.475 Q30.7145 893.61 32.9367 894.165 Q35.1589 894.721 37.6357 894.721 Q41.6403 894.721 43.9783 892.614 Q46.3162 890.508 46.3162 886.897 Q46.3162 883.286 43.9783 881.179 Q41.6403 879.073 37.6357 879.073 Q35.7607 879.073 33.8857 879.489 Q32.0339 879.906 30.0895 880.786 L30.0895 863.425 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M-0.303895 571.724 L7.33495 571.724 L7.33495 545.358 L-0.975188 547.025 L-0.975188 542.766 L7.28866 541.099 L11.9646 541.099 L11.9646 571.724 L19.6034 571.724 L19.6034 575.659 L-0.303895 575.659 L-0.303895 571.724 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M39.0477 544.178 Q35.4367 544.178 33.608 547.743 Q31.8024 551.284 31.8024 558.414 Q31.8024 565.52 33.608 569.085 Q35.4367 572.627 39.0477 572.627 Q42.682 572.627 44.4875 569.085 Q46.3162 565.52 46.3162 558.414 Q46.3162 551.284 44.4875 547.743 Q42.682 544.178 39.0477 544.178 M39.0477 540.474 Q44.8579 540.474 47.9134 545.081 Q50.9921 549.664 50.9921 558.414 Q50.9921 567.141 47.9134 571.747 Q44.8579 576.33 39.0477 576.33 Q33.2376 576.33 30.1589 571.747 Q27.1034 567.141 27.1034 558.414 Q27.1034 549.664 30.1589 545.081 Q33.2376 540.474 39.0477 540.474 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M0.69147 249.398 L8.33032 249.398 L8.33032 223.033 L0.0201769 224.699 L0.0201769 220.44 L8.28402 218.774 L12.9599 218.774 L12.9599 249.398 L20.5988 249.398 L20.5988 253.334 L0.69147 253.334 L0.69147 249.398 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip050)" d="M30.0895 218.774 L48.4458 218.774 L48.4458 222.709 L34.3718 222.709 L34.3718 231.181 Q35.3904 230.834 36.4089 230.672 Q37.4274 230.486 38.4459 230.486 Q44.2329 230.486 47.6125 233.658 Q50.9921 236.829 50.9921 242.246 Q50.9921 247.824 47.5199 250.926 Q44.0477 254.005 37.7283 254.005 Q35.5524 254.005 33.2839 253.635 Q31.0385 253.264 28.6311 252.523 L28.6311 247.824 Q30.7145 248.959 32.9367 249.514 Q35.1589 250.07 37.6357 250.07 Q41.6403 250.07 43.9783 247.963 Q46.3162 245.857 46.3162 242.246 Q46.3162 238.635 43.9783 236.528 Q41.6403 234.422 37.6357 234.422 Q35.7607 234.422 33.8857 234.838 Q32.0339 235.255 30.0895 236.135 L30.0895 218.774 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip052)" d="M151.118 1278.96 L222.368 1427.49 L293.618 1478.9 L364.869 1479.3 L436.119 1466.77 L507.37 1452.48 L578.62 1445.56 L649.871 1435.9 L721.121 1423.82 L792.371 1412.05 L863.622 1398.57 L934.872 1390.65 L1006.12 1380.19 L1077.37 1373.57 L1148.62 1365.16 L1219.87 1357.29 L1291.12 1349.29 L1362.37 1340.77 L1433.63 1331.8 L1504.88 1325.33 L1576.13 1318.02 L1647.38 1315.37 L1718.63 1310.61 L1789.88 1303.19 L1861.13 1298.84 L1932.38 1295.01 L2003.63 1291.21 L2074.88 1286.48 L2146.13 1284.72 L2217.38 1279.13 L2288.63 1274.37 L2288.63 932.84 L2217.38 917.675 L2146.13 903.277 L2074.88 887.794 L2003.63 871.754 L1932.38 851.553 L1861.13 830.672 L1789.88 811.979 L1718.63 789.934 L1647.38 767.374 L1576.13 743.793 L1504.88 718.713 L1433.63 692.55 L1362.37 664.668 L1291.12 635.367 L1219.87 603.697 L1148.62 570.671 L1077.37 537.346 L1006.12 505.977 L934.872 473.269 L863.622 438.292 L792.371 395.165 L721.121 350.924 L649.871 307.789 L578.62 264.464 L507.37 217.147 L436.119 166.192 L364.869 119.469 L293.618 88.9544 L222.368 179.555 L151.118 1089.01  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip052)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1196.15 222.368,1066.16 293.618,1112.81 364.869,1118.47 436.119,1119.18 507.37,1119.95 578.62,1126.24 649.871,1129.9 721.121,1130.47 792.371,1136.56 863.622,1140.5 934.872,1148.63 1006.12,1155.03 1077.37,1156.35 1148.62,1160.01 1219.87,1162.42 1291.12,1163.52 1362.37,1165.06 1433.63,1166.74 1504.88,1168.06 1576.13,1169.85 1647.38,1170.43 1718.63,1173.17 1789.88,1180.22 1861.13,1185.41 1932.38,1185.35 2003.63,1184.38 2074.88,1186.4 2146.13,1185.17 2217.38,1184.72 2288.63,1183.9 "/>
<path clip-path="url(#clip052)" d="M151.118 1314.12 L222.368 1225.23 L293.618 1207.64 L364.869 1204.47 L436.119 1204.03 L507.37 1203.93 L578.62 1204.25 L649.871 1204.18 L721.121 1204.22 L792.371 1204.18 L863.622 1203.91 L934.872 1204.28 L1006.12 1203.8 L1077.37 1203.83 L1148.62 1204.27 L1219.87 1203.85 L1291.12 1203.93 L1362.37 1203.92 L1433.63 1204.16 L1504.88 1203.77 L1576.13 1203.83 L1647.38 1203.95 L1718.63 1203.92 L1789.88 1204.16 L1861.13 1204.08 L1932.38 1203.96 L2003.63 1203.94 L2074.88 1203.77 L2146.13 1204.12 L2217.38 1204.51 L2288.63 1204.04 L2288.63 1202.28 L2217.38 1202.16 L2146.13 1201.89 L2074.88 1201.96 L2003.63 1202.06 L1932.38 1201.83 L1861.13 1202.1 L1789.88 1201.53 L1718.63 1201.95 L1647.38 1202.08 L1576.13 1202.2 L1504.88 1201.97 L1433.63 1202.17 L1362.37 1202.27 L1291.12 1201.59 L1219.87 1202.06 L1148.62 1201.96 L1077.37 1202.05 L1006.12 1201.9 L934.872 1201.91 L863.622 1202.03 L792.371 1201.78 L721.121 1202.32 L649.871 1202.01 L578.62 1202.06 L507.37 1202.06 L436.119 1201.97 L364.869 1201.72 L293.618 1199.27 L222.368 1184.56 L151.118 1109.46  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip052)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1198.92 222.368,1201.62 293.618,1202.86 364.869,1202.82 436.119,1203.09 507.37,1203.02 578.62,1203.02 649.871,1203.03 721.121,1203.14 792.371,1202.79 863.622,1203.2 934.872,1203.03 1006.12,1202.79 1077.37,1202.91 1148.62,1203.1 1219.87,1203.12 1291.12,1203.11 1362.37,1203.09 1433.63,1203.21 1504.88,1202.87 1576.13,1203.12 1647.38,1203.13 1718.63,1202.96 1789.88,1202.92 1861.13,1203.1 1932.38,1202.96 2003.63,1202.93 2074.88,1202.85 2146.13,1202.93 2217.38,1203.12 2288.63,1203.06 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">54.83315862182398</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([207.02193868556145, 1784.4607847507293], [-56.570743584629874 -0.8375987560612309; -404.05117818299 -6.7763853754735], [22.15023513267962 0.13439019712082348; 147.86414237918797 1.7427644660214863;;; 0.13439019712082348 0.029297571627812734; 1.7427644660214863 0.2776004422793336], [-150.49020132887586; -494.2201343680575;;], [6.909680119883202, -7.474313959967954], [6.264230877974792 0.07691667183347746; -5.678187092100334 -0.8856110151769905], [-3.367419985497738 -0.015906747152505233; 1.9602468053489357 0.12618003260300956;;; -0.015906747152505233 0.011273780068726515; 0.12618003260300956 0.0041424339592338755], [-1.3499384374715462 -1.2914954024222014 … 1.0161684508717126 -0.07134706692291905])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 13 March 2023 21:54">Monday 13 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
