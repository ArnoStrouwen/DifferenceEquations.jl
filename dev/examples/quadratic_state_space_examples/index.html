<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.003136000000453795]
 [-0.019565013508669064, 0.00038603329624304836]
 [-0.016271720649046247, -0.005173073964583116]
 [-0.04752015401982532, -0.0187664663814454]
 [-0.16041307616224565, -0.004375165080546443]
 [-0.17949443050154296, -0.00920558154563044]
 [-0.22730198706543686, -0.006505480097309358]
 [-0.25612696102804305, -0.004409698204680304]
 [-0.2706149024840157, -0.003471686498411272]
 ⋮
 [-0.6299245880817689, -0.019230757878232693]
 [-0.7158357210069414, -0.006764577857394061]
 [-0.7216940745797427, 0.0017489023564865687]
 [-0.6750274964602245, 0.007826771937588139]
 [-0.593090052152111, -0.011808478509217967]
 [-0.6358845083658947, 0.007763664682611731]
 [-0.5562645495093704, 0.00870311125034819]
 [-0.47472687273511815, 0.0009436079820634626]
 [-0.4452924433716219, -0.017734950108347327]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip780">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip780)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip781">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip780)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip782">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip780)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1234.91 2352.76,1234.91 
  "/>
<polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,858.427 2352.76,858.427 
  "/>
<polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,481.939 2352.76,481.939 
  "/>
<polyline clip-path="url(#clip782)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,105.452 2352.76,105.452 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1234.91 105.89,1234.91 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,858.427 105.89,858.427 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,481.939 105.89,481.939 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,105.452 105.89,105.452 
  "/>
<path clip-path="url(#clip780)" d="M-56.1138 1235.37 L-26.438 1235.37 L-26.438 1239.3 L-56.1138 1239.3 L-56.1138 1235.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M-6.34553 1220.71 Q-9.95662 1220.71 -11.7853 1224.28 Q-13.5909 1227.82 -13.5909 1234.95 Q-13.5909 1242.06 -11.7853 1245.62 Q-9.95662 1249.16 -6.34553 1249.16 Q-2.71129 1249.16 -0.905744 1245.62 Q0.92295 1242.06 0.92295 1234.95 Q0.92295 1227.82 -0.905744 1224.28 Q-2.71129 1220.71 -6.34553 1220.71 M-6.34553 1217.01 Q-0.535376 1217.01 2.52016 1221.62 Q5.59885 1226.2 5.59885 1234.95 Q5.59885 1243.68 2.52016 1248.28 Q-0.535376 1252.87 -6.34553 1252.87 Q-12.1557 1252.87 -15.2344 1248.28 Q-18.2899 1243.68 -18.2899 1234.95 Q-18.2899 1226.2 -15.2344 1221.62 Q-12.1557 1217.01 -6.34553 1217.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M13.8164 1246.31 L18.7006 1246.31 L18.7006 1252.19 L13.8164 1252.19 L13.8164 1246.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M39.4644 1233.05 Q36.3163 1233.05 34.4644 1235.2 Q32.6357 1237.36 32.6357 1241.11 Q32.6357 1244.83 34.4644 1247.01 Q36.3163 1249.16 39.4644 1249.16 Q42.6125 1249.16 44.4412 1247.01 Q46.2931 1244.83 46.2931 1241.11 Q46.2931 1237.36 44.4412 1235.2 Q42.6125 1233.05 39.4644 1233.05 M48.7468 1218.4 L48.7468 1222.66 Q46.9875 1221.82 45.182 1221.38 Q43.3996 1220.94 41.6403 1220.94 Q37.0107 1220.94 34.557 1224.07 Q32.1265 1227.19 31.7793 1233.51 Q33.145 1231.5 35.2052 1230.43 Q37.2653 1229.35 39.7422 1229.35 Q44.9505 1229.35 47.9597 1232.52 Q50.9921 1235.67 50.9921 1241.11 Q50.9921 1246.43 47.844 1249.65 Q44.6959 1252.87 39.4644 1252.87 Q33.4691 1252.87 30.2978 1248.28 Q27.1265 1243.68 27.1265 1234.95 Q27.1265 1226.75 31.0154 1221.89 Q34.9042 1217.01 41.4551 1217.01 Q43.2144 1217.01 44.9968 1217.36 Q46.8023 1217.7 48.7468 1218.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M-56.4379 858.878 L-26.7621 858.878 L-26.7621 862.813 L-56.4379 862.813 L-56.4379 858.878 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M-6.6696 844.225 Q-10.2807 844.225 -12.1094 847.79 Q-13.9149 851.332 -13.9149 858.461 Q-13.9149 865.568 -12.1094 869.133 Q-10.2807 872.674 -6.6696 872.674 Q-3.03536 872.674 -1.22982 869.133 Q0.598877 865.568 0.598877 858.461 Q0.598877 851.332 -1.22982 847.79 Q-3.03536 844.225 -6.6696 844.225 M-6.6696 840.522 Q-0.859448 840.522 2.19609 845.128 Q5.27478 849.711 5.27478 858.461 Q5.27478 867.188 2.19609 871.795 Q-0.859448 876.378 -6.6696 876.378 Q-12.4798 876.378 -15.5584 871.795 Q-18.614 867.188 -18.614 858.461 Q-18.614 849.711 -15.5584 845.128 Q-12.4798 840.522 -6.6696 840.522 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M13.4923 869.827 L18.3766 869.827 L18.3766 875.707 L13.4923 875.707 L13.4923 869.827 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M41.4088 845.221 L29.6034 863.67 L41.4088 863.67 L41.4088 845.221 M40.182 841.147 L46.0616 841.147 L46.0616 863.67 L50.9921 863.67 L50.9921 867.558 L46.0616 867.558 L46.0616 875.707 L41.4088 875.707 L41.4088 867.558 L25.8071 867.558 L25.8071 863.045 L40.182 841.147 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M-54.3545 482.391 L-24.6788 482.391 L-24.6788 486.326 L-54.3545 486.326 L-54.3545 482.391 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M-4.58628 467.738 Q-8.19737 467.738 -10.0261 471.303 Q-11.8316 474.844 -11.8316 481.974 Q-11.8316 489.08 -10.0261 492.645 Q-8.19737 496.187 -4.58628 496.187 Q-0.95204 496.187 0.853506 492.645 Q2.6822 489.08 2.6822 481.974 Q2.6822 474.844 0.853506 471.303 Q-0.95204 467.738 -4.58628 467.738 M-4.58628 464.034 Q1.22387 464.034 4.27941 468.641 Q7.3581 473.224 7.3581 481.974 Q7.3581 490.701 4.27941 495.307 Q1.22387 499.891 -4.58628 499.891 Q-10.3964 499.891 -13.4751 495.307 Q-16.5307 490.701 -16.5307 481.974 Q-16.5307 473.224 -13.4751 468.641 Q-10.3964 464.034 -4.58628 464.034 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M15.5756 493.34 L20.4599 493.34 L20.4599 499.219 L15.5756 499.219 L15.5756 493.34 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M34.6728 495.284 L50.9921 495.284 L50.9921 499.219 L29.0478 499.219 L29.0478 495.284 Q31.7098 492.53 36.2931 487.9 Q40.8996 483.247 42.0801 481.905 Q44.3255 479.381 45.2051 477.645 Q46.1079 475.886 46.1079 474.196 Q46.1079 471.442 44.1635 469.706 Q42.2422 467.969 39.1403 467.969 Q36.9413 467.969 34.4876 468.733 Q32.057 469.497 29.2793 471.048 L29.2793 466.326 Q32.1033 465.192 34.557 464.613 Q37.0107 464.034 39.0477 464.034 Q44.4181 464.034 47.6125 466.719 Q50.8069 469.405 50.8069 473.895 Q50.8069 476.025 49.9968 477.946 Q49.2097 479.844 47.1033 482.437 Q46.5246 483.108 43.4227 486.326 Q40.3209 489.52 34.6728 495.284 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M-6.18349 91.2507 Q-9.79459 91.2507 -11.6233 94.8155 Q-13.4288 98.3572 -13.4288 105.487 Q-13.4288 112.593 -11.6233 116.158 Q-9.79459 119.7 -6.18349 119.7 Q-2.54925 119.7 -0.743708 116.158 Q1.08499 112.593 1.08499 105.487 Q1.08499 98.3572 -0.743708 94.8155 Q-2.54925 91.2507 -6.18349 91.2507 M-6.18349 87.547 Q-0.37334 87.547 2.6822 92.1535 Q5.76089 96.7368 5.76089 105.487 Q5.76089 114.214 2.6822 118.82 Q-0.37334 123.403 -6.18349 123.403 Q-11.9936 123.403 -15.0723 118.82 Q-18.1279 114.214 -18.1279 105.487 Q-18.1279 96.7368 -15.0723 92.1535 Q-11.9936 87.547 -6.18349 87.547 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M13.9784 116.852 L18.8627 116.852 L18.8627 122.732 L13.9784 122.732 L13.9784 116.852 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip780)" d="M39.0477 91.2507 Q35.4367 91.2507 33.608 94.8155 Q31.8024 98.3572 31.8024 105.487 Q31.8024 112.593 33.608 116.158 Q35.4367 119.7 39.0477 119.7 Q42.682 119.7 44.4875 116.158 Q46.3162 112.593 46.3162 105.487 Q46.3162 98.3572 44.4875 94.8155 Q42.682 91.2507 39.0477 91.2507 M39.0477 87.547 Q44.8579 87.547 47.9134 92.1535 Q50.9921 96.7368 50.9921 105.487 Q50.9921 114.214 47.9134 118.82 Q44.8579 123.403 39.0477 123.403 Q33.2376 123.403 30.1589 118.82 Q27.1034 114.214 27.1034 105.487 Q27.1034 96.7368 30.1589 92.1535 Q33.2376 87.547 39.0477 87.547 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip782)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,105.452 162.518,105.599 238.043,142.282 313.569,136.082 389.094,194.906 464.619,407.419 540.145,443.339 615.67,533.334 691.196,587.595 766.721,614.867 
  842.247,629.899 917.772,954.694 993.298,1143.07 1068.82,1279.66 1144.35,1252.69 1219.87,1090.8 1295.4,1050.38 1370.92,949.904 1446.45,924.959 1521.98,1010.17 
  1597.5,1139.77 1673.03,1140.62 1748.55,1291.25 1824.08,1452.97 1899.6,1464 1975.13,1376.15 2050.65,1221.91 2126.18,1302.46 2201.7,1152.58 2277.23,999.095 
  2352.76,943.687 
  "/>
<polyline clip-path="url(#clip782)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,105.452 162.518,111.355 238.043,104.725 313.569,115.19 389.094,140.779 464.619,113.688 540.145,122.781 615.67,117.698 691.196,113.753 766.721,111.987 
  842.247,163.106 917.772,143.217 993.298,136.249 1068.82,110.566 1144.35,88.5087 1219.87,106.847 1295.4,96.8003 1370.92,108.218 1446.45,125.98 1521.98,133.982 
  1597.5,113.959 1673.03,138.546 1748.55,141.653 1824.08,118.186 1899.6,102.16 1975.13,90.7186 2050.65,127.681 2126.18,90.8374 2201.7,89.069 2277.23,103.676 
  2352.76,138.837 
  "/>
<path clip-path="url(#clip780)" d="
M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip780)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 
  "/>
<polyline clip-path="url(#clip780)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  187.693,1352.98 338.744,1352.98 
  "/>
<path clip-path="url(#clip780)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip780)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  187.693,1404.82 338.744,1404.82 
  "/>
<path clip-path="url(#clip780)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -0.3136  0.101323  -0.525028  -1.77319  …  0.715038  -0.0797014  -1.79237</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip840">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip840)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip841">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip840)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip842">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip840)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1488.23 2352.76,1488.23 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1266.9 2352.76,1266.9 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1045.58 2352.76,1045.58 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,824.252 2352.76,824.252 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,602.928 2352.76,602.928 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,381.603 2352.76,381.603 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,160.278 2352.76,160.278 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1488.23 105.89,1488.23 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1266.9 105.89,1266.9 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1045.58 105.89,1045.58 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,824.252 105.89,824.252 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,602.928 105.89,602.928 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,381.603 105.89,381.603 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,160.278 105.89,160.278 
  "/>
<path clip-path="url(#clip840)" d="M-9.72514 1488.68 L19.9506 1488.68 L19.9506 1492.61 L-9.72514 1492.61 L-9.72514 1488.68 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M30.0895 1470.95 L48.4458 1470.95 L48.4458 1474.88 L34.3718 1474.88 L34.3718 1483.35 Q35.3904 1483.01 36.4089 1482.84 Q37.4274 1482.66 38.4459 1482.66 Q44.2329 1482.66 47.6125 1485.83 Q50.9921 1489 50.9921 1494.42 Q50.9921 1500 47.5199 1503.1 Q44.0477 1506.18 37.7283 1506.18 Q35.5524 1506.18 33.2839 1505.81 Q31.0385 1505.44 28.6311 1504.7 L28.6311 1500 Q30.7145 1501.13 32.9367 1501.69 Q35.1589 1502.24 37.6357 1502.24 Q41.6403 1502.24 43.9783 1500.14 Q46.3162 1498.03 46.3162 1494.42 Q46.3162 1490.81 43.9783 1488.7 Q41.6403 1486.59 37.6357 1486.59 Q35.7607 1486.59 33.8857 1487.01 Q32.0339 1487.43 30.0895 1488.31 L30.0895 1470.95 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M39.0477 1252.7 Q35.4367 1252.7 33.608 1256.27 Q31.8024 1259.81 31.8024 1266.94 Q31.8024 1274.04 33.608 1277.61 Q35.4367 1281.15 39.0477 1281.15 Q42.682 1281.15 44.4875 1277.61 Q46.3162 1274.04 46.3162 1266.94 Q46.3162 1259.81 44.4875 1256.27 Q42.682 1252.7 39.0477 1252.7 M39.0477 1249 Q44.8579 1249 47.9134 1253.6 Q50.9921 1258.19 50.9921 1266.94 Q50.9921 1275.66 47.9134 1280.27 Q44.8579 1284.85 39.0477 1284.85 Q33.2376 1284.85 30.1589 1280.27 Q27.1034 1275.66 27.1034 1266.94 Q27.1034 1258.19 30.1589 1253.6 Q33.2376 1249 39.0477 1249 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M30.0895 1028.3 L48.4458 1028.3 L48.4458 1032.23 L34.3718 1032.23 L34.3718 1040.7 Q35.3904 1040.36 36.4089 1040.2 Q37.4274 1040.01 38.4459 1040.01 Q44.2329 1040.01 47.6125 1043.18 Q50.9921 1046.35 50.9921 1051.77 Q50.9921 1057.35 47.5199 1060.45 Q44.0477 1063.53 37.7283 1063.53 Q35.5524 1063.53 33.2839 1063.16 Q31.0385 1062.79 28.6311 1062.05 L28.6311 1057.35 Q30.7145 1058.48 32.9367 1059.04 Q35.1589 1059.59 37.6357 1059.59 Q41.6403 1059.59 43.9783 1057.49 Q46.3162 1055.38 46.3162 1051.77 Q46.3162 1048.16 43.9783 1046.05 Q41.6403 1043.95 37.6357 1043.95 Q35.7607 1043.95 33.8857 1044.36 Q32.0339 1044.78 30.0895 1045.66 L30.0895 1028.3 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-0.303895 837.597 L7.33495 837.597 L7.33495 811.232 L-0.975188 812.898 L-0.975188 808.639 L7.28866 806.972 L11.9646 806.972 L11.9646 837.597 L19.6034 837.597 L19.6034 841.532 L-0.303895 841.532 L-0.303895 837.597 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M39.0477 810.051 Q35.4367 810.051 33.608 813.616 Q31.8024 817.157 31.8024 824.287 Q31.8024 831.393 33.608 834.958 Q35.4367 838.5 39.0477 838.5 Q42.682 838.5 44.4875 834.958 Q46.3162 831.393 46.3162 824.287 Q46.3162 817.157 44.4875 813.616 Q42.682 810.051 39.0477 810.051 M39.0477 806.347 Q44.8579 806.347 47.9134 810.954 Q50.9921 815.537 50.9921 824.287 Q50.9921 833.014 47.9134 837.62 Q44.8579 842.204 39.0477 842.204 Q33.2376 842.204 30.1589 837.62 Q27.1034 833.014 27.1034 824.287 Q27.1034 815.537 30.1589 810.954 Q33.2376 806.347 39.0477 806.347 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M0.69147 616.272 L8.33032 616.272 L8.33032 589.907 L0.0201769 591.574 L0.0201769 587.314 L8.28402 585.648 L12.9599 585.648 L12.9599 616.272 L20.5988 616.272 L20.5988 620.208 L0.69147 620.208 L0.69147 616.272 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M30.0895 585.648 L48.4458 585.648 L48.4458 589.583 L34.3718 589.583 L34.3718 598.055 Q35.3904 597.708 36.4089 597.546 Q37.4274 597.361 38.4459 597.361 Q44.2329 597.361 47.6125 600.532 Q50.9921 603.703 50.9921 609.12 Q50.9921 614.698 47.5199 617.8 Q44.0477 620.879 37.7283 620.879 Q35.5524 620.879 33.2839 620.509 Q31.0385 620.138 28.6311 619.397 L28.6311 614.698 Q30.7145 615.833 32.9367 616.388 Q35.1589 616.944 37.6357 616.944 Q41.6403 616.944 43.9783 614.837 Q46.3162 612.731 46.3162 609.12 Q46.3162 605.509 43.9783 603.402 Q41.6403 601.296 37.6357 601.296 Q35.7607 601.296 33.8857 601.712 Q32.0339 602.129 30.0895 603.009 L30.0895 585.648 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M2.91368 394.948 L19.233 394.948 L19.233 398.883 L-2.71129 398.883 L-2.71129 394.948 Q-0.0492672 392.193 4.53404 387.564 Q9.1405 382.911 10.321 381.568 Q12.5664 379.045 13.446 377.309 Q14.3488 375.55 14.3488 373.86 Q14.3488 371.105 12.4044 369.369 Q10.4831 367.633 7.38125 367.633 Q5.18219 367.633 2.7285 368.397 Q0.297953 369.161 -2.47981 370.712 L-2.47981 365.99 Q0.344249 364.855 2.79794 364.277 Q5.25163 363.698 7.28866 363.698 Q12.659 363.698 15.8534 366.383 Q19.0479 369.068 19.0479 373.559 Q19.0479 375.689 18.2377 377.61 Q17.4506 379.508 15.3442 382.101 Q14.7655 382.772 11.6636 385.989 Q8.5618 389.184 2.91368 394.948 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M39.0477 367.402 Q35.4367 367.402 33.608 370.966 Q31.8024 374.508 31.8024 381.638 Q31.8024 388.744 33.608 392.309 Q35.4367 395.851 39.0477 395.851 Q42.682 395.851 44.4875 392.309 Q46.3162 388.744 46.3162 381.638 Q46.3162 374.508 44.4875 370.966 Q42.682 367.402 39.0477 367.402 M39.0477 363.698 Q44.8579 363.698 47.9134 368.304 Q50.9921 372.888 50.9921 381.638 Q50.9921 390.364 47.9134 394.971 Q44.8579 399.554 39.0477 399.554 Q33.2376 399.554 30.1589 394.971 Q27.1034 390.364 27.1034 381.638 Q27.1034 372.888 30.1589 368.304 Q33.2376 363.698 39.0477 363.698 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M3.90904 173.623 L20.2284 173.623 L20.2284 177.558 L-1.71592 177.558 L-1.71592 173.623 Q0.946098 170.868 5.52941 166.239 Q10.1359 161.586 11.3164 160.244 Q13.5618 157.72 14.4414 155.984 Q15.3442 154.225 15.3442 152.535 Q15.3442 149.781 13.3997 148.045 Q11.4784 146.308 8.37661 146.308 Q6.17755 146.308 3.72386 147.072 Q1.29332 147.836 -1.48444 149.387 L-1.48444 144.665 Q1.33961 143.531 3.7933 142.952 Q6.247 142.373 8.28402 142.373 Q13.6544 142.373 16.8488 145.058 Q20.0432 147.744 20.0432 152.234 Q20.0432 154.364 19.233 156.285 Q18.446 158.183 16.3395 160.776 Q15.7608 161.447 12.659 164.665 Q9.55716 167.859 3.90904 173.623 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M30.0895 142.998 L48.4458 142.998 L48.4458 146.933 L34.3718 146.933 L34.3718 155.406 Q35.3904 155.058 36.4089 154.896 Q37.4274 154.711 38.4459 154.711 Q44.2329 154.711 47.6125 157.882 Q50.9921 161.054 50.9921 166.47 Q50.9921 172.049 47.5199 175.151 Q44.0477 178.23 37.7283 178.23 Q35.5524 178.23 33.2839 177.859 Q31.0385 177.489 28.6311 176.748 L28.6311 172.049 Q30.7145 173.183 32.9367 173.739 Q35.1589 174.294 37.6357 174.294 Q41.6403 174.294 43.9783 172.188 Q46.3162 170.081 46.3162 166.47 Q46.3162 162.859 43.9783 160.753 Q41.6403 158.646 37.6357 158.646 Q35.7607 158.646 33.8857 159.063 Q32.0339 159.48 30.0895 160.359 L30.0895 142.998 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip842)" d="
M151.118 1346.64 L222.368 1435.62 L293.618 1479.3 L364.869 1477.21 L436.119 1474.25 L507.37 1463.88 L578.62 1455.95 L649.871 1450.66 L721.121 1444.2 L792.371 1431.93 
  L863.622 1420.64 L934.872 1412.09 L1006.12 1404.97 L1077.37 1397.44 L1148.62 1392.27 L1219.87 1388.96 L1291.12 1385.98 L1362.37 1382.58 L1433.63 1379.45 L1504.88 1372.86 
  L1576.13 1365.54 L1647.38 1360.95 L1718.63 1355.24 L1789.88 1349.26 L1861.13 1341.74 L1932.38 1337.49 L2003.63 1333.74 L2074.88 1328.78 L2146.13 1329.83 L2217.38 1328.35 
  L2288.63 1326.64 L2288.63 981.575 L2217.38 966.119 L2146.13 950.656 L2074.88 933.344 L2003.63 914.59 L1932.38 897.403 L1861.13 878.879 L1789.88 858.42 L1718.63 840.513 
  L1647.38 818.054 L1576.13 796.31 L1504.88 770.079 L1433.63 748.428 L1362.37 718.246 L1291.12 687.964 L1219.87 652.891 L1148.62 620.176 L1077.37 585.259 L1006.12 549.983 
  L934.872 510.644 L863.622 471.369 L792.371 428.268 L721.121 384.439 L649.871 337.449 L578.62 291 L507.37 237.309 L436.119 178.92 L364.869 125.694 L293.618 88.9544 
  L222.368 179.795 L151.118 1190  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip842)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1252.93 222.368,1235.6 293.618,1251.4 364.869,1248.58 436.119,1246.59 507.37,1247.23 578.62,1249.62 649.871,1251.6 721.121,1253.56 792.371,1256.43 
  863.622,1258.7 934.872,1261.24 1006.12,1262.53 1077.37,1259.38 1148.62,1258.87 1219.87,1257.86 1291.12,1259.94 1362.37,1260.47 1433.63,1257.98 1504.88,1258.92 
  1576.13,1259.74 1647.38,1262.89 1718.63,1265.3 1789.88,1268.06 1861.13,1270.19 1932.38,1269.84 2003.63,1267.47 2074.88,1268.22 2146.13,1268.49 2217.38,1269.33 
  2288.63,1269.63 
  "/>
<path clip-path="url(#clip842)" d="
M151.118 1334.2 L222.368 1280.4 L293.618 1269.04 L364.869 1268.03 L436.119 1267.61 L507.37 1267.42 L578.62 1267.49 L649.871 1267.52 L721.121 1267.71 L792.371 1267.63 
  L863.622 1267.58 L934.872 1267.71 L1006.12 1267.61 L1077.37 1267.36 L1148.62 1267.57 L1219.87 1267.6 L1291.12 1267.46 L1362.37 1267.77 L1433.63 1267.71 L1504.88 1267.63 
  L1576.13 1267.89 L1647.38 1267.5 L1718.63 1267.67 L1789.88 1267.56 L1861.13 1267.68 L1932.38 1267.53 L2003.63 1267.56 L2074.88 1267.72 L2146.13 1267.65 L2217.38 1267.56 
  L2288.63 1267.63 L2288.63 1266.22 L2217.38 1266.36 L2146.13 1266.29 L2074.88 1266.16 L2003.63 1266.35 L1932.38 1266.11 L1861.13 1266.28 L1789.88 1266.1 L1718.63 1266.07 
  L1647.38 1266.28 L1576.13 1266.28 L1504.88 1266.28 L1433.63 1266.22 L1362.37 1266.1 L1291.12 1266.46 L1219.87 1266.11 L1148.62 1266.17 L1077.37 1266.09 L1006.12 1266.09 
  L934.872 1266.49 L863.622 1266.18 L792.371 1266.18 L721.121 1266.08 L649.871 1266.27 L578.62 1266.32 L507.37 1266.4 L436.119 1266.3 L364.869 1265.99 L293.618 1263.51 
  L222.368 1249.21 L151.118 1179.77  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip842)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1268.29 222.368,1267.24 293.618,1266.74 364.869,1266.93 436.119,1267.02 507.37,1266.96 578.62,1266.87 649.871,1266.88 721.121,1266.99 792.371,1266.98 
  863.622,1266.95 934.872,1266.95 1006.12,1266.79 1077.37,1266.75 1148.62,1266.91 1219.87,1266.95 1291.12,1266.96 1362.37,1266.92 1433.63,1266.93 1504.88,1266.98 
  1576.13,1266.84 1647.38,1266.79 1718.63,1266.89 1789.88,1266.87 1861.13,1266.87 1932.38,1266.89 2003.63,1266.94 2074.88,1267.07 2146.13,1267.01 2217.38,1266.86 
  2288.63,1266.85 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">56.97617550385838</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-1116.6070037576992, -8341.974767017608], [400.43817505918514 7.328617490273192; 2832.363324526055 56.193777429273425], [-205.1743093157187 -2.3979035736995598; -1453.4327881669658 -18.61960447101748;;; -2.3979035736995598 -0.14085676895468707; -18.61960447101748 -1.0710276375201608], [654.0573469386411; 4460.607511273656;;], [-37.41742772631353, -84.95949424277462], [22.8794755781021 0.3174481769004201; 42.979555937674704 1.0239969179633976], [-14.126953708505292 -0.2020767625497337; -22.644632770536862 -0.5137918743397161;;; -0.2020767625497337 0.00017181257270223018; -0.5137918743397161 -0.01670855493430054], [-3.091880071075222 -3.977043669670576 … -0.7120921787035855 -0.08844609288665314])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 5 January 2023 04:03">Thursday 5 January 2023</span>. Using Julia version 1.8.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
