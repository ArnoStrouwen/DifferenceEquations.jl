<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.012580471508188133]
 [0.0783415591029975, -0.008533193620555136]
 [0.021622194165430538, -0.0038005483118693844]
 [-0.003060886934335583, -0.0058911586361657595]
 [-0.03940132135796508, -0.005212185066617085]
 [-0.06972638713239086, -0.01681791151570959]
 [-0.16962586669525906, -0.015389117670203472]
 [-0.2557229298089552, -0.0013612201333772953]
 [-0.25143843876073635, -1.7177722943672214e-6]
 ⋮
 [-0.006443096487537386, -0.004085812396672824]
 [-0.03147680793661032, -0.004333899947499368]
 [-0.05678322810670872, 0.0005864164857131001]
 [-0.05038843131566806, 0.011183283706503597]
 [0.02174100964691766, -0.007121208412823823]
 [-0.023426941985693717, 0.008835610113374989]
 [0.032676294086544516, -0.021969938574611922]
 [-0.10378545001621053, -0.024454469133538357]
 [-0.24824750663934136, -0.0010857216322363071]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip120">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip120)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip121">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip120)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip122">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip120)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1440.43 2352.76,1440.43 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1234.56 2352.76,1234.56 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1028.69 2352.76,1028.69 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,822.817 2352.76,822.817 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,616.946 2352.76,616.946 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,411.074 2352.76,411.074 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,205.203 2352.76,205.203 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1440.43 105.89,1440.43 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1234.56 105.89,1234.56 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1028.69 105.89,1028.69 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,822.817 105.89,822.817 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,616.946 105.89,616.946 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,411.074 105.89,411.074 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,205.203 105.89,205.203 
  "/>
<path clip-path="url(#clip120)" d="M-85.1183 1440.88 L-55.4425 1440.88 L-55.4425 1444.82 L-85.1183 1444.82 L-85.1183 1440.88 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-35.35 1426.23 Q-38.9611 1426.23 -40.7898 1429.79 Q-42.5953 1433.34 -42.5953 1440.47 Q-42.5953 1447.57 -40.7898 1451.14 Q-38.9611 1454.68 -35.35 1454.68 Q-31.7158 1454.68 -29.9102 1451.14 Q-28.0815 1447.57 -28.0815 1440.47 Q-28.0815 1433.34 -29.9102 1429.79 Q-31.7158 1426.23 -35.35 1426.23 M-35.35 1422.53 Q-29.5398 1422.53 -26.4843 1427.13 Q-23.4056 1431.72 -23.4056 1440.47 Q-23.4056 1449.19 -26.4843 1453.8 Q-29.5398 1458.38 -35.35 1458.38 Q-41.1602 1458.38 -44.2388 1453.8 Q-47.2944 1449.19 -47.2944 1440.47 Q-47.2944 1431.72 -44.2388 1427.13 Q-41.1602 1422.53 -35.35 1422.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-15.1881 1451.83 L-10.3038 1451.83 L-10.3038 1457.71 L-15.1881 1457.71 L-15.1881 1451.83 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M3.90904 1453.78 L20.2284 1453.78 L20.2284 1457.71 L-1.71592 1457.71 L-1.71592 1453.78 Q0.946098 1451.02 5.52941 1446.39 Q10.1359 1441.74 11.3164 1440.4 Q13.5618 1437.87 14.4414 1436.14 Q15.3442 1434.38 15.3442 1432.69 Q15.3442 1429.93 13.3997 1428.2 Q11.4784 1426.46 8.37661 1426.46 Q6.17755 1426.46 3.72386 1427.23 Q1.29332 1427.99 -1.48444 1429.54 L-1.48444 1424.82 Q1.33961 1423.68 3.7933 1423.11 Q6.247 1422.53 8.28402 1422.53 Q13.6544 1422.53 16.8488 1425.21 Q20.0432 1427.9 20.0432 1432.39 Q20.0432 1434.52 19.233 1436.44 Q18.446 1438.34 16.3395 1440.93 Q15.7608 1441.6 12.659 1444.82 Q9.55716 1448.01 3.90904 1453.78 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M30.0895 1423.15 L48.4458 1423.15 L48.4458 1427.09 L34.3718 1427.09 L34.3718 1435.56 Q35.3904 1435.21 36.4089 1435.05 Q37.4274 1434.86 38.4459 1434.86 Q44.2329 1434.86 47.6125 1438.04 Q50.9921 1441.21 50.9921 1446.62 Q50.9921 1452.2 47.5199 1455.3 Q44.0477 1458.38 37.7283 1458.38 Q35.5524 1458.38 33.2839 1458.01 Q31.0385 1457.64 28.6311 1456.9 L28.6311 1452.2 Q30.7145 1453.34 32.9367 1453.89 Q35.1589 1454.45 37.6357 1454.45 Q41.6403 1454.45 43.9783 1452.34 Q46.3162 1450.23 46.3162 1446.62 Q46.3162 1443.01 43.9783 1440.91 Q41.6403 1438.8 37.6357 1438.8 Q35.7607 1438.8 33.8857 1439.22 Q32.0339 1439.63 30.0895 1440.51 L30.0895 1423.15 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-86.1136 1235.01 L-56.4379 1235.01 L-56.4379 1238.95 L-86.1136 1238.95 L-86.1136 1235.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-36.3454 1220.36 Q-39.9565 1220.36 -41.7852 1223.92 Q-43.5907 1227.47 -43.5907 1234.59 Q-43.5907 1241.7 -41.7852 1245.27 Q-39.9565 1248.81 -36.3454 1248.81 Q-32.7111 1248.81 -30.9056 1245.27 Q-29.0769 1241.7 -29.0769 1234.59 Q-29.0769 1227.47 -30.9056 1223.92 Q-32.7111 1220.36 -36.3454 1220.36 M-36.3454 1216.66 Q-30.5352 1216.66 -27.4797 1221.26 Q-24.401 1225.84 -24.401 1234.59 Q-24.401 1243.32 -27.4797 1247.93 Q-30.5352 1252.51 -36.3454 1252.51 Q-42.1555 1252.51 -45.2342 1247.93 Q-48.2897 1243.32 -48.2897 1234.59 Q-48.2897 1225.84 -45.2342 1221.26 Q-42.1555 1216.66 -36.3454 1216.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-16.1834 1245.96 L-11.2992 1245.96 L-11.2992 1251.84 L-16.1834 1251.84 L-16.1834 1245.96 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M2.91368 1247.9 L19.233 1247.9 L19.233 1251.84 L-2.71129 1251.84 L-2.71129 1247.9 Q-0.0492672 1245.15 4.53404 1240.52 Q9.1405 1235.87 10.321 1234.53 Q12.5664 1232 13.446 1230.27 Q14.3488 1228.51 14.3488 1226.82 Q14.3488 1224.06 12.4044 1222.33 Q10.4831 1220.59 7.38125 1220.59 Q5.18219 1220.59 2.7285 1221.35 Q0.297953 1222.12 -2.47981 1223.67 L-2.47981 1218.95 Q0.344249 1217.81 2.79794 1217.23 Q5.25163 1216.66 7.28866 1216.66 Q12.659 1216.66 15.8534 1219.34 Q19.0479 1222.03 19.0479 1226.52 Q19.0479 1228.65 18.2377 1230.57 Q17.4506 1232.47 15.3442 1235.06 Q14.7655 1235.73 11.6636 1238.95 Q8.5618 1242.14 2.91368 1247.9 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M39.0477 1220.36 Q35.4367 1220.36 33.608 1223.92 Q31.8024 1227.47 31.8024 1234.59 Q31.8024 1241.7 33.608 1245.27 Q35.4367 1248.81 39.0477 1248.81 Q42.682 1248.81 44.4875 1245.27 Q46.3162 1241.7 46.3162 1234.59 Q46.3162 1227.47 44.4875 1223.92 Q42.682 1220.36 39.0477 1220.36 M39.0477 1216.66 Q44.8579 1216.66 47.9134 1221.26 Q50.9921 1225.84 50.9921 1234.59 Q50.9921 1243.32 47.9134 1247.93 Q44.8579 1252.51 39.0477 1252.51 Q33.2376 1252.51 30.1589 1247.93 Q27.1034 1243.32 27.1034 1234.59 Q27.1034 1225.84 30.1589 1221.26 Q33.2376 1216.66 39.0477 1216.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-85.1183 1029.14 L-55.4425 1029.14 L-55.4425 1033.08 L-85.1183 1033.08 L-85.1183 1029.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-35.35 1014.49 Q-38.9611 1014.49 -40.7898 1018.05 Q-42.5953 1021.59 -42.5953 1028.72 Q-42.5953 1035.83 -40.7898 1039.39 Q-38.9611 1042.94 -35.35 1042.94 Q-31.7158 1042.94 -29.9102 1039.39 Q-28.0815 1035.83 -28.0815 1028.72 Q-28.0815 1021.59 -29.9102 1018.05 Q-31.7158 1014.49 -35.35 1014.49 M-35.35 1010.78 Q-29.5398 1010.78 -26.4843 1015.39 Q-23.4056 1019.97 -23.4056 1028.72 Q-23.4056 1037.45 -26.4843 1042.06 Q-29.5398 1046.64 -35.35 1046.64 Q-41.1602 1046.64 -44.2388 1042.06 Q-47.2944 1037.45 -47.2944 1028.72 Q-47.2944 1019.97 -44.2388 1015.39 Q-41.1602 1010.78 -35.35 1010.78 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-15.1881 1040.09 L-10.3038 1040.09 L-10.3038 1045.97 L-15.1881 1045.97 L-15.1881 1040.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M0.69147 1042.03 L8.33032 1042.03 L8.33032 1015.67 L0.0201769 1017.33 L0.0201769 1013.08 L8.28402 1011.41 L12.9599 1011.41 L12.9599 1042.03 L20.5988 1042.03 L20.5988 1045.97 L0.69147 1045.97 L0.69147 1042.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M30.0895 1011.41 L48.4458 1011.41 L48.4458 1015.34 L34.3718 1015.34 L34.3718 1023.82 Q35.3904 1023.47 36.4089 1023.31 Q37.4274 1023.12 38.4459 1023.12 Q44.2329 1023.12 47.6125 1026.29 Q50.9921 1029.46 50.9921 1034.88 Q50.9921 1040.46 47.5199 1043.56 Q44.0477 1046.64 37.7283 1046.64 Q35.5524 1046.64 33.2839 1046.27 Q31.0385 1045.9 28.6311 1045.16 L28.6311 1040.46 Q30.7145 1041.59 32.9367 1042.15 Q35.1589 1042.7 37.6357 1042.7 Q41.6403 1042.7 43.9783 1040.6 Q46.3162 1038.49 46.3162 1034.88 Q46.3162 1031.27 43.9783 1029.16 Q41.6403 1027.06 37.6357 1027.06 Q35.7607 1027.06 33.8857 1027.47 Q32.0339 1027.89 30.0895 1028.77 L30.0895 1011.41 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-86.1136 823.269 L-56.4379 823.269 L-56.4379 827.204 L-86.1136 827.204 L-86.1136 823.269 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-36.3454 808.616 Q-39.9565 808.616 -41.7852 812.181 Q-43.5907 815.722 -43.5907 822.852 Q-43.5907 829.958 -41.7852 833.523 Q-39.9565 837.065 -36.3454 837.065 Q-32.7111 837.065 -30.9056 833.523 Q-29.0769 829.958 -29.0769 822.852 Q-29.0769 815.722 -30.9056 812.181 Q-32.7111 808.616 -36.3454 808.616 M-36.3454 804.912 Q-30.5352 804.912 -27.4797 809.519 Q-24.401 814.102 -24.401 822.852 Q-24.401 831.579 -27.4797 836.185 Q-30.5352 840.769 -36.3454 840.769 Q-42.1555 840.769 -45.2342 836.185 Q-48.2897 831.579 -48.2897 822.852 Q-48.2897 814.102 -45.2342 809.519 Q-42.1555 804.912 -36.3454 804.912 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-16.1834 834.218 L-11.2992 834.218 L-11.2992 840.097 L-16.1834 840.097 L-16.1834 834.218 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-0.303895 836.162 L7.33495 836.162 L7.33495 809.796 L-0.975188 811.463 L-0.975188 807.204 L7.28866 805.537 L11.9646 805.537 L11.9646 836.162 L19.6034 836.162 L19.6034 840.097 L-0.303895 840.097 L-0.303895 836.162 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M39.0477 808.616 Q35.4367 808.616 33.608 812.181 Q31.8024 815.722 31.8024 822.852 Q31.8024 829.958 33.608 833.523 Q35.4367 837.065 39.0477 837.065 Q42.682 837.065 44.4875 833.523 Q46.3162 829.958 46.3162 822.852 Q46.3162 815.722 44.4875 812.181 Q42.682 808.616 39.0477 808.616 M39.0477 804.912 Q44.8579 804.912 47.9134 809.519 Q50.9921 814.102 50.9921 822.852 Q50.9921 831.579 47.9134 836.185 Q44.8579 840.769 39.0477 840.769 Q33.2376 840.769 30.1589 836.185 Q27.1034 831.579 27.1034 822.852 Q27.1034 814.102 30.1589 809.519 Q33.2376 804.912 39.0477 804.912 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-85.1183 617.397 L-55.4425 617.397 L-55.4425 621.332 L-85.1183 621.332 L-85.1183 617.397 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-35.35 602.745 Q-38.9611 602.745 -40.7898 606.309 Q-42.5953 609.851 -42.5953 616.981 Q-42.5953 624.087 -40.7898 627.652 Q-38.9611 631.193 -35.35 631.193 Q-31.7158 631.193 -29.9102 627.652 Q-28.0815 624.087 -28.0815 616.981 Q-28.0815 609.851 -29.9102 606.309 Q-31.7158 602.745 -35.35 602.745 M-35.35 599.041 Q-29.5398 599.041 -26.4843 603.647 Q-23.4056 608.231 -23.4056 616.981 Q-23.4056 625.707 -26.4843 630.314 Q-29.5398 634.897 -35.35 634.897 Q-41.1602 634.897 -44.2388 630.314 Q-47.2944 625.707 -47.2944 616.981 Q-47.2944 608.231 -44.2388 603.647 Q-41.1602 599.041 -35.35 599.041 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-15.1881 628.346 L-10.3038 628.346 L-10.3038 634.226 L-15.1881 634.226 L-15.1881 628.346 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M9.88124 602.745 Q6.27014 602.745 4.44145 606.309 Q2.6359 609.851 2.6359 616.981 Q2.6359 624.087 4.44145 627.652 Q6.27014 631.193 9.88124 631.193 Q13.5155 631.193 15.321 627.652 Q17.1497 624.087 17.1497 616.981 Q17.1497 609.851 15.321 606.309 Q13.5155 602.745 9.88124 602.745 M9.88124 599.041 Q15.6914 599.041 18.7469 603.647 Q21.8256 608.231 21.8256 616.981 Q21.8256 625.707 18.7469 630.314 Q15.6914 634.897 9.88124 634.897 Q4.07108 634.897 0.992394 630.314 Q-2.06315 625.707 -2.06315 616.981 Q-2.06315 608.231 0.992394 603.647 Q4.07108 599.041 9.88124 599.041 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M30.0895 599.666 L48.4458 599.666 L48.4458 603.601 L34.3718 603.601 L34.3718 612.073 Q35.3904 611.726 36.4089 611.564 Q37.4274 611.379 38.4459 611.379 Q44.2329 611.379 47.6125 614.55 Q50.9921 617.721 50.9921 623.138 Q50.9921 628.717 47.5199 631.818 Q44.0477 634.897 37.7283 634.897 Q35.5524 634.897 33.2839 634.527 Q31.0385 634.156 28.6311 633.416 L28.6311 628.717 Q30.7145 629.851 32.9367 630.406 Q35.1589 630.962 37.6357 630.962 Q41.6403 630.962 43.9783 628.856 Q46.3162 626.749 46.3162 623.138 Q46.3162 619.527 43.9783 617.42 Q41.6403 615.314 37.6357 615.314 Q35.7607 615.314 33.8857 615.731 Q32.0339 616.147 30.0895 617.027 L30.0895 599.666 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-36.3454 396.873 Q-39.9565 396.873 -41.7852 400.438 Q-43.5907 403.98 -43.5907 411.109 Q-43.5907 418.216 -41.7852 421.78 Q-39.9565 425.322 -36.3454 425.322 Q-32.7111 425.322 -30.9056 421.78 Q-29.0769 418.216 -29.0769 411.109 Q-29.0769 403.98 -30.9056 400.438 Q-32.7111 396.873 -36.3454 396.873 M-36.3454 393.169 Q-30.5352 393.169 -27.4797 397.776 Q-24.401 402.359 -24.401 411.109 Q-24.401 419.836 -27.4797 424.442 Q-30.5352 429.026 -36.3454 429.026 Q-42.1555 429.026 -45.2342 424.442 Q-48.2897 419.836 -48.2897 411.109 Q-48.2897 402.359 -45.2342 397.776 Q-42.1555 393.169 -36.3454 393.169 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-16.1834 422.475 L-11.2992 422.475 L-11.2992 428.354 L-16.1834 428.354 L-16.1834 422.475 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M8.88587 396.873 Q5.27478 396.873 3.44608 400.438 Q1.64054 403.98 1.64054 411.109 Q1.64054 418.216 3.44608 421.78 Q5.27478 425.322 8.88587 425.322 Q12.5201 425.322 14.3257 421.78 Q16.1543 418.216 16.1543 411.109 Q16.1543 403.98 14.3257 400.438 Q12.5201 396.873 8.88587 396.873 M8.88587 393.169 Q14.696 393.169 17.7516 397.776 Q20.8303 402.359 20.8303 411.109 Q20.8303 419.836 17.7516 424.442 Q14.696 429.026 8.88587 429.026 Q3.07572 429.026 -0.00297114 424.442 Q-3.05851 419.836 -3.05851 411.109 Q-3.05851 402.359 -0.00297114 397.776 Q3.07572 393.169 8.88587 393.169 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M39.0477 396.873 Q35.4367 396.873 33.608 400.438 Q31.8024 403.98 31.8024 411.109 Q31.8024 418.216 33.608 421.78 Q35.4367 425.322 39.0477 425.322 Q42.682 425.322 44.4875 421.78 Q46.3162 418.216 46.3162 411.109 Q46.3162 403.98 44.4875 400.438 Q42.682 396.873 39.0477 396.873 M39.0477 393.169 Q44.8579 393.169 47.9134 397.776 Q50.9921 402.359 50.9921 411.109 Q50.9921 419.836 47.9134 424.442 Q44.8579 429.026 39.0477 429.026 Q33.2376 429.026 30.1589 424.442 Q27.1034 419.836 27.1034 411.109 Q27.1034 402.359 30.1589 397.776 Q33.2376 393.169 39.0477 393.169 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-35.35 191.002 Q-38.9611 191.002 -40.7898 194.567 Q-42.5953 198.108 -42.5953 205.238 Q-42.5953 212.344 -40.7898 215.909 Q-38.9611 219.451 -35.35 219.451 Q-31.7158 219.451 -29.9102 215.909 Q-28.0815 212.344 -28.0815 205.238 Q-28.0815 198.108 -29.9102 194.567 Q-31.7158 191.002 -35.35 191.002 M-35.35 187.298 Q-29.5398 187.298 -26.4843 191.904 Q-23.4056 196.488 -23.4056 205.238 Q-23.4056 213.965 -26.4843 218.571 Q-29.5398 223.154 -35.35 223.154 Q-41.1602 223.154 -44.2388 218.571 Q-47.2944 213.965 -47.2944 205.238 Q-47.2944 196.488 -44.2388 191.904 Q-41.1602 187.298 -35.35 187.298 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-15.1881 216.603 L-10.3038 216.603 L-10.3038 222.483 L-15.1881 222.483 L-15.1881 216.603 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M9.88124 191.002 Q6.27014 191.002 4.44145 194.567 Q2.6359 198.108 2.6359 205.238 Q2.6359 212.344 4.44145 215.909 Q6.27014 219.451 9.88124 219.451 Q13.5155 219.451 15.321 215.909 Q17.1497 212.344 17.1497 205.238 Q17.1497 198.108 15.321 194.567 Q13.5155 191.002 9.88124 191.002 M9.88124 187.298 Q15.6914 187.298 18.7469 191.904 Q21.8256 196.488 21.8256 205.238 Q21.8256 213.965 18.7469 218.571 Q15.6914 223.154 9.88124 223.154 Q4.07108 223.154 0.992394 218.571 Q-2.06315 213.965 -2.06315 205.238 Q-2.06315 196.488 0.992394 191.904 Q4.07108 187.298 9.88124 187.298 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip120)" d="M30.0895 187.923 L48.4458 187.923 L48.4458 191.858 L34.3718 191.858 L34.3718 200.33 Q35.3904 199.983 36.4089 199.821 Q37.4274 199.636 38.4459 199.636 Q44.2329 199.636 47.6125 202.807 Q50.9921 205.978 50.9921 211.395 Q50.9921 216.974 47.5199 220.076 Q44.0477 223.154 37.7283 223.154 Q35.5524 223.154 33.2839 222.784 Q31.0385 222.414 28.6311 221.673 L28.6311 216.974 Q30.7145 218.108 32.9367 218.664 Q35.1589 219.219 37.6357 219.219 Q41.6403 219.219 43.9783 217.113 Q46.3162 215.006 46.3162 211.395 Q46.3162 207.784 43.9783 205.678 Q41.6403 203.571 37.6357 203.571 Q35.7607 203.571 33.8857 203.988 Q32.0339 204.404 30.0895 205.284 L30.0895 187.923 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip122)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,411.074 162.518,411.397 238.043,88.5087 313.569,322.047 389.094,423.677 464.619,573.307 540.145,698.168 615.67,1109.5 691.196,1464 766.721,1446.35 
  842.247,1395.01 917.772,1383.21 993.298,1394.15 1068.82,1371.08 1144.35,1339.35 1219.87,1053.71 1295.4,492.766 1370.92,289.623 1446.45,523.801 1521.98,496.422 
  1597.5,365.246 1673.03,444.279 1748.55,437.603 1824.08,540.678 1899.6,644.875 1975.13,618.545 2050.65,321.557 2126.18,507.533 2201.7,276.532 2277.23,838.404 
  2352.76,1433.22 
  "/>
<polyline clip-path="url(#clip122)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,411.074 162.518,359.275 238.043,446.209 313.569,426.723 389.094,435.331 464.619,432.535 540.145,480.321 615.67,474.438 691.196,416.679 766.721,411.082 
  842.247,417.066 917.772,420.656 993.298,415.235 1068.82,413.647 1144.35,372.518 1219.87,326.459 1295.4,379.034 1370.92,447.969 1446.45,407.516 1521.98,390.6 
  1597.5,423.418 1673.03,410.214 1748.55,427.897 1824.08,428.919 1899.6,408.66 1975.13,365.028 2050.65,440.396 2126.18,374.694 2201.7,501.534 2277.23,511.764 
  2352.76,415.545 
  "/>
<path clip-path="url(#clip120)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip120)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip120)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip120)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip120)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 1.25805  -1.10493  -0.209391  -0.513105  …  -2.37371  -2.00605  0.380517</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip180">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip180)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip181">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip180)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip182">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip180)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1222.53 2352.76,1222.53 
  "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,909.171 2352.76,909.171 
  "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,595.816 2352.76,595.816 
  "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,282.461 2352.76,282.461 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1222.53 105.89,1222.53 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,909.171 105.89,909.171 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,595.816 105.89,595.816 
  "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,282.461 105.89,282.461 
  "/>
<path clip-path="url(#clip180)" d="M39.0477 1208.32 Q35.4367 1208.32 33.608 1211.89 Q31.8024 1215.43 31.8024 1222.56 Q31.8024 1229.67 33.608 1233.23 Q35.4367 1236.77 39.0477 1236.77 Q42.682 1236.77 44.4875 1233.23 Q46.3162 1229.67 46.3162 1222.56 Q46.3162 1215.43 44.4875 1211.89 Q42.682 1208.32 39.0477 1208.32 M39.0477 1204.62 Q44.8579 1204.62 47.9134 1209.23 Q50.9921 1213.81 50.9921 1222.56 Q50.9921 1231.29 47.9134 1235.89 Q44.8579 1240.48 39.0477 1240.48 Q33.2376 1240.48 30.1589 1235.89 Q27.1034 1231.29 27.1034 1222.56 Q27.1034 1213.81 30.1589 1209.23 Q33.2376 1204.62 39.0477 1204.62 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M30.0895 891.891 L48.4458 891.891 L48.4458 895.826 L34.3718 895.826 L34.3718 904.298 Q35.3904 903.951 36.4089 903.789 Q37.4274 903.603 38.4459 903.603 Q44.2329 903.603 47.6125 906.775 Q50.9921 909.946 50.9921 915.363 Q50.9921 920.941 47.5199 924.043 Q44.0477 927.122 37.7283 927.122 Q35.5524 927.122 33.2839 926.751 Q31.0385 926.381 28.6311 925.64 L28.6311 920.941 Q30.7145 922.076 32.9367 922.631 Q35.1589 923.187 37.6357 923.187 Q41.6403 923.187 43.9783 921.08 Q46.3162 918.974 46.3162 915.363 Q46.3162 911.752 43.9783 909.645 Q41.6403 907.539 37.6357 907.539 Q35.7607 907.539 33.8857 907.955 Q32.0339 908.372 30.0895 909.252 L30.0895 891.891 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M-0.303895 609.161 L7.33495 609.161 L7.33495 582.795 L-0.975188 584.462 L-0.975188 580.202 L7.28866 578.536 L11.9646 578.536 L11.9646 609.161 L19.6034 609.161 L19.6034 613.096 L-0.303895 613.096 L-0.303895 609.161 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M39.0477 581.614 Q35.4367 581.614 33.608 585.179 Q31.8024 588.721 31.8024 595.85 Q31.8024 602.957 33.608 606.522 Q35.4367 610.063 39.0477 610.063 Q42.682 610.063 44.4875 606.522 Q46.3162 602.957 46.3162 595.85 Q46.3162 588.721 44.4875 585.179 Q42.682 581.614 39.0477 581.614 M39.0477 577.911 Q44.8579 577.911 47.9134 582.517 Q50.9921 587.1 50.9921 595.85 Q50.9921 604.577 47.9134 609.184 Q44.8579 613.767 39.0477 613.767 Q33.2376 613.767 30.1589 609.184 Q27.1034 604.577 27.1034 595.85 Q27.1034 587.1 30.1589 582.517 Q33.2376 577.911 39.0477 577.911 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M0.69147 295.806 L8.33032 295.806 L8.33032 269.44 L0.0201769 271.107 L0.0201769 266.848 L8.28402 265.181 L12.9599 265.181 L12.9599 295.806 L20.5988 295.806 L20.5988 299.741 L0.69147 299.741 L0.69147 295.806 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip180)" d="M30.0895 265.181 L48.4458 265.181 L48.4458 269.116 L34.3718 269.116 L34.3718 277.588 Q35.3904 277.241 36.4089 277.079 Q37.4274 276.894 38.4459 276.894 Q44.2329 276.894 47.6125 280.065 Q50.9921 283.236 50.9921 288.653 Q50.9921 294.232 47.5199 297.333 Q44.0477 300.412 37.7283 300.412 Q35.5524 300.412 33.2839 300.042 Q31.0385 299.671 28.6311 298.931 L28.6311 294.232 Q30.7145 295.366 32.9367 295.921 Q35.1589 296.477 37.6357 296.477 Q41.6403 296.477 43.9783 294.371 Q46.3162 292.264 46.3162 288.653 Q46.3162 285.042 43.9783 282.935 Q41.6403 280.829 37.6357 280.829 Q35.7607 280.829 33.8857 281.246 Q32.0339 281.662 30.0895 282.542 L30.0895 265.181 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip182)" d="
M151.118 1318.73 L222.368 1433.51 L293.618 1476.29 L364.869 1479.3 L436.119 1467.03 L507.37 1457.04 L578.62 1446.87 L649.871 1434.71 L721.121 1428.93 L792.371 1423.68 
  L863.622 1414.16 L934.872 1403.86 L1006.12 1393.95 L1077.37 1382.44 L1148.62 1374.67 L1219.87 1366.81 L1291.12 1358.69 L1362.37 1352.47 L1433.63 1345.92 L1504.88 1340.3 
  L1576.13 1332.4 L1647.38 1323.87 L1718.63 1316.18 L1789.88 1308.76 L1861.13 1307.77 L1932.38 1305.13 L2003.63 1299.63 L2074.88 1295.64 L2146.13 1295.24 L2217.38 1293.7 
  L2288.63 1289.9 L2288.63 952.966 L2217.38 933.546 L2146.13 918.819 L2074.88 899.041 L2003.63 884.032 L1932.38 866.368 L1861.13 845.849 L1789.88 833.548 L1718.63 816.946 
  L1647.38 794.722 L1576.13 767.868 L1504.88 742.887 L1433.63 711.204 L1362.37 684.533 L1291.12 656.085 L1219.87 625.067 L1148.62 593.095 L1077.37 561.314 L1006.12 526.179 
  L934.872 486.779 L863.622 442.534 L792.371 404.329 L721.121 365.752 L649.871 320.1 L578.62 277.317 L507.37 224.158 L436.119 172.272 L364.869 121.163 L293.618 88.9544 
  L222.368 188.822 L151.118 1138.24  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip182)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1223.19 222.368,1100.64 293.618,1081.05 364.869,1084.78 436.119,1088.86 507.37,1097.05 578.62,1102.46 649.871,1111.97 721.121,1120.1 792.371,1126.8 
  863.622,1133.46 934.872,1140.78 1006.12,1147.07 1077.37,1147.44 1148.62,1151.31 1219.87,1152.37 1291.12,1155.08 1362.37,1163.51 1433.63,1165.49 1504.88,1171.82 
  1576.13,1175.69 1647.38,1177.88 1718.63,1182.05 1789.88,1188.23 1861.13,1189.52 1932.38,1190.28 2003.63,1190.53 2074.88,1191.88 2146.13,1193.45 2217.38,1197.57 
  2288.63,1200.18 
  "/>
<path clip-path="url(#clip182)" d="
M151.118 1295.1 L222.368 1236.62 L293.618 1225.19 L364.869 1223.57 L436.119 1223.24 L507.37 1223.42 L578.62 1223.57 L649.871 1223.53 L721.121 1223.53 L792.371 1223.35 
  L863.622 1223.56 L934.872 1223.52 L1006.12 1223.36 L1077.37 1223.53 L1148.62 1223.27 L1219.87 1223.28 L1291.12 1223.61 L1362.37 1223.67 L1433.63 1223.42 L1504.88 1223.54 
  L1576.13 1223.57 L1647.38 1223.35 L1718.63 1223.44 L1789.88 1223.26 L1861.13 1223.63 L1932.38 1223.69 L2003.63 1223.42 L2074.88 1223.12 L2146.13 1223.8 L2217.38 1223.54 
  L2288.63 1223.74 L2288.63 1221.56 L2217.38 1221.58 L2146.13 1221.57 L2074.88 1221.74 L2003.63 1221.39 L1932.38 1221.8 L1861.13 1221.61 L1789.88 1221.2 L1718.63 1221.4 
  L1647.38 1221.45 L1576.13 1221.32 L1504.88 1221.35 L1433.63 1221.49 L1362.37 1221.86 L1291.12 1221.54 L1219.87 1221.3 L1148.62 1221.67 L1077.37 1221.47 L1006.12 1221.42 
  L934.872 1221.36 L863.622 1221.28 L792.371 1221.76 L721.121 1221.65 L649.871 1221.51 L578.62 1221.36 L507.37 1221.65 L436.119 1221.44 L364.869 1221.41 L293.618 1218.76 
  L222.368 1202.94 L151.118 1125.72  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip182)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1204.38 222.368,1218.25 293.618,1221.64 364.869,1222.48 436.119,1222.37 507.37,1222.47 578.62,1222.54 649.871,1222.53 721.121,1222.62 792.371,1222.71 
  863.622,1222.47 934.872,1222.42 1006.12,1222.58 1077.37,1222.45 1148.62,1222.52 1219.87,1222.44 1291.12,1222.66 1362.37,1222.64 1433.63,1222.68 1504.88,1222.23 
  1576.13,1222.48 1647.38,1222.49 1718.63,1222.42 1789.88,1222.64 1861.13,1222.53 1932.38,1222.32 2003.63,1222.53 2074.88,1222.55 2146.13,1222.8 2217.38,1222.66 
  2288.63,1222.5 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">53.577352229495844</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-580.4764158999931, -4686.7950219997065], [80.97918486227113 0.012874933502368987; 654.9792764883288 3.9105639428709984], [-17.535532497907923 0.0639799936683845; -142.72077964351362 0.14814170937969393;;; 0.0639799936683845 -0.03657486069263963; 0.14814170937969393 -0.34528132898192626], [-73.45629254606749; 47.85439393499553;;], [-129.92715450416873, -11.801871159822824], [20.262899908930777 0.9481765080322103; -1.8177981225366322 -0.826989678382349], [-4.579927107629293 -0.058994703003202364; 0.5928779137257657 0.05625592392214909;;; -0.058994703003202364 -0.018656405190748435; 0.05625592392214909 0.004593418632531234], [1.378153266947121 1.283028600405852 … 0.05517294825725918 -0.033916963653250844])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 13 August 2022 17:14">Saturday 13 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
