<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.005368074671654007]
 [0.03321964329056054, 0.006362393247374217]
 [0.07106796293295299, -0.0023096193498883186]
 [0.0531212943430253, -0.019217789069491165]
 [-0.0676771629317867, -0.008575346707278761]
 [-0.11726988947013645, -0.010218413864579159]
 [-0.17443338089337507, -0.0001614609724782741]
 [-0.1667952047899559, 0.0034207776800754264]
 [-0.13733263690541656, -0.007669563344465122]
 ⋮
 [-0.07051232355696792, 0.005771265811082673]
 [-0.031208397510569273, 0.004991772215630719]
 [0.0012891724633689497, -0.002707098020474072]
 [-0.015614422604506482, -0.00036859047752843717]
 [-0.0171964080125302, 0.014005160557516102]
 [0.0710127259288253, -0.003998782614439547]
 [0.04262198572589374, -0.002652478625704755]
 [0.02398173601316631, 0.00986666615661579]
 [0.08419683060920483, 0.0007022535331950163]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip750">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip750)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip751">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip750)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip752">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip750)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1383.59 2352.76,1383.59 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1189.83 2352.76,1189.83 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,996.071 2352.76,996.071 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,802.311 2352.76,802.311 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,608.55 2352.76,608.55 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,414.789 2352.76,414.789 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,221.029 2352.76,221.029 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1383.59 105.89,1383.59 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1189.83 105.89,1189.83 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,996.071 105.89,996.071 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,802.311 105.89,802.311 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,608.55 105.89,608.55 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,414.789 105.89,414.789 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,221.029 105.89,221.029 "/>
<path clip-path="url(#clip750)" d="M-85.1183 1384.04 L-55.4425 1384.04 L-55.4425 1387.98 L-85.1183 1387.98 L-85.1183 1384.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 1369.39 Q-38.9611 1369.39 -40.7898 1372.96 Q-42.5953 1376.5 -42.5953 1383.63 Q-42.5953 1390.73 -40.7898 1394.3 Q-38.9611 1397.84 -35.35 1397.84 Q-31.7158 1397.84 -29.9102 1394.3 Q-28.0815 1390.73 -28.0815 1383.63 Q-28.0815 1376.5 -29.9102 1372.96 Q-31.7158 1369.39 -35.35 1369.39 M-35.35 1365.69 Q-29.5398 1365.69 -26.4843 1370.29 Q-23.4056 1374.88 -23.4056 1383.63 Q-23.4056 1392.35 -26.4843 1396.96 Q-29.5398 1401.54 -35.35 1401.54 Q-41.1602 1401.54 -44.2388 1396.96 Q-47.2944 1392.35 -47.2944 1383.63 Q-47.2944 1374.88 -44.2388 1370.29 Q-41.1602 1365.69 -35.35 1365.69 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 1394.99 L-10.3038 1394.99 L-10.3038 1400.87 L-15.1881 1400.87 L-15.1881 1394.99 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M3.90904 1396.94 L20.2284 1396.94 L20.2284 1400.87 L-1.71592 1400.87 L-1.71592 1396.94 Q0.946098 1394.18 5.52941 1389.55 Q10.1359 1384.9 11.3164 1383.56 Q13.5618 1381.04 14.4414 1379.3 Q15.3442 1377.54 15.3442 1375.85 Q15.3442 1373.1 13.3997 1371.36 Q11.4784 1369.62 8.37661 1369.62 Q6.17755 1369.62 3.72386 1370.39 Q1.29332 1371.15 -1.48444 1372.7 L-1.48444 1367.98 Q1.33961 1366.85 3.7933 1366.27 Q6.247 1365.69 8.28402 1365.69 Q13.6544 1365.69 16.8488 1368.37 Q20.0432 1371.06 20.0432 1375.55 Q20.0432 1377.68 19.233 1379.6 Q18.446 1381.5 16.3395 1384.09 Q15.7608 1384.76 12.659 1387.98 Q9.55716 1391.17 3.90904 1396.94 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 1366.31 L48.4458 1366.31 L48.4458 1370.25 L34.3718 1370.25 L34.3718 1378.72 Q35.3904 1378.37 36.4089 1378.21 Q37.4274 1378.03 38.4459 1378.03 Q44.2329 1378.03 47.6125 1381.2 Q50.9921 1384.37 50.9921 1389.78 Q50.9921 1395.36 47.5199 1398.47 Q44.0477 1401.54 37.7283 1401.54 Q35.5524 1401.54 33.2839 1401.17 Q31.0385 1400.8 28.6311 1400.06 L28.6311 1395.36 Q30.7145 1396.5 32.9367 1397.05 Q35.1589 1397.61 37.6357 1397.61 Q41.6403 1397.61 43.9783 1395.5 Q46.3162 1393.4 46.3162 1389.78 Q46.3162 1386.17 43.9783 1384.07 Q41.6403 1381.96 37.6357 1381.96 Q35.7607 1381.96 33.8857 1382.38 Q32.0339 1382.79 30.0895 1383.67 L30.0895 1366.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-86.1136 1190.28 L-56.4379 1190.28 L-56.4379 1194.22 L-86.1136 1194.22 L-86.1136 1190.28 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-36.3454 1175.63 Q-39.9565 1175.63 -41.7852 1179.2 Q-43.5907 1182.74 -43.5907 1189.87 Q-43.5907 1196.97 -41.7852 1200.54 Q-39.9565 1204.08 -36.3454 1204.08 Q-32.7111 1204.08 -30.9056 1200.54 Q-29.0769 1196.97 -29.0769 1189.87 Q-29.0769 1182.74 -30.9056 1179.2 Q-32.7111 1175.63 -36.3454 1175.63 M-36.3454 1171.93 Q-30.5352 1171.93 -27.4797 1176.53 Q-24.401 1181.12 -24.401 1189.87 Q-24.401 1198.59 -27.4797 1203.2 Q-30.5352 1207.78 -36.3454 1207.78 Q-42.1555 1207.78 -45.2342 1203.2 Q-48.2897 1198.59 -48.2897 1189.87 Q-48.2897 1181.12 -45.2342 1176.53 Q-42.1555 1171.93 -36.3454 1171.93 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-16.1834 1201.23 L-11.2992 1201.23 L-11.2992 1207.11 L-16.1834 1207.11 L-16.1834 1201.23 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2.91368 1203.18 L19.233 1203.18 L19.233 1207.11 L-2.71129 1207.11 L-2.71129 1203.18 Q-0.0492672 1200.42 4.53404 1195.79 Q9.1405 1191.14 10.321 1189.8 Q12.5664 1187.27 13.446 1185.54 Q14.3488 1183.78 14.3488 1182.09 Q14.3488 1179.33 12.4044 1177.6 Q10.4831 1175.86 7.38125 1175.86 Q5.18219 1175.86 2.7285 1176.63 Q0.297953 1177.39 -2.47981 1178.94 L-2.47981 1174.22 Q0.344249 1173.08 2.79794 1172.51 Q5.25163 1171.93 7.28866 1171.93 Q12.659 1171.93 15.8534 1174.61 Q19.0479 1177.3 19.0479 1181.79 Q19.0479 1183.92 18.2377 1185.84 Q17.4506 1187.74 15.3442 1190.33 Q14.7655 1191 11.6636 1194.22 Q8.5618 1197.41 2.91368 1203.18 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 1175.63 Q35.4367 1175.63 33.608 1179.2 Q31.8024 1182.74 31.8024 1189.87 Q31.8024 1196.97 33.608 1200.54 Q35.4367 1204.08 39.0477 1204.08 Q42.682 1204.08 44.4875 1200.54 Q46.3162 1196.97 46.3162 1189.87 Q46.3162 1182.74 44.4875 1179.2 Q42.682 1175.63 39.0477 1175.63 M39.0477 1171.93 Q44.8579 1171.93 47.9134 1176.53 Q50.9921 1181.12 50.9921 1189.87 Q50.9921 1198.59 47.9134 1203.2 Q44.8579 1207.78 39.0477 1207.78 Q33.2376 1207.78 30.1589 1203.2 Q27.1034 1198.59 27.1034 1189.87 Q27.1034 1181.12 30.1589 1176.53 Q33.2376 1171.93 39.0477 1171.93 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-85.1183 996.523 L-55.4425 996.523 L-55.4425 1000.46 L-85.1183 1000.46 L-85.1183 996.523 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 981.87 Q-38.9611 981.87 -40.7898 985.435 Q-42.5953 988.977 -42.5953 996.106 Q-42.5953 1003.21 -40.7898 1006.78 Q-38.9611 1010.32 -35.35 1010.32 Q-31.7158 1010.32 -29.9102 1006.78 Q-28.0815 1003.21 -28.0815 996.106 Q-28.0815 988.977 -29.9102 985.435 Q-31.7158 981.87 -35.35 981.87 M-35.35 978.167 Q-29.5398 978.167 -26.4843 982.773 Q-23.4056 987.356 -23.4056 996.106 Q-23.4056 1004.83 -26.4843 1009.44 Q-29.5398 1014.02 -35.35 1014.02 Q-41.1602 1014.02 -44.2388 1009.44 Q-47.2944 1004.83 -47.2944 996.106 Q-47.2944 987.356 -44.2388 982.773 Q-41.1602 978.167 -35.35 978.167 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 1007.47 L-10.3038 1007.47 L-10.3038 1013.35 L-15.1881 1013.35 L-15.1881 1007.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M0.69147 1009.42 L8.33032 1009.42 L8.33032 983.051 L0.0201769 984.717 L0.0201769 980.458 L8.28402 978.791 L12.9599 978.791 L12.9599 1009.42 L20.5988 1009.42 L20.5988 1013.35 L0.69147 1013.35 L0.69147 1009.42 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 978.791 L48.4458 978.791 L48.4458 982.727 L34.3718 982.727 L34.3718 991.199 Q35.3904 990.852 36.4089 990.69 Q37.4274 990.504 38.4459 990.504 Q44.2329 990.504 47.6125 993.676 Q50.9921 996.847 50.9921 1002.26 Q50.9921 1007.84 47.5199 1010.94 Q44.0477 1014.02 37.7283 1014.02 Q35.5524 1014.02 33.2839 1013.65 Q31.0385 1013.28 28.6311 1012.54 L28.6311 1007.84 Q30.7145 1008.98 32.9367 1009.53 Q35.1589 1010.09 37.6357 1010.09 Q41.6403 1010.09 43.9783 1007.98 Q46.3162 1005.87 46.3162 1002.26 Q46.3162 998.653 43.9783 996.546 Q41.6403 994.44 37.6357 994.44 Q35.7607 994.44 33.8857 994.856 Q32.0339 995.273 30.0895 996.153 L30.0895 978.791 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-86.1136 802.762 L-56.4379 802.762 L-56.4379 806.697 L-86.1136 806.697 L-86.1136 802.762 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-36.3454 788.109 Q-39.9565 788.109 -41.7852 791.674 Q-43.5907 795.216 -43.5907 802.346 Q-43.5907 809.452 -41.7852 813.017 Q-39.9565 816.558 -36.3454 816.558 Q-32.7111 816.558 -30.9056 813.017 Q-29.0769 809.452 -29.0769 802.346 Q-29.0769 795.216 -30.9056 791.674 Q-32.7111 788.109 -36.3454 788.109 M-36.3454 784.406 Q-30.5352 784.406 -27.4797 789.012 Q-24.401 793.596 -24.401 802.346 Q-24.401 811.072 -27.4797 815.679 Q-30.5352 820.262 -36.3454 820.262 Q-42.1555 820.262 -45.2342 815.679 Q-48.2897 811.072 -48.2897 802.346 Q-48.2897 793.596 -45.2342 789.012 Q-42.1555 784.406 -36.3454 784.406 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-16.1834 813.711 L-11.2992 813.711 L-11.2992 819.591 L-16.1834 819.591 L-16.1834 813.711 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-0.303895 815.656 L7.33495 815.656 L7.33495 789.29 L-0.975188 790.957 L-0.975188 786.697 L7.28866 785.031 L11.9646 785.031 L11.9646 815.656 L19.6034 815.656 L19.6034 819.591 L-0.303895 819.591 L-0.303895 815.656 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 788.109 Q35.4367 788.109 33.608 791.674 Q31.8024 795.216 31.8024 802.346 Q31.8024 809.452 33.608 813.017 Q35.4367 816.558 39.0477 816.558 Q42.682 816.558 44.4875 813.017 Q46.3162 809.452 46.3162 802.346 Q46.3162 795.216 44.4875 791.674 Q42.682 788.109 39.0477 788.109 M39.0477 784.406 Q44.8579 784.406 47.9134 789.012 Q50.9921 793.596 50.9921 802.346 Q50.9921 811.072 47.9134 815.679 Q44.8579 820.262 39.0477 820.262 Q33.2376 820.262 30.1589 815.679 Q27.1034 811.072 27.1034 802.346 Q27.1034 793.596 30.1589 789.012 Q33.2376 784.406 39.0477 784.406 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-85.1183 609.001 L-55.4425 609.001 L-55.4425 612.937 L-85.1183 612.937 L-85.1183 609.001 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 594.349 Q-38.9611 594.349 -40.7898 597.914 Q-42.5953 601.455 -42.5953 608.585 Q-42.5953 615.691 -40.7898 619.256 Q-38.9611 622.798 -35.35 622.798 Q-31.7158 622.798 -29.9102 619.256 Q-28.0815 615.691 -28.0815 608.585 Q-28.0815 601.455 -29.9102 597.914 Q-31.7158 594.349 -35.35 594.349 M-35.35 590.645 Q-29.5398 590.645 -26.4843 595.252 Q-23.4056 599.835 -23.4056 608.585 Q-23.4056 617.312 -26.4843 621.918 Q-29.5398 626.501 -35.35 626.501 Q-41.1602 626.501 -44.2388 621.918 Q-47.2944 617.312 -47.2944 608.585 Q-47.2944 599.835 -44.2388 595.252 Q-41.1602 590.645 -35.35 590.645 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 619.951 L-10.3038 619.951 L-10.3038 625.83 L-15.1881 625.83 L-15.1881 619.951 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M9.88124 594.349 Q6.27014 594.349 4.44145 597.914 Q2.6359 601.455 2.6359 608.585 Q2.6359 615.691 4.44145 619.256 Q6.27014 622.798 9.88124 622.798 Q13.5155 622.798 15.321 619.256 Q17.1497 615.691 17.1497 608.585 Q17.1497 601.455 15.321 597.914 Q13.5155 594.349 9.88124 594.349 M9.88124 590.645 Q15.6914 590.645 18.7469 595.252 Q21.8256 599.835 21.8256 608.585 Q21.8256 617.312 18.7469 621.918 Q15.6914 626.501 9.88124 626.501 Q4.07108 626.501 0.992394 621.918 Q-2.06315 617.312 -2.06315 608.585 Q-2.06315 599.835 0.992394 595.252 Q4.07108 590.645 9.88124 590.645 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 591.27 L48.4458 591.27 L48.4458 595.205 L34.3718 595.205 L34.3718 603.677 Q35.3904 603.33 36.4089 603.168 Q37.4274 602.983 38.4459 602.983 Q44.2329 602.983 47.6125 606.154 Q50.9921 609.326 50.9921 614.742 Q50.9921 620.321 47.5199 623.423 Q44.0477 626.501 37.7283 626.501 Q35.5524 626.501 33.2839 626.131 Q31.0385 625.761 28.6311 625.02 L28.6311 620.321 Q30.7145 621.455 32.9367 622.011 Q35.1589 622.566 37.6357 622.566 Q41.6403 622.566 43.9783 620.46 Q46.3162 618.353 46.3162 614.742 Q46.3162 611.131 43.9783 609.025 Q41.6403 606.918 37.6357 606.918 Q35.7607 606.918 33.8857 607.335 Q32.0339 607.752 30.0895 608.631 L30.0895 591.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-36.3454 400.588 Q-39.9565 400.588 -41.7852 404.153 Q-43.5907 407.695 -43.5907 414.824 Q-43.5907 421.931 -41.7852 425.495 Q-39.9565 429.037 -36.3454 429.037 Q-32.7111 429.037 -30.9056 425.495 Q-29.0769 421.931 -29.0769 414.824 Q-29.0769 407.695 -30.9056 404.153 Q-32.7111 400.588 -36.3454 400.588 M-36.3454 396.884 Q-30.5352 396.884 -27.4797 401.491 Q-24.401 406.074 -24.401 414.824 Q-24.401 423.551 -27.4797 428.157 Q-30.5352 432.741 -36.3454 432.741 Q-42.1555 432.741 -45.2342 428.157 Q-48.2897 423.551 -48.2897 414.824 Q-48.2897 406.074 -45.2342 401.491 Q-42.1555 396.884 -36.3454 396.884 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-16.1834 426.19 L-11.2992 426.19 L-11.2992 432.069 L-16.1834 432.069 L-16.1834 426.19 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M8.88587 400.588 Q5.27478 400.588 3.44608 404.153 Q1.64054 407.695 1.64054 414.824 Q1.64054 421.931 3.44608 425.495 Q5.27478 429.037 8.88587 429.037 Q12.5201 429.037 14.3257 425.495 Q16.1543 421.931 16.1543 414.824 Q16.1543 407.695 14.3257 404.153 Q12.5201 400.588 8.88587 400.588 M8.88587 396.884 Q14.696 396.884 17.7516 401.491 Q20.8303 406.074 20.8303 414.824 Q20.8303 423.551 17.7516 428.157 Q14.696 432.741 8.88587 432.741 Q3.07572 432.741 -0.00297114 428.157 Q-3.05851 423.551 -3.05851 414.824 Q-3.05851 406.074 -0.00297114 401.491 Q3.07572 396.884 8.88587 396.884 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 400.588 Q35.4367 400.588 33.608 404.153 Q31.8024 407.695 31.8024 414.824 Q31.8024 421.931 33.608 425.495 Q35.4367 429.037 39.0477 429.037 Q42.682 429.037 44.4875 425.495 Q46.3162 421.931 46.3162 414.824 Q46.3162 407.695 44.4875 404.153 Q42.682 400.588 39.0477 400.588 M39.0477 396.884 Q44.8579 396.884 47.9134 401.491 Q50.9921 406.074 50.9921 414.824 Q50.9921 423.551 47.9134 428.157 Q44.8579 432.741 39.0477 432.741 Q33.2376 432.741 30.1589 428.157 Q27.1034 423.551 27.1034 414.824 Q27.1034 406.074 30.1589 401.491 Q33.2376 396.884 39.0477 396.884 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 206.827 Q-38.9611 206.827 -40.7898 210.392 Q-42.5953 213.934 -42.5953 221.063 Q-42.5953 228.17 -40.7898 231.735 Q-38.9611 235.276 -35.35 235.276 Q-31.7158 235.276 -29.9102 231.735 Q-28.0815 228.17 -28.0815 221.063 Q-28.0815 213.934 -29.9102 210.392 Q-31.7158 206.827 -35.35 206.827 M-35.35 203.124 Q-29.5398 203.124 -26.4843 207.73 Q-23.4056 212.313 -23.4056 221.063 Q-23.4056 229.79 -26.4843 234.397 Q-29.5398 238.98 -35.35 238.98 Q-41.1602 238.98 -44.2388 234.397 Q-47.2944 229.79 -47.2944 221.063 Q-47.2944 212.313 -44.2388 207.73 Q-41.1602 203.124 -35.35 203.124 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 232.429 L-10.3038 232.429 L-10.3038 238.309 L-15.1881 238.309 L-15.1881 232.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M9.88124 206.827 Q6.27014 206.827 4.44145 210.392 Q2.6359 213.934 2.6359 221.063 Q2.6359 228.17 4.44145 231.735 Q6.27014 235.276 9.88124 235.276 Q13.5155 235.276 15.321 231.735 Q17.1497 228.17 17.1497 221.063 Q17.1497 213.934 15.321 210.392 Q13.5155 206.827 9.88124 206.827 M9.88124 203.124 Q15.6914 203.124 18.7469 207.73 Q21.8256 212.313 21.8256 221.063 Q21.8256 229.79 18.7469 234.397 Q15.6914 238.98 9.88124 238.98 Q4.07108 238.98 0.992394 234.397 Q-2.06315 229.79 -2.06315 221.063 Q-2.06315 212.313 0.992394 207.73 Q4.07108 203.124 9.88124 203.124 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 203.749 L48.4458 203.749 L48.4458 207.684 L34.3718 207.684 L34.3718 216.156 Q35.3904 215.809 36.4089 215.647 Q37.4274 215.462 38.4459 215.462 Q44.2329 215.462 47.6125 218.633 Q50.9921 221.804 50.9921 227.221 Q50.9921 232.799 47.5199 235.901 Q44.0477 238.98 37.7283 238.98 Q35.5524 238.98 33.2839 238.61 Q31.0385 238.239 28.6311 237.499 L28.6311 232.799 Q30.7145 233.934 32.9367 234.489 Q35.1589 235.045 37.6357 235.045 Q41.6403 235.045 43.9783 232.938 Q46.3162 230.832 46.3162 227.221 Q46.3162 223.61 43.9783 221.503 Q41.6403 219.397 37.6357 219.397 Q35.7607 219.397 33.8857 219.813 Q32.0339 220.23 30.0895 221.11 L30.0895 203.749 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip752)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,414.789 162.518,415.093 238.043,286.056 313.569,139.386 389.094,208.933 464.619,677.053 540.145,869.235 615.67,1090.76 691.196,1061.16 766.721,946.983 842.247,1103.97 917.772,1464 993.298,1223.29 1068.82,1260.6 1144.35,1233.64 1219.87,768.459 1295.4,254.681 1370.92,274.01 1446.45,111.137 1521.98,195.772 1597.5,444.656 1673.03,479.016 1748.55,688.04 1824.08,535.729 1899.6,409.794 1975.13,475.299 2050.65,481.429 2126.18,139.6 2201.7,249.62 2277.23,321.855 2352.76,88.5087 "/>
<polyline clip-path="url(#clip752)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,414.789 162.518,393.987 238.043,390.134 313.569,423.74 389.094,489.262 464.619,448.021 540.145,454.388 615.67,415.415 691.196,401.533 766.721,444.511 842.247,479.025 917.772,384.399 993.298,427.323 1068.82,417.214 1144.35,346.754 1219.87,335.463 1295.4,416.566 1370.92,387.442 1446.45,425.949 1521.98,453.287 1597.5,420.528 1673.03,449.133 1748.55,392.425 1824.08,395.445 1899.6,425.28 1975.13,416.218 2050.65,360.516 2126.18,430.286 2201.7,425.068 2277.23,376.554 2352.76,412.068 "/>
<path clip-path="url(#clip750)" d="M2027.46 1456.66 L2277.23 1456.66 L2277.23 1301.14 L2027.46 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,1456.66 2277.23,1456.66 2277.23,1301.14 2027.46,1301.14 2027.46,1456.66 "/>
<polyline clip-path="url(#clip750)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,1352.98 2203.69,1352.98 "/>
<path clip-path="url(#clip750)" d="M2242.26 1357.23 Q2237.1 1357.23 2235.11 1358.41 Q2233.12 1359.59 2233.12 1362.44 Q2233.12 1364.7 2234.6 1366.05 Q2236.11 1367.37 2238.68 1367.37 Q2242.22 1367.37 2244.35 1364.87 Q2246.5 1362.34 2246.5 1358.18 L2246.5 1357.23 L2242.26 1357.23 M2250.76 1355.47 L2250.76 1370.26 L2246.5 1370.26 L2246.5 1366.32 Q2245.04 1368.69 2242.87 1369.82 Q2240.69 1370.93 2237.54 1370.93 Q2233.56 1370.93 2231.2 1368.71 Q2228.86 1366.46 2228.86 1362.71 Q2228.86 1358.34 2231.78 1356.12 Q2234.72 1353.89 2240.53 1353.89 L2246.5 1353.89 L2246.5 1353.48 Q2246.5 1350.54 2244.56 1348.94 Q2242.63 1347.32 2239.14 1347.32 Q2236.92 1347.32 2234.81 1347.85 Q2232.7 1348.38 2230.76 1349.45 L2230.76 1345.51 Q2233.1 1344.61 2235.3 1344.17 Q2237.5 1343.71 2239.58 1343.71 Q2245.2 1343.71 2247.98 1346.63 Q2250.76 1349.54 2250.76 1355.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip750)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,1404.82 2203.69,1404.82 "/>
<path clip-path="url(#clip750)" d="M2247.63 1409.16 Q2247.63 1404.46 2245.69 1401.8 Q2243.77 1399.11 2240.39 1399.11 Q2237.01 1399.11 2235.06 1401.8 Q2233.14 1404.46 2233.14 1409.16 Q2233.14 1413.86 2235.06 1416.54 Q2237.01 1419.21 2240.39 1419.21 Q2243.77 1419.21 2245.69 1416.54 Q2247.63 1413.86 2247.63 1409.16 M2233.14 1400.11 Q2234.49 1397.79 2236.52 1396.68 Q2238.58 1395.55 2241.43 1395.55 Q2246.15 1395.55 2249.09 1399.3 Q2252.06 1403.05 2252.06 1409.16 Q2252.06 1415.27 2249.09 1419.02 Q2246.15 1422.77 2241.43 1422.77 Q2238.58 1422.77 2236.52 1421.66 Q2234.49 1420.53 2233.14 1418.21 L2233.14 1422.1 L2228.86 1422.1 L2228.86 1386.08 L2233.14 1386.08 L2233.14 1400.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.536807  0.528878  -0.35821  -1.87559  …  -0.185272  1.03972  -0.127108</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip810">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip810)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip811">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip810)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip812">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip810)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1316.51 2352.76,1316.51 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,939.042 2352.76,939.042 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,561.575 2352.76,561.575 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,184.108 2352.76,184.108 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1316.51 105.89,1316.51 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,939.042 105.89,939.042 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,561.575 105.89,561.575 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,184.108 105.89,184.108 "/>
<path clip-path="url(#clip810)" d="M39.0477 1302.31 Q35.4367 1302.31 33.608 1305.87 Q31.8024 1309.41 31.8024 1316.54 Q31.8024 1323.65 33.608 1327.21 Q35.4367 1330.76 39.0477 1330.76 Q42.682 1330.76 44.4875 1327.21 Q46.3162 1323.65 46.3162 1316.54 Q46.3162 1309.41 44.4875 1305.87 Q42.682 1302.31 39.0477 1302.31 M39.0477 1298.6 Q44.8579 1298.6 47.9134 1303.21 Q50.9921 1307.79 50.9921 1316.54 Q50.9921 1325.27 47.9134 1329.88 Q44.8579 1334.46 39.0477 1334.46 Q33.2376 1334.46 30.1589 1329.88 Q27.1034 1325.27 27.1034 1316.54 Q27.1034 1307.79 30.1589 1303.21 Q33.2376 1298.6 39.0477 1298.6 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-0.303895 952.387 L7.33495 952.387 L7.33495 926.021 L-0.975188 927.688 L-0.975188 923.429 L7.28866 921.762 L11.9646 921.762 L11.9646 952.387 L19.6034 952.387 L19.6034 956.322 L-0.303895 956.322 L-0.303895 952.387 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M39.0477 924.841 Q35.4367 924.841 33.608 928.406 Q31.8024 931.947 31.8024 939.077 Q31.8024 946.183 33.608 949.748 Q35.4367 953.29 39.0477 953.29 Q42.682 953.29 44.4875 949.748 Q46.3162 946.183 46.3162 939.077 Q46.3162 931.947 44.4875 928.406 Q42.682 924.841 39.0477 924.841 M39.0477 921.137 Q44.8579 921.137 47.9134 925.744 Q50.9921 930.327 50.9921 939.077 Q50.9921 947.804 47.9134 952.41 Q44.8579 956.993 39.0477 956.993 Q33.2376 956.993 30.1589 952.41 Q27.1034 947.804 27.1034 939.077 Q27.1034 930.327 30.1589 925.744 Q33.2376 921.137 39.0477 921.137 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M2.91368 574.92 L19.233 574.92 L19.233 578.855 L-2.71129 578.855 L-2.71129 574.92 Q-0.0492672 572.166 4.53404 567.536 Q9.1405 562.883 10.321 561.541 Q12.5664 559.017 13.446 557.281 Q14.3488 555.522 14.3488 553.832 Q14.3488 551.078 12.4044 549.342 Q10.4831 547.605 7.38125 547.605 Q5.18219 547.605 2.7285 548.369 Q0.297953 549.133 -2.47981 550.684 L-2.47981 545.962 Q0.344249 544.828 2.79794 544.249 Q5.25163 543.67 7.28866 543.67 Q12.659 543.67 15.8534 546.355 Q19.0479 549.041 19.0479 553.531 Q19.0479 555.661 18.2377 557.582 Q17.4506 559.48 15.3442 562.073 Q14.7655 562.744 11.6636 565.962 Q8.5618 569.156 2.91368 574.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M39.0477 547.374 Q35.4367 547.374 33.608 550.939 Q31.8024 554.48 31.8024 561.61 Q31.8024 568.716 33.608 572.281 Q35.4367 575.823 39.0477 575.823 Q42.682 575.823 44.4875 572.281 Q46.3162 568.716 46.3162 561.61 Q46.3162 554.48 44.4875 550.939 Q42.682 547.374 39.0477 547.374 M39.0477 543.67 Q44.8579 543.67 47.9134 548.277 Q50.9921 552.86 50.9921 561.61 Q50.9921 570.337 47.9134 574.943 Q44.8579 579.527 39.0477 579.527 Q33.2376 579.527 30.1589 574.943 Q27.1034 570.337 27.1034 561.61 Q27.1034 552.86 30.1589 548.277 Q33.2376 543.67 39.0477 543.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M13.0525 182.754 Q16.409 183.472 18.284 185.74 Q20.1821 188.009 20.1821 191.342 Q20.1821 196.458 16.6636 199.259 Q13.1451 202.06 6.66366 202.06 Q4.48775 202.06 2.17294 201.62 Q-0.118711 201.203 -2.5724 200.347 L-2.5724 195.833 Q-0.627968 196.967 1.68683 197.546 Q4.00164 198.125 6.52477 198.125 Q10.9229 198.125 13.2146 196.388 Q15.5294 194.652 15.5294 191.342 Q15.5294 188.287 13.3766 186.574 Q11.247 184.838 7.42754 184.838 L3.39979 184.838 L3.39979 180.995 L7.61273 180.995 Q11.0618 180.995 12.8905 179.629 Q14.7192 178.24 14.7192 175.648 Q14.7192 172.986 12.821 171.574 Q10.946 170.139 7.42754 170.139 Q5.50626 170.139 3.3072 170.555 Q1.10813 170.972 -1.53074 171.852 L-1.53074 167.685 Q1.13128 166.944 3.44608 166.574 Q5.78403 166.203 7.84421 166.203 Q13.1683 166.203 16.2701 168.634 Q19.3719 171.041 19.3719 175.162 Q19.3719 178.032 17.7284 180.023 Q16.0849 181.99 13.0525 182.754 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M39.0477 169.907 Q35.4367 169.907 33.608 173.472 Q31.8024 177.014 31.8024 184.143 Q31.8024 191.25 33.608 194.814 Q35.4367 198.356 39.0477 198.356 Q42.682 198.356 44.4875 194.814 Q46.3162 191.25 46.3162 184.143 Q46.3162 177.014 44.4875 173.472 Q42.682 169.907 39.0477 169.907 M39.0477 166.203 Q44.8579 166.203 47.9134 170.81 Q50.9921 175.393 50.9921 184.143 Q50.9921 192.87 47.9134 197.476 Q44.8579 202.06 39.0477 202.06 Q33.2376 202.06 30.1589 197.476 Q27.1034 192.87 27.1034 184.143 Q27.1034 175.393 30.1589 170.81 Q33.2376 166.203 39.0477 166.203 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip812)" d="M151.118 1351.74 L222.368 1447.02 L293.618 1479.3 L364.869 1478.35 L436.119 1473.91 L507.37 1465.72 L578.62 1459.68 L649.871 1452.57 L721.121 1444.03 L792.371 1434.31 L863.622 1428.13 L934.872 1423.24 L1006.12 1420.66 L1077.37 1413.61 L1148.62 1406.91 L1219.87 1403.88 L1291.12 1401.09 L1362.37 1400.31 L1433.63 1398.1 L1504.88 1392.12 L1576.13 1388.52 L1647.38 1383.79 L1718.63 1378.24 L1789.88 1374.53 L1861.13 1371.23 L1932.38 1369.25 L2003.63 1368.42 L2074.88 1365.95 L2146.13 1362.32 L2217.38 1362.34 L2288.63 1360.87 L2288.63 1031.5 L2217.38 1014.06 L2146.13 997.653 L2074.88 979.626 L2003.63 960.698 L1932.38 938.939 L1861.13 917.1 L1789.88 895.771 L1718.63 874.166 L1647.38 853.663 L1576.13 828.869 L1504.88 803.785 L1433.63 775.019 L1362.37 744.289 L1291.12 711.724 L1219.87 678.608 L1148.62 644.66 L1077.37 609.119 L1006.12 571.088 L934.872 526.814 L863.622 484.874 L792.371 441.174 L721.121 395.37 L649.871 344.779 L578.62 294.421 L507.37 238.202 L436.119 181.33 L364.869 127.077 L293.618 88.9544 L222.368 176.034 L151.118 1242.59  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip812)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1317.82 222.368,1204.52 293.618,1193.99 364.869,1198.31 436.119,1202.22 507.37,1210.14 578.62,1210.8 649.871,1213.57 721.121,1217.17 792.371,1221.7 863.622,1227.46 934.872,1229.85 1006.12,1236.05 1077.37,1237.86 1148.62,1241.65 1219.87,1249.06 1291.12,1251.7 1362.37,1256.67 1433.63,1263.06 1504.88,1265.86 1576.13,1271.23 1647.38,1271.19 1718.63,1273.56 1789.88,1276.88 1861.13,1279.2 1932.38,1280.6 2003.63,1280.84 2074.88,1282.07 2146.13,1280.19 2217.38,1278.66 2288.63,1280.81 "/>
<path clip-path="url(#clip812)" d="M151.118 1350.02 L222.368 1322.96 L293.618 1317.99 L364.869 1317.24 L436.119 1317 L507.37 1317.2 L578.62 1317.17 L649.871 1317.25 L721.121 1316.99 L792.371 1317.04 L863.622 1317 L934.872 1317.14 L1006.12 1316.98 L1077.37 1317.09 L1148.62 1317.06 L1219.87 1317.43 L1291.12 1317.21 L1362.37 1317.2 L1433.63 1317.23 L1504.88 1317.18 L1576.13 1317.07 L1647.38 1317.09 L1718.63 1317.14 L1789.88 1317.13 L1861.13 1317.17 L1932.38 1317.17 L2003.63 1317.13 L2074.88 1316.99 L2146.13 1317.09 L2217.38 1317.09 L2288.63 1317.02 L2288.63 1315.74 L2217.38 1315.94 L2146.13 1315.78 L2074.88 1315.83 L2003.63 1315.76 L1932.38 1316.21 L1861.13 1316.11 L1789.88 1315.92 L1718.63 1316.13 L1647.38 1315.85 L1576.13 1315.97 L1504.88 1315.87 L1433.63 1315.9 L1362.37 1315.96 L1291.12 1315.93 L1219.87 1315.93 L1148.62 1316.04 L1077.37 1315.81 L1006.12 1315.78 L934.872 1316.05 L863.622 1316 L792.371 1316.03 L721.121 1315.93 L649.871 1315.87 L578.62 1315.78 L507.37 1315.82 L436.119 1315.82 L364.869 1315.45 L293.618 1313.05 L222.368 1299.51 L151.118 1230.53  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip812)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1302.64 222.368,1313.82 293.618,1316.1 364.869,1316.3 436.119,1316.45 507.37,1316.56 578.62,1316.56 649.871,1316.55 721.121,1316.51 792.371,1316.67 863.622,1316.47 934.872,1316.57 1006.12,1316.43 1077.37,1316.44 1148.62,1316.48 1219.87,1316.51 1291.12,1316.51 1362.37,1316.48 1433.63,1316.41 1504.88,1316.47 1576.13,1316.51 1647.38,1316.42 1718.63,1316.46 1789.88,1316.47 1861.13,1316.53 1932.38,1316.53 2003.63,1316.53 2074.88,1316.46 2146.13,1316.33 2217.38,1316.52 2288.63,1316.35 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">58.3242591890868</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([72.85378408570298, 778.7420986865302], [-13.351278347528297 0.9662656231959337; -198.6121195608694 9.68785713911306], [3.2953505863074817 -0.10151539855546692; 36.15116533164623 -0.7121082748462485;;; -0.10151539855546692 0.012924560623403844; -0.7121082748462485 0.1276366934779293], [154.13326590286692; 597.1835026770307;;], [29.37290565769994, -17.178606086623557], [-8.08734229958245 -0.14376221711127685; 6.755056297128207 0.8286243432030074], [2.213043328325196 -0.02084400683256628; -1.0547343370186293 -0.06403887890310918;;; -0.02084400683256628 0.005395327055883178; -0.06403887890310918 -0.0034908223852185886], [-1.6544992067423008 -1.4475180693907903 … -0.027870960657647922 -0.11254967153616507])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 14 March 2023 00:44">Tuesday 14 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
