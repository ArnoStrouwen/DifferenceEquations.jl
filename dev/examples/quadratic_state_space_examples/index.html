<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.019673333907013923]
 [0.12303313294933366, 0.014861318410501978]
 [0.20975366925014624, -0.007968272792860272]
 [0.1498627445796445, -0.014611433080385572]
 [0.05221814173600817, -0.013480421861630508]
 [-0.033527147034441804, 0.001270655118588683]
 [-0.02404925520027937, 0.010740014599178978]
 [0.04400486492073356, -0.003917642875722339]
 [0.017473654131792454, 0.0016146130776928803]
 ⋮
 [-0.123234173832544, -0.011167606989826448]
 [-0.1859073413702195, -0.0042247811293311]
 [-0.2027811765396106, -0.011757716499818443]
 [-0.2650305240356389, 0.003402571761277772]
 [-0.2308012648566149, 0.0005446069132294777]
 [-0.2159815690480772, -0.010552473494983514]
 [-0.27019121315977557, -0.003225596081493593]
 [-0.27668150094463073, -0.009435492712098748]
 [-0.3209846768449776, 0.006644056364737727]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip300">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip300)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip301">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip300)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip302">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip300)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1409.61 2352.76,1409.61 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1150.45 2352.76,1150.45 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,891.281 2352.76,891.281 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,632.116 2352.76,632.116 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,372.951 2352.76,372.951 "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,113.787 2352.76,113.787 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1409.61 105.89,1409.61 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1150.45 105.89,1150.45 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,891.281 105.89,891.281 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,632.116 105.89,632.116 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,372.951 105.89,372.951 "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,113.787 105.89,113.787 "/>
<path clip-path="url(#clip300)" d="M-55.3036 1410.06 L-25.6278 1410.06 L-25.6278 1414 L-55.3036 1414 L-55.3036 1410.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-5.53535 1395.41 Q-9.14644 1395.41 -10.9751 1398.97 Q-12.7807 1402.52 -12.7807 1409.65 Q-12.7807 1416.75 -10.9751 1420.32 Q-9.14644 1423.86 -5.53535 1423.86 Q-1.90111 1423.86 -0.0955632 1420.32 Q1.73313 1416.75 1.73313 1409.65 Q1.73313 1402.52 -0.0955632 1398.97 Q-1.90111 1395.41 -5.53535 1395.41 M-5.53535 1391.71 Q0.274805 1391.71 3.33034 1396.31 Q6.40903 1400.9 6.40903 1409.65 Q6.40903 1418.37 3.33034 1422.98 Q0.274805 1427.56 -5.53535 1427.56 Q-11.3455 1427.56 -14.4242 1422.98 Q-17.4797 1418.37 -17.4797 1409.65 Q-17.4797 1400.9 -14.4242 1396.31 Q-11.3455 1391.71 -5.53535 1391.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M14.6266 1421.01 L19.5108 1421.01 L19.5108 1426.89 L14.6266 1426.89 L14.6266 1421.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M43.8625 1408.26 Q47.219 1408.97 49.094 1411.24 Q50.9921 1413.51 50.9921 1416.84 Q50.9921 1421.96 47.4736 1424.76 Q43.9551 1427.56 37.4737 1427.56 Q35.2978 1427.56 32.983 1427.12 Q30.6913 1426.71 28.2376 1425.85 L28.2376 1421.33 Q30.1821 1422.47 32.4969 1423.05 Q34.8117 1423.63 37.3348 1423.63 Q41.7329 1423.63 44.0246 1421.89 Q46.3394 1420.15 46.3394 1416.84 Q46.3394 1413.79 44.1866 1412.08 Q42.057 1410.34 38.2376 1410.34 L34.2098 1410.34 L34.2098 1406.5 L38.4227 1406.5 Q41.8718 1406.5 43.7005 1405.13 Q45.5292 1403.74 45.5292 1401.15 Q45.5292 1398.49 43.6311 1397.08 Q41.7561 1395.64 38.2376 1395.64 Q36.3163 1395.64 34.1172 1396.06 Q31.9182 1396.47 29.2793 1397.35 L29.2793 1393.19 Q31.9413 1392.45 34.2561 1392.08 Q36.5941 1391.71 38.6542 1391.71 Q43.9783 1391.71 47.0801 1394.14 Q50.1819 1396.54 50.1819 1400.66 Q50.1819 1403.53 48.5384 1405.52 Q46.8949 1407.49 43.8625 1408.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-54.3545 1150.9 L-24.6788 1150.9 L-24.6788 1154.83 L-54.3545 1154.83 L-54.3545 1150.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-4.58628 1136.24 Q-8.19737 1136.24 -10.0261 1139.81 Q-11.8316 1143.35 -11.8316 1150.48 Q-11.8316 1157.59 -10.0261 1161.15 Q-8.19737 1164.69 -4.58628 1164.69 Q-0.95204 1164.69 0.853506 1161.15 Q2.6822 1157.59 2.6822 1150.48 Q2.6822 1143.35 0.853506 1139.81 Q-0.95204 1136.24 -4.58628 1136.24 M-4.58628 1132.54 Q1.22387 1132.54 4.27941 1137.15 Q7.3581 1141.73 7.3581 1150.48 Q7.3581 1159.21 4.27941 1163.81 Q1.22387 1168.4 -4.58628 1168.4 Q-10.3964 1168.4 -13.4751 1163.81 Q-16.5307 1159.21 -16.5307 1150.48 Q-16.5307 1141.73 -13.4751 1137.15 Q-10.3964 1132.54 -4.58628 1132.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M15.5756 1161.85 L20.4599 1161.85 L20.4599 1167.73 L15.5756 1167.73 L15.5756 1161.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M34.6728 1163.79 L50.9921 1163.79 L50.9921 1167.73 L29.0478 1167.73 L29.0478 1163.79 Q31.7098 1161.04 36.2931 1156.41 Q40.8996 1151.75 42.0801 1150.41 Q44.3255 1147.89 45.2051 1146.15 Q46.1079 1144.39 46.1079 1142.7 Q46.1079 1139.95 44.1635 1138.21 Q42.2422 1136.48 39.1403 1136.48 Q36.9413 1136.48 34.4876 1137.24 Q32.057 1138 29.2793 1139.55 L29.2793 1134.83 Q32.1033 1133.7 34.557 1133.12 Q37.0107 1132.54 39.0477 1132.54 Q44.4181 1132.54 47.6125 1135.23 Q50.8069 1137.91 50.8069 1142.4 Q50.8069 1144.53 49.9968 1146.45 Q49.2097 1148.35 47.1033 1150.94 Q46.5246 1151.61 43.4227 1154.83 Q40.3209 1158.03 34.6728 1163.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-54.7249 891.732 L-25.0491 891.732 L-25.0491 895.667 L-54.7249 895.667 L-54.7249 891.732 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-4.95665 877.08 Q-8.56774 877.08 -10.3964 880.644 Q-12.202 884.186 -12.202 891.316 Q-12.202 898.422 -10.3964 901.987 Q-8.56774 905.529 -4.95665 905.529 Q-1.32241 905.529 0.483137 901.987 Q2.31183 898.422 2.31183 891.316 Q2.31183 884.186 0.483137 880.644 Q-1.32241 877.08 -4.95665 877.08 M-4.95665 873.376 Q0.853506 873.376 3.90904 877.982 Q6.98773 882.566 6.98773 891.316 Q6.98773 900.042 3.90904 904.649 Q0.853506 909.232 -4.95665 909.232 Q-10.7668 909.232 -13.8455 904.649 Q-16.901 900.042 -16.901 891.316 Q-16.901 882.566 -13.8455 877.982 Q-10.7668 873.376 -4.95665 873.376 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M15.2053 902.681 L20.0895 902.681 L20.0895 908.561 L15.2053 908.561 L15.2053 902.681 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M31.0848 904.626 L38.7237 904.626 L38.7237 878.26 L30.4135 879.927 L30.4135 875.668 L38.6774 874.001 L43.3533 874.001 L43.3533 904.626 L50.9921 904.626 L50.9921 908.561 L31.0848 908.561 L31.0848 904.626 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-6.18349 617.915 Q-9.79459 617.915 -11.6233 621.48 Q-13.4288 625.021 -13.4288 632.151 Q-13.4288 639.257 -11.6233 642.822 Q-9.79459 646.364 -6.18349 646.364 Q-2.54925 646.364 -0.743708 642.822 Q1.08499 639.257 1.08499 632.151 Q1.08499 625.021 -0.743708 621.48 Q-2.54925 617.915 -6.18349 617.915 M-6.18349 614.211 Q-0.37334 614.211 2.6822 618.818 Q5.76089 623.401 5.76089 632.151 Q5.76089 640.878 2.6822 645.484 Q-0.37334 650.067 -6.18349 650.067 Q-11.9936 650.067 -15.0723 645.484 Q-18.1279 640.878 -18.1279 632.151 Q-18.1279 623.401 -15.0723 618.818 Q-11.9936 614.211 -6.18349 614.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M13.9784 643.517 L18.8627 643.517 L18.8627 649.396 L13.9784 649.396 L13.9784 643.517 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M39.0477 617.915 Q35.4367 617.915 33.608 621.48 Q31.8024 625.021 31.8024 632.151 Q31.8024 639.257 33.608 642.822 Q35.4367 646.364 39.0477 646.364 Q42.682 646.364 44.4875 642.822 Q46.3162 639.257 46.3162 632.151 Q46.3162 625.021 44.4875 621.48 Q42.682 617.915 39.0477 617.915 M39.0477 614.211 Q44.8579 614.211 47.9134 618.818 Q50.9921 623.401 50.9921 632.151 Q50.9921 640.878 47.9134 645.484 Q44.8579 650.067 39.0477 650.067 Q33.2376 650.067 30.1589 645.484 Q27.1034 640.878 27.1034 632.151 Q27.1034 623.401 30.1589 618.818 Q33.2376 614.211 39.0477 614.211 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-4.95665 358.75 Q-8.56774 358.75 -10.3964 362.315 Q-12.202 365.857 -12.202 372.986 Q-12.202 380.093 -10.3964 383.657 Q-8.56774 387.199 -4.95665 387.199 Q-1.32241 387.199 0.483137 383.657 Q2.31183 380.093 2.31183 372.986 Q2.31183 365.857 0.483137 362.315 Q-1.32241 358.75 -4.95665 358.75 M-4.95665 355.046 Q0.853506 355.046 3.90904 359.653 Q6.98773 364.236 6.98773 372.986 Q6.98773 381.713 3.90904 386.319 Q0.853506 390.903 -4.95665 390.903 Q-10.7668 390.903 -13.8455 386.319 Q-16.901 381.713 -16.901 372.986 Q-16.901 364.236 -13.8455 359.653 Q-10.7668 355.046 -4.95665 355.046 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M15.2053 384.352 L20.0895 384.352 L20.0895 390.231 L15.2053 390.231 L15.2053 384.352 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M31.0848 386.296 L38.7237 386.296 L38.7237 359.931 L30.4135 361.597 L30.4135 357.338 L38.6774 355.671 L43.3533 355.671 L43.3533 386.296 L50.9921 386.296 L50.9921 390.231 L31.0848 390.231 L31.0848 386.296 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-4.58628 99.5854 Q-8.19737 99.5854 -10.0261 103.15 Q-11.8316 106.692 -11.8316 113.821 Q-11.8316 120.928 -10.0261 124.493 Q-8.19737 128.034 -4.58628 128.034 Q-0.95204 128.034 0.853506 124.493 Q2.6822 120.928 2.6822 113.821 Q2.6822 106.692 0.853506 103.15 Q-0.95204 99.5854 -4.58628 99.5854 M-4.58628 95.8818 Q1.22387 95.8818 4.27941 100.488 Q7.3581 105.072 7.3581 113.821 Q7.3581 122.548 4.27941 127.155 Q1.22387 131.738 -4.58628 131.738 Q-10.3964 131.738 -13.4751 127.155 Q-16.5307 122.548 -16.5307 113.821 Q-16.5307 105.072 -13.4751 100.488 Q-10.3964 95.8818 -4.58628 95.8818 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M15.5756 125.187 L20.4599 125.187 L20.4599 131.067 L15.5756 131.067 L15.5756 125.187 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip300)" d="M34.6728 127.132 L50.9921 127.132 L50.9921 131.067 L29.0478 131.067 L29.0478 127.132 Q31.7098 124.377 36.2931 119.747 Q40.8996 115.095 42.0801 113.752 Q44.3255 111.229 45.2051 109.493 Q46.1079 107.734 46.1079 106.044 Q46.1079 103.289 44.1635 101.553 Q42.2422 99.8169 39.1403 99.8169 Q36.9413 99.8169 34.4876 100.581 Q32.057 101.345 29.2793 102.896 L29.2793 98.1734 Q32.1033 97.0392 34.557 96.4605 Q37.0107 95.8818 39.0477 95.8818 Q44.4181 95.8818 47.6125 98.5669 Q50.8069 101.252 50.8069 105.743 Q50.8069 107.872 49.9968 109.794 Q49.2097 111.692 47.1033 114.284 Q46.5246 114.956 43.4227 118.173 Q40.3209 121.368 34.6728 127.132 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip302)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,632.116 162.518,632.319 238.043,313.258 313.569,88.5087 389.094,243.725 464.619,496.785 540.145,719.007 615.67,694.443 691.196,518.071 766.721,586.831 842.247,563.328 917.772,363.244 993.298,302.368 1068.82,538.209 1144.35,735.61 1219.87,745.525 1295.4,922.382 1370.92,1018.03 1446.45,879.856 1521.98,1013.55 1597.5,998.431 1673.03,699.7 1748.55,951.496 1824.08,1113.92 1899.6,1157.65 1975.13,1318.98 2050.65,1230.27 2126.18,1191.86 2201.7,1332.36 2277.23,1349.18 2352.76,1464 "/>
<polyline clip-path="url(#clip302)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,632.116 162.518,581.13 238.043,593.601 313.569,652.767 389.094,669.984 464.619,667.053 540.145,628.823 615.67,604.282 691.196,642.269 766.721,627.932 842.247,599.473 917.772,620.137 993.298,667.659 1068.82,663.343 1144.35,634.519 1219.87,661.709 1295.4,649.935 1370.92,612.947 1446.45,655.779 1521.98,632.72 1597.5,587.176 1673.03,673.589 1748.55,661.059 1824.08,643.065 1899.6,662.588 1975.13,623.298 2050.65,630.705 2126.18,659.464 2201.7,640.476 2277.23,656.57 2352.76,614.897 "/>
<path clip-path="url(#clip300)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip300)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip300)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip300)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip300)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 1.96733  1.09267  -1.09405  -1.30178  …  -0.11151  -0.879037  0.853115</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip360">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip360)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip361">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip360)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip362">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip360)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1332.29 2352.76,1332.29 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1140.9 2352.76,1140.9 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,949.498 2352.76,949.498 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,758.1 2352.76,758.1 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,566.702 2352.76,566.702 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,375.304 2352.76,375.304 "/>
<polyline clip-path="url(#clip362)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,183.906 2352.76,183.906 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1332.29 105.89,1332.29 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1140.9 105.89,1140.9 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,949.498 105.89,949.498 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,758.1 105.89,758.1 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,566.702 105.89,566.702 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,375.304 105.89,375.304 "/>
<polyline clip-path="url(#clip360)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,183.906 105.89,183.906 "/>
<path clip-path="url(#clip360)" d="M-54.9564 1332.75 L-25.2806 1332.75 L-25.2806 1336.68 L-54.9564 1336.68 L-54.9564 1332.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-11.1603 1345.64 L5.15904 1345.64 L5.15904 1349.57 L-16.7853 1349.57 L-16.7853 1345.64 Q-14.1233 1342.88 -9.53996 1338.25 Q-4.9335 1333.6 -3.75295 1332.26 Q-1.50759 1329.74 -0.627968 1328 Q0.274805 1326.24 0.274805 1324.55 Q0.274805 1321.8 -1.66963 1320.06 Q-3.59091 1318.32 -6.69275 1318.32 Q-8.89181 1318.32 -11.3455 1319.09 Q-13.776 1319.85 -16.5538 1321.4 L-16.5538 1316.68 Q-13.7297 1315.55 -11.2761 1314.97 Q-8.82237 1314.39 -6.78534 1314.39 Q-1.415 1314.39 1.77943 1317.07 Q4.97385 1319.76 4.97385 1324.25 Q4.97385 1326.38 4.16367 1328.3 Q3.37664 1330.2 1.27017 1332.79 Q0.69147 1333.46 -2.41037 1336.68 Q-5.5122 1339.88 -11.1603 1345.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M14.9738 1343.69 L19.858 1343.69 L19.858 1349.57 L14.9738 1349.57 L14.9738 1343.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M30.0895 1315.01 L48.4458 1315.01 L48.4458 1318.95 L34.3718 1318.95 L34.3718 1327.42 Q35.3904 1327.07 36.4089 1326.91 Q37.4274 1326.73 38.4459 1326.73 Q44.2329 1326.73 47.6125 1329.9 Q50.9921 1333.07 50.9921 1338.49 Q50.9921 1344.07 47.5199 1347.17 Q44.0477 1350.25 37.7283 1350.25 Q35.5524 1350.25 33.2839 1349.88 Q31.0385 1349.5 28.6311 1348.76 L28.6311 1344.07 Q30.7145 1345.2 32.9367 1345.75 Q35.1589 1346.31 37.6357 1346.31 Q41.6403 1346.31 43.9783 1344.2 Q46.3162 1342.1 46.3162 1338.49 Q46.3162 1334.88 43.9783 1332.77 Q41.6403 1330.66 37.6357 1330.66 Q35.7607 1330.66 33.8857 1331.08 Q32.0339 1331.5 30.0895 1332.38 L30.0895 1315.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-6.18349 1126.69 Q-9.79459 1126.69 -11.6233 1130.26 Q-13.4288 1133.8 -13.4288 1140.93 Q-13.4288 1148.04 -11.6233 1151.6 Q-9.79459 1155.14 -6.18349 1155.14 Q-2.54925 1155.14 -0.743708 1151.6 Q1.08499 1148.04 1.08499 1140.93 Q1.08499 1133.8 -0.743708 1130.26 Q-2.54925 1126.69 -6.18349 1126.69 M-6.18349 1122.99 Q-0.37334 1122.99 2.6822 1127.6 Q5.76089 1132.18 5.76089 1140.93 Q5.76089 1149.66 2.6822 1154.26 Q-0.37334 1158.85 -6.18349 1158.85 Q-11.9936 1158.85 -15.0723 1154.26 Q-18.1279 1149.66 -18.1279 1140.93 Q-18.1279 1132.18 -15.0723 1127.6 Q-11.9936 1122.99 -6.18349 1122.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M13.9784 1152.3 L18.8627 1152.3 L18.8627 1158.18 L13.9784 1158.18 L13.9784 1152.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M39.0477 1126.69 Q35.4367 1126.69 33.608 1130.26 Q31.8024 1133.8 31.8024 1140.93 Q31.8024 1148.04 33.608 1151.6 Q35.4367 1155.14 39.0477 1155.14 Q42.682 1155.14 44.4875 1151.6 Q46.3162 1148.04 46.3162 1140.93 Q46.3162 1133.8 44.4875 1130.26 Q42.682 1126.69 39.0477 1126.69 M39.0477 1122.99 Q44.8579 1122.99 47.9134 1127.6 Q50.9921 1132.18 50.9921 1140.93 Q50.9921 1149.66 47.9134 1154.26 Q44.8579 1158.85 39.0477 1158.85 Q33.2376 1158.85 30.1589 1154.26 Q27.1034 1149.66 27.1034 1140.93 Q27.1034 1132.18 30.1589 1127.6 Q33.2376 1122.99 39.0477 1122.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-11.1603 962.843 L5.15904 962.843 L5.15904 966.778 L-16.7853 966.778 L-16.7853 962.843 Q-14.1233 960.088 -9.53996 955.459 Q-4.9335 950.806 -3.75295 949.464 Q-1.50759 946.94 -0.627968 945.204 Q0.274805 943.445 0.274805 941.755 Q0.274805 939.001 -1.66963 937.265 Q-3.59091 935.528 -6.69275 935.528 Q-8.89181 935.528 -11.3455 936.292 Q-13.776 937.056 -16.5538 938.607 L-16.5538 933.885 Q-13.7297 932.751 -11.2761 932.172 Q-8.82237 931.593 -6.78534 931.593 Q-1.415 931.593 1.77943 934.278 Q4.97385 936.964 4.97385 941.454 Q4.97385 943.584 4.16367 945.505 Q3.37664 947.403 1.27017 949.996 Q0.69147 950.667 -2.41037 953.885 Q-5.5122 957.079 -11.1603 962.843 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M14.9738 960.899 L19.858 960.899 L19.858 966.778 L14.9738 966.778 L14.9738 960.899 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M30.0895 932.218 L48.4458 932.218 L48.4458 936.153 L34.3718 936.153 L34.3718 944.626 Q35.3904 944.278 36.4089 944.116 Q37.4274 943.931 38.4459 943.931 Q44.2329 943.931 47.6125 947.102 Q50.9921 950.274 50.9921 955.69 Q50.9921 961.269 47.5199 964.371 Q44.0477 967.45 37.7283 967.45 Q35.5524 967.45 33.2839 967.079 Q31.0385 966.709 28.6311 965.968 L28.6311 961.269 Q30.7145 962.403 32.9367 962.959 Q35.1589 963.514 37.6357 963.514 Q41.6403 963.514 43.9783 961.408 Q46.3162 959.301 46.3162 955.69 Q46.3162 952.079 43.9783 949.973 Q41.6403 947.866 37.6357 947.866 Q35.7607 947.866 33.8857 948.283 Q32.0339 948.7 30.0895 949.579 L30.0895 932.218 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-16.1371 740.82 L2.21924 740.82 L2.21924 744.755 L-11.8548 744.755 L-11.8548 753.228 Q-10.8362 752.88 -9.81773 752.718 Q-8.79922 752.533 -7.78071 752.533 Q-1.9937 752.533 1.38591 755.704 Q4.76552 758.876 4.76552 764.292 Q4.76552 769.871 1.29332 772.973 Q-2.17889 776.051 -8.4983 776.051 Q-10.6742 776.051 -12.9427 775.681 Q-15.1881 775.311 -17.5955 774.57 L-17.5955 769.871 Q-15.5121 771.005 -13.2899 771.561 Q-11.0677 772.116 -8.59089 772.116 Q-4.58628 772.116 -2.24833 770.01 Q0.089621 767.903 0.089621 764.292 Q0.089621 760.681 -2.24833 758.575 Q-4.58628 756.468 -8.59089 756.468 Q-10.4659 756.468 -12.3409 756.885 Q-14.1927 757.302 -16.1371 758.181 L-16.1371 740.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M13.9784 769.501 L18.8627 769.501 L18.8627 775.38 L13.9784 775.38 L13.9784 769.501 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M39.0477 743.899 Q35.4367 743.899 33.608 747.464 Q31.8024 751.005 31.8024 758.135 Q31.8024 765.241 33.608 768.806 Q35.4367 772.348 39.0477 772.348 Q42.682 772.348 44.4875 768.806 Q46.3162 765.241 46.3162 758.135 Q46.3162 751.005 44.4875 747.464 Q42.682 743.899 39.0477 743.899 M39.0477 740.195 Q44.8579 740.195 47.9134 744.802 Q50.9921 749.385 50.9921 758.135 Q50.9921 766.862 47.9134 771.468 Q44.8579 776.051 39.0477 776.051 Q33.2376 776.051 30.1589 771.468 Q27.1034 766.862 27.1034 758.135 Q27.1034 749.385 30.1589 744.802 Q33.2376 740.195 39.0477 740.195 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-16.3686 549.422 L5.85348 549.422 L5.85348 551.413 L-6.69275 583.982 L-11.577 583.982 L0.228509 553.357 L-16.3686 553.357 L-16.3686 549.422 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M14.9738 578.103 L19.858 578.103 L19.858 583.982 L14.9738 583.982 L14.9738 578.103 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M30.0895 549.422 L48.4458 549.422 L48.4458 553.357 L34.3718 553.357 L34.3718 561.829 Q35.3904 561.482 36.4089 561.32 Q37.4274 561.135 38.4459 561.135 Q44.2329 561.135 47.6125 564.306 Q50.9921 567.478 50.9921 572.894 Q50.9921 578.473 47.5199 581.575 Q44.0477 584.653 37.7283 584.653 Q35.5524 584.653 33.2839 584.283 Q31.0385 583.913 28.6311 583.172 L28.6311 578.473 Q30.7145 579.607 32.9367 580.163 Q35.1589 580.718 37.6357 580.718 Q41.6403 580.718 43.9783 578.612 Q46.3162 576.505 46.3162 572.894 Q46.3162 569.283 43.9783 567.177 Q41.6403 565.07 37.6357 565.07 Q35.7607 565.07 33.8857 565.487 Q32.0339 565.904 30.0895 566.783 L30.0895 549.422 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-45.5351 388.649 L-37.8963 388.649 L-37.8963 362.283 L-46.2064 363.95 L-46.2064 359.691 L-37.9426 358.024 L-33.2667 358.024 L-33.2667 388.649 L-25.6278 388.649 L-25.6278 392.584 L-45.5351 392.584 L-45.5351 388.649 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-6.18349 361.103 Q-9.79459 361.103 -11.6233 364.668 Q-13.4288 368.209 -13.4288 375.339 Q-13.4288 382.445 -11.6233 386.01 Q-9.79459 389.552 -6.18349 389.552 Q-2.54925 389.552 -0.743708 386.01 Q1.08499 382.445 1.08499 375.339 Q1.08499 368.209 -0.743708 364.668 Q-2.54925 361.103 -6.18349 361.103 M-6.18349 357.399 Q-0.37334 357.399 2.6822 362.006 Q5.76089 366.589 5.76089 375.339 Q5.76089 384.066 2.6822 388.672 Q-0.37334 393.255 -6.18349 393.255 Q-11.9936 393.255 -15.0723 388.672 Q-18.1279 384.066 -18.1279 375.339 Q-18.1279 366.589 -15.0723 362.006 Q-11.9936 357.399 -6.18349 357.399 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M13.9784 386.704 L18.8627 386.704 L18.8627 392.584 L13.9784 392.584 L13.9784 386.704 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M39.0477 361.103 Q35.4367 361.103 33.608 364.668 Q31.8024 368.209 31.8024 375.339 Q31.8024 382.445 33.608 386.01 Q35.4367 389.552 39.0477 389.552 Q42.682 389.552 44.4875 386.01 Q46.3162 382.445 46.3162 375.339 Q46.3162 368.209 44.4875 364.668 Q42.682 361.103 39.0477 361.103 M39.0477 357.399 Q44.8579 357.399 47.9134 362.006 Q50.9921 366.589 50.9921 375.339 Q50.9921 384.066 47.9134 388.672 Q44.8579 393.255 39.0477 393.255 Q33.2376 393.255 30.1589 388.672 Q27.1034 384.066 27.1034 375.339 Q27.1034 366.589 30.1589 362.006 Q33.2376 357.399 39.0477 357.399 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-44.5398 197.251 L-36.9009 197.251 L-36.9009 170.885 L-45.2111 172.552 L-45.2111 168.293 L-36.9472 166.626 L-32.2713 166.626 L-32.2713 197.251 L-24.6325 197.251 L-24.6325 201.186 L-44.5398 201.186 L-44.5398 197.251 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M-11.1603 197.251 L5.15904 197.251 L5.15904 201.186 L-16.7853 201.186 L-16.7853 197.251 Q-14.1233 194.496 -9.53996 189.867 Q-4.9335 185.214 -3.75295 183.871 Q-1.50759 181.348 -0.627968 179.612 Q0.274805 177.853 0.274805 176.163 Q0.274805 173.408 -1.66963 171.672 Q-3.59091 169.936 -6.69275 169.936 Q-8.89181 169.936 -11.3455 170.7 Q-13.776 171.464 -16.5538 173.015 L-16.5538 168.293 Q-13.7297 167.158 -11.2761 166.58 Q-8.82237 166.001 -6.78534 166.001 Q-1.415 166.001 1.77943 168.686 Q4.97385 171.371 4.97385 175.862 Q4.97385 177.992 4.16367 179.913 Q3.37664 181.811 1.27017 184.404 Q0.69147 185.075 -2.41037 188.293 Q-5.5122 191.487 -11.1603 197.251 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M14.9738 195.306 L19.858 195.306 L19.858 201.186 L14.9738 201.186 L14.9738 195.306 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip360)" d="M30.0895 166.626 L48.4458 166.626 L48.4458 170.561 L34.3718 170.561 L34.3718 179.033 Q35.3904 178.686 36.4089 178.524 Q37.4274 178.339 38.4459 178.339 Q44.2329 178.339 47.6125 181.51 Q50.9921 184.681 50.9921 190.098 Q50.9921 195.677 47.5199 198.779 Q44.0477 201.857 37.7283 201.857 Q35.5524 201.857 33.2839 201.487 Q31.0385 201.117 28.6311 200.376 L28.6311 195.677 Q30.7145 196.811 32.9367 197.367 Q35.1589 197.922 37.6357 197.922 Q41.6403 197.922 43.9783 195.816 Q46.3162 193.709 46.3162 190.098 Q46.3162 186.487 43.9783 184.381 Q41.6403 182.274 37.6357 182.274 Q35.7607 182.274 33.8857 182.691 Q32.0339 183.107 30.0895 183.987 L30.0895 166.626 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip362)" d="M151.118 1265.46 L222.368 1416.58 L293.618 1478.08 L364.869 1479.3 L436.119 1470.72 L507.37 1460.86 L578.62 1445.17 L649.871 1429.05 L721.121 1417.01 L792.371 1402.98 L863.622 1386.23 L934.872 1375.89 L1006.12 1365.83 L1077.37 1359.75 L1148.62 1347.28 L1219.87 1337.35 L1291.12 1329.93 L1362.37 1323.59 L1433.63 1317.09 L1504.88 1313.98 L1576.13 1310.86 L1647.38 1298.68 L1718.63 1291.1 L1789.88 1285.25 L1861.13 1276.3 L1932.38 1267.92 L2003.63 1265.53 L2074.88 1258.89 L2146.13 1256.56 L2217.38 1252.04 L2288.63 1245.81 L2288.63 868.914 L2217.38 853.714 L2146.13 839.983 L2074.88 824.104 L2003.63 811.631 L1932.38 800.03 L1861.13 785.637 L1789.88 769.237 L1718.63 749.211 L1647.38 730.61 L1576.13 708.155 L1504.88 678.843 L1433.63 651.495 L1362.37 626.641 L1291.12 598.736 L1219.87 574.561 L1148.62 549.476 L1077.37 515.297 L1006.12 475.252 L934.872 438.924 L863.622 408.606 L792.371 373.709 L721.121 333.584 L649.871 293.594 L578.62 255.56 L507.37 210.331 L436.119 162.161 L364.869 118.373 L293.618 88.9544 L222.368 179.923 L151.118 1016.07  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip362)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1130.39 222.368,1052.85 293.618,1042.87 364.869,1050.1 436.119,1052.14 507.37,1044.86 578.62,1044.85 649.871,1048.07 721.121,1056.36 792.371,1065.36 863.622,1070.45 934.872,1076.24 1006.12,1080.53 1077.37,1083.53 1148.62,1087.39 1219.87,1088.68 1291.12,1090.94 1362.37,1095.61 1433.63,1101.72 1504.88,1101.99 1576.13,1100.85 1647.38,1102.7 1718.63,1102.78 1789.88,1105.75 1861.13,1110.46 1932.38,1109.49 2003.63,1113.86 2074.88,1113.75 2146.13,1115.5 2217.38,1116.27 2288.63,1121.08 "/>
<path clip-path="url(#clip362)" d="M151.118 1255.73 L222.368 1163.68 L293.618 1146.12 L364.869 1142.53 L436.119 1142.21 L507.37 1142.06 L578.62 1141.78 L649.871 1141.83 L721.121 1141.98 L792.371 1141.9 L863.622 1141.78 L934.872 1141.92 L1006.12 1142.07 L1077.37 1142.28 L1148.62 1141.89 L1219.87 1142.41 L1291.12 1142.12 L1362.37 1142.14 L1433.63 1142.16 L1504.88 1142.17 L1576.13 1141.75 L1647.38 1141.95 L1718.63 1142.19 L1789.88 1142.42 L1861.13 1142.46 L1932.38 1142.32 L2003.63 1142.21 L2074.88 1142.35 L2146.13 1142.06 L2217.38 1141.73 L2288.63 1142.19 L2288.63 1140.06 L2217.38 1139.78 L2146.13 1139.56 L2074.88 1139.78 L2003.63 1139.95 L1932.38 1139.83 L1861.13 1139.78 L1789.88 1140.06 L1718.63 1139.39 L1647.38 1139.79 L1576.13 1139.53 L1504.88 1139.47 L1433.63 1139.46 L1362.37 1139.78 L1291.12 1140.07 L1219.87 1139.48 L1148.62 1139.34 L1077.37 1139.9 L1006.12 1139.81 L934.872 1139.59 L863.622 1139.67 L792.371 1139.68 L721.121 1139.44 L649.871 1139.58 L578.62 1139.62 L507.37 1139.56 L436.119 1139.05 L364.869 1139.59 L293.618 1136.92 L222.368 1121.19 L151.118 1041.65  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip362)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1138.66 222.368,1139.31 293.618,1140.8 364.869,1140.88 436.119,1140.91 507.37,1140.76 578.62,1140.67 649.871,1140.72 721.121,1140.76 792.371,1140.99 863.622,1140.89 934.872,1140.97 1006.12,1140.89 1077.37,1140.89 1148.62,1141.09 1219.87,1140.99 1291.12,1141.15 1362.37,1141.02 1433.63,1140.94 1504.88,1140.84 1576.13,1140.76 1647.38,1140.74 1718.63,1140.73 1789.88,1140.75 1861.13,1140.87 1932.38,1140.95 2003.63,1140.86 2074.88,1140.98 2146.13,1140.78 2217.38,1141.07 2288.63,1140.91 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">45.33284412782492</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-1134.0646019081664, -8198.797741395783], [25.048205984578875 1.4407797179824762; 133.3918601968538 9.91204410611471], [-18.041564419011692 0.08414894289357368; -122.53248451323716 0.7005038951352855;;; 0.08414894289357368 -0.1258860642189523; 0.7005038951352855 -0.8861360519583631], [164.7515829943846; 796.9678593317777;;], [25.489900543280527, -116.45133081915952], [7.177614681997612 -0.2778118634587716; 7.977890650313278 0.6004242326547168], [-0.0485148138244863 0.03336768431274316; -2.9864451181429676 -0.10712242291605206;;; 0.03336768431274316 0.007872411368295322; -0.10712242291605206 -0.012536114224529974], [-4.072763635432113 -3.5364394900594767 … 0.14026172731759712 -0.0145623525269405])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 24 September 2023 17:09">Sunday 24 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
