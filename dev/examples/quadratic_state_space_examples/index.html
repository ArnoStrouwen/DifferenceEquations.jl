<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.0031188209018396533]
 [0.019214539867663156, 0.0014608126896893266]
 [0.027241108791241007, 0.019879586035641376]
 [0.15032741049372125, 0.006302580155207357]
 [0.18199204654857964, 0.0038612477462011373]
 [0.1968411197815396, 0.007423433372193734]
 [0.23320883712774523, 0.0037210556254619275]
 [0.2446314442051331, 0.0021110337986629674]
 [0.24544676511982372, 0.005295462638399468]
 ⋮
 [0.20700061670375125, -0.012082373637634664]
 [0.1219438921086004, -0.017492689809378927]
 [0.00812815076980719, -0.016976965116233485]
 [-0.09671706896253124, -0.008000036644878472]
 [-0.14130704768331634, -0.0030063313850291476]
 [-0.15290567262836183, 0.0027241532270029945]
 [-0.12845938753757252, 0.019306453561931995]
 [-0.0014237671230508183, 0.018816324257590406]
 [0.11633083768696778, 0.007541521586369702]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip310">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip310)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip311">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip310)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip312">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip310)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1290.32 2352.76,1290.32 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,962.035 2352.76,962.035 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,633.754 2352.76,633.754 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,305.473 2352.76,305.473 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1290.32 105.89,1290.32 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,962.035 105.89,962.035 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,633.754 105.89,633.754 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,305.473 105.89,305.473 "/>
<path clip-path="url(#clip310)" d="M-54.7249 1290.77 L-25.0491 1290.77 L-25.0491 1294.7 L-54.7249 1294.7 L-54.7249 1290.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M-4.95665 1276.11 Q-8.56774 1276.11 -10.3964 1279.68 Q-12.202 1283.22 -12.202 1290.35 Q-12.202 1297.46 -10.3964 1301.02 Q-8.56774 1304.56 -4.95665 1304.56 Q-1.32241 1304.56 0.483137 1301.02 Q2.31183 1297.46 2.31183 1290.35 Q2.31183 1283.22 0.483137 1279.68 Q-1.32241 1276.11 -4.95665 1276.11 M-4.95665 1272.41 Q0.853506 1272.41 3.90904 1277.02 Q6.98773 1281.6 6.98773 1290.35 Q6.98773 1299.08 3.90904 1303.68 Q0.853506 1308.27 -4.95665 1308.27 Q-10.7668 1308.27 -13.8455 1303.68 Q-16.901 1299.08 -16.901 1290.35 Q-16.901 1281.6 -13.8455 1277.02 Q-10.7668 1272.41 -4.95665 1272.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M15.2053 1301.72 L20.0895 1301.72 L20.0895 1307.6 L15.2053 1307.6 L15.2053 1301.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M31.0848 1303.66 L38.7237 1303.66 L38.7237 1277.3 L30.4135 1278.96 L30.4135 1274.7 L38.6774 1273.04 L43.3533 1273.04 L43.3533 1303.66 L50.9921 1303.66 L50.9921 1307.6 L31.0848 1307.6 L31.0848 1303.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M-6.18349 947.834 Q-9.79459 947.834 -11.6233 951.399 Q-13.4288 954.94 -13.4288 962.07 Q-13.4288 969.176 -11.6233 972.741 Q-9.79459 976.283 -6.18349 976.283 Q-2.54925 976.283 -0.743708 972.741 Q1.08499 969.176 1.08499 962.07 Q1.08499 954.94 -0.743708 951.399 Q-2.54925 947.834 -6.18349 947.834 M-6.18349 944.13 Q-0.37334 944.13 2.6822 948.736 Q5.76089 953.32 5.76089 962.07 Q5.76089 970.797 2.6822 975.403 Q-0.37334 979.986 -6.18349 979.986 Q-11.9936 979.986 -15.0723 975.403 Q-18.1279 970.797 -18.1279 962.07 Q-18.1279 953.32 -15.0723 948.736 Q-11.9936 944.13 -6.18349 944.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M13.9784 973.435 L18.8627 973.435 L18.8627 979.315 L13.9784 979.315 L13.9784 973.435 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M39.0477 947.834 Q35.4367 947.834 33.608 951.399 Q31.8024 954.94 31.8024 962.07 Q31.8024 969.176 33.608 972.741 Q35.4367 976.283 39.0477 976.283 Q42.682 976.283 44.4875 972.741 Q46.3162 969.176 46.3162 962.07 Q46.3162 954.94 44.4875 951.399 Q42.682 947.834 39.0477 947.834 M39.0477 944.13 Q44.8579 944.13 47.9134 948.736 Q50.9921 953.32 50.9921 962.07 Q50.9921 970.797 47.9134 975.403 Q44.8579 979.986 39.0477 979.986 Q33.2376 979.986 30.1589 975.403 Q27.1034 970.797 27.1034 962.07 Q27.1034 953.32 30.1589 948.736 Q33.2376 944.13 39.0477 944.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M-4.95665 619.553 Q-8.56774 619.553 -10.3964 623.118 Q-12.202 626.659 -12.202 633.789 Q-12.202 640.895 -10.3964 644.46 Q-8.56774 648.002 -4.95665 648.002 Q-1.32241 648.002 0.483137 644.46 Q2.31183 640.895 2.31183 633.789 Q2.31183 626.659 0.483137 623.118 Q-1.32241 619.553 -4.95665 619.553 M-4.95665 615.849 Q0.853506 615.849 3.90904 620.456 Q6.98773 625.039 6.98773 633.789 Q6.98773 642.516 3.90904 647.122 Q0.853506 651.705 -4.95665 651.705 Q-10.7668 651.705 -13.8455 647.122 Q-16.901 642.516 -16.901 633.789 Q-16.901 625.039 -13.8455 620.456 Q-10.7668 615.849 -4.95665 615.849 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M15.2053 645.154 L20.0895 645.154 L20.0895 651.034 L15.2053 651.034 L15.2053 645.154 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M31.0848 647.099 L38.7237 647.099 L38.7237 620.733 L30.4135 622.4 L30.4135 618.141 L38.6774 616.474 L43.3533 616.474 L43.3533 647.099 L50.9921 647.099 L50.9921 651.034 L31.0848 651.034 L31.0848 647.099 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M-4.58628 291.272 Q-8.19737 291.272 -10.0261 294.837 Q-11.8316 298.378 -11.8316 305.508 Q-11.8316 312.614 -10.0261 316.179 Q-8.19737 319.721 -4.58628 319.721 Q-0.95204 319.721 0.853506 316.179 Q2.6822 312.614 2.6822 305.508 Q2.6822 298.378 0.853506 294.837 Q-0.95204 291.272 -4.58628 291.272 M-4.58628 287.568 Q1.22387 287.568 4.27941 292.175 Q7.3581 296.758 7.3581 305.508 Q7.3581 314.235 4.27941 318.841 Q1.22387 323.424 -4.58628 323.424 Q-10.3964 323.424 -13.4751 318.841 Q-16.5307 314.235 -16.5307 305.508 Q-16.5307 296.758 -13.4751 292.175 Q-10.3964 287.568 -4.58628 287.568 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M15.5756 316.874 L20.4599 316.874 L20.4599 322.753 L15.5756 322.753 L15.5756 316.874 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M34.6728 318.818 L50.9921 318.818 L50.9921 322.753 L29.0478 322.753 L29.0478 318.818 Q31.7098 316.063 36.2931 311.434 Q40.8996 306.781 42.0801 305.438 Q44.3255 302.915 45.2051 301.179 Q46.1079 299.42 46.1079 297.73 Q46.1079 294.975 44.1635 293.239 Q42.2422 291.503 39.1403 291.503 Q36.9413 291.503 34.4876 292.267 Q32.057 293.031 29.2793 294.582 L29.2793 289.86 Q32.1033 288.726 34.557 288.147 Q37.0107 287.568 39.0477 287.568 Q44.4181 287.568 47.6125 290.253 Q50.8069 292.938 50.8069 297.429 Q50.8069 299.559 49.9968 301.48 Q49.2097 303.378 47.1033 305.971 Q46.5246 306.642 43.4227 309.86 Q40.3209 313.054 34.6728 318.818 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip312)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,962.035 162.518,962.292 238.043,898.957 313.569,872.608 389.094,468.539 464.619,364.59 540.145,315.843 615.67,196.455 691.196,158.957 766.721,156.28 842.247,88.5087 917.772,332.45 993.298,705.578 1068.82,912.449 1144.35,1080.17 1219.87,1199.43 1295.4,795.576 1370.92,496.783 1446.45,374.252 1521.98,607.888 1597.5,512.666 1673.03,428.29 1748.55,282.491 1824.08,561.716 1899.6,935.352 1975.13,1279.54 2050.65,1425.92 2126.18,1464 2201.7,1383.74 2277.23,966.709 2352.76,580.143 "/>
<polyline clip-path="url(#clip312)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,962.035 162.518,951.797 238.043,957.239 313.569,896.774 389.094,941.345 464.619,949.359 540.145,937.665 615.67,949.82 691.196,955.105 766.721,944.651 842.247,994.354 917.772,1017.45 993.298,993.416 1068.82,988.751 1144.35,982.253 1219.87,899.324 1295.4,912.856 1370.92,938.596 1446.45,995.038 1521.98,943.85 1597.5,944.829 1673.03,934.337 1748.55,1001.7 1824.08,1019.46 1899.6,1017.77 1975.13,988.298 2050.65,971.904 2126.18,953.092 2201.7,898.656 2277.23,900.265 2352.76,937.278 "/>
<path clip-path="url(#clip310)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip310)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip310)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip310)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip310)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.311882  0.0837049  1.95874  …  0.332542  1.87616  1.4955  0.377826</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip370">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip370)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip371">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip370)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip372">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip370)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1511.5 2352.76,1511.5 "/>
<polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1089.16 2352.76,1089.16 "/>
<polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,666.824 2352.76,666.824 "/>
<polyline clip-path="url(#clip372)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,244.484 2352.76,244.484 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1511.5 105.89,1511.5 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1089.16 105.89,1089.16 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,666.824 105.89,666.824 "/>
<polyline clip-path="url(#clip370)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,244.484 105.89,244.484 "/>
<path clip-path="url(#clip370)" d="M-9.72514 1511.96 L19.9506 1511.96 L19.9506 1515.89 L-9.72514 1515.89 L-9.72514 1511.96 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M30.0895 1494.22 L48.4458 1494.22 L48.4458 1498.16 L34.3718 1498.16 L34.3718 1506.63 Q35.3904 1506.28 36.4089 1506.12 Q37.4274 1505.94 38.4459 1505.94 Q44.2329 1505.94 47.6125 1509.11 Q50.9921 1512.28 50.9921 1517.7 Q50.9921 1523.27 47.5199 1526.38 Q44.0477 1529.46 37.7283 1529.46 Q35.5524 1529.46 33.2839 1529.08 Q31.0385 1528.71 28.6311 1527.97 L28.6311 1523.27 Q30.7145 1524.41 32.9367 1524.96 Q35.1589 1525.52 37.6357 1525.52 Q41.6403 1525.52 43.9783 1523.41 Q46.3162 1521.31 46.3162 1517.7 Q46.3162 1514.08 43.9783 1511.98 Q41.6403 1509.87 37.6357 1509.87 Q35.7607 1509.87 33.8857 1510.29 Q32.0339 1510.71 30.0895 1511.58 L30.0895 1494.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M39.0477 1074.96 Q35.4367 1074.96 33.608 1078.53 Q31.8024 1082.07 31.8024 1089.2 Q31.8024 1096.31 33.608 1099.87 Q35.4367 1103.41 39.0477 1103.41 Q42.682 1103.41 44.4875 1099.87 Q46.3162 1096.31 46.3162 1089.2 Q46.3162 1082.07 44.4875 1078.53 Q42.682 1074.96 39.0477 1074.96 M39.0477 1071.26 Q44.8579 1071.26 47.9134 1075.87 Q50.9921 1080.45 50.9921 1089.2 Q50.9921 1097.93 47.9134 1102.53 Q44.8579 1107.12 39.0477 1107.12 Q33.2376 1107.12 30.1589 1102.53 Q27.1034 1097.93 27.1034 1089.2 Q27.1034 1080.45 30.1589 1075.87 Q33.2376 1071.26 39.0477 1071.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M30.0895 649.544 L48.4458 649.544 L48.4458 653.479 L34.3718 653.479 L34.3718 661.951 Q35.3904 661.604 36.4089 661.442 Q37.4274 661.257 38.4459 661.257 Q44.2329 661.257 47.6125 664.428 Q50.9921 667.599 50.9921 673.016 Q50.9921 678.595 47.5199 681.697 Q44.0477 684.775 37.7283 684.775 Q35.5524 684.775 33.2839 684.405 Q31.0385 684.035 28.6311 683.294 L28.6311 678.595 Q30.7145 679.729 32.9367 680.285 Q35.1589 680.84 37.6357 680.84 Q41.6403 680.84 43.9783 678.734 Q46.3162 676.627 46.3162 673.016 Q46.3162 669.405 43.9783 667.298 Q41.6403 665.192 37.6357 665.192 Q35.7607 665.192 33.8857 665.609 Q32.0339 666.025 30.0895 666.905 L30.0895 649.544 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M-0.303895 257.829 L7.33495 257.829 L7.33495 231.463 L-0.975188 233.13 L-0.975188 228.871 L7.28866 227.204 L11.9646 227.204 L11.9646 257.829 L19.6034 257.829 L19.6034 261.764 L-0.303895 261.764 L-0.303895 257.829 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip370)" d="M39.0477 230.283 Q35.4367 230.283 33.608 233.847 Q31.8024 237.389 31.8024 244.519 Q31.8024 251.625 33.608 255.19 Q35.4367 258.732 39.0477 258.732 Q42.682 258.732 44.4875 255.19 Q46.3162 251.625 46.3162 244.519 Q46.3162 237.389 44.4875 233.847 Q42.682 230.283 39.0477 230.283 M39.0477 226.579 Q44.8579 226.579 47.9134 231.185 Q50.9921 235.769 50.9921 244.519 Q50.9921 253.245 47.9134 257.852 Q44.8579 262.435 39.0477 262.435 Q33.2376 262.435 30.1589 257.852 Q27.1034 253.245 27.1034 244.519 Q27.1034 235.769 30.1589 231.185 Q33.2376 226.579 39.0477 226.579 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip372)" d="M151.118 1229.5 L222.368 1398.81 L293.618 1479.3 L364.869 1478.95 L436.119 1462.27 L507.37 1445.93 L578.62 1431.38 L649.871 1420.54 L721.121 1407.29 L792.371 1391.51 L863.622 1383.77 L934.872 1374.1 L1006.12 1361.53 L1077.37 1349.05 L1148.62 1340.87 L1219.87 1327.86 L1291.12 1318.58 L1362.37 1304.38 L1433.63 1294.41 L1504.88 1282.6 L1576.13 1274.16 L1647.38 1267.9 L1718.63 1257.08 L1789.88 1251.9 L1861.13 1246.8 L1932.38 1231.34 L2003.63 1220.79 L2074.88 1210.31 L2146.13 1204.77 L2217.38 1201.82 L2288.63 1202.35 L2288.63 837.306 L2217.38 822.536 L2146.13 812.271 L2074.88 806.409 L2003.63 787.83 L1932.38 778.563 L1861.13 758.311 L1789.88 739.184 L1718.63 723.45 L1647.38 705.366 L1576.13 680.953 L1504.88 660.13 L1433.63 637.276 L1362.37 611.799 L1291.12 588.647 L1219.87 565.374 L1148.62 537.567 L1077.37 507.864 L1006.12 480.279 L934.872 452.137 L863.622 415 L792.371 376.464 L721.121 337.92 L649.871 293.099 L578.62 250.968 L507.37 204.375 L436.119 151.836 L364.869 115.394 L293.618 88.9544 L222.368 174.679 L151.118 948.77  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip372)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1070.5 222.368,1088.2 293.618,1110.38 364.869,1113.53 436.119,1111.79 507.37,1110.1 578.62,1110.25 649.871,1104.52 721.121,1100.32 792.371,1096.76 863.622,1089.01 934.872,1092.19 1006.12,1087.67 1077.37,1093.8 1148.62,1096.39 1219.87,1096.88 1291.12,1099.21 1362.37,1098.23 1433.63,1095.37 1504.88,1096.66 1576.13,1095.21 1647.38,1102.22 1718.63,1109.07 1789.88,1110.96 1861.13,1110.8 1932.38,1109.84 2003.63,1114.12 2074.88,1115.1 2146.13,1110.21 2217.38,1105.95 2288.63,1103.47 "/>
<path clip-path="url(#clip372)" d="M151.118 1244.56 L222.368 1120.34 L293.618 1096.08 L364.869 1090.8 L436.119 1090.94 L507.37 1090.26 L578.62 1090.38 L649.871 1090.2 L721.121 1090.4 L792.371 1090.89 L863.622 1090.56 L934.872 1090.63 L1006.12 1090.44 L1077.37 1090.53 L1148.62 1090.67 L1219.87 1090.24 L1291.12 1090.38 L1362.37 1090.71 L1433.63 1090.11 L1504.88 1090.17 L1576.13 1090.59 L1647.38 1090.35 L1718.63 1090.77 L1789.88 1090.05 L1861.13 1090.73 L1932.38 1090.38 L2003.63 1090.98 L2074.88 1090.72 L2146.13 1090.16 L2217.38 1090.53 L2288.63 1090.09 L2288.63 1087.52 L2217.38 1087.93 L2146.13 1087.83 L2074.88 1087.51 L2003.63 1087.93 L1932.38 1087.74 L1861.13 1087.54 L1789.88 1087.91 L1718.63 1087.96 L1647.38 1087.77 L1576.13 1087.92 L1504.88 1087.5 L1433.63 1087.73 L1362.37 1088.18 L1291.12 1087.83 L1219.87 1087.79 L1148.62 1087.85 L1077.37 1087.81 L1006.12 1087.82 L934.872 1087.8 L863.622 1087.89 L792.371 1088.06 L721.121 1087.36 L649.871 1087.69 L578.62 1087.66 L507.37 1087.82 L436.119 1088.07 L364.869 1087.58 L293.618 1085.4 L222.368 1069.64 L151.118 992.437  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip372)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1113.93 222.368,1093.76 293.618,1090.34 364.869,1089.31 436.119,1089.29 507.37,1088.95 578.62,1088.89 649.871,1088.94 721.121,1089.13 792.371,1089.16 863.622,1089.33 934.872,1089.3 1006.12,1089.11 1077.37,1089.32 1148.62,1089.26 1219.87,1089.27 1291.12,1089.06 1362.37,1089.09 1433.63,1089.06 1504.88,1089.12 1576.13,1089.11 1647.38,1089.07 1718.63,1089.08 1789.88,1089.15 1861.13,1089.29 1932.38,1089.1 2003.63,1089.09 2074.88,1089.12 2146.13,1089.02 2217.38,1089.07 2288.63,1088.68 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">52.03428919010865</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([293.7560428037226, 2268.387215782675], [21.769983977459567 -0.15795012606652586; 196.35293876411941 -2.319011035653281], [5.090881114582604 -0.11217383374601086; 51.99702092854787 -1.2865603039812474;;; -0.11217383374601086 0.040215338970213295; -1.2865603039812474 0.26571316322097266], [-4.784969687385409; -81.69077323544239;;], [-15.184172538887868, 11.89497957641089], [-1.6202656180872022 -0.12577483298905437; -0.728873725882201 0.07909796808934948], [0.03399687344451997 -0.13738272324097128; -0.020406703065688033 0.06170841885282835;;; -0.13738272324097128 0.005206873227544399; 0.06170841885282835 0.0021908644289868003], [1.1800014305408946 1.2378406666536 … 0.8888951649858468 -0.10542706321943061])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 18 March 2023 08:57">Saturday 18 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
