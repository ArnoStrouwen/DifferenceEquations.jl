<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.0008337039556669121]
 [0.0050185537311783525, -0.0041188713015178615]
 [-0.020795981582354975, -0.007609961601581237]
 [-0.06682449387936916, 0.0067602369837906785]
 [-0.021536369185129852, -0.0021986440946760314]
 [-0.03415117042277679, -0.012719417828817185]
 [-0.11084704654842847, -0.006104558202729161]
 [-0.14307130678020485, 0.01485453336380953]
 [-0.043355261528794, 0.0038503716957725646]
 ⋮
 [-0.012870549811461057, -0.0161004875481861]
 [-0.11130209138834715, -0.005110276765192758]
 [-0.13738085211231346, -0.010964617565728724]
 [-0.198095587024396, 0.014616490483802057]
 [-0.09718348861672736, 0.004420067356049441]
 [-0.0649686339191402, -0.01891549133089937]
 [-0.17787029297168053, -0.011538111733372127]
 [-0.24004053333299816, -0.0030863260197718403]
 [-0.24718337604564503, 0.003389308508679741]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip170">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip170)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip171">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip170)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip172">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip170)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1476.41 2352.76,1476.41 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1256.05 2352.76,1256.05 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1035.69 2352.76,1035.69 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,815.327 2352.76,815.327 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,594.966 2352.76,594.966 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,374.605 2352.76,374.605 "/>
<polyline clip-path="url(#clip172)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,154.245 2352.76,154.245 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1476.41 105.89,1476.41 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1256.05 105.89,1256.05 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1035.69 105.89,1035.69 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,815.327 105.89,815.327 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,594.966 105.89,594.966 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,374.605 105.89,374.605 "/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,154.245 105.89,154.245 "/>
<path clip-path="url(#clip170)" d="M-85.1183 1476.86 L-55.4425 1476.86 L-55.4425 1480.8 L-85.1183 1480.8 L-85.1183 1476.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-35.35 1462.21 Q-38.9611 1462.21 -40.7898 1465.77 Q-42.5953 1469.31 -42.5953 1476.44 Q-42.5953 1483.55 -40.7898 1487.11 Q-38.9611 1490.66 -35.35 1490.66 Q-31.7158 1490.66 -29.9102 1487.11 Q-28.0815 1483.55 -28.0815 1476.44 Q-28.0815 1469.31 -29.9102 1465.77 Q-31.7158 1462.21 -35.35 1462.21 M-35.35 1458.5 Q-29.5398 1458.5 -26.4843 1463.11 Q-23.4056 1467.69 -23.4056 1476.44 Q-23.4056 1485.17 -26.4843 1489.78 Q-29.5398 1494.36 -35.35 1494.36 Q-41.1602 1494.36 -44.2388 1489.78 Q-47.2944 1485.17 -47.2944 1476.44 Q-47.2944 1467.69 -44.2388 1463.11 Q-41.1602 1458.5 -35.35 1458.5 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-15.1881 1487.81 L-10.3038 1487.81 L-10.3038 1493.69 L-15.1881 1493.69 L-15.1881 1487.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M3.90904 1489.75 L20.2284 1489.75 L20.2284 1493.69 L-1.71592 1493.69 L-1.71592 1489.75 Q0.946098 1487 5.52941 1482.37 Q10.1359 1477.72 11.3164 1476.37 Q13.5618 1473.85 14.4414 1472.11 Q15.3442 1470.36 15.3442 1468.67 Q15.3442 1465.91 13.3997 1464.17 Q11.4784 1462.44 8.37661 1462.44 Q6.17755 1462.44 3.72386 1463.2 Q1.29332 1463.97 -1.48444 1465.52 L-1.48444 1460.8 Q1.33961 1459.66 3.7933 1459.08 Q6.247 1458.5 8.28402 1458.5 Q13.6544 1458.5 16.8488 1461.19 Q20.0432 1463.87 20.0432 1468.36 Q20.0432 1470.49 19.233 1472.42 Q18.446 1474.31 16.3395 1476.91 Q15.7608 1477.58 12.659 1480.8 Q9.55716 1483.99 3.90904 1489.75 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M30.0895 1459.13 L48.4458 1459.13 L48.4458 1463.06 L34.3718 1463.06 L34.3718 1471.54 Q35.3904 1471.19 36.4089 1471.03 Q37.4274 1470.84 38.4459 1470.84 Q44.2329 1470.84 47.6125 1474.01 Q50.9921 1477.18 50.9921 1482.6 Q50.9921 1488.18 47.5199 1491.28 Q44.0477 1494.36 37.7283 1494.36 Q35.5524 1494.36 33.2839 1493.99 Q31.0385 1493.62 28.6311 1492.88 L28.6311 1488.18 Q30.7145 1489.31 32.9367 1489.87 Q35.1589 1490.42 37.6357 1490.42 Q41.6403 1490.42 43.9783 1488.32 Q46.3162 1486.21 46.3162 1482.6 Q46.3162 1478.99 43.9783 1476.88 Q41.6403 1474.78 37.6357 1474.78 Q35.7607 1474.78 33.8857 1475.19 Q32.0339 1475.61 30.0895 1476.49 L30.0895 1459.13 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-86.1136 1256.5 L-56.4379 1256.5 L-56.4379 1260.43 L-86.1136 1260.43 L-86.1136 1256.5 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-36.3454 1241.85 Q-39.9565 1241.85 -41.7852 1245.41 Q-43.5907 1248.95 -43.5907 1256.08 Q-43.5907 1263.19 -41.7852 1266.75 Q-39.9565 1270.3 -36.3454 1270.3 Q-32.7111 1270.3 -30.9056 1266.75 Q-29.0769 1263.19 -29.0769 1256.08 Q-29.0769 1248.95 -30.9056 1245.41 Q-32.7111 1241.85 -36.3454 1241.85 M-36.3454 1238.14 Q-30.5352 1238.14 -27.4797 1242.75 Q-24.401 1247.33 -24.401 1256.08 Q-24.401 1264.81 -27.4797 1269.42 Q-30.5352 1274 -36.3454 1274 Q-42.1555 1274 -45.2342 1269.42 Q-48.2897 1264.81 -48.2897 1256.08 Q-48.2897 1247.33 -45.2342 1242.75 Q-42.1555 1238.14 -36.3454 1238.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-16.1834 1267.45 L-11.2992 1267.45 L-11.2992 1273.33 L-16.1834 1273.33 L-16.1834 1267.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M2.91368 1269.39 L19.233 1269.39 L19.233 1273.33 L-2.71129 1273.33 L-2.71129 1269.39 Q-0.0492672 1266.64 4.53404 1262.01 Q9.1405 1257.36 10.321 1256.01 Q12.5664 1253.49 13.446 1251.75 Q14.3488 1249.99 14.3488 1248.31 Q14.3488 1245.55 12.4044 1243.81 Q10.4831 1242.08 7.38125 1242.08 Q5.18219 1242.08 2.7285 1242.84 Q0.297953 1243.61 -2.47981 1245.16 L-2.47981 1240.43 Q0.344249 1239.3 2.79794 1238.72 Q5.25163 1238.14 7.28866 1238.14 Q12.659 1238.14 15.8534 1240.83 Q19.0479 1243.51 19.0479 1248 Q19.0479 1250.13 18.2377 1252.06 Q17.4506 1253.95 15.3442 1256.55 Q14.7655 1257.22 11.6636 1260.43 Q8.5618 1263.63 2.91368 1269.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M39.0477 1241.85 Q35.4367 1241.85 33.608 1245.41 Q31.8024 1248.95 31.8024 1256.08 Q31.8024 1263.19 33.608 1266.75 Q35.4367 1270.3 39.0477 1270.3 Q42.682 1270.3 44.4875 1266.75 Q46.3162 1263.19 46.3162 1256.08 Q46.3162 1248.95 44.4875 1245.41 Q42.682 1241.85 39.0477 1241.85 M39.0477 1238.14 Q44.8579 1238.14 47.9134 1242.75 Q50.9921 1247.33 50.9921 1256.08 Q50.9921 1264.81 47.9134 1269.42 Q44.8579 1274 39.0477 1274 Q33.2376 1274 30.1589 1269.42 Q27.1034 1264.81 27.1034 1256.08 Q27.1034 1247.33 30.1589 1242.75 Q33.2376 1238.14 39.0477 1238.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-85.1183 1036.14 L-55.4425 1036.14 L-55.4425 1040.07 L-85.1183 1040.07 L-85.1183 1036.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-35.35 1021.49 Q-38.9611 1021.49 -40.7898 1025.05 Q-42.5953 1028.59 -42.5953 1035.72 Q-42.5953 1042.83 -40.7898 1046.39 Q-38.9611 1049.93 -35.35 1049.93 Q-31.7158 1049.93 -29.9102 1046.39 Q-28.0815 1042.83 -28.0815 1035.72 Q-28.0815 1028.59 -29.9102 1025.05 Q-31.7158 1021.49 -35.35 1021.49 M-35.35 1017.78 Q-29.5398 1017.78 -26.4843 1022.39 Q-23.4056 1026.97 -23.4056 1035.72 Q-23.4056 1044.45 -26.4843 1049.06 Q-29.5398 1053.64 -35.35 1053.64 Q-41.1602 1053.64 -44.2388 1049.06 Q-47.2944 1044.45 -47.2944 1035.72 Q-47.2944 1026.97 -44.2388 1022.39 Q-41.1602 1017.78 -35.35 1017.78 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-15.1881 1047.09 L-10.3038 1047.09 L-10.3038 1052.97 L-15.1881 1052.97 L-15.1881 1047.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M0.69147 1049.03 L8.33032 1049.03 L8.33032 1022.67 L0.0201769 1024.33 L0.0201769 1020.07 L8.28402 1018.41 L12.9599 1018.41 L12.9599 1049.03 L20.5988 1049.03 L20.5988 1052.97 L0.69147 1052.97 L0.69147 1049.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M30.0895 1018.41 L48.4458 1018.41 L48.4458 1022.34 L34.3718 1022.34 L34.3718 1030.81 Q35.3904 1030.47 36.4089 1030.31 Q37.4274 1030.12 38.4459 1030.12 Q44.2329 1030.12 47.6125 1033.29 Q50.9921 1036.46 50.9921 1041.88 Q50.9921 1047.46 47.5199 1050.56 Q44.0477 1053.64 37.7283 1053.64 Q35.5524 1053.64 33.2839 1053.27 Q31.0385 1052.9 28.6311 1052.16 L28.6311 1047.46 Q30.7145 1048.59 32.9367 1049.15 Q35.1589 1049.7 37.6357 1049.7 Q41.6403 1049.7 43.9783 1047.6 Q46.3162 1045.49 46.3162 1041.88 Q46.3162 1038.27 43.9783 1036.16 Q41.6403 1034.06 37.6357 1034.06 Q35.7607 1034.06 33.8857 1034.47 Q32.0339 1034.89 30.0895 1035.77 L30.0895 1018.41 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-86.1136 815.778 L-56.4379 815.778 L-56.4379 819.713 L-86.1136 819.713 L-86.1136 815.778 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-36.3454 801.125 Q-39.9565 801.125 -41.7852 804.69 Q-43.5907 808.232 -43.5907 815.361 Q-43.5907 822.468 -41.7852 826.033 Q-39.9565 829.574 -36.3454 829.574 Q-32.7111 829.574 -30.9056 826.033 Q-29.0769 822.468 -29.0769 815.361 Q-29.0769 808.232 -30.9056 804.69 Q-32.7111 801.125 -36.3454 801.125 M-36.3454 797.422 Q-30.5352 797.422 -27.4797 802.028 Q-24.401 806.611 -24.401 815.361 Q-24.401 824.088 -27.4797 828.695 Q-30.5352 833.278 -36.3454 833.278 Q-42.1555 833.278 -45.2342 828.695 Q-48.2897 824.088 -48.2897 815.361 Q-48.2897 806.611 -45.2342 802.028 Q-42.1555 797.422 -36.3454 797.422 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-16.1834 826.727 L-11.2992 826.727 L-11.2992 832.607 L-16.1834 832.607 L-16.1834 826.727 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-0.303895 828.672 L7.33495 828.672 L7.33495 802.306 L-0.975188 803.973 L-0.975188 799.713 L7.28866 798.047 L11.9646 798.047 L11.9646 828.672 L19.6034 828.672 L19.6034 832.607 L-0.303895 832.607 L-0.303895 828.672 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M39.0477 801.125 Q35.4367 801.125 33.608 804.69 Q31.8024 808.232 31.8024 815.361 Q31.8024 822.468 33.608 826.033 Q35.4367 829.574 39.0477 829.574 Q42.682 829.574 44.4875 826.033 Q46.3162 822.468 46.3162 815.361 Q46.3162 808.232 44.4875 804.69 Q42.682 801.125 39.0477 801.125 M39.0477 797.422 Q44.8579 797.422 47.9134 802.028 Q50.9921 806.611 50.9921 815.361 Q50.9921 824.088 47.9134 828.695 Q44.8579 833.278 39.0477 833.278 Q33.2376 833.278 30.1589 828.695 Q27.1034 824.088 27.1034 815.361 Q27.1034 806.611 30.1589 802.028 Q33.2376 797.422 39.0477 797.422 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-85.1183 595.417 L-55.4425 595.417 L-55.4425 599.353 L-85.1183 599.353 L-85.1183 595.417 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-35.35 580.765 Q-38.9611 580.765 -40.7898 584.33 Q-42.5953 587.871 -42.5953 595.001 Q-42.5953 602.107 -40.7898 605.672 Q-38.9611 609.214 -35.35 609.214 Q-31.7158 609.214 -29.9102 605.672 Q-28.0815 602.107 -28.0815 595.001 Q-28.0815 587.871 -29.9102 584.33 Q-31.7158 580.765 -35.35 580.765 M-35.35 577.061 Q-29.5398 577.061 -26.4843 581.668 Q-23.4056 586.251 -23.4056 595.001 Q-23.4056 603.728 -26.4843 608.334 Q-29.5398 612.917 -35.35 612.917 Q-41.1602 612.917 -44.2388 608.334 Q-47.2944 603.728 -47.2944 595.001 Q-47.2944 586.251 -44.2388 581.668 Q-41.1602 577.061 -35.35 577.061 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-15.1881 606.366 L-10.3038 606.366 L-10.3038 612.246 L-15.1881 612.246 L-15.1881 606.366 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M9.88124 580.765 Q6.27014 580.765 4.44145 584.33 Q2.6359 587.871 2.6359 595.001 Q2.6359 602.107 4.44145 605.672 Q6.27014 609.214 9.88124 609.214 Q13.5155 609.214 15.321 605.672 Q17.1497 602.107 17.1497 595.001 Q17.1497 587.871 15.321 584.33 Q13.5155 580.765 9.88124 580.765 M9.88124 577.061 Q15.6914 577.061 18.7469 581.668 Q21.8256 586.251 21.8256 595.001 Q21.8256 603.728 18.7469 608.334 Q15.6914 612.917 9.88124 612.917 Q4.07108 612.917 0.992394 608.334 Q-2.06315 603.728 -2.06315 595.001 Q-2.06315 586.251 0.992394 581.668 Q4.07108 577.061 9.88124 577.061 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M30.0895 577.686 L48.4458 577.686 L48.4458 581.621 L34.3718 581.621 L34.3718 590.093 Q35.3904 589.746 36.4089 589.584 Q37.4274 589.399 38.4459 589.399 Q44.2329 589.399 47.6125 592.57 Q50.9921 595.742 50.9921 601.158 Q50.9921 606.737 47.5199 609.839 Q44.0477 612.917 37.7283 612.917 Q35.5524 612.917 33.2839 612.547 Q31.0385 612.177 28.6311 611.436 L28.6311 606.737 Q30.7145 607.871 32.9367 608.427 Q35.1589 608.982 37.6357 608.982 Q41.6403 608.982 43.9783 606.876 Q46.3162 604.769 46.3162 601.158 Q46.3162 597.547 43.9783 595.441 Q41.6403 593.334 37.6357 593.334 Q35.7607 593.334 33.8857 593.751 Q32.0339 594.167 30.0895 595.047 L30.0895 577.686 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-36.3454 360.404 Q-39.9565 360.404 -41.7852 363.969 Q-43.5907 367.511 -43.5907 374.64 Q-43.5907 381.747 -41.7852 385.311 Q-39.9565 388.853 -36.3454 388.853 Q-32.7111 388.853 -30.9056 385.311 Q-29.0769 381.747 -29.0769 374.64 Q-29.0769 367.511 -30.9056 363.969 Q-32.7111 360.404 -36.3454 360.404 M-36.3454 356.7 Q-30.5352 356.7 -27.4797 361.307 Q-24.401 365.89 -24.401 374.64 Q-24.401 383.367 -27.4797 387.973 Q-30.5352 392.557 -36.3454 392.557 Q-42.1555 392.557 -45.2342 387.973 Q-48.2897 383.367 -48.2897 374.64 Q-48.2897 365.89 -45.2342 361.307 Q-42.1555 356.7 -36.3454 356.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-16.1834 386.006 L-11.2992 386.006 L-11.2992 391.885 L-16.1834 391.885 L-16.1834 386.006 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M8.88587 360.404 Q5.27478 360.404 3.44608 363.969 Q1.64054 367.511 1.64054 374.64 Q1.64054 381.747 3.44608 385.311 Q5.27478 388.853 8.88587 388.853 Q12.5201 388.853 14.3257 385.311 Q16.1543 381.747 16.1543 374.64 Q16.1543 367.511 14.3257 363.969 Q12.5201 360.404 8.88587 360.404 M8.88587 356.7 Q14.696 356.7 17.7516 361.307 Q20.8303 365.89 20.8303 374.64 Q20.8303 383.367 17.7516 387.973 Q14.696 392.557 8.88587 392.557 Q3.07572 392.557 -0.00297114 387.973 Q-3.05851 383.367 -3.05851 374.64 Q-3.05851 365.89 -0.00297114 361.307 Q3.07572 356.7 8.88587 356.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M39.0477 360.404 Q35.4367 360.404 33.608 363.969 Q31.8024 367.511 31.8024 374.64 Q31.8024 381.747 33.608 385.311 Q35.4367 388.853 39.0477 388.853 Q42.682 388.853 44.4875 385.311 Q46.3162 381.747 46.3162 374.64 Q46.3162 367.511 44.4875 363.969 Q42.682 360.404 39.0477 360.404 M39.0477 356.7 Q44.8579 356.7 47.9134 361.307 Q50.9921 365.89 50.9921 374.64 Q50.9921 383.367 47.9134 387.973 Q44.8579 392.557 39.0477 392.557 Q33.2376 392.557 30.1589 387.973 Q27.1034 383.367 27.1034 374.64 Q27.1034 365.89 30.1589 361.307 Q33.2376 356.7 39.0477 356.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-35.35 140.043 Q-38.9611 140.043 -40.7898 143.608 Q-42.5953 147.15 -42.5953 154.279 Q-42.5953 161.386 -40.7898 164.951 Q-38.9611 168.492 -35.35 168.492 Q-31.7158 168.492 -29.9102 164.951 Q-28.0815 161.386 -28.0815 154.279 Q-28.0815 147.15 -29.9102 143.608 Q-31.7158 140.043 -35.35 140.043 M-35.35 136.34 Q-29.5398 136.34 -26.4843 140.946 Q-23.4056 145.53 -23.4056 154.279 Q-23.4056 163.006 -26.4843 167.613 Q-29.5398 172.196 -35.35 172.196 Q-41.1602 172.196 -44.2388 167.613 Q-47.2944 163.006 -47.2944 154.279 Q-47.2944 145.53 -44.2388 140.946 Q-41.1602 136.34 -35.35 136.34 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M-15.1881 165.645 L-10.3038 165.645 L-10.3038 171.525 L-15.1881 171.525 L-15.1881 165.645 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M9.88124 140.043 Q6.27014 140.043 4.44145 143.608 Q2.6359 147.15 2.6359 154.279 Q2.6359 161.386 4.44145 164.951 Q6.27014 168.492 9.88124 168.492 Q13.5155 168.492 15.321 164.951 Q17.1497 161.386 17.1497 154.279 Q17.1497 147.15 15.321 143.608 Q13.5155 140.043 9.88124 140.043 M9.88124 136.34 Q15.6914 136.34 18.7469 140.946 Q21.8256 145.53 21.8256 154.279 Q21.8256 163.006 18.7469 167.613 Q15.6914 172.196 9.88124 172.196 Q4.07108 172.196 0.992394 167.613 Q-2.06315 163.006 -2.06315 154.279 Q-2.06315 145.53 0.992394 140.946 Q4.07108 136.34 9.88124 136.34 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip170)" d="M30.0895 136.965 L48.4458 136.965 L48.4458 140.9 L34.3718 140.9 L34.3718 149.372 Q35.3904 149.025 36.4089 148.863 Q37.4274 148.678 38.4459 148.678 Q44.2329 148.678 47.6125 151.849 Q50.9921 155.02 50.9921 160.437 Q50.9921 166.016 47.5199 169.117 Q44.0477 172.196 37.7283 172.196 Q35.5524 172.196 33.2839 171.826 Q31.0385 171.455 28.6311 170.715 L28.6311 166.016 Q30.7145 167.15 32.9367 167.705 Q35.1589 168.261 37.6357 168.261 Q41.6403 168.261 43.9783 166.154 Q46.3162 164.048 46.3162 160.437 Q46.3162 156.826 43.9783 154.719 Q41.6403 152.613 37.6357 152.613 Q35.7607 152.613 33.8857 153.029 Q32.0339 153.446 30.0895 154.326 L30.0895 136.965 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip172)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,374.605 162.518,374.95 238.043,352.488 313.569,466.258 389.094,669.115 464.619,469.521 540.145,525.117 615.67,863.132 691.196,1005.15 766.721,565.681 842.247,451.11 917.772,320.29 993.298,166.911 1068.82,88.5087 1144.35,320.114 1219.87,194.539 1295.4,276.386 1370.92,518.006 1446.45,669.962 1521.98,694.068 1597.5,964.974 1673.03,779.746 1748.55,431.329 1824.08,865.137 1899.6,980.072 1975.13,1247.65 2050.65,802.914 2126.18,660.936 2201.7,1158.52 2277.23,1432.52 2352.76,1464 "/>
<polyline clip-path="url(#clip172)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,374.605 162.518,370.931 238.043,392.758 313.569,408.144 389.094,344.812 464.619,384.295 540.145,430.663 615.67,401.509 691.196,309.138 766.721,357.636 842.247,354.111 917.772,349.449 993.298,360.26 1068.82,409.714 1144.35,353.908 1219.87,386.309 1295.4,412.887 1370.92,400.3 1446.45,380.828 1521.98,421.104 1597.5,349.468 1673.03,321.885 1748.55,445.564 1824.08,397.127 1899.6,422.929 1975.13,310.187 2050.65,355.125 2126.18,457.97 2201.7,425.456 2277.23,388.207 2352.76,359.668 "/>
<path clip-path="url(#clip170)" d="M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip170)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 "/>
<polyline clip-path="url(#clip170)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1352.98 338.744,1352.98 "/>
<path clip-path="url(#clip170)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip170)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1404.82 338.744,1404.82 "/>
<path clip-path="url(#clip170)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.0833704  -0.428561  -0.678619  …  -0.775501  -0.0778704  0.400657</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip230">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip230)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip231">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip230)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip232">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip230)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1519.94 2352.76,1519.94 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1173.18 2352.76,1173.18 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,826.424 2352.76,826.424 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,479.668 2352.76,479.668 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,132.913 2352.76,132.913 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1519.94 105.89,1519.94 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1173.18 105.89,1173.18 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,826.424 105.89,826.424 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,479.668 105.89,479.668 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,132.913 105.89,132.913 "/>
<path clip-path="url(#clip230)" d="M-9.72514 1520.39 L19.9506 1520.39 L19.9506 1524.32 L-9.72514 1524.32 L-9.72514 1520.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M30.0895 1502.66 L48.4458 1502.66 L48.4458 1506.59 L34.3718 1506.59 L34.3718 1515.06 Q35.3904 1514.72 36.4089 1514.55 Q37.4274 1514.37 38.4459 1514.37 Q44.2329 1514.37 47.6125 1517.54 Q50.9921 1520.71 50.9921 1526.13 Q50.9921 1531.71 47.5199 1534.81 Q44.0477 1537.89 37.7283 1537.89 Q35.5524 1537.89 33.2839 1537.52 Q31.0385 1537.15 28.6311 1536.41 L28.6311 1531.71 Q30.7145 1532.84 32.9367 1533.4 Q35.1589 1533.95 37.6357 1533.95 Q41.6403 1533.95 43.9783 1531.84 Q46.3162 1529.74 46.3162 1526.13 Q46.3162 1522.52 43.9783 1520.41 Q41.6403 1518.3 37.6357 1518.3 Q35.7607 1518.3 33.8857 1518.72 Q32.0339 1519.14 30.0895 1520.02 L30.0895 1502.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M39.0477 1158.98 Q35.4367 1158.98 33.608 1162.54 Q31.8024 1166.08 31.8024 1173.21 Q31.8024 1180.32 33.608 1183.89 Q35.4367 1187.43 39.0477 1187.43 Q42.682 1187.43 44.4875 1183.89 Q46.3162 1180.32 46.3162 1173.21 Q46.3162 1166.08 44.4875 1162.54 Q42.682 1158.98 39.0477 1158.98 M39.0477 1155.27 Q44.8579 1155.27 47.9134 1159.88 Q50.9921 1164.46 50.9921 1173.21 Q50.9921 1181.94 47.9134 1186.55 Q44.8579 1191.13 39.0477 1191.13 Q33.2376 1191.13 30.1589 1186.55 Q27.1034 1181.94 27.1034 1173.21 Q27.1034 1164.46 30.1589 1159.88 Q33.2376 1155.27 39.0477 1155.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M30.0895 809.144 L48.4458 809.144 L48.4458 813.079 L34.3718 813.079 L34.3718 821.551 Q35.3904 821.204 36.4089 821.042 Q37.4274 820.857 38.4459 820.857 Q44.2329 820.857 47.6125 824.028 Q50.9921 827.199 50.9921 832.616 Q50.9921 838.195 47.5199 841.296 Q44.0477 844.375 37.7283 844.375 Q35.5524 844.375 33.2839 844.005 Q31.0385 843.634 28.6311 842.894 L28.6311 838.195 Q30.7145 839.329 32.9367 839.884 Q35.1589 840.44 37.6357 840.44 Q41.6403 840.44 43.9783 838.334 Q46.3162 836.227 46.3162 832.616 Q46.3162 829.005 43.9783 826.898 Q41.6403 824.792 37.6357 824.792 Q35.7607 824.792 33.8857 825.209 Q32.0339 825.625 30.0895 826.505 L30.0895 809.144 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M-0.303895 493.013 L7.33495 493.013 L7.33495 466.647 L-0.975188 468.314 L-0.975188 464.055 L7.28866 462.388 L11.9646 462.388 L11.9646 493.013 L19.6034 493.013 L19.6034 496.948 L-0.303895 496.948 L-0.303895 493.013 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M39.0477 465.467 Q35.4367 465.467 33.608 469.032 Q31.8024 472.573 31.8024 479.703 Q31.8024 486.809 33.608 490.374 Q35.4367 493.916 39.0477 493.916 Q42.682 493.916 44.4875 490.374 Q46.3162 486.809 46.3162 479.703 Q46.3162 472.573 44.4875 469.032 Q42.682 465.467 39.0477 465.467 M39.0477 461.763 Q44.8579 461.763 47.9134 466.37 Q50.9921 470.953 50.9921 479.703 Q50.9921 488.43 47.9134 493.036 Q44.8579 497.619 39.0477 497.619 Q33.2376 497.619 30.1589 493.036 Q27.1034 488.43 27.1034 479.703 Q27.1034 470.953 30.1589 466.37 Q33.2376 461.763 39.0477 461.763 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M0.69147 146.257 L8.33032 146.257 L8.33032 119.892 L0.0201769 121.558 L0.0201769 117.299 L8.28402 115.633 L12.9599 115.633 L12.9599 146.257 L20.5988 146.257 L20.5988 150.193 L0.69147 150.193 L0.69147 146.257 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip230)" d="M30.0895 115.633 L48.4458 115.633 L48.4458 119.568 L34.3718 119.568 L34.3718 128.04 Q35.3904 127.693 36.4089 127.531 Q37.4274 127.345 38.4459 127.345 Q44.2329 127.345 47.6125 130.517 Q50.9921 133.688 50.9921 139.105 Q50.9921 144.683 47.5199 147.785 Q44.0477 150.864 37.7283 150.864 Q35.5524 150.864 33.2839 150.493 Q31.0385 150.123 28.6311 149.382 L28.6311 144.683 Q30.7145 145.818 32.9367 146.373 Q35.1589 146.929 37.6357 146.929 Q41.6403 146.929 43.9783 144.822 Q46.3162 142.716 46.3162 139.105 Q46.3162 135.494 43.9783 133.387 Q41.6403 131.281 37.6357 131.281 Q35.7607 131.281 33.8857 131.697 Q32.0339 132.114 30.0895 132.994 L30.0895 115.633 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip232)" d="M151.118 1289.87 L222.368 1396.95 L293.618 1476.71 L364.869 1479.3 L436.119 1464.2 L507.37 1447.91 L578.62 1430.99 L649.871 1417.02 L721.121 1406.83 L792.371 1394.32 L863.622 1383.37 L934.872 1375.02 L1006.12 1364.08 L1077.37 1355.09 L1148.62 1349.99 L1219.87 1345.99 L1291.12 1340.1 L1362.37 1336.02 L1433.63 1330.75 L1504.88 1324.11 L1576.13 1319.87 L1647.38 1310.47 L1718.63 1307.5 L1789.88 1301 L1861.13 1292.72 L1932.38 1293.51 L2003.63 1286.78 L2074.88 1279.45 L2146.13 1273.52 L2217.38 1266.78 L2288.63 1257.81 L2288.63 898.313 L2217.38 879.754 L2146.13 866.392 L2074.88 848.242 L2003.63 828.949 L1932.38 816.5 L1861.13 799.214 L1789.88 781.852 L1718.63 763.234 L1647.38 742.19 L1576.13 721.887 L1504.88 701.089 L1433.63 679.825 L1362.37 652.46 L1291.12 624.714 L1219.87 596.782 L1148.62 564.662 L1077.37 535.993 L1006.12 506.922 L934.872 467.604 L863.622 430.812 L792.371 396.116 L721.121 357.745 L649.871 313.121 L578.62 268.579 L507.37 221.807 L436.119 176.066 L364.869 118.296 L293.618 88.9544 L222.368 182.498 L151.118 1063.78  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip232)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1161.7 222.368,1134.46 293.618,1146.24 364.869,1147.64 436.119,1148.96 507.37,1149.16 578.62,1152.92 649.871,1154.23 721.121,1155.39 792.371,1154.86 863.622,1152.38 934.872,1153.31 1006.12,1150.64 1077.37,1155.46 1148.62,1154.36 1219.87,1151.75 1291.12,1154.88 1362.37,1151.43 1433.63,1154.78 1504.88,1157.59 1576.13,1162.66 1647.38,1164.31 1718.63,1172.45 1789.88,1171.42 1861.13,1172.1 1932.38,1172.46 2003.63,1168.74 2074.88,1168.24 2146.13,1173.06 2217.38,1171.25 2288.63,1170.44 "/>
<path clip-path="url(#clip232)" d="M151.118 1291.98 L222.368 1197.18 L293.618 1178.11 L364.869 1174.64 L436.119 1174.09 L507.37 1174.08 L578.62 1174.74 L649.871 1174.24 L721.121 1174.28 L792.371 1174.54 L863.622 1174.35 L934.872 1173.92 L1006.12 1173.98 L1077.37 1174.33 L1148.62 1174.24 L1219.87 1174.09 L1291.12 1174.43 L1362.37 1174.15 L1433.63 1174.32 L1504.88 1174.22 L1576.13 1174.14 L1647.38 1174.3 L1718.63 1173.85 L1789.88 1174.12 L1861.13 1174.18 L1932.38 1174.46 L2003.63 1174.45 L2074.88 1174.29 L2146.13 1174.06 L2217.38 1174.31 L2288.63 1174.12 L2288.63 1172.29 L2217.38 1172.01 L2146.13 1172.15 L2074.88 1172.39 L2003.63 1172.28 L1932.38 1172.09 L1861.13 1172.24 L1789.88 1171.89 L1718.63 1172.07 L1647.38 1171.86 L1576.13 1171.76 L1504.88 1172.23 L1433.63 1172.13 L1362.37 1171.92 L1291.12 1171.82 L1219.87 1171.79 L1148.62 1172.2 L1077.37 1171.98 L1006.12 1171.98 L934.872 1171.81 L863.622 1172.33 L792.371 1172.32 L721.121 1171.89 L649.871 1172.02 L578.62 1172.37 L507.37 1171.89 L436.119 1172.14 L364.869 1172.42 L293.618 1168.89 L222.368 1153.73 L151.118 1076.88  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip232)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1174.33 222.368,1173.18 293.618,1172.74 364.869,1173.3 436.119,1173.09 507.37,1173.08 578.62,1173.22 649.871,1173.24 721.121,1173.17 792.371,1173.29 863.622,1173.22 934.872,1173.14 1006.12,1173.06 1077.37,1173.07 1148.62,1173.22 1219.87,1173.16 1291.12,1173.26 1362.37,1173.17 1433.63,1173.21 1504.88,1173.13 1576.13,1173.05 1647.38,1173.12 1718.63,1173.11 1789.88,1173.14 1861.13,1173.27 1932.38,1173.26 2003.63,1173.3 2074.88,1173.33 2146.13,1173.18 2217.38,1173.18 2288.63,1173.23 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">52.04707922014792</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([732.74376433008, 5264.8872776711805], [-20.627308638926518 -0.07636218539138913; -152.97723237620852 -1.9393390408183315], [3.5633081211130464 -0.0912587911353827; 26.36876501879929 -0.7237159567538435;;; -0.0912587911353827 0.037909696916883055; -0.7237159567538435 0.3107227682925056], [-55.66338479927033; -23.225150050100723;;], [-8.529884166563752, 76.78920770870545], [2.9798198784951913 0.024013565537056834; -0.6795053498915186 -0.5040827030921736], [-0.223348779986194 -0.0410115267362698; 0.2330644443560645 0.019121117941318967;;; -0.0410115267362698 -0.009216966179747793; 0.019121117941318967 0.007933351958578996], [3.416912886705253 3.355476152475756 … 0.3052356776263347 0.01194344730761533])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 14 March 2023 00:45">Tuesday 14 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
