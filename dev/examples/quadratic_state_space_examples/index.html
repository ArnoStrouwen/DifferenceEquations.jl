<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.0005651527949286235]
 [-0.003655533577060132, -0.011211269084488168]
 [-0.07266493700157306, -0.0037004050817785123]
 [-0.09199249992618598, -0.00880246022164824]
 [-0.1417509651342249, 0.0012697819488849337]
 [-0.1268801737477991, -0.007177866792427543]
 [-0.16489770523833608, -0.004367717642780086]
 [-0.1837080352558032, -0.008708238074587801]
 [-0.228253403838789, 0.0005608338890063218]
 ⋮
 [-0.028679449021729246, -0.004386965040975003]
 [-0.05445305306458367, 0.01253252411984139]
 [0.02633402872306348, -0.002921225843721915]
 [0.006849798479671487, 0.0044464135835918725]
 [0.03405945468326666, 0.011206390849984954]
 [0.10217329194317731, 0.005038516395552945]
 [0.12833597080309164, -5.417132191495085e-5]
 [0.12150152479797847, 0.007858080318773572]
 [0.16432111509166195, 0.001538522776796958]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip770">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip770)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip771">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip770)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip772">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip770)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1261.08 2352.76,1261.08 
  "/>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,939.23 2352.76,939.23 
  "/>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,617.378 2352.76,617.378 
  "/>
<polyline clip-path="url(#clip772)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,295.527 2352.76,295.527 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1261.08 105.89,1261.08 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,939.23 105.89,939.23 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,617.378 105.89,617.378 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,295.527 105.89,295.527 
  "/>
<path clip-path="url(#clip770)" d="M-54.3545 1261.53 L-24.6788 1261.53 L-24.6788 1265.47 L-54.3545 1265.47 L-54.3545 1261.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M-4.58628 1246.88 Q-8.19737 1246.88 -10.0261 1250.44 Q-11.8316 1253.99 -11.8316 1261.12 Q-11.8316 1268.22 -10.0261 1271.79 Q-8.19737 1275.33 -4.58628 1275.33 Q-0.95204 1275.33 0.853506 1271.79 Q2.6822 1268.22 2.6822 1261.12 Q2.6822 1253.99 0.853506 1250.44 Q-0.95204 1246.88 -4.58628 1246.88 M-4.58628 1243.18 Q1.22387 1243.18 4.27941 1247.78 Q7.3581 1252.37 7.3581 1261.12 Q7.3581 1269.84 4.27941 1274.45 Q1.22387 1279.03 -4.58628 1279.03 Q-10.3964 1279.03 -13.4751 1274.45 Q-16.5307 1269.84 -16.5307 1261.12 Q-16.5307 1252.37 -13.4751 1247.78 Q-10.3964 1243.18 -4.58628 1243.18 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M15.5756 1272.48 L20.4599 1272.48 L20.4599 1278.36 L15.5756 1278.36 L15.5756 1272.48 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M34.6728 1274.43 L50.9921 1274.43 L50.9921 1278.36 L29.0478 1278.36 L29.0478 1274.43 Q31.7098 1271.67 36.2931 1267.04 Q40.8996 1262.39 42.0801 1261.05 Q44.3255 1258.52 45.2051 1256.79 Q46.1079 1255.03 46.1079 1253.34 Q46.1079 1250.58 44.1635 1248.85 Q42.2422 1247.11 39.1403 1247.11 Q36.9413 1247.11 34.4876 1247.88 Q32.057 1248.64 29.2793 1250.19 L29.2793 1245.47 Q32.1033 1244.33 34.557 1243.75 Q37.0107 1243.18 39.0477 1243.18 Q44.4181 1243.18 47.6125 1245.86 Q50.8069 1248.55 50.8069 1253.04 Q50.8069 1255.17 49.9968 1257.09 Q49.2097 1258.99 47.1033 1261.58 Q46.5246 1262.25 43.4227 1265.47 Q40.3209 1268.66 34.6728 1274.43 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M-54.7249 939.681 L-25.0491 939.681 L-25.0491 943.616 L-54.7249 943.616 L-54.7249 939.681 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M-4.95665 925.028 Q-8.56774 925.028 -10.3964 928.593 Q-12.202 932.135 -12.202 939.264 Q-12.202 946.371 -10.3964 949.936 Q-8.56774 953.477 -4.95665 953.477 Q-1.32241 953.477 0.483137 949.936 Q2.31183 946.371 2.31183 939.264 Q2.31183 932.135 0.483137 928.593 Q-1.32241 925.028 -4.95665 925.028 M-4.95665 921.325 Q0.853506 921.325 3.90904 925.931 Q6.98773 930.514 6.98773 939.264 Q6.98773 947.991 3.90904 952.598 Q0.853506 957.181 -4.95665 957.181 Q-10.7668 957.181 -13.8455 952.598 Q-16.901 947.991 -16.901 939.264 Q-16.901 930.514 -13.8455 925.931 Q-10.7668 921.325 -4.95665 921.325 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M15.2053 950.63 L20.0895 950.63 L20.0895 956.51 L15.2053 956.51 L15.2053 950.63 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M31.0848 952.574 L38.7237 952.574 L38.7237 926.209 L30.4135 927.876 L30.4135 923.616 L38.6774 921.95 L43.3533 921.95 L43.3533 952.574 L50.9921 952.574 L50.9921 956.51 L31.0848 956.51 L31.0848 952.574 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M-6.18349 603.177 Q-9.79459 603.177 -11.6233 606.742 Q-13.4288 610.283 -13.4288 617.413 Q-13.4288 624.52 -11.6233 628.084 Q-9.79459 631.626 -6.18349 631.626 Q-2.54925 631.626 -0.743708 628.084 Q1.08499 624.52 1.08499 617.413 Q1.08499 610.283 -0.743708 606.742 Q-2.54925 603.177 -6.18349 603.177 M-6.18349 599.473 Q-0.37334 599.473 2.6822 604.08 Q5.76089 608.663 5.76089 617.413 Q5.76089 626.14 2.6822 630.746 Q-0.37334 635.33 -6.18349 635.33 Q-11.9936 635.33 -15.0723 630.746 Q-18.1279 626.14 -18.1279 617.413 Q-18.1279 608.663 -15.0723 604.08 Q-11.9936 599.473 -6.18349 599.473 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M13.9784 628.779 L18.8627 628.779 L18.8627 634.658 L13.9784 634.658 L13.9784 628.779 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M39.0477 603.177 Q35.4367 603.177 33.608 606.742 Q31.8024 610.283 31.8024 617.413 Q31.8024 624.52 33.608 628.084 Q35.4367 631.626 39.0477 631.626 Q42.682 631.626 44.4875 628.084 Q46.3162 624.52 46.3162 617.413 Q46.3162 610.283 44.4875 606.742 Q42.682 603.177 39.0477 603.177 M39.0477 599.473 Q44.8579 599.473 47.9134 604.08 Q50.9921 608.663 50.9921 617.413 Q50.9921 626.14 47.9134 630.746 Q44.8579 635.33 39.0477 635.33 Q33.2376 635.33 30.1589 630.746 Q27.1034 626.14 27.1034 617.413 Q27.1034 608.663 30.1589 604.08 Q33.2376 599.473 39.0477 599.473 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M-4.95665 281.326 Q-8.56774 281.326 -10.3964 284.891 Q-12.202 288.432 -12.202 295.562 Q-12.202 302.668 -10.3964 306.233 Q-8.56774 309.775 -4.95665 309.775 Q-1.32241 309.775 0.483137 306.233 Q2.31183 302.668 2.31183 295.562 Q2.31183 288.432 0.483137 284.891 Q-1.32241 281.326 -4.95665 281.326 M-4.95665 277.622 Q0.853506 277.622 3.90904 282.229 Q6.98773 286.812 6.98773 295.562 Q6.98773 304.289 3.90904 308.895 Q0.853506 313.478 -4.95665 313.478 Q-10.7668 313.478 -13.8455 308.895 Q-16.901 304.289 -16.901 295.562 Q-16.901 286.812 -13.8455 282.229 Q-10.7668 277.622 -4.95665 277.622 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M15.2053 306.927 L20.0895 306.927 L20.0895 312.807 L15.2053 312.807 L15.2053 306.927 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip770)" d="M31.0848 308.872 L38.7237 308.872 L38.7237 282.506 L30.4135 284.173 L30.4135 279.914 L38.6774 278.247 L43.3533 278.247 L43.3533 308.872 L50.9921 308.872 L50.9921 312.807 L31.0848 312.807 L31.0848 308.872 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip772)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,617.378 162.518,617.63 238.043,629.144 313.569,851.251 389.094,913.457 464.619,1073.61 540.145,1025.74 615.67,1148.1 691.196,1208.65 766.721,1352.01 
  842.247,1304.4 917.772,1076.65 993.298,1045.6 1068.82,1128.43 1144.35,1048.88 1219.87,1235.4 1295.4,1464 1370.92,1073.29 1446.45,882.023 1521.98,833.677 
  1597.5,1373.48 1673.03,1161.54 1748.55,709.684 1824.08,792.636 1899.6,532.622 1975.13,595.332 2050.65,507.758 2126.18,288.532 2201.7,204.327 2277.23,226.324 
  2352.76,88.5087 
  "/>
<polyline clip-path="url(#clip772)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,617.378 162.518,619.197 238.043,653.462 313.569,629.288 389.094,645.709 464.619,613.292 540.145,640.48 615.67,631.436 691.196,645.406 766.721,615.573 
  842.247,586.22 917.772,616.029 993.298,634.217 1068.82,608.623 1144.35,651.128 1219.87,659.555 1295.4,561.47 1370.92,590.236 1446.45,611.673 1521.98,707.488 
  1597.5,589.296 1673.03,549.439 1748.55,631.498 1824.08,577.042 1899.6,626.78 1975.13,603.068 2050.65,581.31 2126.18,601.162 2201.7,617.553 2277.23,592.087 
  2352.76,612.427 
  "/>
<path clip-path="url(#clip770)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip770)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip770)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip770)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip770)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip770)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -0.0565153  -1.10982  -0.145815  …  -0.106187  0.786891  -0.00330933</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip830">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip830)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip831">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip830)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip832">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip830)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1332.5 2352.76,1332.5 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1129.66 2352.76,1129.66 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,926.828 2352.76,926.828 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,723.992 2352.76,723.992 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,521.156 2352.76,521.156 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,318.32 2352.76,318.32 
  "/>
<polyline clip-path="url(#clip832)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,115.484 2352.76,115.484 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1332.5 105.89,1332.5 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1129.66 105.89,1129.66 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,926.828 105.89,926.828 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,723.992 105.89,723.992 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,521.156 105.89,521.156 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,318.32 105.89,318.32 
  "/>
<polyline clip-path="url(#clip830)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,115.484 105.89,115.484 
  "/>
<path clip-path="url(#clip830)" d="M-54.9564 1332.95 L-25.2806 1332.95 L-25.2806 1336.89 L-54.9564 1336.89 L-54.9564 1332.95 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-11.1603 1345.85 L5.15904 1345.85 L5.15904 1349.78 L-16.7853 1349.78 L-16.7853 1345.85 Q-14.1233 1343.09 -9.53996 1338.46 Q-4.9335 1333.81 -3.75295 1332.47 Q-1.50759 1329.94 -0.627968 1328.21 Q0.274805 1326.45 0.274805 1324.76 Q0.274805 1322 -1.66963 1320.27 Q-3.59091 1318.53 -6.69275 1318.53 Q-8.89181 1318.53 -11.3455 1319.29 Q-13.776 1320.06 -16.5538 1321.61 L-16.5538 1316.89 Q-13.7297 1315.75 -11.2761 1315.17 Q-8.82237 1314.6 -6.78534 1314.6 Q-1.415 1314.6 1.77943 1317.28 Q4.97385 1319.97 4.97385 1324.46 Q4.97385 1326.59 4.16367 1328.51 Q3.37664 1330.41 1.27017 1333 Q0.69147 1333.67 -2.41037 1336.89 Q-5.5122 1340.08 -11.1603 1345.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M14.9738 1343.9 L19.858 1343.9 L19.858 1349.78 L14.9738 1349.78 L14.9738 1343.9 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M30.0895 1315.22 L48.4458 1315.22 L48.4458 1319.16 L34.3718 1319.16 L34.3718 1327.63 Q35.3904 1327.28 36.4089 1327.12 Q37.4274 1326.93 38.4459 1326.93 Q44.2329 1326.93 47.6125 1330.1 Q50.9921 1333.28 50.9921 1338.69 Q50.9921 1344.27 47.5199 1347.37 Q44.0477 1350.45 37.7283 1350.45 Q35.5524 1350.45 33.2839 1350.08 Q31.0385 1349.71 28.6311 1348.97 L28.6311 1344.27 Q30.7145 1345.41 32.9367 1345.96 Q35.1589 1346.52 37.6357 1346.52 Q41.6403 1346.52 43.9783 1344.41 Q46.3162 1342.3 46.3162 1338.69 Q46.3162 1335.08 43.9783 1332.97 Q41.6403 1330.87 37.6357 1330.87 Q35.7607 1330.87 33.8857 1331.29 Q32.0339 1331.7 30.0895 1332.58 L30.0895 1315.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-6.18349 1115.46 Q-9.79459 1115.46 -11.6233 1119.03 Q-13.4288 1122.57 -13.4288 1129.7 Q-13.4288 1136.81 -11.6233 1140.37 Q-9.79459 1143.91 -6.18349 1143.91 Q-2.54925 1143.91 -0.743708 1140.37 Q1.08499 1136.81 1.08499 1129.7 Q1.08499 1122.57 -0.743708 1119.03 Q-2.54925 1115.46 -6.18349 1115.46 M-6.18349 1111.76 Q-0.37334 1111.76 2.6822 1116.37 Q5.76089 1120.95 5.76089 1129.7 Q5.76089 1138.43 2.6822 1143.03 Q-0.37334 1147.62 -6.18349 1147.62 Q-11.9936 1147.62 -15.0723 1143.03 Q-18.1279 1138.43 -18.1279 1129.7 Q-18.1279 1120.95 -15.0723 1116.37 Q-11.9936 1111.76 -6.18349 1111.76 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M13.9784 1141.06 L18.8627 1141.06 L18.8627 1146.94 L13.9784 1146.94 L13.9784 1141.06 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M39.0477 1115.46 Q35.4367 1115.46 33.608 1119.03 Q31.8024 1122.57 31.8024 1129.7 Q31.8024 1136.81 33.608 1140.37 Q35.4367 1143.91 39.0477 1143.91 Q42.682 1143.91 44.4875 1140.37 Q46.3162 1136.81 46.3162 1129.7 Q46.3162 1122.57 44.4875 1119.03 Q42.682 1115.46 39.0477 1115.46 M39.0477 1111.76 Q44.8579 1111.76 47.9134 1116.37 Q50.9921 1120.95 50.9921 1129.7 Q50.9921 1138.43 47.9134 1143.03 Q44.8579 1147.62 39.0477 1147.62 Q33.2376 1147.62 30.1589 1143.03 Q27.1034 1138.43 27.1034 1129.7 Q27.1034 1120.95 30.1589 1116.37 Q33.2376 1111.76 39.0477 1111.76 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-11.1603 940.173 L5.15904 940.173 L5.15904 944.108 L-16.7853 944.108 L-16.7853 940.173 Q-14.1233 937.418 -9.53996 932.789 Q-4.9335 928.136 -3.75295 926.793 Q-1.50759 924.27 -0.627968 922.534 Q0.274805 920.775 0.274805 919.085 Q0.274805 916.33 -1.66963 914.594 Q-3.59091 912.858 -6.69275 912.858 Q-8.89181 912.858 -11.3455 913.622 Q-13.776 914.386 -16.5538 915.937 L-16.5538 911.215 Q-13.7297 910.081 -11.2761 909.502 Q-8.82237 908.923 -6.78534 908.923 Q-1.415 908.923 1.77943 911.608 Q4.97385 914.293 4.97385 918.784 Q4.97385 920.914 4.16367 922.835 Q3.37664 924.733 1.27017 927.326 Q0.69147 927.997 -2.41037 931.215 Q-5.5122 934.409 -11.1603 940.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M14.9738 938.229 L19.858 938.229 L19.858 944.108 L14.9738 944.108 L14.9738 938.229 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M30.0895 909.548 L48.4458 909.548 L48.4458 913.483 L34.3718 913.483 L34.3718 921.955 Q35.3904 921.608 36.4089 921.446 Q37.4274 921.261 38.4459 921.261 Q44.2329 921.261 47.6125 924.432 Q50.9921 927.604 50.9921 933.02 Q50.9921 938.599 47.5199 941.701 Q44.0477 944.779 37.7283 944.779 Q35.5524 944.779 33.2839 944.409 Q31.0385 944.039 28.6311 943.298 L28.6311 938.599 Q30.7145 939.733 32.9367 940.289 Q35.1589 940.844 37.6357 940.844 Q41.6403 940.844 43.9783 938.738 Q46.3162 936.631 46.3162 933.02 Q46.3162 929.409 43.9783 927.303 Q41.6403 925.196 37.6357 925.196 Q35.7607 925.196 33.8857 925.613 Q32.0339 926.03 30.0895 926.909 L30.0895 909.548 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-16.1371 706.712 L2.21924 706.712 L2.21924 710.647 L-11.8548 710.647 L-11.8548 719.119 Q-10.8362 718.772 -9.81773 718.61 Q-8.79922 718.425 -7.78071 718.425 Q-1.9937 718.425 1.38591 721.596 Q4.76552 724.767 4.76552 730.184 Q4.76552 735.763 1.29332 738.865 Q-2.17889 741.943 -8.4983 741.943 Q-10.6742 741.943 -12.9427 741.573 Q-15.1881 741.203 -17.5955 740.462 L-17.5955 735.763 Q-15.5121 736.897 -13.2899 737.453 Q-11.0677 738.008 -8.59089 738.008 Q-4.58628 738.008 -2.24833 735.902 Q0.089621 733.795 0.089621 730.184 Q0.089621 726.573 -2.24833 724.467 Q-4.58628 722.36 -8.59089 722.36 Q-10.4659 722.36 -12.3409 722.777 Q-14.1927 723.193 -16.1371 724.073 L-16.1371 706.712 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M13.9784 735.392 L18.8627 735.392 L18.8627 741.272 L13.9784 741.272 L13.9784 735.392 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M39.0477 709.791 Q35.4367 709.791 33.608 713.355 Q31.8024 716.897 31.8024 724.027 Q31.8024 731.133 33.608 734.698 Q35.4367 738.24 39.0477 738.24 Q42.682 738.24 44.4875 734.698 Q46.3162 731.133 46.3162 724.027 Q46.3162 716.897 44.4875 713.355 Q42.682 709.791 39.0477 709.791 M39.0477 706.087 Q44.8579 706.087 47.9134 710.693 Q50.9921 715.277 50.9921 724.027 Q50.9921 732.753 47.9134 737.36 Q44.8579 741.943 39.0477 741.943 Q33.2376 741.943 30.1589 737.36 Q27.1034 732.753 27.1034 724.027 Q27.1034 715.277 30.1589 710.693 Q33.2376 706.087 39.0477 706.087 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-16.3686 503.876 L5.85348 503.876 L5.85348 505.867 L-6.69275 538.436 L-11.577 538.436 L0.228509 507.811 L-16.3686 507.811 L-16.3686 503.876 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M14.9738 532.556 L19.858 532.556 L19.858 538.436 L14.9738 538.436 L14.9738 532.556 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M30.0895 503.876 L48.4458 503.876 L48.4458 507.811 L34.3718 507.811 L34.3718 516.283 Q35.3904 515.936 36.4089 515.774 Q37.4274 515.589 38.4459 515.589 Q44.2329 515.589 47.6125 518.76 Q50.9921 521.931 50.9921 527.348 Q50.9921 532.927 47.5199 536.028 Q44.0477 539.107 37.7283 539.107 Q35.5524 539.107 33.2839 538.737 Q31.0385 538.366 28.6311 537.626 L28.6311 532.927 Q30.7145 534.061 32.9367 534.616 Q35.1589 535.172 37.6357 535.172 Q41.6403 535.172 43.9783 533.065 Q46.3162 530.959 46.3162 527.348 Q46.3162 523.737 43.9783 521.63 Q41.6403 519.524 37.6357 519.524 Q35.7607 519.524 33.8857 519.941 Q32.0339 520.357 30.0895 521.237 L30.0895 503.876 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-45.5351 331.665 L-37.8963 331.665 L-37.8963 305.299 L-46.2064 306.966 L-46.2064 302.706 L-37.9426 301.04 L-33.2667 301.04 L-33.2667 331.665 L-25.6278 331.665 L-25.6278 335.6 L-45.5351 335.6 L-45.5351 331.665 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-6.18349 304.118 Q-9.79459 304.118 -11.6233 307.683 Q-13.4288 311.225 -13.4288 318.354 Q-13.4288 325.461 -11.6233 329.026 Q-9.79459 332.567 -6.18349 332.567 Q-2.54925 332.567 -0.743708 329.026 Q1.08499 325.461 1.08499 318.354 Q1.08499 311.225 -0.743708 307.683 Q-2.54925 304.118 -6.18349 304.118 M-6.18349 300.415 Q-0.37334 300.415 2.6822 305.021 Q5.76089 309.604 5.76089 318.354 Q5.76089 327.081 2.6822 331.688 Q-0.37334 336.271 -6.18349 336.271 Q-11.9936 336.271 -15.0723 331.688 Q-18.1279 327.081 -18.1279 318.354 Q-18.1279 309.604 -15.0723 305.021 Q-11.9936 300.415 -6.18349 300.415 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M13.9784 329.72 L18.8627 329.72 L18.8627 335.6 L13.9784 335.6 L13.9784 329.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M39.0477 304.118 Q35.4367 304.118 33.608 307.683 Q31.8024 311.225 31.8024 318.354 Q31.8024 325.461 33.608 329.026 Q35.4367 332.567 39.0477 332.567 Q42.682 332.567 44.4875 329.026 Q46.3162 325.461 46.3162 318.354 Q46.3162 311.225 44.4875 307.683 Q42.682 304.118 39.0477 304.118 M39.0477 300.415 Q44.8579 300.415 47.9134 305.021 Q50.9921 309.604 50.9921 318.354 Q50.9921 327.081 47.9134 331.688 Q44.8579 336.271 39.0477 336.271 Q33.2376 336.271 30.1589 331.688 Q27.1034 327.081 27.1034 318.354 Q27.1034 309.604 30.1589 305.021 Q33.2376 300.415 39.0477 300.415 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-44.5398 128.828 L-36.9009 128.828 L-36.9009 102.463 L-45.2111 104.129 L-45.2111 99.8702 L-36.9472 98.2036 L-32.2713 98.2036 L-32.2713 128.828 L-24.6325 128.828 L-24.6325 132.764 L-44.5398 132.764 L-44.5398 128.828 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M-11.1603 128.828 L5.15904 128.828 L5.15904 132.764 L-16.7853 132.764 L-16.7853 128.828 Q-14.1233 126.074 -9.53996 121.444 Q-4.9335 116.791 -3.75295 115.449 Q-1.50759 112.926 -0.627968 111.19 Q0.274805 109.43 0.274805 107.741 Q0.274805 104.986 -1.66963 103.25 Q-3.59091 101.514 -6.69275 101.514 Q-8.89181 101.514 -11.3455 102.278 Q-13.776 103.041 -16.5538 104.592 L-16.5538 99.8702 Q-13.7297 98.736 -11.2761 98.1573 Q-8.82237 97.5786 -6.78534 97.5786 Q-1.415 97.5786 1.77943 100.264 Q4.97385 102.949 4.97385 107.44 Q4.97385 109.569 4.16367 111.491 Q3.37664 113.389 1.27017 115.981 Q0.69147 116.653 -2.41037 119.87 Q-5.5122 123.065 -11.1603 128.828 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M14.9738 126.884 L19.858 126.884 L19.858 132.764 L14.9738 132.764 L14.9738 126.884 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip830)" d="M30.0895 98.2036 L48.4458 98.2036 L48.4458 102.139 L34.3718 102.139 L34.3718 110.611 Q35.3904 110.264 36.4089 110.102 Q37.4274 109.916 38.4459 109.916 Q44.2329 109.916 47.6125 113.088 Q50.9921 116.259 50.9921 121.676 Q50.9921 127.254 47.5199 130.356 Q44.0477 133.435 37.7283 133.435 Q35.5524 133.435 33.2839 133.064 Q31.0385 132.694 28.6311 131.953 L28.6311 127.254 Q30.7145 128.389 32.9367 128.944 Q35.1589 129.5 37.6357 129.5 Q41.6403 129.5 43.9783 127.393 Q46.3162 125.287 46.3162 121.676 Q46.3162 118.065 43.9783 115.958 Q41.6403 113.852 37.6357 113.852 Q35.7607 113.852 33.8857 114.268 Q32.0339 114.685 30.0895 115.565 L30.0895 98.2036 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip832)" d="
M151.118 1249.5 L222.368 1399.43 L293.618 1474.79 L364.869 1479.3 L436.119 1470.58 L507.37 1458.19 L578.62 1441.57 L649.871 1424.63 L721.121 1413.21 L792.371 1398.74 
  L863.622 1388.4 L934.872 1375.99 L1006.12 1362.36 L1077.37 1354.87 L1148.62 1340.51 L1219.87 1330.36 L1291.12 1319.43 L1362.37 1309.89 L1433.63 1297.61 L1504.88 1284.02 
  L1576.13 1272.7 L1647.38 1268.8 L1718.63 1260.92 L1789.88 1255.04 L1861.13 1251.44 L1932.38 1249.97 L2003.63 1246.38 L2074.88 1242.89 L2146.13 1241.36 L2217.38 1233.1 
  L2288.63 1230.54 L2288.63 861.137 L2217.38 848.359 L2146.13 836.491 L2074.88 817.814 L2003.63 800.663 L1932.38 784.037 L1861.13 769.597 L1789.88 756.652 L1718.63 741.784 
  L1647.38 718.318 L1576.13 691.556 L1504.88 670.789 L1433.63 645.528 L1362.37 616.497 L1291.12 587.767 L1219.87 560.688 L1148.62 525.669 L1077.37 495.448 L1006.12 465.954 
  L934.872 436.305 L863.622 399.753 L792.371 365.711 L721.121 325.261 L649.871 281.711 L578.62 243.538 L507.37 203.63 L436.119 154.051 L364.869 110.838 L293.618 88.9544 
  L222.368 187.283 L151.118 970.192  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip832)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1118.78 222.368,1167.96 293.618,1186.28 364.869,1184.66 436.119,1184.87 507.37,1183.14 578.62,1180.37 649.871,1179.48 721.121,1179.79 792.371,1180.3 
  863.622,1174.71 934.872,1176.44 1006.12,1169.93 1077.37,1166.99 1148.62,1165.01 1219.87,1168.67 1291.12,1162.34 1362.37,1160.17 1433.63,1158.59 1504.88,1154.98 
  1576.13,1150.52 1647.38,1150.38 1718.63,1157.81 1789.88,1150.53 1861.13,1150.21 1932.38,1151.27 2003.63,1152.47 2074.88,1155.27 2146.13,1153.94 2217.38,1151.55 
  2288.63,1150.2 
  "/>
<path clip-path="url(#clip832)" d="
M151.118 1272.64 L222.368 1157.07 L293.618 1136.05 L364.869 1131.65 L436.119 1130.91 L507.37 1131.01 L578.62 1130.86 L649.871 1130.68 L721.121 1130.88 L792.371 1130.98 
  L863.622 1130.67 L934.872 1130.81 L1006.12 1130.62 L1077.37 1130.73 L1148.62 1130.8 L1219.87 1130.97 L1291.12 1130.95 L1362.37 1130.75 L1433.63 1130.91 L1504.88 1130.66 
  L1576.13 1130.93 L1647.38 1131.09 L1718.63 1130.8 L1789.88 1130.6 L1861.13 1130.82 L1932.38 1131 L2003.63 1131.2 L2074.88 1130.98 L2146.13 1130.64 L2217.38 1131.3 
  L2288.63 1130.6 L2288.63 1128.4 L2217.38 1128.52 L2146.13 1128.33 L2074.88 1128.53 L2003.63 1128.9 L1932.38 1127.83 L1861.13 1128.35 L1789.88 1128.53 L1718.63 1128.49 
  L1647.38 1128.4 L1576.13 1128.7 L1504.88 1128.28 L1433.63 1128.27 L1362.37 1128.58 L1291.12 1128 L1219.87 1128.26 L1148.62 1128.21 L1077.37 1128.62 L1006.12 1128.43 
  L934.872 1128.5 L863.622 1128.35 L792.371 1128.41 L721.121 1128.49 L649.871 1128.5 L578.62 1128.6 L507.37 1128.4 L436.119 1128.19 L364.869 1128.02 L293.618 1125.5 
  L222.368 1110.06 L151.118 1034.61  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip832)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1149.79 222.368,1134.02 293.618,1130.29 364.869,1129.87 436.119,1129.81 507.37,1129.44 578.62,1129.63 649.871,1129.7 721.121,1129.75 792.371,1129.65 
  863.622,1129.52 934.872,1129.56 1006.12,1129.64 1077.37,1129.78 1148.62,1129.6 1219.87,1129.49 1291.12,1129.55 1362.37,1129.76 1433.63,1129.66 1504.88,1129.59 
  1576.13,1129.78 1647.38,1129.79 1718.63,1129.5 1789.88,1129.43 1861.13,1129.52 1932.38,1129.55 2003.63,1129.84 2074.88,1129.79 2146.13,1129.73 2217.38,1129.63 
  2288.63,1129.61 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">51.93324126432557</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([731.6378796585853, 5368.706586944274], [-101.82050893911264 -1.3162998627739195; -740.9491789100886 -12.899998659225755], [16.5012278979326 -0.029145984778249787; 120.66076809830486 -0.10441159646393194;;; -0.029145984778249787 0.0543207204364736; -0.10441159646393194 0.5036554755318597], [-140.36184751381458; -742.4667149174893;;], [11.352109441502066, 66.26039631256918], [-6.203117728941265 0.5939289447214338; -7.485941437412894 -0.4735635013514197], [0.8763052163829692 -0.09313615969075602; 0.8820729982639967 0.04261944694808699;;; -0.09313615969075602 0.0015483801486305844; 0.04261944694808699 0.019144080821341464], [2.410480875430625 2.8546846342252667 … -0.577924563878883 -0.02641434304633927])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Friday 12 August 2022 23:44">Friday 12 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
