<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/linear_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Linear (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Simulating-Ensembles-and-Fixing-Noise"><span>Simulating Ensembles and Fixing Noise</span></a></li><li><a class="tocitem" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><span>Observables and Marginal Likelihood using a Kalman Filter</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li><li><a class="tocitem" href="#Composition-of-State-Space-Models-and-AD"><span>Composition of State Space Models and AD</span></a></li><li><a class="tocitem" href="#Caveats-on-Gradients-and-Performance"><span>Caveats on Gradients and Performance</span></a></li></ul></li><li><a class="tocitem" href="../quadratic_state_space_examples/">Quadratic State Space Examples</a></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/linear_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-State-Space-Examples"><a class="docs-heading-anchor" href="#Linear-State-Space-Examples">Linear State Space Examples</a><a id="Linear-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-State-Space-Examples" title="Permalink"></a></h1><p>This tutorial provides describes the support for linear and linear gaussian state space models.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form of the linear model is</p><p class="math-container">\[u_{n+1} = A u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.  More generally, support could be added for <span>$u_{n+1} = A(p,n) u_n + B(p,n) w_{n+1}$</span> where <span>$p$</span> is a vector of differentiable parameters, and the <span>$A$</span> and <span>$B$</span> are potentially matrix-free operators.</p><h2 id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model">Simulating a Linear (and Time-Invariant) State Space Model</a><a id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>LinearStateSpaceProblem</code> and simulating it for a simple, linear equation.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote
A = [0.95 6.2;
     0.0  0.2]
B = [0.0; 0.01;;] # matrix
C = [0.09 0.67;
     1.00 0.00]
D = [0.1, 0.1] # diagonal observation noise
u0 = zeros(2)
T = 10

prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:10
u: 11-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [0.0, 0.00841652751894345]
 [0.0521824706174494, -0.004554850034602507]
 [0.02133327687204139, -0.020910882391804705]
 [-0.10938085780074985, 0.0016852393439880818]
 [-0.09346333097798624, 0.010159864974687311]
 [-0.02579900158602559, -0.0025705849290345766]
 [-0.040446678066738684, 0.003696472750725619]
 [-0.015506213108902912, 0.010078111888488103]
 [0.047753391255168476, -0.012163915437231413]
 [-0.030050554018424713, -0.008648393841343444]</code></pre><p>The <code>u</code> vector of the simulated solution can be plotted using standard recipes, including use of the optional <code>syms</code>.  See <a href="https://diffeq.sciml.ai/latest/basics/plot/">SciML docs</a> for more options.</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip470">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip470)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip471">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip470)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip472">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  540.145,1505.26 540.145,47.2441 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  993.298,1505.26 993.298,47.2441 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1446.45,1505.26 1446.45,47.2441 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1899.6,1505.26 1899.6,47.2441 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  540.145,1505.26 540.145,1486.36 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  993.298,1505.26 993.298,1486.36 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1446.45,1505.26 1446.45,1486.36 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1899.6,1505.26 1899.6,1486.36 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip470)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1298.99 2352.76,1298.99 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1043.59 2352.76,1043.59 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,788.178 2352.76,788.178 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,532.77 2352.76,532.77 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,277.362 2352.76,277.362 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1298.99 105.89,1298.99 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1043.59 105.89,1043.59 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,788.178 105.89,788.178 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,532.77 105.89,532.77 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,277.362 105.89,277.362 
  "/>
<path clip-path="url(#clip470)" d="M-85.9284 1299.45 L-56.2527 1299.45 L-56.2527 1303.38 L-85.9284 1303.38 L-85.9284 1299.45 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-36.1602 1284.79 Q-39.7713 1284.79 -41.6 1288.36 Q-43.4055 1291.9 -43.4055 1299.03 Q-43.4055 1306.14 -41.6 1309.7 Q-39.7713 1313.24 -36.1602 1313.24 Q-32.5259 1313.24 -30.7204 1309.7 Q-28.8917 1306.14 -28.8917 1299.03 Q-28.8917 1291.9 -30.7204 1288.36 Q-32.5259 1284.79 -36.1602 1284.79 M-36.1602 1281.09 Q-30.35 1281.09 -27.2945 1285.7 Q-24.2158 1290.28 -24.2158 1299.03 Q-24.2158 1307.76 -27.2945 1312.36 Q-30.35 1316.95 -36.1602 1316.95 Q-41.9703 1316.95 -45.049 1312.36 Q-48.1046 1307.76 -48.1046 1299.03 Q-48.1046 1290.28 -45.049 1285.7 Q-41.9703 1281.09 -36.1602 1281.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-15.9983 1310.39 L-11.114 1310.39 L-11.114 1316.27 L-15.9983 1316.27 L-15.9983 1310.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M9.07105 1284.79 Q5.45996 1284.79 3.63127 1288.36 Q1.82572 1291.9 1.82572 1299.03 Q1.82572 1306.14 3.63127 1309.7 Q5.45996 1313.24 9.07105 1313.24 Q12.7053 1313.24 14.5108 1309.7 Q16.3395 1306.14 16.3395 1299.03 Q16.3395 1291.9 14.5108 1288.36 Q12.7053 1284.79 9.07105 1284.79 M9.07105 1281.09 Q14.8812 1281.09 17.9367 1285.7 Q21.0154 1290.28 21.0154 1299.03 Q21.0154 1307.76 17.9367 1312.36 Q14.8812 1316.95 9.07105 1316.95 Q3.2609 1316.95 0.182213 1312.36 Q-2.87333 1307.76 -2.87333 1299.03 Q-2.87333 1290.28 0.182213 1285.7 Q3.2609 1281.09 9.07105 1281.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M29.3719 1315.56 L29.3719 1311.3 Q31.1311 1312.13 32.9367 1312.57 Q34.7422 1313.01 36.4783 1313.01 Q41.1079 1313.01 43.5385 1309.91 Q45.9922 1306.78 46.3394 1300.44 Q44.9968 1302.43 42.9366 1303.5 Q40.8764 1304.56 38.3765 1304.56 Q33.1913 1304.56 30.1589 1301.44 Q27.1497 1298.29 27.1497 1292.85 Q27.1497 1287.52 30.2978 1284.31 Q33.4459 1281.09 38.6774 1281.09 Q44.6727 1281.09 47.8208 1285.7 Q50.9921 1290.28 50.9921 1299.03 Q50.9921 1307.2 47.1033 1312.08 Q43.2375 1316.95 36.6866 1316.95 Q34.9274 1316.95 33.1219 1316.6 Q31.3163 1316.25 29.3719 1315.56 M38.6774 1300.9 Q41.8255 1300.9 43.6542 1298.75 Q45.506 1296.6 45.506 1292.85 Q45.506 1289.12 43.6542 1286.97 Q41.8255 1284.79 38.6774 1284.79 Q35.5292 1284.79 33.6774 1286.97 Q31.8487 1289.12 31.8487 1292.85 Q31.8487 1296.6 33.6774 1298.75 Q35.5292 1300.9 38.6774 1300.9 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-86.2757 1044.04 L-56.5999 1044.04 L-56.5999 1047.97 L-86.2757 1047.97 L-86.2757 1044.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-36.5074 1029.38 Q-40.1185 1029.38 -41.9472 1032.95 Q-43.7527 1036.49 -43.7527 1043.62 Q-43.7527 1050.73 -41.9472 1054.29 Q-40.1185 1057.83 -36.5074 1057.83 Q-32.8732 1057.83 -31.0676 1054.29 Q-29.2389 1050.73 -29.2389 1043.62 Q-29.2389 1036.49 -31.0676 1032.95 Q-32.8732 1029.38 -36.5074 1029.38 M-36.5074 1025.68 Q-30.6973 1025.68 -27.6417 1030.29 Q-24.563 1034.87 -24.563 1043.62 Q-24.563 1052.35 -27.6417 1056.95 Q-30.6973 1061.54 -36.5074 1061.54 Q-42.3176 1061.54 -45.3962 1056.95 Q-48.4518 1052.35 -48.4518 1043.62 Q-48.4518 1034.87 -45.3962 1030.29 Q-42.3176 1025.68 -36.5074 1025.68 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-16.3455 1054.99 L-11.4612 1054.99 L-11.4612 1060.87 L-16.3455 1060.87 L-16.3455 1054.99 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M8.72383 1029.38 Q5.11274 1029.38 3.28405 1032.95 Q1.4785 1036.49 1.4785 1043.62 Q1.4785 1050.73 3.28405 1054.29 Q5.11274 1057.83 8.72383 1057.83 Q12.3581 1057.83 14.1636 1054.29 Q15.9923 1050.73 15.9923 1043.62 Q15.9923 1036.49 14.1636 1032.95 Q12.3581 1029.38 8.72383 1029.38 M8.72383 1025.68 Q14.534 1025.68 17.5895 1030.29 Q20.6682 1034.87 20.6682 1043.62 Q20.6682 1052.35 17.5895 1056.95 Q14.534 1061.54 8.72383 1061.54 Q2.91368 1061.54 -0.165007 1056.95 Q-3.22055 1052.35 -3.22055 1043.62 Q-3.22055 1034.87 -0.165007 1030.29 Q2.91368 1025.68 8.72383 1025.68 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M39.4644 1041.72 Q36.3163 1041.72 34.4644 1043.88 Q32.6357 1046.03 32.6357 1049.78 Q32.6357 1053.5 34.4644 1055.68 Q36.3163 1057.83 39.4644 1057.83 Q42.6125 1057.83 44.4412 1055.68 Q46.2931 1053.5 46.2931 1049.78 Q46.2931 1046.03 44.4412 1043.88 Q42.6125 1041.72 39.4644 1041.72 M48.7468 1027.07 L48.7468 1031.33 Q46.9875 1030.5 45.182 1030.06 Q43.3996 1029.62 41.6403 1029.62 Q37.0107 1029.62 34.557 1032.74 Q32.1265 1035.87 31.7793 1042.19 Q33.145 1040.17 35.2052 1039.11 Q37.2653 1038.02 39.7422 1038.02 Q44.9505 1038.02 47.9597 1041.19 Q50.9921 1044.34 50.9921 1049.78 Q50.9921 1055.1 47.844 1058.32 Q44.6959 1061.54 39.4644 1061.54 Q33.4691 1061.54 30.2978 1056.95 Q27.1265 1052.35 27.1265 1043.62 Q27.1265 1035.43 31.0154 1030.57 Q34.9042 1025.68 41.4551 1025.68 Q43.2144 1025.68 44.9968 1026.03 Q46.8023 1026.38 48.7468 1027.07 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-85.4655 788.629 L-55.7897 788.629 L-55.7897 792.564 L-85.4655 792.564 L-85.4655 788.629 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-35.6972 773.977 Q-39.3083 773.977 -41.137 777.541 Q-42.9426 781.083 -42.9426 788.213 Q-42.9426 795.319 -41.137 798.884 Q-39.3083 802.425 -35.6972 802.425 Q-32.063 802.425 -30.2574 798.884 Q-28.4287 795.319 -28.4287 788.213 Q-28.4287 781.083 -30.2574 777.541 Q-32.063 773.977 -35.6972 773.977 M-35.6972 770.273 Q-29.8871 770.273 -26.8315 774.879 Q-23.7528 779.463 -23.7528 788.213 Q-23.7528 796.939 -26.8315 801.546 Q-29.8871 806.129 -35.6972 806.129 Q-41.5074 806.129 -44.5861 801.546 Q-47.6416 796.939 -47.6416 788.213 Q-47.6416 779.463 -44.5861 774.879 Q-41.5074 770.273 -35.6972 770.273 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-15.5353 799.578 L-10.6511 799.578 L-10.6511 805.458 L-15.5353 805.458 L-15.5353 799.578 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M9.53401 773.977 Q5.92292 773.977 4.09423 777.541 Q2.28868 781.083 2.28868 788.213 Q2.28868 795.319 4.09423 798.884 Q5.92292 802.425 9.53401 802.425 Q13.1683 802.425 14.9738 798.884 Q16.8025 795.319 16.8025 788.213 Q16.8025 781.083 14.9738 777.541 Q13.1683 773.977 9.53401 773.977 M9.53401 770.273 Q15.3442 770.273 18.3997 774.879 Q21.4784 779.463 21.4784 788.213 Q21.4784 796.939 18.3997 801.546 Q15.3442 806.129 9.53401 806.129 Q3.72386 806.129 0.645174 801.546 Q-2.41037 796.939 -2.41037 788.213 Q-2.41037 779.463 0.645174 774.879 Q3.72386 770.273 9.53401 770.273 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M43.8625 786.824 Q47.219 787.541 49.094 789.81 Q50.9921 792.078 50.9921 795.412 Q50.9921 800.527 47.4736 803.328 Q43.9551 806.129 37.4737 806.129 Q35.2978 806.129 32.983 805.689 Q30.6913 805.273 28.2376 804.416 L28.2376 799.902 Q30.1821 801.037 32.4969 801.615 Q34.8117 802.194 37.3348 802.194 Q41.7329 802.194 44.0246 800.458 Q46.3394 798.722 46.3394 795.412 Q46.3394 792.356 44.1866 790.643 Q42.057 788.907 38.2376 788.907 L34.2098 788.907 L34.2098 785.064 L38.4227 785.064 Q41.8718 785.064 43.7005 783.699 Q45.5292 782.31 45.5292 779.717 Q45.5292 777.055 43.6311 775.643 Q41.7561 774.208 38.2376 774.208 Q36.3163 774.208 34.1172 774.625 Q31.9182 775.041 29.2793 775.921 L29.2793 771.754 Q31.9413 771.014 34.2561 770.643 Q36.5941 770.273 38.6542 770.273 Q43.9783 770.273 47.0801 772.703 Q50.1819 775.111 50.1819 779.231 Q50.1819 782.102 48.5384 784.092 Q46.8949 786.06 43.8625 786.824 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-36.3454 518.568 Q-39.9565 518.568 -41.7852 522.133 Q-43.5907 525.675 -43.5907 532.804 Q-43.5907 539.911 -41.7852 543.476 Q-39.9565 547.017 -36.3454 547.017 Q-32.7111 547.017 -30.9056 543.476 Q-29.0769 539.911 -29.0769 532.804 Q-29.0769 525.675 -30.9056 522.133 Q-32.7111 518.568 -36.3454 518.568 M-36.3454 514.865 Q-30.5352 514.865 -27.4797 519.471 Q-24.401 524.054 -24.401 532.804 Q-24.401 541.531 -27.4797 546.138 Q-30.5352 550.721 -36.3454 550.721 Q-42.1555 550.721 -45.2342 546.138 Q-48.2897 541.531 -48.2897 532.804 Q-48.2897 524.054 -45.2342 519.471 Q-42.1555 514.865 -36.3454 514.865 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-16.1834 544.17 L-11.2992 544.17 L-11.2992 550.05 L-16.1834 550.05 L-16.1834 544.17 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M8.88587 518.568 Q5.27478 518.568 3.44608 522.133 Q1.64054 525.675 1.64054 532.804 Q1.64054 539.911 3.44608 543.476 Q5.27478 547.017 8.88587 547.017 Q12.5201 547.017 14.3257 543.476 Q16.1543 539.911 16.1543 532.804 Q16.1543 525.675 14.3257 522.133 Q12.5201 518.568 8.88587 518.568 M8.88587 514.865 Q14.696 514.865 17.7516 519.471 Q20.8303 524.054 20.8303 532.804 Q20.8303 541.531 17.7516 546.138 Q14.696 550.721 8.88587 550.721 Q3.07572 550.721 -0.00297114 546.138 Q-3.05851 541.531 -3.05851 532.804 Q-3.05851 524.054 -0.00297114 519.471 Q3.07572 514.865 8.88587 514.865 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M39.0477 518.568 Q35.4367 518.568 33.608 522.133 Q31.8024 525.675 31.8024 532.804 Q31.8024 539.911 33.608 543.476 Q35.4367 547.017 39.0477 547.017 Q42.682 547.017 44.4875 543.476 Q46.3162 539.911 46.3162 532.804 Q46.3162 525.675 44.4875 522.133 Q42.682 518.568 39.0477 518.568 M39.0477 514.865 Q44.8579 514.865 47.9134 519.471 Q50.9921 524.054 50.9921 532.804 Q50.9921 541.531 47.9134 546.138 Q44.8579 550.721 39.0477 550.721 Q33.2376 550.721 30.1589 546.138 Q27.1034 541.531 27.1034 532.804 Q27.1034 524.054 30.1589 519.471 Q33.2376 514.865 39.0477 514.865 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-35.6972 263.16 Q-39.3083 263.16 -41.137 266.725 Q-42.9426 270.267 -42.9426 277.396 Q-42.9426 284.503 -41.137 288.067 Q-39.3083 291.609 -35.6972 291.609 Q-32.063 291.609 -30.2574 288.067 Q-28.4287 284.503 -28.4287 277.396 Q-28.4287 270.267 -30.2574 266.725 Q-32.063 263.16 -35.6972 263.16 M-35.6972 259.457 Q-29.8871 259.457 -26.8315 264.063 Q-23.7528 268.646 -23.7528 277.396 Q-23.7528 286.123 -26.8315 290.729 Q-29.8871 295.313 -35.6972 295.313 Q-41.5074 295.313 -44.5861 290.729 Q-47.6416 286.123 -47.6416 277.396 Q-47.6416 268.646 -44.5861 264.063 Q-41.5074 259.457 -35.6972 259.457 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M-15.5353 288.762 L-10.6511 288.762 L-10.6511 294.642 L-15.5353 294.642 L-15.5353 288.762 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M9.53401 263.16 Q5.92292 263.16 4.09423 266.725 Q2.28868 270.267 2.28868 277.396 Q2.28868 284.503 4.09423 288.067 Q5.92292 291.609 9.53401 291.609 Q13.1683 291.609 14.9738 288.067 Q16.8025 284.503 16.8025 277.396 Q16.8025 270.267 14.9738 266.725 Q13.1683 263.16 9.53401 263.16 M9.53401 259.457 Q15.3442 259.457 18.3997 264.063 Q21.4784 268.646 21.4784 277.396 Q21.4784 286.123 18.3997 290.729 Q15.3442 295.313 9.53401 295.313 Q3.72386 295.313 0.645174 290.729 Q-2.41037 286.123 -2.41037 277.396 Q-2.41037 268.646 0.645174 264.063 Q3.72386 259.457 9.53401 259.457 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip470)" d="M43.8625 276.007 Q47.219 276.725 49.094 278.993 Q50.9921 281.262 50.9921 284.595 Q50.9921 289.711 47.4736 292.512 Q43.9551 295.313 37.4737 295.313 Q35.2978 295.313 32.983 294.873 Q30.6913 294.456 28.2376 293.6 L28.2376 289.086 Q30.1821 290.22 32.4969 290.799 Q34.8117 291.378 37.3348 291.378 Q41.7329 291.378 44.0246 289.642 Q46.3394 287.905 46.3394 284.595 Q46.3394 281.54 44.1866 279.827 Q42.057 278.091 38.2376 278.091 L34.2098 278.091 L34.2098 274.248 L38.4227 274.248 Q41.8718 274.248 43.7005 272.882 Q45.5292 271.493 45.5292 268.901 Q45.5292 266.239 43.6311 264.827 Q41.7561 263.392 38.2376 263.392 Q36.3163 263.392 34.1172 263.808 Q31.9182 264.225 29.2793 265.105 L29.2793 260.938 Q31.9413 260.197 34.2561 259.827 Q36.5941 259.457 38.6542 259.457 Q43.9783 259.457 47.0801 261.887 Q50.1819 264.294 50.1819 268.415 Q50.1819 271.285 48.5384 273.276 Q46.8949 275.243 43.8625 276.007 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip472)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,532.77 313.569,532.77 540.145,88.5087 766.721,351.147 993.298,1464 1219.87,1328.48 1446.45,752.412 1673.03,877.117 1899.6,664.783 2126.18,126.216 
  2352.76,788.608 
  "/>
<polyline clip-path="url(#clip472)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,532.77 313.569,461.115 540.145,571.548 766.721,710.797 993.298,518.422 1219.87,446.273 1446.45,554.655 1673.03,501.299 1899.6,446.969 2126.18,636.328 
  2352.76,606.399 
  "/>
<path clip-path="url(#clip470)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip470)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip470)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip470)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip470)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip470)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>By default the solution provides an interface to access the simulated <code>u</code>.  That is, <code>sol.u[...] = sol[...]</code>,</p><pre><code class="language-julia hljs">sol[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.0
 0.00841652751894345</code></pre><p>Or to get the first element of the last step</p><pre><code class="language-julia hljs">sol[end][1] #first element of last step</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-0.030050554018424713</code></pre><p>Finally, to extract the full vector</p><pre><code class="language-julia hljs">@show sol[2,:];  # whole second vector</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
  0.00841652751894345
 -0.004554850034602507
 -0.020910882391804705
  0.0016852393439880818
  0.010159864974687311
 -0.0025705849290345766
  0.003696472750725619
  0.010078111888488103
 -0.012163915437231413
 -0.008648393841343444</code></pre><p>The results for all of <code>sol.u</code> can be loaded in a dataframe, where the column names will be the (optionally) provided symbols.</p><pre><code class="language-julia hljs">df = DataFrame(sol)</code></pre><div class="data-frame"><p>11 rows × 3 columns</p><table class="data-frame"><thead><tr><th></th><th>timestamp</th><th>a</th><th>b</th></tr><tr><th></th><th title="Int64">Int64</th><th title="Float64">Float64</th><th title="Float64">Float64</th></tr></thead><tbody><tr><th>1</th><td>0</td><td>0.0</td><td>0.0</td></tr><tr><th>2</th><td>1</td><td>0.0</td><td>0.00841653</td></tr><tr><th>3</th><td>2</td><td>0.0521825</td><td>-0.00455485</td></tr><tr><th>4</th><td>3</td><td>0.0213333</td><td>-0.0209109</td></tr><tr><th>5</th><td>4</td><td>-0.109381</td><td>0.00168524</td></tr><tr><th>6</th><td>5</td><td>-0.0934633</td><td>0.0101599</td></tr><tr><th>7</th><td>6</td><td>-0.025799</td><td>-0.00257058</td></tr><tr><th>8</th><td>7</td><td>-0.0404467</td><td>0.00369647</td></tr><tr><th>9</th><td>8</td><td>-0.0155062</td><td>0.0100781</td></tr><tr><th>10</th><td>9</td><td>0.0477534</td><td>-0.0121639</td></tr><tr><th>11</th><td>10</td><td>-0.0300506</td><td>-0.00864839</td></tr></tbody></table></div><p>Other results, such as the simulated noise and observables can be extracted from the solution</p><pre><code class="language-julia hljs">sol.z # observables</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-0.22248547610541486, 0.17582957957820428]
 [-0.16383496460225738, 0.2898043358924536]
 [0.18485556515873325, 0.32776719209286]
 [0.3671292003295169, 0.22691687443795427]
 [-0.17232485013475035, 0.21143971908222625]
 [-0.4291738799867171, -0.6721629342336983]
 [0.7343024709599751, 0.05183026502708066]
 [0.030734063197251058, 0.08093893230310158]
 [0.46291269975844007, -0.2621896659917963]
 [-0.16632251212168633, 0.779412592740546]
 [-0.22427241427186212, 0.2923489362401137]</code></pre><pre><code class="language-julia hljs">sol.W # Simulated Noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10 Matrix{Float64}:
 0.841653  -0.623816  -1.99999  0.586742  …  0.933882  -1.41795  -0.621561</code></pre><p>We can also solve the model passing in fixed noise, which will be useful for joint likelihoods.  First lets extract the noise from the previous solution, then rerun the simulation but with a different initial value</p><pre><code class="language-julia hljs">noise = sol.W
u0_2 = [0.1, 0.0]
prob2 = LinearStateSpaceProblem(A, B, u0_2, (0, T); C, observables_noise = D, syms = [:a, :b], noise)
sol2 = solve(prob2)
plot(sol2)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip530">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip530)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip531">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip530)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip532">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  540.145,1505.26 540.145,47.2441 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  993.298,1505.26 993.298,47.2441 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1446.45,1505.26 1446.45,47.2441 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1899.6,1505.26 1899.6,47.2441 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  540.145,1505.26 540.145,1486.36 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  993.298,1505.26 993.298,1486.36 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1446.45,1505.26 1446.45,1486.36 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1899.6,1505.26 1899.6,1486.36 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip530)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1440.34 2352.76,1440.34 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1238.49 2352.76,1238.49 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1036.64 2352.76,1036.64 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,834.797 2352.76,834.797 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,632.95 2352.76,632.95 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,431.103 2352.76,431.103 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,229.256 2352.76,229.256 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1440.34 105.89,1440.34 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1238.49 105.89,1238.49 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1036.64 105.89,1036.64 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,834.797 105.89,834.797 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,632.95 105.89,632.95 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,431.103 105.89,431.103 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,229.256 105.89,229.256 
  "/>
<path clip-path="url(#clip530)" d="M-115.28 1440.79 L-85.6044 1440.79 L-85.6044 1444.72 L-115.28 1444.72 L-115.28 1440.79 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-65.5119 1426.14 Q-69.123 1426.14 -70.9517 1429.7 Q-72.7572 1433.24 -72.7572 1440.37 Q-72.7572 1447.48 -70.9517 1451.04 Q-69.123 1454.58 -65.5119 1454.58 Q-61.8776 1454.58 -60.0721 1451.04 Q-58.2434 1447.48 -58.2434 1440.37 Q-58.2434 1433.24 -60.0721 1429.7 Q-61.8776 1426.14 -65.5119 1426.14 M-65.5119 1422.43 Q-59.7017 1422.43 -56.6462 1427.04 Q-53.5675 1431.62 -53.5675 1440.37 Q-53.5675 1449.1 -56.6462 1453.7 Q-59.7017 1458.29 -65.5119 1458.29 Q-71.322 1458.29 -74.4007 1453.7 Q-77.4563 1449.1 -77.4563 1440.37 Q-77.4563 1431.62 -74.4007 1427.04 Q-71.322 1422.43 -65.5119 1422.43 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-45.35 1451.74 L-40.4657 1451.74 L-40.4657 1457.62 L-45.35 1457.62 L-45.35 1451.74 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-20.2806 1426.14 Q-23.8917 1426.14 -25.7204 1429.7 Q-27.526 1433.24 -27.526 1440.37 Q-27.526 1447.48 -25.7204 1451.04 Q-23.8917 1454.58 -20.2806 1454.58 Q-16.6464 1454.58 -14.8409 1451.04 Q-13.0122 1447.48 -13.0122 1440.37 Q-13.0122 1433.24 -14.8409 1429.7 Q-16.6464 1426.14 -20.2806 1426.14 M-20.2806 1422.43 Q-14.4705 1422.43 -11.4149 1427.04 Q-8.33626 1431.62 -8.33626 1440.37 Q-8.33626 1449.1 -11.4149 1453.7 Q-14.4705 1458.29 -20.2806 1458.29 Q-26.0908 1458.29 -29.1695 1453.7 Q-32.225 1449.1 -32.225 1440.37 Q-32.225 1431.62 -29.1695 1427.04 Q-26.0908 1422.43 -20.2806 1422.43 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M3.90904 1453.68 L20.2284 1453.68 L20.2284 1457.62 L-1.71592 1457.62 L-1.71592 1453.68 Q0.946098 1450.93 5.52941 1446.3 Q10.1359 1441.64 11.3164 1440.3 Q13.5618 1437.78 14.4414 1436.04 Q15.3442 1434.28 15.3442 1432.59 Q15.3442 1429.84 13.3997 1428.1 Q11.4784 1426.37 8.37661 1426.37 Q6.17755 1426.37 3.72386 1427.13 Q1.29332 1427.89 -1.48444 1429.45 L-1.48444 1424.72 Q1.33961 1423.59 3.7933 1423.01 Q6.247 1422.43 8.28402 1422.43 Q13.6544 1422.43 16.8488 1425.12 Q20.0432 1427.8 20.0432 1432.29 Q20.0432 1434.42 19.233 1436.34 Q18.446 1438.24 16.3395 1440.83 Q15.7608 1441.51 12.659 1444.72 Q9.55716 1447.92 3.90904 1453.68 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M30.0895 1423.06 L48.4458 1423.06 L48.4458 1426.99 L34.3718 1426.99 L34.3718 1435.46 Q35.3904 1435.12 36.4089 1434.96 Q37.4274 1434.77 38.4459 1434.77 Q44.2329 1434.77 47.6125 1437.94 Q50.9921 1441.11 50.9921 1446.53 Q50.9921 1452.11 47.5199 1455.21 Q44.0477 1458.29 37.7283 1458.29 Q35.5524 1458.29 33.2839 1457.92 Q31.0385 1457.55 28.6311 1456.81 L28.6311 1452.11 Q30.7145 1453.24 32.9367 1453.8 Q35.1589 1454.35 37.6357 1454.35 Q41.6403 1454.35 43.9783 1452.25 Q46.3162 1450.14 46.3162 1446.53 Q46.3162 1442.92 43.9783 1440.81 Q41.6403 1438.7 37.6357 1438.7 Q35.7607 1438.7 33.8857 1439.12 Q32.0339 1439.54 30.0895 1440.42 L30.0895 1423.06 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-66.5072 1224.29 Q-70.1183 1224.29 -71.947 1227.85 Q-73.7526 1231.4 -73.7526 1238.52 Q-73.7526 1245.63 -71.947 1249.2 Q-70.1183 1252.74 -66.5072 1252.74 Q-62.873 1252.74 -61.0675 1249.2 Q-59.2388 1245.63 -59.2388 1238.52 Q-59.2388 1231.4 -61.0675 1227.85 Q-62.873 1224.29 -66.5072 1224.29 M-66.5072 1220.59 Q-60.6971 1220.59 -57.6416 1225.19 Q-54.5629 1229.77 -54.5629 1238.52 Q-54.5629 1247.25 -57.6416 1251.86 Q-60.6971 1256.44 -66.5072 1256.44 Q-72.3174 1256.44 -75.3961 1251.86 Q-78.4516 1247.25 -78.4516 1238.52 Q-78.4516 1229.77 -75.3961 1225.19 Q-72.3174 1220.59 -66.5072 1220.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-46.3453 1249.89 L-41.4611 1249.89 L-41.4611 1255.77 L-46.3453 1255.77 L-46.3453 1249.89 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-21.276 1224.29 Q-24.8871 1224.29 -26.7158 1227.85 Q-28.5213 1231.4 -28.5213 1238.52 Q-28.5213 1245.63 -26.7158 1249.2 Q-24.8871 1252.74 -21.276 1252.74 Q-17.6418 1252.74 -15.8362 1249.2 Q-14.0075 1245.63 -14.0075 1238.52 Q-14.0075 1231.4 -15.8362 1227.85 Q-17.6418 1224.29 -21.276 1224.29 M-21.276 1220.59 Q-15.4659 1220.59 -12.4103 1225.19 Q-9.33162 1229.77 -9.33162 1238.52 Q-9.33162 1247.25 -12.4103 1251.86 Q-15.4659 1256.44 -21.276 1256.44 Q-27.0862 1256.44 -30.1648 1251.86 Q-33.2204 1247.25 -33.2204 1238.52 Q-33.2204 1229.77 -30.1648 1225.19 Q-27.0862 1220.59 -21.276 1220.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M8.88587 1224.29 Q5.27478 1224.29 3.44608 1227.85 Q1.64054 1231.4 1.64054 1238.52 Q1.64054 1245.63 3.44608 1249.2 Q5.27478 1252.74 8.88587 1252.74 Q12.5201 1252.74 14.3257 1249.2 Q16.1543 1245.63 16.1543 1238.52 Q16.1543 1231.4 14.3257 1227.85 Q12.5201 1224.29 8.88587 1224.29 M8.88587 1220.59 Q14.696 1220.59 17.7516 1225.19 Q20.8303 1229.77 20.8303 1238.52 Q20.8303 1247.25 17.7516 1251.86 Q14.696 1256.44 8.88587 1256.44 Q3.07572 1256.44 -0.00297114 1251.86 Q-3.05851 1247.25 -3.05851 1238.52 Q-3.05851 1229.77 -0.00297114 1225.19 Q3.07572 1220.59 8.88587 1220.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M39.0477 1224.29 Q35.4367 1224.29 33.608 1227.85 Q31.8024 1231.4 31.8024 1238.52 Q31.8024 1245.63 33.608 1249.2 Q35.4367 1252.74 39.0477 1252.74 Q42.682 1252.74 44.4875 1249.2 Q46.3162 1245.63 46.3162 1238.52 Q46.3162 1231.4 44.4875 1227.85 Q42.682 1224.29 39.0477 1224.29 M39.0477 1220.59 Q44.8579 1220.59 47.9134 1225.19 Q50.9921 1229.77 50.9921 1238.52 Q50.9921 1247.25 47.9134 1251.86 Q44.8579 1256.44 39.0477 1256.44 Q33.2376 1256.44 30.1589 1251.86 Q27.1034 1247.25 27.1034 1238.52 Q27.1034 1229.77 30.1589 1225.19 Q33.2376 1220.59 39.0477 1220.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-65.5119 1022.44 Q-69.123 1022.44 -70.9517 1026.01 Q-72.7572 1029.55 -72.7572 1036.68 Q-72.7572 1043.78 -70.9517 1047.35 Q-69.123 1050.89 -65.5119 1050.89 Q-61.8776 1050.89 -60.0721 1047.35 Q-58.2434 1043.78 -58.2434 1036.68 Q-58.2434 1029.55 -60.0721 1026.01 Q-61.8776 1022.44 -65.5119 1022.44 M-65.5119 1018.74 Q-59.7017 1018.74 -56.6462 1023.34 Q-53.5675 1027.93 -53.5675 1036.68 Q-53.5675 1045.4 -56.6462 1050.01 Q-59.7017 1054.59 -65.5119 1054.59 Q-71.322 1054.59 -74.4007 1050.01 Q-77.4563 1045.4 -77.4563 1036.68 Q-77.4563 1027.93 -74.4007 1023.34 Q-71.322 1018.74 -65.5119 1018.74 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-45.35 1048.04 L-40.4657 1048.04 L-40.4657 1053.92 L-45.35 1053.92 L-45.35 1048.04 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-20.2806 1022.44 Q-23.8917 1022.44 -25.7204 1026.01 Q-27.526 1029.55 -27.526 1036.68 Q-27.526 1043.78 -25.7204 1047.35 Q-23.8917 1050.89 -20.2806 1050.89 Q-16.6464 1050.89 -14.8409 1047.35 Q-13.0122 1043.78 -13.0122 1036.68 Q-13.0122 1029.55 -14.8409 1026.01 Q-16.6464 1022.44 -20.2806 1022.44 M-20.2806 1018.74 Q-14.4705 1018.74 -11.4149 1023.34 Q-8.33626 1027.93 -8.33626 1036.68 Q-8.33626 1045.4 -11.4149 1050.01 Q-14.4705 1054.59 -20.2806 1054.59 Q-26.0908 1054.59 -29.1695 1050.01 Q-32.225 1045.4 -32.225 1036.68 Q-32.225 1027.93 -29.1695 1023.34 Q-26.0908 1018.74 -20.2806 1018.74 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M3.90904 1049.99 L20.2284 1049.99 L20.2284 1053.92 L-1.71592 1053.92 L-1.71592 1049.99 Q0.946098 1047.23 5.52941 1042.6 Q10.1359 1037.95 11.3164 1036.61 Q13.5618 1034.09 14.4414 1032.35 Q15.3442 1030.59 15.3442 1028.9 Q15.3442 1026.15 13.3997 1024.41 Q11.4784 1022.67 8.37661 1022.67 Q6.17755 1022.67 3.72386 1023.44 Q1.29332 1024.2 -1.48444 1025.75 L-1.48444 1021.03 Q1.33961 1019.9 3.7933 1019.32 Q6.247 1018.74 8.28402 1018.74 Q13.6544 1018.74 16.8488 1021.42 Q20.0432 1024.11 20.0432 1028.6 Q20.0432 1030.73 19.233 1032.65 Q18.446 1034.55 16.3395 1037.14 Q15.7608 1037.81 12.659 1041.03 Q9.55716 1044.22 3.90904 1049.99 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M30.0895 1019.36 L48.4458 1019.36 L48.4458 1023.3 L34.3718 1023.3 L34.3718 1031.77 Q35.3904 1031.42 36.4089 1031.26 Q37.4274 1031.08 38.4459 1031.08 Q44.2329 1031.08 47.6125 1034.25 Q50.9921 1037.42 50.9921 1042.84 Q50.9921 1048.41 47.5199 1051.52 Q44.0477 1054.59 37.7283 1054.59 Q35.5524 1054.59 33.2839 1054.22 Q31.0385 1053.85 28.6311 1053.11 L28.6311 1048.41 Q30.7145 1049.55 32.9367 1050.1 Q35.1589 1050.66 37.6357 1050.66 Q41.6403 1050.66 43.9783 1048.55 Q46.3162 1046.45 46.3162 1042.84 Q46.3162 1039.22 43.9783 1037.12 Q41.6403 1035.01 37.6357 1035.01 Q35.7607 1035.01 33.8857 1035.43 Q32.0339 1035.84 30.0895 1036.72 L30.0895 1019.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-66.5072 820.595 Q-70.1183 820.595 -71.947 824.16 Q-73.7526 827.702 -73.7526 834.831 Q-73.7526 841.938 -71.947 845.503 Q-70.1183 849.044 -66.5072 849.044 Q-62.873 849.044 -61.0675 845.503 Q-59.2388 841.938 -59.2388 834.831 Q-59.2388 827.702 -61.0675 824.16 Q-62.873 820.595 -66.5072 820.595 M-66.5072 816.892 Q-60.6971 816.892 -57.6416 821.498 Q-54.5629 826.081 -54.5629 834.831 Q-54.5629 843.558 -57.6416 848.165 Q-60.6971 852.748 -66.5072 852.748 Q-72.3174 852.748 -75.3961 848.165 Q-78.4516 843.558 -78.4516 834.831 Q-78.4516 826.081 -75.3961 821.498 Q-72.3174 816.892 -66.5072 816.892 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-46.3453 846.197 L-41.4611 846.197 L-41.4611 852.077 L-46.3453 852.077 L-46.3453 846.197 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-21.276 820.595 Q-24.8871 820.595 -26.7158 824.16 Q-28.5213 827.702 -28.5213 834.831 Q-28.5213 841.938 -26.7158 845.503 Q-24.8871 849.044 -21.276 849.044 Q-17.6418 849.044 -15.8362 845.503 Q-14.0075 841.938 -14.0075 834.831 Q-14.0075 827.702 -15.8362 824.16 Q-17.6418 820.595 -21.276 820.595 M-21.276 816.892 Q-15.4659 816.892 -12.4103 821.498 Q-9.33162 826.081 -9.33162 834.831 Q-9.33162 843.558 -12.4103 848.165 Q-15.4659 852.748 -21.276 852.748 Q-27.0862 852.748 -30.1648 848.165 Q-33.2204 843.558 -33.2204 834.831 Q-33.2204 826.081 -30.1648 821.498 Q-27.0862 816.892 -21.276 816.892 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-1.06778 817.517 L17.2886 817.517 L17.2886 821.452 L3.2146 821.452 L3.2146 829.924 Q4.23312 829.577 5.25163 829.415 Q6.27014 829.229 7.28866 829.229 Q13.0757 829.229 16.4553 832.401 Q19.8349 835.572 19.8349 840.989 Q19.8349 846.567 16.3627 849.669 Q12.8905 852.748 6.57107 852.748 Q4.39515 852.748 2.12665 852.377 Q-0.118711 852.007 -2.52611 851.266 L-2.52611 846.567 Q-0.442784 847.702 1.77943 848.257 Q4.00164 848.813 6.47848 848.813 Q10.4831 848.813 12.821 846.706 Q15.159 844.6 15.159 840.989 Q15.159 837.378 12.821 835.271 Q10.4831 833.165 6.47848 833.165 Q4.60349 833.165 2.7285 833.581 Q0.876654 833.998 -1.06778 834.878 L-1.06778 817.517 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M39.0477 820.595 Q35.4367 820.595 33.608 824.16 Q31.8024 827.702 31.8024 834.831 Q31.8024 841.938 33.608 845.503 Q35.4367 849.044 39.0477 849.044 Q42.682 849.044 44.4875 845.503 Q46.3162 841.938 46.3162 834.831 Q46.3162 827.702 44.4875 824.16 Q42.682 820.595 39.0477 820.595 M39.0477 816.892 Q44.8579 816.892 47.9134 821.498 Q50.9921 826.081 50.9921 834.831 Q50.9921 843.558 47.9134 848.165 Q44.8579 852.748 39.0477 852.748 Q33.2376 852.748 30.1589 848.165 Q27.1034 843.558 27.1034 834.831 Q27.1034 826.081 30.1589 821.498 Q33.2376 816.892 39.0477 816.892 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-65.5119 618.748 Q-69.123 618.748 -70.9517 622.313 Q-72.7572 625.855 -72.7572 632.985 Q-72.7572 640.091 -70.9517 643.656 Q-69.123 647.197 -65.5119 647.197 Q-61.8776 647.197 -60.0721 643.656 Q-58.2434 640.091 -58.2434 632.985 Q-58.2434 625.855 -60.0721 622.313 Q-61.8776 618.748 -65.5119 618.748 M-65.5119 615.045 Q-59.7017 615.045 -56.6462 619.651 Q-53.5675 624.235 -53.5675 632.985 Q-53.5675 641.711 -56.6462 646.318 Q-59.7017 650.901 -65.5119 650.901 Q-71.322 650.901 -74.4007 646.318 Q-77.4563 641.711 -77.4563 632.985 Q-77.4563 624.235 -74.4007 619.651 Q-71.322 615.045 -65.5119 615.045 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-45.35 644.35 L-40.4657 644.35 L-40.4657 650.23 L-45.35 650.23 L-45.35 644.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-20.2806 618.748 Q-23.8917 618.748 -25.7204 622.313 Q-27.526 625.855 -27.526 632.985 Q-27.526 640.091 -25.7204 643.656 Q-23.8917 647.197 -20.2806 647.197 Q-16.6464 647.197 -14.8409 643.656 Q-13.0122 640.091 -13.0122 632.985 Q-13.0122 625.855 -14.8409 622.313 Q-16.6464 618.748 -20.2806 618.748 M-20.2806 615.045 Q-14.4705 615.045 -11.4149 619.651 Q-8.33626 624.235 -8.33626 632.985 Q-8.33626 641.711 -11.4149 646.318 Q-14.4705 650.901 -20.2806 650.901 Q-26.0908 650.901 -29.1695 646.318 Q-32.225 641.711 -32.225 632.985 Q-32.225 624.235 -29.1695 619.651 Q-26.0908 615.045 -20.2806 615.045 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-1.29926 615.67 L20.9228 615.67 L20.9228 617.661 L8.37661 650.23 L3.49238 650.23 L15.2979 619.605 L-1.29926 619.605 L-1.29926 615.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M30.0895 615.67 L48.4458 615.67 L48.4458 619.605 L34.3718 619.605 L34.3718 628.077 Q35.3904 627.73 36.4089 627.568 Q37.4274 627.383 38.4459 627.383 Q44.2329 627.383 47.6125 630.554 Q50.9921 633.725 50.9921 639.142 Q50.9921 644.721 47.5199 647.822 Q44.0477 650.901 37.7283 650.901 Q35.5524 650.901 33.2839 650.531 Q31.0385 650.16 28.6311 649.42 L28.6311 644.721 Q30.7145 645.855 32.9367 646.41 Q35.1589 646.966 37.6357 646.966 Q41.6403 646.966 43.9783 644.859 Q46.3162 642.753 46.3162 639.142 Q46.3162 635.531 43.9783 633.424 Q41.6403 631.318 37.6357 631.318 Q35.7607 631.318 33.8857 631.735 Q32.0339 632.151 30.0895 633.031 L30.0895 615.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-66.5072 416.902 Q-70.1183 416.902 -71.947 420.466 Q-73.7526 424.008 -73.7526 431.138 Q-73.7526 438.244 -71.947 441.809 Q-70.1183 445.351 -66.5072 445.351 Q-62.873 445.351 -61.0675 441.809 Q-59.2388 438.244 -59.2388 431.138 Q-59.2388 424.008 -61.0675 420.466 Q-62.873 416.902 -66.5072 416.902 M-66.5072 413.198 Q-60.6971 413.198 -57.6416 417.804 Q-54.5629 422.388 -54.5629 431.138 Q-54.5629 439.865 -57.6416 444.471 Q-60.6971 449.054 -66.5072 449.054 Q-72.3174 449.054 -75.3961 444.471 Q-78.4516 439.865 -78.4516 431.138 Q-78.4516 422.388 -75.3961 417.804 Q-72.3174 413.198 -66.5072 413.198 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-46.3453 442.503 L-41.4611 442.503 L-41.4611 448.383 L-46.3453 448.383 L-46.3453 442.503 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-30.4658 444.448 L-22.8269 444.448 L-22.8269 418.082 L-31.1371 419.749 L-31.1371 415.49 L-22.8732 413.823 L-18.1973 413.823 L-18.1973 444.448 L-10.5585 444.448 L-10.5585 448.383 L-30.4658 448.383 L-30.4658 444.448 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M8.88587 416.902 Q5.27478 416.902 3.44608 420.466 Q1.64054 424.008 1.64054 431.138 Q1.64054 438.244 3.44608 441.809 Q5.27478 445.351 8.88587 445.351 Q12.5201 445.351 14.3257 441.809 Q16.1543 438.244 16.1543 431.138 Q16.1543 424.008 14.3257 420.466 Q12.5201 416.902 8.88587 416.902 M8.88587 413.198 Q14.696 413.198 17.7516 417.804 Q20.8303 422.388 20.8303 431.138 Q20.8303 439.865 17.7516 444.471 Q14.696 449.054 8.88587 449.054 Q3.07572 449.054 -0.00297114 444.471 Q-3.05851 439.865 -3.05851 431.138 Q-3.05851 422.388 -0.00297114 417.804 Q3.07572 413.198 8.88587 413.198 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M39.0477 416.902 Q35.4367 416.902 33.608 420.466 Q31.8024 424.008 31.8024 431.138 Q31.8024 438.244 33.608 441.809 Q35.4367 445.351 39.0477 445.351 Q42.682 445.351 44.4875 441.809 Q46.3162 438.244 46.3162 431.138 Q46.3162 424.008 44.4875 420.466 Q42.682 416.902 39.0477 416.902 M39.0477 413.198 Q44.8579 413.198 47.9134 417.804 Q50.9921 422.388 50.9921 431.138 Q50.9921 439.865 47.9134 444.471 Q44.8579 449.054 39.0477 449.054 Q33.2376 449.054 30.1589 444.471 Q27.1034 439.865 27.1034 431.138 Q27.1034 422.388 30.1589 417.804 Q33.2376 413.198 39.0477 413.198 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-65.5119 215.055 Q-69.123 215.055 -70.9517 218.62 Q-72.7572 222.161 -72.7572 229.291 Q-72.7572 236.397 -70.9517 239.962 Q-69.123 243.504 -65.5119 243.504 Q-61.8776 243.504 -60.0721 239.962 Q-58.2434 236.397 -58.2434 229.291 Q-58.2434 222.161 -60.0721 218.62 Q-61.8776 215.055 -65.5119 215.055 M-65.5119 211.351 Q-59.7017 211.351 -56.6462 215.958 Q-53.5675 220.541 -53.5675 229.291 Q-53.5675 238.018 -56.6462 242.624 Q-59.7017 247.208 -65.5119 247.208 Q-71.322 247.208 -74.4007 242.624 Q-77.4563 238.018 -77.4563 229.291 Q-77.4563 220.541 -74.4007 215.958 Q-71.322 211.351 -65.5119 211.351 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-45.35 240.657 L-40.4657 240.657 L-40.4657 246.536 L-45.35 246.536 L-45.35 240.657 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M-29.4704 242.601 L-21.8316 242.601 L-21.8316 216.235 L-30.1417 217.902 L-30.1417 213.643 L-21.8779 211.976 L-17.202 211.976 L-17.202 242.601 L-9.56311 242.601 L-9.56311 246.536 L-29.4704 246.536 L-29.4704 242.601 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M3.90904 242.601 L20.2284 242.601 L20.2284 246.536 L-1.71592 246.536 L-1.71592 242.601 Q0.946098 239.846 5.52941 235.217 Q10.1359 230.564 11.3164 229.221 Q13.5618 226.698 14.4414 224.962 Q15.3442 223.203 15.3442 221.513 Q15.3442 218.759 13.3997 217.022 Q11.4784 215.286 8.37661 215.286 Q6.17755 215.286 3.72386 216.05 Q1.29332 216.814 -1.48444 218.365 L-1.48444 213.643 Q1.33961 212.509 3.7933 211.93 Q6.247 211.351 8.28402 211.351 Q13.6544 211.351 16.8488 214.036 Q20.0432 216.722 20.0432 221.212 Q20.0432 223.342 19.233 225.263 Q18.446 227.161 16.3395 229.754 Q15.7608 230.425 12.659 233.643 Q9.55716 236.837 3.90904 242.601 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip530)" d="M30.0895 211.976 L48.4458 211.976 L48.4458 215.911 L34.3718 215.911 L34.3718 224.384 Q35.3904 224.036 36.4089 223.874 Q37.4274 223.689 38.4459 223.689 Q44.2329 223.689 47.6125 226.86 Q50.9921 230.032 50.9921 235.448 Q50.9921 241.027 47.5199 244.129 Q44.0477 247.208 37.7283 247.208 Q35.5524 247.208 33.2839 246.837 Q31.0385 246.467 28.6311 245.726 L28.6311 241.027 Q30.7145 242.161 32.9367 242.717 Q35.1589 243.272 37.6357 243.272 Q41.6403 243.272 43.9783 241.166 Q46.3162 239.059 46.3162 235.448 Q46.3162 231.837 43.9783 229.731 Q41.6403 227.624 37.6357 227.624 Q35.7607 227.624 33.8857 228.041 Q32.0339 228.458 30.0895 229.337 L30.0895 211.976 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip532)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,431.103 313.569,471.472 540.145,88.5087 766.721,374.014 993.298,1464 1219.87,1368.36 1446.45,853.284 1673.03,1001.22 1899.6,828.048 2126.18,344.08 
  2352.76,997.702 
  "/>
<polyline clip-path="url(#clip532)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1238.49 313.569,1170.54 540.145,1275.27 766.721,1407.32 993.298,1224.88 1219.87,1156.46 1446.45,1259.24 1673.03,1208.65 1899.6,1157.12 2126.18,1336.7 
  2352.76,1308.32 
  "/>
<path clip-path="url(#clip530)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip530)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip530)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip530)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip530)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip530)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>To construct an IRF we can take the model and perturb just the first element of the noise,</p><pre><code class="language-julia hljs">function irf(A, B, C, T = 20)
    noise = Matrix([1.0; zeros(T-1)]&#39;)
    problem = LinearStateSpaceProblem(A, B, zeros(2), (0, T); C, noise, syms = [:a, :b])
    return solve(problem)
end
plot(irf(A, B, C))</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip590">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip590)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip591">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip590)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip592">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  653.433,1505.26 653.433,47.2441 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1219.87,1505.26 1219.87,47.2441 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1786.31,1505.26 1786.31,47.2441 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  653.433,1505.26 653.433,1486.36 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1219.87,1505.26 1219.87,1486.36 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1786.31,1505.26 1786.31,1486.36 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip590)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M643.711 1533.1 L662.067 1533.1 L662.067 1537.04 L647.993 1537.04 L647.993 1545.51 Q649.012 1545.16 650.03 1545 Q651.049 1544.81 652.067 1544.81 Q657.854 1544.81 661.234 1547.98 Q664.614 1551.16 664.614 1556.57 Q664.614 1562.15 661.141 1565.25 Q657.669 1568.33 651.35 1568.33 Q649.174 1568.33 646.905 1567.96 Q644.66 1567.59 642.253 1566.85 L642.253 1562.15 Q644.336 1563.28 646.558 1563.84 Q648.78 1564.4 651.257 1564.4 Q655.262 1564.4 657.6 1562.29 Q659.938 1560.18 659.938 1556.57 Q659.938 1552.96 657.6 1550.85 Q655.262 1548.75 651.257 1548.75 Q649.382 1548.75 647.507 1549.16 Q645.655 1549.58 643.711 1550.46 L643.711 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M1194.56 1563.72 L1202.2 1563.72 L1202.2 1537.36 L1193.89 1539.03 L1193.89 1534.77 L1202.15 1533.1 L1206.83 1533.1 L1206.83 1563.72 L1214.47 1563.72 L1214.47 1567.66 L1194.56 1567.66 L1194.56 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M1233.91 1536.18 Q1230.3 1536.18 1228.47 1539.74 Q1226.67 1543.28 1226.67 1550.41 Q1226.67 1557.52 1228.47 1561.09 Q1230.3 1564.63 1233.91 1564.63 Q1237.55 1564.63 1239.35 1561.09 Q1241.18 1557.52 1241.18 1550.41 Q1241.18 1543.28 1239.35 1539.74 Q1237.55 1536.18 1233.91 1536.18 M1233.91 1532.47 Q1239.72 1532.47 1242.78 1537.08 Q1245.86 1541.66 1245.86 1550.41 Q1245.86 1559.14 1242.78 1563.75 Q1239.72 1568.33 1233.91 1568.33 Q1228.1 1568.33 1225.02 1563.75 Q1221.97 1559.14 1221.97 1550.41 Q1221.97 1541.66 1225.02 1537.08 Q1228.1 1532.47 1233.91 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M1761.5 1563.72 L1769.14 1563.72 L1769.14 1537.36 L1760.83 1539.03 L1760.83 1534.77 L1769.09 1533.1 L1773.77 1533.1 L1773.77 1563.72 L1781.41 1563.72 L1781.41 1567.66 L1761.5 1567.66 L1761.5 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M1790.9 1533.1 L1809.25 1533.1 L1809.25 1537.04 L1795.18 1537.04 L1795.18 1545.51 Q1796.2 1545.16 1797.22 1545 Q1798.24 1544.81 1799.25 1544.81 Q1805.04 1544.81 1808.42 1547.98 Q1811.8 1551.16 1811.8 1556.57 Q1811.8 1562.15 1808.33 1565.25 Q1804.86 1568.33 1798.54 1568.33 Q1796.36 1568.33 1794.09 1567.96 Q1791.85 1567.59 1789.44 1566.85 L1789.44 1562.15 Q1791.52 1563.28 1793.75 1563.84 Q1795.97 1564.4 1798.44 1564.4 Q1802.45 1564.4 1804.79 1562.29 Q1807.13 1560.18 1807.13 1556.57 Q1807.13 1552.96 1804.79 1550.85 Q1802.45 1548.75 1798.44 1548.75 Q1796.57 1548.75 1794.69 1549.16 Q1792.84 1549.58 1790.9 1550.46 L1790.9 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M2331.53 1563.72 L2347.85 1563.72 L2347.85 1567.66 L2325.9 1567.66 L2325.9 1563.72 Q2328.57 1560.97 2333.15 1556.34 Q2337.76 1551.69 2338.94 1550.35 Q2341.18 1547.82 2342.06 1546.09 Q2342.96 1544.33 2342.96 1542.64 Q2342.96 1539.88 2341.02 1538.15 Q2339.1 1536.41 2336 1536.41 Q2333.8 1536.41 2331.34 1537.17 Q2328.91 1537.94 2326.14 1539.49 L2326.14 1534.77 Q2328.96 1533.63 2331.41 1533.05 Q2333.87 1532.47 2335.9 1532.47 Q2341.27 1532.47 2344.47 1535.16 Q2347.66 1537.85 2347.66 1542.34 Q2347.66 1544.47 2346.85 1546.39 Q2346.07 1548.28 2343.96 1550.88 Q2343.38 1551.55 2340.28 1554.77 Q2337.18 1557.96 2331.53 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M2367.66 1536.18 Q2364.05 1536.18 2362.22 1539.74 Q2360.42 1543.28 2360.42 1550.41 Q2360.42 1557.52 2362.22 1561.09 Q2364.05 1564.63 2367.66 1564.63 Q2371.3 1564.63 2373.1 1561.09 Q2374.93 1557.52 2374.93 1550.41 Q2374.93 1543.28 2373.1 1539.74 Q2371.3 1536.18 2367.66 1536.18 M2367.66 1532.47 Q2373.47 1532.47 2376.53 1537.08 Q2379.61 1541.66 2379.61 1550.41 Q2379.61 1559.14 2376.53 1563.75 Q2373.47 1568.33 2367.66 1568.33 Q2361.85 1568.33 2358.77 1563.75 Q2355.72 1559.14 2355.72 1550.41 Q2355.72 1541.66 2358.77 1537.08 Q2361.85 1532.47 2367.66 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1464 2352.76,1464 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1078.16 2352.76,1078.16 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,692.334 2352.76,692.334 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,306.503 2352.76,306.503 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1464 105.89,1464 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1078.16 105.89,1078.16 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,692.334 105.89,692.334 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,306.503 105.89,306.503 
  "/>
<path clip-path="url(#clip590)" d="M-36.3454 1449.79 Q-39.9565 1449.79 -41.7852 1453.36 Q-43.5907 1456.9 -43.5907 1464.03 Q-43.5907 1471.14 -41.7852 1474.7 Q-39.9565 1478.24 -36.3454 1478.24 Q-32.7111 1478.24 -30.9056 1474.7 Q-29.0769 1471.14 -29.0769 1464.03 Q-29.0769 1456.9 -30.9056 1453.36 Q-32.7111 1449.79 -36.3454 1449.79 M-36.3454 1446.09 Q-30.5352 1446.09 -27.4797 1450.7 Q-24.401 1455.28 -24.401 1464.03 Q-24.401 1472.76 -27.4797 1477.36 Q-30.5352 1481.95 -36.3454 1481.95 Q-42.1555 1481.95 -45.2342 1477.36 Q-48.2897 1472.76 -48.2897 1464.03 Q-48.2897 1455.28 -45.2342 1450.7 Q-42.1555 1446.09 -36.3454 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M-16.1834 1475.4 L-11.2992 1475.4 L-11.2992 1481.28 L-16.1834 1481.28 L-16.1834 1475.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M8.88587 1449.79 Q5.27478 1449.79 3.44608 1453.36 Q1.64054 1456.9 1.64054 1464.03 Q1.64054 1471.14 3.44608 1474.7 Q5.27478 1478.24 8.88587 1478.24 Q12.5201 1478.24 14.3257 1474.7 Q16.1543 1471.14 16.1543 1464.03 Q16.1543 1456.9 14.3257 1453.36 Q12.5201 1449.79 8.88587 1449.79 M8.88587 1446.09 Q14.696 1446.09 17.7516 1450.7 Q20.8303 1455.28 20.8303 1464.03 Q20.8303 1472.76 17.7516 1477.36 Q14.696 1481.95 8.88587 1481.95 Q3.07572 1481.95 -0.00297114 1477.36 Q-3.05851 1472.76 -3.05851 1464.03 Q-3.05851 1455.28 -0.00297114 1450.7 Q3.07572 1446.09 8.88587 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M-34.7482 1063.96 Q-38.3592 1063.96 -40.1879 1067.53 Q-41.9935 1071.07 -41.9935 1078.2 Q-41.9935 1085.31 -40.1879 1088.87 Q-38.3592 1092.41 -34.7482 1092.41 Q-31.1139 1092.41 -29.3084 1088.87 Q-27.4797 1085.31 -27.4797 1078.2 Q-27.4797 1071.07 -29.3084 1067.53 Q-31.1139 1063.96 -34.7482 1063.96 M-34.7482 1060.26 Q-28.938 1060.26 -25.8825 1064.87 Q-22.8038 1069.45 -22.8038 1078.2 Q-22.8038 1086.93 -25.8825 1091.53 Q-28.938 1096.12 -34.7482 1096.12 Q-40.5583 1096.12 -43.637 1091.53 Q-46.6925 1086.93 -46.6925 1078.2 Q-46.6925 1069.45 -43.637 1064.87 Q-40.5583 1060.26 -34.7482 1060.26 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M-14.5862 1089.56 L-9.70199 1089.56 L-9.70199 1095.44 L-14.5862 1095.44 L-14.5862 1089.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M10.4831 1063.96 Q6.87199 1063.96 5.0433 1067.53 Q3.23775 1071.07 3.23775 1078.2 Q3.23775 1085.31 5.0433 1088.87 Q6.87199 1092.41 10.4831 1092.41 Q14.1173 1092.41 15.9229 1088.87 Q17.7516 1085.31 17.7516 1078.2 Q17.7516 1071.07 15.9229 1067.53 Q14.1173 1063.96 10.4831 1063.96 M10.4831 1060.26 Q16.2932 1060.26 19.3488 1064.87 Q22.4275 1069.45 22.4275 1078.2 Q22.4275 1086.93 19.3488 1091.53 Q16.2932 1096.12 10.4831 1096.12 Q4.67293 1096.12 1.59424 1091.53 Q-1.4613 1086.93 -1.4613 1078.2 Q-1.4613 1069.45 1.59424 1064.87 Q4.67293 1060.26 10.4831 1060.26 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M34.6728 1091.51 L50.9921 1091.51 L50.9921 1095.44 L29.0478 1095.44 L29.0478 1091.51 Q31.7098 1088.75 36.2931 1084.13 Q40.8996 1079.47 42.0801 1078.13 Q44.3255 1075.61 45.2051 1073.87 Q46.1079 1072.11 46.1079 1070.42 Q46.1079 1067.67 44.1635 1065.93 Q42.2422 1064.19 39.1403 1064.19 Q36.9413 1064.19 34.4876 1064.96 Q32.057 1065.72 29.2793 1067.27 L29.2793 1062.55 Q32.1033 1061.42 34.557 1060.84 Q37.0107 1060.26 39.0477 1060.26 Q44.4181 1060.26 47.6125 1062.94 Q50.8069 1065.63 50.8069 1070.12 Q50.8069 1072.25 49.9968 1074.17 Q49.2097 1076.07 47.1033 1078.66 Q46.5246 1079.33 43.4227 1082.55 Q40.3209 1085.75 34.6728 1091.51 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M-36.8315 678.132 Q-40.4426 678.132 -42.2713 681.697 Q-44.0768 685.239 -44.0768 692.369 Q-44.0768 699.475 -42.2713 703.04 Q-40.4426 706.581 -36.8315 706.581 Q-33.1972 706.581 -31.3917 703.04 Q-29.563 699.475 -29.563 692.369 Q-29.563 685.239 -31.3917 681.697 Q-33.1972 678.132 -36.8315 678.132 M-36.8315 674.429 Q-31.0213 674.429 -27.9658 679.035 Q-24.8871 683.619 -24.8871 692.369 Q-24.8871 701.095 -27.9658 705.702 Q-31.0213 710.285 -36.8315 710.285 Q-42.6416 710.285 -45.7203 705.702 Q-48.7759 701.095 -48.7759 692.369 Q-48.7759 683.619 -45.7203 679.035 Q-42.6416 674.429 -36.8315 674.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M-16.6695 703.734 L-11.7853 703.734 L-11.7853 709.614 L-16.6695 709.614 L-16.6695 703.734 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M8.39976 678.132 Q4.78867 678.132 2.95998 681.697 Q1.15443 685.239 1.15443 692.369 Q1.15443 699.475 2.95998 703.04 Q4.78867 706.581 8.39976 706.581 Q12.034 706.581 13.8395 703.04 Q15.6682 699.475 15.6682 692.369 Q15.6682 685.239 13.8395 681.697 Q12.034 678.132 8.39976 678.132 M8.39976 674.429 Q14.2099 674.429 17.2655 679.035 Q20.3441 683.619 20.3441 692.369 Q20.3441 701.095 17.2655 705.702 Q14.2099 710.285 8.39976 710.285 Q2.58961 710.285 -0.48908 705.702 Q-3.54462 701.095 -3.54462 692.369 Q-3.54462 683.619 -0.48908 679.035 Q2.58961 674.429 8.39976 674.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M41.4088 679.128 L29.6034 697.577 L41.4088 697.577 L41.4088 679.128 M40.182 675.054 L46.0616 675.054 L46.0616 697.577 L50.9921 697.577 L50.9921 701.466 L46.0616 701.466 L46.0616 709.614 L41.4088 709.614 L41.4088 701.466 L25.8071 701.466 L25.8071 696.952 L40.182 675.054 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M-36.5074 292.302 Q-40.1185 292.302 -41.9472 295.867 Q-43.7527 299.408 -43.7527 306.538 Q-43.7527 313.644 -41.9472 317.209 Q-40.1185 320.751 -36.5074 320.751 Q-32.8732 320.751 -31.0676 317.209 Q-29.2389 313.644 -29.2389 306.538 Q-29.2389 299.408 -31.0676 295.867 Q-32.8732 292.302 -36.5074 292.302 M-36.5074 288.598 Q-30.6973 288.598 -27.6417 293.205 Q-24.563 297.788 -24.563 306.538 Q-24.563 315.265 -27.6417 319.871 Q-30.6973 324.454 -36.5074 324.454 Q-42.3176 324.454 -45.3962 319.871 Q-48.4518 315.265 -48.4518 306.538 Q-48.4518 297.788 -45.3962 293.205 Q-42.3176 288.598 -36.5074 288.598 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M-16.3455 317.903 L-11.4612 317.903 L-11.4612 323.783 L-16.3455 323.783 L-16.3455 317.903 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M8.72383 292.302 Q5.11274 292.302 3.28405 295.867 Q1.4785 299.408 1.4785 306.538 Q1.4785 313.644 3.28405 317.209 Q5.11274 320.751 8.72383 320.751 Q12.3581 320.751 14.1636 317.209 Q15.9923 313.644 15.9923 306.538 Q15.9923 299.408 14.1636 295.867 Q12.3581 292.302 8.72383 292.302 M8.72383 288.598 Q14.534 288.598 17.5895 293.205 Q20.6682 297.788 20.6682 306.538 Q20.6682 315.265 17.5895 319.871 Q14.534 324.454 8.72383 324.454 Q2.91368 324.454 -0.165007 319.871 Q-3.22055 315.265 -3.22055 306.538 Q-3.22055 297.788 -0.165007 293.205 Q2.91368 288.598 8.72383 288.598 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip590)" d="M39.4644 304.64 Q36.3163 304.64 34.4644 306.792 Q32.6357 308.945 32.6357 312.695 Q32.6357 316.422 34.4644 318.598 Q36.3163 320.751 39.4644 320.751 Q42.6125 320.751 44.4412 318.598 Q46.2931 316.422 46.2931 312.695 Q46.2931 308.945 44.4412 306.792 Q42.6125 304.64 39.4644 304.64 M48.7468 289.987 L48.7468 294.246 Q46.9875 293.413 45.182 292.973 Q43.3996 292.533 41.6403 292.533 Q37.0107 292.533 34.557 295.658 Q32.1265 298.783 31.7793 305.103 Q33.145 303.089 35.2052 302.024 Q37.2653 300.936 39.7422 300.936 Q44.9505 300.936 47.9597 304.107 Q50.9921 307.255 50.9921 312.695 Q50.9921 318.019 47.844 321.237 Q44.6959 324.454 39.4644 324.454 Q33.4691 324.454 30.2978 319.871 Q27.1265 315.265 27.1265 306.538 Q27.1265 298.343 31.0154 293.482 Q34.9042 288.598 41.4551 288.598 Q43.2144 288.598 44.9968 288.945 Q46.8023 289.292 48.7468 289.987 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip592)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1464 200.28,1464 313.569,267.92 426.857,88.5087 540.145,109.44 653.433,167.599 766.721,230.505 880.009,291.797 993.298,350.33 1106.59,405.998 
  1219.87,458.895 1333.16,509.149 1446.45,556.892 1559.74,602.247 1673.03,645.334 1786.31,686.267 1899.6,725.154 2012.89,762.096 2126.18,797.191 2239.47,830.531 
  2352.76,862.204 
  "/>
<polyline clip-path="url(#clip592)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1464 200.28,1271.08 313.569,1425.41 426.857,1456.28 540.145,1462.45 653.433,1463.69 766.721,1463.93 880.009,1463.98 993.298,1463.99 1106.59,1463.99 
  1219.87,1464 1333.16,1464 1446.45,1464 1559.74,1464 1673.03,1464 1786.31,1464 1899.6,1464 2012.89,1464 2126.18,1464 2239.47,1464 
  2352.76,1464 
  "/>
<path clip-path="url(#clip590)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip590)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip590)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip590)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip590)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip590)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>Lets find the 2nd observable at the end of the IRF.</p><pre><code class="language-julia hljs">function last_observable_irf(A, B, C)
    sol = irf(A, B, C)
    return sol.z[end][2]  # return 2nd argument of last observable
end
last_observable_irf(A, B, C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.03119456447624772</code></pre><p>But everything in this package is differentiable.  Lets differentiate the observable of the IRF with respect to all of the parameters using <code>Zygote.jl</code>,</p><pre><code class="language-julia hljs">gradient(last_observable_irf, A, B, C)  # calculates gradient wrt all arguments</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.5822985368900442 0.0050313813671367304; 4.469834483178462 0.041592752634585235], [0.37735360253530714; 3.119456447624773;;], [0.0 0.0; 0.03119456447624772 5.242880000000006e-16])</code></pre><p>Gradients of other model elements (e.g. <code>.u</code> are also possible.  With this in mind, lets find the gradient of the mean of the 1st element of the IRF of the solution with respect to a particular noise vector.</p><pre><code class="language-julia hljs">function mean_u_1(A, B, C, noise, u0, T)
    problem = LinearStateSpaceProblem(A, B, u0, (0, T); noise, syms = [:a, :b])
    sol = solve(problem)
    u = sol.u # see issue #75 workaround
    # can have nontrivial functions and even non-mutating loops
    return mean( u[i][1] for i in 1:T)
end
u0 = [0.0, 0.0]
noise = sol.W # from simulation above
mean_u_1(A, B, C, noise, u0, T)
# dropping a few arguments from derivative
gradient((noise, u0)-&gt; mean_u_1(A, B, C, noise, u0, T), noise, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.05079876954953124 0.045314515146875 … 0.0 0.0], [0.702526121523242, 5.600882710405467])</code></pre><h2 id="Simulating-Ensembles-and-Fixing-Noise"><a class="docs-heading-anchor" href="#Simulating-Ensembles-and-Fixing-Noise">Simulating Ensembles and Fixing Noise</a><a id="Simulating-Ensembles-and-Fixing-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Ensembles-and-Fixing-Noise" title="Permalink"></a></h2><p>If you pass in a distribution for the initial condition, it will draw an initial condition.  Below we will simulate from a deterministic evolution equation and without any observation noise.</p><pre><code class="language-julia hljs">using Distributions, DiffEqBase
u0 = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = LinearStateSpaceProblem(A, nothing, u0, (0, T); C)
sol = solve(prob)
plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip650">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip650)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip651">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip650)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip652">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  540.145,1505.26 540.145,47.2441 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  993.298,1505.26 993.298,47.2441 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1446.45,1505.26 1446.45,47.2441 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1899.6,1505.26 1899.6,47.2441 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  540.145,1505.26 540.145,1486.36 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  993.298,1505.26 993.298,1486.36 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1446.45,1505.26 1446.45,1486.36 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1899.6,1505.26 1899.6,1486.36 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip650)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1192.88 2352.76,1192.88 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,824.755 2352.76,824.755 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,456.632 2352.76,456.632 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,88.5087 2352.76,88.5087 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1192.88 105.89,1192.88 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,824.755 105.89,824.755 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,456.632 105.89,456.632 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,88.5087 105.89,88.5087 
  "/>
<path clip-path="url(#clip650)" d="M-10.0724 1193.33 L19.6034 1193.33 L19.6034 1197.26 L-10.0724 1197.26 L-10.0724 1193.33 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M43.8625 1191.52 Q47.219 1192.24 49.094 1194.51 Q50.9921 1196.78 50.9921 1200.11 Q50.9921 1205.23 47.4736 1208.03 Q43.9551 1210.83 37.4737 1210.83 Q35.2978 1210.83 32.983 1210.39 Q30.6913 1209.97 28.2376 1209.12 L28.2376 1204.6 Q30.1821 1205.74 32.4969 1206.31 Q34.8117 1206.89 37.3348 1206.89 Q41.7329 1206.89 44.0246 1205.16 Q46.3394 1203.42 46.3394 1200.11 Q46.3394 1197.06 44.1866 1195.34 Q42.057 1193.61 38.2376 1193.61 L34.2098 1193.61 L34.2098 1189.76 L38.4227 1189.76 Q41.8718 1189.76 43.7005 1188.4 Q45.5292 1187.01 45.5292 1184.42 Q45.5292 1181.75 43.6311 1180.34 Q41.7561 1178.91 38.2376 1178.91 Q36.3163 1178.91 34.1172 1179.32 Q31.9182 1179.74 29.2793 1180.62 L29.2793 1176.45 Q31.9413 1175.71 34.2561 1175.34 Q36.5941 1174.97 38.6542 1174.97 Q43.9783 1174.97 47.0801 1177.4 Q50.1819 1179.81 50.1819 1183.93 Q50.1819 1186.8 48.5384 1188.79 Q46.8949 1190.76 43.8625 1191.52 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M-9.12329 825.206 L20.5525 825.206 L20.5525 829.141 L-9.12329 829.141 L-9.12329 825.206 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M34.6728 838.099 L50.9921 838.099 L50.9921 842.035 L29.0478 842.035 L29.0478 838.099 Q31.7098 835.345 36.2931 830.715 Q40.8996 826.062 42.0801 824.72 Q44.3255 822.197 45.2051 820.461 Q46.1079 818.701 46.1079 817.012 Q46.1079 814.257 44.1635 812.521 Q42.2422 810.785 39.1403 810.785 Q36.9413 810.785 34.4876 811.549 Q32.057 812.313 29.2793 813.863 L29.2793 809.141 Q32.1033 808.007 34.557 807.428 Q37.0107 806.85 39.0477 806.85 Q44.4181 806.85 47.6125 809.535 Q50.8069 812.22 50.8069 816.711 Q50.8069 818.84 49.9968 820.762 Q49.2097 822.66 47.1033 825.252 Q46.5246 825.924 43.4227 829.141 Q40.3209 832.336 34.6728 838.099 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M-9.49366 457.083 L20.1821 457.083 L20.1821 461.018 L-9.49366 461.018 L-9.49366 457.083 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M31.0848 469.976 L38.7237 469.976 L38.7237 443.611 L30.4135 445.278 L30.4135 441.018 L38.6774 439.352 L43.3533 439.352 L43.3533 469.976 L50.9921 469.976 L50.9921 473.912 L31.0848 473.912 L31.0848 469.976 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M39.0477 74.3074 Q35.4367 74.3074 33.608 77.8722 Q31.8024 81.4138 31.8024 88.5434 Q31.8024 95.6498 33.608 99.2146 Q35.4367 102.756 39.0477 102.756 Q42.682 102.756 44.4875 99.2146 Q46.3162 95.6498 46.3162 88.5434 Q46.3162 81.4138 44.4875 77.8722 Q42.682 74.3074 39.0477 74.3074 M39.0477 70.6037 Q44.8579 70.6037 47.9134 75.2101 Q50.9921 79.7934 50.9921 88.5434 Q50.9921 97.2702 47.9134 101.877 Q44.8579 106.46 39.0477 106.46 Q33.2376 106.46 30.1589 101.877 Q27.1034 97.2702 27.1034 88.5434 Q27.1034 79.7934 30.1589 75.2101 Q33.2376 70.6037 39.0477 70.6037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip652)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,450.891 313.569,1344.46 540.145,1464 766.721,1431.69 993.298,1371.82 1219.87,1309.12 1446.45,1248.38 1673.03,1190.44 1899.6,1135.36 2126.18,1083.02 
  2352.76,1033.29 
  "/>
<polyline clip-path="url(#clip652)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,235.555 313.569,117.918 540.145,94.3905 766.721,89.685 993.298,88.7439 1219.87,88.5557 1446.45,88.5181 1673.03,88.5106 1899.6,88.5091 2126.18,88.5088 
  2352.76,88.5087 
  "/>
<path clip-path="url(#clip650)" d="
M1917.79 251.365 L2277.23 251.365 L2277.23 95.8446 L1917.79 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1917.79,251.365 2277.23,251.365 2277.23,95.8446 1917.79,95.8446 1917.79,251.365 
  "/>
<polyline clip-path="url(#clip650)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1942.97,147.685 2094.02,147.685 
  "/>
<path clip-path="url(#clip650)" d="M2119.2 154.733 L2119.2 139.039 L2123.45 139.039 L2123.45 154.571 Q2123.45 158.252 2124.89 160.104 Q2126.33 161.932 2129.2 161.932 Q2132.64 161.932 2134.64 159.733 Q2136.65 157.534 2136.65 153.738 L2136.65 139.039 L2140.91 139.039 L2140.91 164.965 L2136.65 164.965 L2136.65 160.983 Q2135.1 163.344 2133.04 164.502 Q2131 165.636 2128.29 165.636 Q2123.83 165.636 2121.51 162.858 Q2119.2 160.08 2119.2 154.733 M2129.91 138.414 L2129.91 138.414 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2151.09 161.029 L2158.73 161.029 L2158.73 134.664 L2150.42 136.331 L2150.42 132.071 L2158.69 130.405 L2163.36 130.405 L2163.36 161.029 L2171 161.029 L2171 164.965 L2151.09 164.965 L2151.09 161.029 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2190.07 128.993 Q2186.97 134.317 2185.47 139.525 Q2183.96 144.733 2183.96 150.08 Q2183.96 155.428 2185.47 160.682 Q2187 165.914 2190.07 171.215 L2186.37 171.215 Q2182.9 165.775 2181.16 160.52 Q2179.45 155.266 2179.45 150.08 Q2179.45 144.918 2181.16 139.687 Q2182.88 134.456 2186.37 128.993 L2190.07 128.993 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2202.55 131.678 L2202.55 139.039 L2211.32 139.039 L2211.32 142.349 L2202.55 142.349 L2202.55 156.423 Q2202.55 159.594 2203.41 160.497 Q2204.29 161.4 2206.95 161.4 L2211.32 161.4 L2211.32 164.965 L2206.95 164.965 Q2202.02 164.965 2200.14 163.136 Q2198.27 161.284 2198.27 156.423 L2198.27 142.349 L2195.14 142.349 L2195.14 139.039 L2198.27 139.039 L2198.27 131.678 L2202.55 131.678 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2216.26 128.993 L2219.96 128.993 Q2223.43 134.456 2225.14 139.687 Q2226.88 144.918 2226.88 150.08 Q2226.88 155.266 2225.14 160.52 Q2223.43 165.775 2219.96 171.215 L2216.26 171.215 Q2219.33 165.914 2220.84 160.682 Q2222.37 155.428 2222.37 150.08 Q2222.37 144.733 2220.84 139.525 Q2219.33 134.317 2216.26 128.993 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip650)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1942.97,199.525 2094.02,199.525 
  "/>
<path clip-path="url(#clip650)" d="M2119.2 206.573 L2119.2 190.879 L2123.45 190.879 L2123.45 206.411 Q2123.45 210.092 2124.89 211.944 Q2126.33 213.772 2129.2 213.772 Q2132.64 213.772 2134.64 211.573 Q2136.65 209.374 2136.65 205.578 L2136.65 190.879 L2140.91 190.879 L2140.91 216.805 L2136.65 216.805 L2136.65 212.823 Q2135.1 215.184 2133.04 216.342 Q2131 217.476 2128.29 217.476 Q2123.83 217.476 2121.51 214.698 Q2119.2 211.92 2119.2 206.573 M2129.91 190.254 L2129.91 190.254 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2154.31 212.869 L2170.63 212.869 L2170.63 216.805 L2148.69 216.805 L2148.69 212.869 Q2151.35 210.115 2155.93 205.485 Q2160.54 200.832 2161.72 199.49 Q2163.96 196.967 2164.84 195.231 Q2165.75 193.471 2165.75 191.782 Q2165.75 189.027 2163.8 187.291 Q2161.88 185.555 2158.78 185.555 Q2156.58 185.555 2154.13 186.319 Q2151.7 187.083 2148.92 188.633 L2148.92 183.911 Q2151.74 182.777 2154.2 182.198 Q2156.65 181.62 2158.69 181.62 Q2164.06 181.62 2167.25 184.305 Q2170.45 186.99 2170.45 191.481 Q2170.45 193.61 2169.64 195.532 Q2168.85 197.43 2166.74 200.022 Q2166.16 200.694 2163.06 203.911 Q2159.96 207.106 2154.31 212.869 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2190.07 180.833 Q2186.97 186.157 2185.47 191.365 Q2183.96 196.573 2183.96 201.92 Q2183.96 207.268 2185.47 212.522 Q2187 217.754 2190.07 223.055 L2186.37 223.055 Q2182.9 217.615 2181.16 212.36 Q2179.45 207.106 2179.45 201.92 Q2179.45 196.758 2181.16 191.527 Q2182.88 186.296 2186.37 180.833 L2190.07 180.833 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2202.55 183.518 L2202.55 190.879 L2211.32 190.879 L2211.32 194.189 L2202.55 194.189 L2202.55 208.263 Q2202.55 211.434 2203.41 212.337 Q2204.29 213.24 2206.95 213.24 L2211.32 213.24 L2211.32 216.805 L2206.95 216.805 Q2202.02 216.805 2200.14 214.976 Q2198.27 213.124 2198.27 208.263 L2198.27 194.189 L2195.14 194.189 L2195.14 190.879 L2198.27 190.879 L2198.27 183.518 L2202.55 183.518 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2216.26 180.833 L2219.96 180.833 Q2223.43 186.296 2225.14 191.527 Q2226.88 196.758 2226.88 201.92 Q2226.88 207.106 2225.14 212.36 Q2223.43 217.615 2219.96 223.055 L2216.26 223.055 Q2219.33 217.754 2220.84 212.522 Q2222.37 207.268 2222.37 201.92 Q2222.37 196.573 2220.84 191.365 Q2219.33 186.157 2216.26 180.833 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>With this, we can simulate an ensemble of solutions from different initial conditions (and we will turn back on the noise).  The <code>EnsembleSummary</code> calculates a set of quantiles by default.</p><pre><code class="language-julia hljs">T = 10
trajectories = 50
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C)
sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(sol)  #calculate summarize statistics from the
plot(summ)  # shows quantiles by default</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip710">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip710)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip711">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip710)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip712">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  685.496,1521.01 685.496,47.2441 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1219.87,1521.01 1219.87,47.2441 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1754.25,1521.01 1754.25,47.2441 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  685.496,1521.01 685.496,1502.11 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1219.87,1521.01 1219.87,1502.11 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1754.25,1521.01 1754.25,1502.11 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip710)" d="M128.502 1551.93 Q124.891 1551.93 123.062 1555.49 Q121.257 1559.03 121.257 1566.16 Q121.257 1573.27 123.062 1576.83 Q124.891 1580.38 128.502 1580.38 Q132.136 1580.38 133.942 1576.83 Q135.77 1573.27 135.77 1566.16 Q135.77 1559.03 133.942 1555.49 Q132.136 1551.93 128.502 1551.93 M128.502 1548.22 Q134.312 1548.22 137.368 1552.83 Q140.446 1557.41 140.446 1566.16 Q140.446 1574.89 137.368 1579.5 Q134.312 1584.08 128.502 1584.08 Q122.692 1584.08 119.613 1579.5 Q116.558 1574.89 116.558 1566.16 Q116.558 1557.41 119.613 1552.83 Q122.692 1548.22 128.502 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M148.664 1577.53 L153.548 1577.53 L153.548 1583.41 L148.664 1583.41 L148.664 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M173.733 1551.93 Q170.122 1551.93 168.293 1555.49 Q166.488 1559.03 166.488 1566.16 Q166.488 1573.27 168.293 1576.83 Q170.122 1580.38 173.733 1580.38 Q177.367 1580.38 179.173 1576.83 Q181.002 1573.27 181.002 1566.16 Q181.002 1559.03 179.173 1555.49 Q177.367 1551.93 173.733 1551.93 M173.733 1548.22 Q179.543 1548.22 182.599 1552.83 Q185.678 1557.41 185.678 1566.16 Q185.678 1574.89 182.599 1579.5 Q179.543 1584.08 173.733 1584.08 Q167.923 1584.08 164.844 1579.5 Q161.789 1574.89 161.789 1566.16 Q161.789 1557.41 164.844 1552.83 Q167.923 1548.22 173.733 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M657.232 1579.47 L673.551 1579.47 L673.551 1583.41 L651.607 1583.41 L651.607 1579.47 Q654.269 1576.72 658.852 1572.09 Q663.459 1567.44 664.639 1566.09 Q666.885 1563.57 667.764 1561.83 Q668.667 1560.07 668.667 1558.38 Q668.667 1555.63 666.723 1553.89 Q664.801 1552.16 661.7 1552.16 Q659.501 1552.16 657.047 1552.92 Q654.616 1553.69 651.839 1555.24 L651.839 1550.51 Q654.663 1549.38 657.116 1548.8 Q659.57 1548.22 661.607 1548.22 Q666.977 1548.22 670.172 1550.91 Q673.366 1553.59 673.366 1558.08 Q673.366 1560.21 672.556 1562.13 Q671.769 1564.03 669.663 1566.63 Q669.084 1567.3 665.982 1570.51 Q662.88 1573.71 657.232 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M683.366 1577.53 L688.25 1577.53 L688.25 1583.41 L683.366 1583.41 L683.366 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M698.482 1548.85 L716.838 1548.85 L716.838 1552.78 L702.764 1552.78 L702.764 1561.26 Q703.783 1560.91 704.801 1560.75 Q705.82 1560.56 706.838 1560.56 Q712.625 1560.56 716.005 1563.73 Q719.384 1566.9 719.384 1572.32 Q719.384 1577.9 715.912 1581 Q712.44 1584.08 706.121 1584.08 Q703.945 1584.08 701.676 1583.71 Q699.431 1583.34 697.023 1582.6 L697.023 1577.9 Q699.107 1579.03 701.329 1579.59 Q703.551 1580.14 706.028 1580.14 Q710.033 1580.14 712.371 1578.04 Q714.709 1575.93 714.709 1572.32 Q714.709 1568.71 712.371 1566.6 Q710.033 1564.5 706.028 1564.5 Q704.153 1564.5 702.278 1564.91 Q700.426 1565.33 698.482 1566.21 L698.482 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M1187.04 1548.85 L1205.39 1548.85 L1205.39 1552.78 L1191.32 1552.78 L1191.32 1561.26 Q1192.34 1560.91 1193.36 1560.75 Q1194.38 1560.56 1195.39 1560.56 Q1201.18 1560.56 1204.56 1563.73 Q1207.94 1566.9 1207.94 1572.32 Q1207.94 1577.9 1204.47 1581 Q1201 1584.08 1194.68 1584.08 Q1192.5 1584.08 1190.23 1583.71 Q1187.99 1583.34 1185.58 1582.6 L1185.58 1577.9 Q1187.66 1579.03 1189.89 1579.59 Q1192.11 1580.14 1194.58 1580.14 Q1198.59 1580.14 1200.93 1578.04 Q1203.27 1575.93 1203.27 1572.32 Q1203.27 1568.71 1200.93 1566.6 Q1198.59 1564.5 1194.58 1564.5 Q1192.71 1564.5 1190.83 1564.91 Q1188.98 1565.33 1187.04 1566.21 L1187.04 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M1217.15 1577.53 L1222.04 1577.53 L1222.04 1583.41 L1217.15 1583.41 L1217.15 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M1242.22 1551.93 Q1238.61 1551.93 1236.78 1555.49 Q1234.98 1559.03 1234.98 1566.16 Q1234.98 1573.27 1236.78 1576.83 Q1238.61 1580.38 1242.22 1580.38 Q1245.86 1580.38 1247.66 1576.83 Q1249.49 1573.27 1249.49 1566.16 Q1249.49 1559.03 1247.66 1555.49 Q1245.86 1551.93 1242.22 1551.93 M1242.22 1548.22 Q1248.03 1548.22 1251.09 1552.83 Q1254.17 1557.41 1254.17 1566.16 Q1254.17 1574.89 1251.09 1579.5 Q1248.03 1584.08 1242.22 1584.08 Q1236.41 1584.08 1233.33 1579.5 Q1230.28 1574.89 1230.28 1566.16 Q1230.28 1557.41 1233.33 1552.83 Q1236.41 1548.22 1242.22 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M1720.57 1548.85 L1742.79 1548.85 L1742.79 1550.84 L1730.25 1583.41 L1725.36 1583.41 L1737.17 1552.78 L1720.57 1552.78 L1720.57 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M1751.91 1577.53 L1756.8 1577.53 L1756.8 1583.41 L1751.91 1583.41 L1751.91 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M1767.03 1548.85 L1785.39 1548.85 L1785.39 1552.78 L1771.31 1552.78 L1771.31 1561.26 Q1772.33 1560.91 1773.35 1560.75 Q1774.37 1560.56 1775.39 1560.56 Q1781.17 1560.56 1784.55 1563.73 Q1787.93 1566.9 1787.93 1572.32 Q1787.93 1577.9 1784.46 1581 Q1780.99 1584.08 1774.67 1584.08 Q1772.49 1584.08 1770.22 1583.71 Q1767.98 1583.34 1765.57 1582.6 L1765.57 1577.9 Q1767.65 1579.03 1769.88 1579.59 Q1772.1 1580.14 1774.58 1580.14 Q1778.58 1580.14 1780.92 1578.04 Q1783.26 1575.93 1783.26 1572.32 Q1783.26 1568.71 1780.92 1566.6 Q1778.58 1564.5 1774.58 1564.5 Q1772.7 1564.5 1770.83 1564.91 Q1768.97 1565.33 1767.03 1566.21 L1767.03 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M2240.7 1579.47 L2248.34 1579.47 L2248.34 1553.11 L2240.03 1554.77 L2240.03 1550.51 L2248.3 1548.85 L2252.97 1548.85 L2252.97 1579.47 L2260.61 1579.47 L2260.61 1583.41 L2240.7 1583.41 L2240.7 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M2280.05 1551.93 Q2276.44 1551.93 2274.61 1555.49 Q2272.81 1559.03 2272.81 1566.16 Q2272.81 1573.27 2274.61 1576.83 Q2276.44 1580.38 2280.05 1580.38 Q2283.69 1580.38 2285.49 1576.83 Q2287.32 1573.27 2287.32 1566.16 Q2287.32 1559.03 2285.49 1555.49 Q2283.69 1551.93 2280.05 1551.93 M2280.05 1548.22 Q2285.86 1548.22 2288.92 1552.83 Q2292 1557.41 2292 1566.16 Q2292 1574.89 2288.92 1579.5 Q2285.86 1584.08 2280.05 1584.08 Q2274.24 1584.08 2271.17 1579.5 Q2268.11 1574.89 2268.11 1566.16 Q2268.11 1557.41 2271.17 1552.83 Q2274.24 1548.22 2280.05 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M2300.22 1577.53 L2305.1 1577.53 L2305.1 1583.41 L2300.22 1583.41 L2300.22 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M2325.29 1551.93 Q2321.67 1551.93 2319.85 1555.49 Q2318.04 1559.03 2318.04 1566.16 Q2318.04 1573.27 2319.85 1576.83 Q2321.67 1580.38 2325.29 1580.38 Q2328.92 1580.38 2330.73 1576.83 Q2332.55 1573.27 2332.55 1566.16 Q2332.55 1559.03 2330.73 1555.49 Q2328.92 1551.93 2325.29 1551.93 M2325.29 1548.22 Q2331.1 1548.22 2334.15 1552.83 Q2337.23 1557.41 2337.23 1566.16 Q2337.23 1574.89 2334.15 1579.5 Q2331.1 1584.08 2325.29 1584.08 Q2319.48 1584.08 2316.4 1579.5 Q2313.34 1574.89 2313.34 1566.16 Q2313.34 1557.41 2316.4 1552.83 Q2319.48 1548.22 2325.29 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1386.44 2352.76,1386.44 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1133.23 2352.76,1133.23 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,880.025 2352.76,880.025 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,626.816 2352.76,626.816 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,373.606 2352.76,373.606 
  "/>
<polyline clip-path="url(#clip712)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,120.397 2352.76,120.397 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1386.44 105.89,1386.44 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1133.23 105.89,1133.23 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,880.025 105.89,880.025 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,626.816 105.89,626.816 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,373.606 105.89,373.606 
  "/>
<polyline clip-path="url(#clip710)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,120.397 105.89,120.397 
  "/>
<path clip-path="url(#clip710)" d="M-40.8824 1386.89 L-11.2066 1386.89 L-11.2066 1390.83 L-40.8824 1390.83 L-40.8824 1386.89 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M-0.303895 1399.79 L7.33495 1399.79 L7.33495 1373.42 L-0.975188 1375.09 L-0.975188 1370.83 L7.28866 1369.16 L11.9646 1369.16 L11.9646 1399.79 L19.6034 1399.79 L19.6034 1403.72 L-0.303895 1403.72 L-0.303895 1399.79 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M39.0477 1372.24 Q35.4367 1372.24 33.608 1375.81 Q31.8024 1379.35 31.8024 1386.48 Q31.8024 1393.58 33.608 1397.15 Q35.4367 1400.69 39.0477 1400.69 Q42.682 1400.69 44.4875 1397.15 Q46.3162 1393.58 46.3162 1386.48 Q46.3162 1379.35 44.4875 1375.81 Q42.682 1372.24 39.0477 1372.24 M39.0477 1368.54 Q44.8579 1368.54 47.9134 1373.14 Q50.9921 1377.73 50.9921 1386.48 Q50.9921 1395.21 47.9134 1399.81 Q44.8579 1404.39 39.0477 1404.39 Q33.2376 1404.39 30.1589 1399.81 Q27.1034 1395.21 27.1034 1386.48 Q27.1034 1377.73 30.1589 1373.14 Q33.2376 1368.54 39.0477 1368.54 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M-9.72514 1133.69 L19.9506 1133.69 L19.9506 1137.62 L-9.72514 1137.62 L-9.72514 1133.69 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M30.0895 1115.95 L48.4458 1115.95 L48.4458 1119.89 L34.3718 1119.89 L34.3718 1128.36 Q35.3904 1128.01 36.4089 1127.85 Q37.4274 1127.67 38.4459 1127.67 Q44.2329 1127.67 47.6125 1130.84 Q50.9921 1134.01 50.9921 1139.43 Q50.9921 1145 47.5199 1148.11 Q44.0477 1151.19 37.7283 1151.19 Q35.5524 1151.19 33.2839 1150.82 Q31.0385 1150.44 28.6311 1149.7 L28.6311 1145 Q30.7145 1146.14 32.9367 1146.69 Q35.1589 1147.25 37.6357 1147.25 Q41.6403 1147.25 43.9783 1145.14 Q46.3162 1143.04 46.3162 1139.43 Q46.3162 1135.82 43.9783 1133.71 Q41.6403 1131.6 37.6357 1131.6 Q35.7607 1131.6 33.8857 1132.02 Q32.0339 1132.44 30.0895 1133.32 L30.0895 1115.95 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M39.0477 865.824 Q35.4367 865.824 33.608 869.388 Q31.8024 872.93 31.8024 880.06 Q31.8024 887.166 33.608 890.731 Q35.4367 894.273 39.0477 894.273 Q42.682 894.273 44.4875 890.731 Q46.3162 887.166 46.3162 880.06 Q46.3162 872.93 44.4875 869.388 Q42.682 865.824 39.0477 865.824 M39.0477 862.12 Q44.8579 862.12 47.9134 866.726 Q50.9921 871.31 50.9921 880.06 Q50.9921 888.786 47.9134 893.393 Q44.8579 897.976 39.0477 897.976 Q33.2376 897.976 30.1589 893.393 Q27.1034 888.786 27.1034 880.06 Q27.1034 871.31 30.1589 866.726 Q33.2376 862.12 39.0477 862.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M30.0895 609.536 L48.4458 609.536 L48.4458 613.471 L34.3718 613.471 L34.3718 621.943 Q35.3904 621.596 36.4089 621.434 Q37.4274 621.249 38.4459 621.249 Q44.2329 621.249 47.6125 624.42 Q50.9921 627.591 50.9921 633.008 Q50.9921 638.586 47.5199 641.688 Q44.0477 644.767 37.7283 644.767 Q35.5524 644.767 33.2839 644.397 Q31.0385 644.026 28.6311 643.285 L28.6311 638.586 Q30.7145 639.721 32.9367 640.276 Q35.1589 640.832 37.6357 640.832 Q41.6403 640.832 43.9783 638.725 Q46.3162 636.619 46.3162 633.008 Q46.3162 629.397 43.9783 627.29 Q41.6403 625.184 37.6357 625.184 Q35.7607 625.184 33.8857 625.6 Q32.0339 626.017 30.0895 626.897 L30.0895 609.536 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M-0.303895 386.951 L7.33495 386.951 L7.33495 360.586 L-0.975188 362.252 L-0.975188 357.993 L7.28866 356.326 L11.9646 356.326 L11.9646 386.951 L19.6034 386.951 L19.6034 390.886 L-0.303895 390.886 L-0.303895 386.951 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M39.0477 359.405 Q35.4367 359.405 33.608 362.97 Q31.8024 366.511 31.8024 373.641 Q31.8024 380.747 33.608 384.312 Q35.4367 387.854 39.0477 387.854 Q42.682 387.854 44.4875 384.312 Q46.3162 380.747 46.3162 373.641 Q46.3162 366.511 44.4875 362.97 Q42.682 359.405 39.0477 359.405 M39.0477 355.701 Q44.8579 355.701 47.9134 360.308 Q50.9921 364.891 50.9921 373.641 Q50.9921 382.368 47.9134 386.974 Q44.8579 391.558 39.0477 391.558 Q33.2376 391.558 30.1589 386.974 Q27.1034 382.368 27.1034 373.641 Q27.1034 364.891 30.1589 360.308 Q33.2376 355.701 39.0477 355.701 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M0.69147 133.742 L8.33032 133.742 L8.33032 107.376 L0.0201769 109.043 L0.0201769 104.784 L8.28402 103.117 L12.9599 103.117 L12.9599 133.742 L20.5988 133.742 L20.5988 137.677 L0.69147 137.677 L0.69147 133.742 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip710)" d="M30.0895 103.117 L48.4458 103.117 L48.4458 107.052 L34.3718 107.052 L34.3718 115.524 Q35.3904 115.177 36.4089 115.015 Q37.4274 114.83 38.4459 114.83 Q44.2329 114.83 47.6125 118.001 Q50.9921 121.172 50.9921 126.589 Q50.9921 132.168 47.5199 135.27 Q44.0477 138.348 37.7283 138.348 Q35.5524 138.348 33.2839 137.978 Q31.0385 137.608 28.6311 136.867 L28.6311 132.168 Q30.7145 133.302 32.9367 133.858 Q35.1589 134.413 37.6357 134.413 Q41.6403 134.413 43.9783 132.307 Q46.3162 130.2 46.3162 126.589 Q46.3162 122.978 43.9783 120.872 Q41.6403 118.765 37.6357 118.765 Q35.7607 118.765 33.8857 119.182 Q32.0339 119.598 30.0895 120.478 L30.0895 103.117 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip712)" d="
M151.118 959.453 L364.869 1407.38 L578.62 1479.3 L792.371 1464.24 L1006.12 1438.11 L1219.87 1411.64 L1433.63 1384.8 L1647.38 1360.68 L1861.13 1333.03 L2074.88 1312.03 
  L2288.63 1291.28 L2288.63 331.815 L2074.88 296.659 L1861.13 263.846 L1647.38 235.286 L1433.63 201.632 L1219.87 164.831 L1006.12 131.212 L792.371 98.5561 L578.62 88.9544 
  L364.869 192.943 L151.118 800.078  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip712)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,883.32 364.869,869.17 578.62,865.404 792.371,865.491 1006.12,867.702 1219.87,868.59 1433.63,868.764 1647.38,869.159 1861.13,868.136 2074.88,872.787 
  2288.63,871.791 
  "/>
<path clip-path="url(#clip712)" d="
M151.118 960.393 L364.869 895.758 L578.62 882.851 L792.371 880.858 L1006.12 880.785 L1219.87 880.632 L1433.63 880.833 L1647.38 880.904 L1861.13 881.038 L2074.88 880.821 
  L2288.63 880.819 L2288.63 879.176 L2074.88 879.053 L1861.13 879.266 L1647.38 879.295 L1433.63 879.266 L1219.87 879.183 L1006.12 879.201 L792.371 878.801 L578.62 875.833 
  L364.869 858.012 L151.118 767.628  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip712)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,877.838 364.869,879.69 578.62,879.829 792.371,879.999 1006.12,880.033 1219.87,879.811 1433.63,879.992 1647.38,879.983 1861.13,880.142 2074.88,880.089 
  2288.63,880.023 
  "/>
</svg>
<h2 id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><a class="docs-heading-anchor" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter">Observables and Marginal Likelihood using a Kalman Filter</a><a id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter" title="Permalink"></a></h2><p>If you provide <code>observables</code> and provide a distribution for the <code>observables_noise</code> then the model can provide a calculation of the likelihood.  </p><p>The simplest case is if you use a gaussian prior and have gaussian observation noise.  First, lets simulate some data with included observation noise.  If passing in a matrix or vector, the <code>observables_noise</code> argument is intended to be the cholesky of the covariance matrix.  At this point, only diagonal observation noise is allowed.</p><pre><code class="language-julia hljs">u0 = MvNormal([1.0 0.1; 0.1 1.0])  # draw from mean zero initial conditions
T = 10
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)
sol.z # simulated observables with observation noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-0.3202198560353272, 0.41554292104319657]
 [-0.736155522439416, -4.036669446096289]
 [-0.6710526609086083, -5.068563147816061]
 [-0.45138288309185337, -4.273892232623953]
 [-0.21807575665155565, -3.8600737868291493]
 [-0.274710672137364, -3.7926810054423488]
 [-0.33782053451133426, -3.9659221404592495]
 [-0.30975604622382324, -3.240755389713733]
 [0.0613703576211892, -3.487450123143337]
 [-0.35497100037599955, -3.379863652711385]
 [-0.4271510558191173, -3.2611696895791034]</code></pre><p>Next we will find the log likelihood of these simulated observables using the <code>u0</code> as a prior and with the true parameters.</p><p>The new arguments we pass to the problem creation are <code>u0_prior_variance, u0_prior_mean,</code> and <code>observables</code>.  The <code>u0</code> is ignored for the filtering problem but must match the size.  The <code>KalmanFilter()</code> argument to the <code>solve</code> is unnecessary since it can select it manually given the priors and observables.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The timing convention is such that <code>observables</code> are expected to match the predictions starting at the second time period.  As the likelihood of the first element <code>u0</code> comes from a prior, the <code>observables</code> start at the next element, and hence the observables and noise sequences should be 1 less than the tspan </p></div></div><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = copy(sol.W) # save for later
u0_prior_mean = [0.0, 0.0]
# use covariance of distribution we drew from
u0_prior_var = cov(u0)

prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
sol = solve(prob, KalmanFilter())
# plot(sol) The `u` is the sequence of posterior means.
sol.logpdf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-5.47018863401849</code></pre><p>Hence the <code>logpdf</code> provides the log likelihood marginalizing out the latent noise variables.</p><p>As before, we can differentiate the kalman filter itself.</p><pre><code class="language-julia hljs">function kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
# Find the gradient wrt the A, B, C and priors variance.
gradient((A, B, C, u0_prior_var) -&gt; kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables), A, B, C, u0_prior_var)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-37.65354780114874 -0.18312282204385077; -197.93779734327535 -12.806856641297792], [-2.290524639815213; -22.611425710020978;;], [8.416400417274538 0.3846431923205693; -2.0140943110705223 0.17569803116735105], [-0.0660831725647921 0.3874950092681874; -0.2783993264137702 -0.3312229345011657])</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some of the gradients, such as those for <code>observables</code>, have not been implemented so test carefully.  This is a general theme with gradients and <code>Zygote.jl</code> in general.  Your best friend in this process is the spectacular <a href="https://github.com/JuliaDiff/ChainRulesTestUtils.jl">ChainRulesTestUtils.jl</a> package. See <code>test_rrule</code> usage in the <a href="https://github.com/SciML/DifferenceEquations.jl/blob/main/test/linear_gradients.jl">linear unit tests</a>.</p></div></div><h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>A key application of these methods is to find the joint likelihood of the latent variables (i.e., the <code>noise</code>) and the model definition.</p><p>The actual calculation of the likelihood is trivial in that case, and just requires iteration of the linear system while accumulating the likelihood given the observation noise.</p><p>Crucially, the differentiability with respect to the high-dimensional noise vector enables gradient-based sampling and estimation methods which would otherwise be infeasible.</p><pre><code class="language-julia hljs">function joint_likelihood(A, B, C, D, u0, noise, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood(A, B, C, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-776.5664106555097</code></pre><p>And as always, this can be differentiated with respect to the state-space matrices and the noise.  Choosing a few parameters,</p><pre><code class="language-julia hljs">gradient((A, u0, noise) -&gt; joint_likelihood(A, B, C, D, u0, noise, observables), A, u0, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-21.048134498232653 -3.659287259435251; -31.903465934226396 -17.390838000923733], [-304.06416320120985, -2426.5885764896466], [-22.108491358824367 -19.241353946808562 … -2.201800428445833 -0.02936453999667602])</code></pre><h2 id="Composition-of-State-Space-Models-and-AD"><a class="docs-heading-anchor" href="#Composition-of-State-Space-Models-and-AD">Composition of State Space Models and AD</a><a id="Composition-of-State-Space-Models-and-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-of-State-Space-Models-and-AD" title="Permalink"></a></h2><p>While the above gradients have been with respect to the full state space objects <code>A, B</code>, etc. those themselves could be generated through a separate procedure and the whole object differentiated.  For example, lets repeat the above examples where we generate the <code>A</code> matrix from some sort of deep parameters.</p><p>First we will generate some observations with a <code>generate_model</code> proxy–-which could be replaced with something more complicated but still differentiable</p><pre><code class="language-julia hljs">function generate_model(β)
    A = [β 6.2;
        0.0  0.2]
    B = Matrix([0.0  0.001]&#39;) # [0.0; 0.001;;] gives a zygote bug
    C = [0.09 0.67;
        1.00 0.00]
    D = [0.01, 0.01]
    return (;A,B,C,D)
end

function simulate_model(β, u0;T = 200)
    mod = generate_model(β)
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, T); mod.C, observables_noise = mod.D)
    sol = solve(prob) # simulates
    observables = hcat(sol.z...)
    observables = observables[:, 2:end] # see note above on likelihood and timing
    return observables, sol.W
end

# Fix a &quot;pseudo-true&quot; and generate noise and observables
β = 0.95
u0 = [0.0, 0.0]
observables, noise = simulate_model(β, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.09075402616643427 0.07327808709927919 … 0.13347548521729055 -0.053354965099283204; 0.011336190682942615 -0.18947697037176017 … 0.03477024265595264 0.06030956094726121], [-0.2304414186365793 -0.5349984228790077 … 0.664703817920774 0.11026283491263827])</code></pre><p>Next, we will evaluate the marginal likelihood using the kalman filter for a particular <code>β</code> value,</p><pre><code class="language-julia hljs">function kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
u0_prior_mean = [0.0, 0.0]
u0_prior_var = [1e-10 0.0;
                0.0 1e-10]  # starting with degenerate prior
kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">369.47571182947604</code></pre><p>Given the observation error we would not expect the pseudo-true to exactly maximimize the log likelihood.  To show this, we can optimize it using using the Optim package and using a gradient-based optimization routine</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimJL
# Create a function to minimize only of β and use Zygote based gradients
kalman_objective(β,p) = -kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
kalman_objective(0.95, nothing)
gradient(β -&gt;kalman_objective(β, nothing),β) # Verifying it can be differentiated


optf = OptimizationFunction(kalman_objective, Optimization.AutoZygote())
β0 = [0.91] # start off of the pseudotrue
optprob = OptimizationProblem(optf, β0)
optsol = solve(optprob,LBFGS())  # reverse-mode AD is overkill here</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 1-element Vector{Float64}:
 0.9351749790260239</code></pre><p>In this way, this package composes with others such as <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">DifferentiableStateSpaceModels.jl</a> which take a set of structural parameters and an expectational difference equation and generate a state-space model.</p><p>Similarly, we can find the joint likelihood for a particular <code>β</code> value and noise.  Here we will add in prior.  Some form of a prior or regularization is generally necessary for these sorts of nonlinear models.</p><pre><code class="language-julia hljs">function joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, noise)
    return solve(prob).logpdf + sum(logpdf.(noise_prior, noise)) + logpdf(β_prior, β) # posterior
end
u0 = [0.0, 0.0]
noise_prior = Normal(0.0, 1.0)
β_prior = Normal(β, 0.03) # prior local to the true value
joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">79.51292519813808</code></pre><p>Which we can turn into a differntiable objective adding in a prior on the noise</p><pre><code class="language-julia hljs">joint_model_objective(x, p) = -joint_model_posterior(x[1], u0, Matrix(x[2:end]&#39;), observables, noise_prior, β_prior) # extract noise and parameeter from vector
x0 = vcat([0.95], noise[1,:])  # starting at the true noise
joint_model_objective(x0, nothing)
gradient(x -&gt;joint_model_objective(x, nothing),x0) # Verifying it can be differentiated

# optimize
optf = OptimizationFunction(joint_model_objective, Optimization.AutoZygote())
optprob = OptimizationProblem(optf, x0)
optsol = solve(optprob,LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 201-element Vector{Float64}:
  0.9805878145782834
  0.023927031570623772
  0.12448537420704908
  0.05520266126788513
  0.09606345135191424
  0.0037673896975124834
  0.030498247593847894
  0.019592051984073308
  0.01742904756852955
  0.09650840012726015
  ⋮
  0.12187381264124135
  0.05061236969627508
  0.03228717262872438
  0.06243512324023439
  0.12376713570366522
  0.1132833090469316
  0.009850866905164776
  0.01697815960631025
 -0.003819551884340054</code></pre><p>This &quot;solves&quot; the problem relatively quickly, despite the high-dimensionality.  However, from a statistics perspective note that this last optimization process does not do especially well in recovering the pseudotrue if you increase the prior variance on the <code>β</code> parameter.  Maximizing the posterior is usually the wrong thing to do in high-dimensions because the mode is not a typical set.</p><h2 id="Caveats-on-Gradients-and-Performance"><a class="docs-heading-anchor" href="#Caveats-on-Gradients-and-Performance">Caveats on Gradients and Performance</a><a id="Caveats-on-Gradients-and-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Caveats-on-Gradients-and-Performance" title="Permalink"></a></h2><p>A few notes on performance and gradients:</p><ol><li>As this is using reverse-mode AD it will be efficient for fairly large systems as long as the ultimate value of your differentiable program.  With a little extra work and unit tests, it could support structured matrices/etc. as well.</li><li>Getting to much higher scales, where the <code>A,B,C,D</code> are so large that matrix-free operators is necessary, is feasible but will require generalizing those to LinearOperators.  This would be reasonably easy for the joint likelihood and feasible but possible for the Kalman filter</li><li>At this point, there is no support for forward-mode auto-differentiation.  For smaller systems with a kalman filter, this should dominate the alternatives, and efficient forward-mode AD rules for the kalman filter exist (see the supplementary materials in the the <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">Differentiable State Space Models</a> paper).  However, it would be a significant amount of work to add end-to-end support and fulfill standard SciML interfaces, and perhaps waiting for <a href="https://enzyme.mit.edu/julia/">Enzyme</a> or similar AD systems that provide both forward/reverse/mixed mode makes sense.</li><li>Forward-mode AD is likely inappropriate for the joint-likelihood based models since the dimensionality of the noise is always large.</li><li>The gradient rules are written using <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules.jl</a> so in theory they will work with any supporting AD.  In practice, though, Zygote is the most tested and other systems have inconsistent support on Julia at this time.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a><a class="docs-footer-nextpage" href="../quadratic_state_space_examples/">Quadratic State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Friday 12 August 2022 23:44">Friday 12 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
