<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/linear_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Linear (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Simulating-Ensembles-and-Fixing-Noise"><span>Simulating Ensembles and Fixing Noise</span></a></li><li><a class="tocitem" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><span>Observables and Marginal Likelihood using a Kalman Filter</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li><li><a class="tocitem" href="#Composition-of-State-Space-Models-and-AD"><span>Composition of State Space Models and AD</span></a></li><li><a class="tocitem" href="#Caveats-on-Gradients-and-Performance"><span>Caveats on Gradients and Performance</span></a></li></ul></li><li><a class="tocitem" href="../quadratic_state_space_examples/">Quadratic State Space Examples</a></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/linear_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-State-Space-Examples"><a class="docs-heading-anchor" href="#Linear-State-Space-Examples">Linear State Space Examples</a><a id="Linear-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-State-Space-Examples" title="Permalink"></a></h1><p>This tutorial provides describes the support for linear and linear gaussian state space models.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form of the linear model is</p><p class="math-container">\[u_{n+1} = A u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.  More generally, support could be added for <span>$u_{n+1} = A(p,n) u_n + B(p,n) w_{n+1}$</span> where <span>$p$</span> is a vector of differentiable parameters, and the <span>$A$</span> and <span>$B$</span> are potentially matrix-free operators.</p><h2 id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model">Simulating a Linear (and Time-Invariant) State Space Model</a><a id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>LinearStateSpaceProblem</code> and simulating it for a simple, linear equation.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote
A = [0.95 6.2;
     0.0  0.2]
B = [0.0; 0.01;;] # matrix
C = [0.09 0.67;
     1.00 0.00]
D = [0.1, 0.1] # diagonal observation noise
u0 = zeros(2)
T = 10

prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:10
u: 11-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [0.0, 0.004243499351207803]
 [0.02630969597748838, 0.004542442755773525]
 [0.053157356264409816, 0.008407535295718895]
 [0.10262620728464647, 0.010041621213358908]
 [0.15975294844323937, 0.0038485467439155043]
 [0.17562629083335352, -0.014080439118260048]
 [0.07954625375847352, 0.0031007930632431825]
 [0.09479385806265758, 0.018707198866453265]
 [0.20603879813153494, 0.009722617733291588]
 [0.25601708817136604, 0.006645205152007907]</code></pre><p>The <code>u</code> vector of the simulated solution can be plotted using standard recipes, including use of the optional <code>syms</code>.  See <a href="https://diffeq.sciml.ai/latest/basics/plot/">SciML docs</a> for more options.</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip000">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip000)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip001">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip000)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip002">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip000)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1392.29 2352.76,1392.29 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1137.66 2352.76,1137.66 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,883.034 2352.76,883.034 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,628.407 2352.76,628.407 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,373.779 2352.76,373.779 "/>
<polyline clip-path="url(#clip002)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,119.151 2352.76,119.151 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1392.29 105.89,1392.29 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1137.66 105.89,1137.66 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,883.034 105.89,883.034 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,628.407 105.89,628.407 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,373.779 105.89,373.779 "/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,119.151 105.89,119.151 "/>
<path clip-path="url(#clip000)" d="M-36.3454 1378.09 Q-39.9565 1378.09 -41.7852 1381.65 Q-43.5907 1385.19 -43.5907 1392.32 Q-43.5907 1399.43 -41.7852 1403 Q-39.9565 1406.54 -36.3454 1406.54 Q-32.7111 1406.54 -30.9056 1403 Q-29.0769 1399.43 -29.0769 1392.32 Q-29.0769 1385.19 -30.9056 1381.65 Q-32.7111 1378.09 -36.3454 1378.09 M-36.3454 1374.38 Q-30.5352 1374.38 -27.4797 1378.99 Q-24.401 1383.57 -24.401 1392.32 Q-24.401 1401.05 -27.4797 1405.66 Q-30.5352 1410.24 -36.3454 1410.24 Q-42.1555 1410.24 -45.2342 1405.66 Q-48.2897 1401.05 -48.2897 1392.32 Q-48.2897 1383.57 -45.2342 1378.99 Q-42.1555 1374.38 -36.3454 1374.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-16.1834 1403.69 L-11.2992 1403.69 L-11.2992 1409.57 L-16.1834 1409.57 L-16.1834 1403.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M8.88587 1378.09 Q5.27478 1378.09 3.44608 1381.65 Q1.64054 1385.19 1.64054 1392.32 Q1.64054 1399.43 3.44608 1403 Q5.27478 1406.54 8.88587 1406.54 Q12.5201 1406.54 14.3257 1403 Q16.1543 1399.43 16.1543 1392.32 Q16.1543 1385.19 14.3257 1381.65 Q12.5201 1378.09 8.88587 1378.09 M8.88587 1374.38 Q14.696 1374.38 17.7516 1378.99 Q20.8303 1383.57 20.8303 1392.32 Q20.8303 1401.05 17.7516 1405.66 Q14.696 1410.24 8.88587 1410.24 Q3.07572 1410.24 -0.00297114 1405.66 Q-3.05851 1401.05 -3.05851 1392.32 Q-3.05851 1383.57 -0.00297114 1378.99 Q3.07572 1374.38 8.88587 1374.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M39.0477 1378.09 Q35.4367 1378.09 33.608 1381.65 Q31.8024 1385.19 31.8024 1392.32 Q31.8024 1399.43 33.608 1403 Q35.4367 1406.54 39.0477 1406.54 Q42.682 1406.54 44.4875 1403 Q46.3162 1399.43 46.3162 1392.32 Q46.3162 1385.19 44.4875 1381.65 Q42.682 1378.09 39.0477 1378.09 M39.0477 1374.38 Q44.8579 1374.38 47.9134 1378.99 Q50.9921 1383.57 50.9921 1392.32 Q50.9921 1401.05 47.9134 1405.66 Q44.8579 1410.24 39.0477 1410.24 Q33.2376 1410.24 30.1589 1405.66 Q27.1034 1401.05 27.1034 1392.32 Q27.1034 1383.57 30.1589 1378.99 Q33.2376 1374.38 39.0477 1374.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-35.35 1123.46 Q-38.9611 1123.46 -40.7898 1127.03 Q-42.5953 1130.57 -42.5953 1137.7 Q-42.5953 1144.8 -40.7898 1148.37 Q-38.9611 1151.91 -35.35 1151.91 Q-31.7158 1151.91 -29.9102 1148.37 Q-28.0815 1144.8 -28.0815 1137.7 Q-28.0815 1130.57 -29.9102 1127.03 Q-31.7158 1123.46 -35.35 1123.46 M-35.35 1119.76 Q-29.5398 1119.76 -26.4843 1124.36 Q-23.4056 1128.95 -23.4056 1137.7 Q-23.4056 1146.42 -26.4843 1151.03 Q-29.5398 1155.61 -35.35 1155.61 Q-41.1602 1155.61 -44.2388 1151.03 Q-47.2944 1146.42 -47.2944 1137.7 Q-47.2944 1128.95 -44.2388 1124.36 Q-41.1602 1119.76 -35.35 1119.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-15.1881 1149.06 L-10.3038 1149.06 L-10.3038 1154.94 L-15.1881 1154.94 L-15.1881 1149.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M9.88124 1123.46 Q6.27014 1123.46 4.44145 1127.03 Q2.6359 1130.57 2.6359 1137.7 Q2.6359 1144.8 4.44145 1148.37 Q6.27014 1151.91 9.88124 1151.91 Q13.5155 1151.91 15.321 1148.37 Q17.1497 1144.8 17.1497 1137.7 Q17.1497 1130.57 15.321 1127.03 Q13.5155 1123.46 9.88124 1123.46 M9.88124 1119.76 Q15.6914 1119.76 18.7469 1124.36 Q21.8256 1128.95 21.8256 1137.7 Q21.8256 1146.42 18.7469 1151.03 Q15.6914 1155.61 9.88124 1155.61 Q4.07108 1155.61 0.992394 1151.03 Q-2.06315 1146.42 -2.06315 1137.7 Q-2.06315 1128.95 0.992394 1124.36 Q4.07108 1119.76 9.88124 1119.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M30.0895 1120.38 L48.4458 1120.38 L48.4458 1124.32 L34.3718 1124.32 L34.3718 1132.79 Q35.3904 1132.44 36.4089 1132.28 Q37.4274 1132.09 38.4459 1132.09 Q44.2329 1132.09 47.6125 1135.27 Q50.9921 1138.44 50.9921 1143.85 Q50.9921 1149.43 47.5199 1152.53 Q44.0477 1155.61 37.7283 1155.61 Q35.5524 1155.61 33.2839 1155.24 Q31.0385 1154.87 28.6311 1154.13 L28.6311 1149.43 Q30.7145 1150.57 32.9367 1151.12 Q35.1589 1151.68 37.6357 1151.68 Q41.6403 1151.68 43.9783 1149.57 Q46.3162 1147.47 46.3162 1143.85 Q46.3162 1140.24 43.9783 1138.14 Q41.6403 1136.03 37.6357 1136.03 Q35.7607 1136.03 33.8857 1136.45 Q32.0339 1136.86 30.0895 1137.74 L30.0895 1120.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-36.3454 868.833 Q-39.9565 868.833 -41.7852 872.398 Q-43.5907 875.939 -43.5907 883.069 Q-43.5907 890.175 -41.7852 893.74 Q-39.9565 897.282 -36.3454 897.282 Q-32.7111 897.282 -30.9056 893.74 Q-29.0769 890.175 -29.0769 883.069 Q-29.0769 875.939 -30.9056 872.398 Q-32.7111 868.833 -36.3454 868.833 M-36.3454 865.129 Q-30.5352 865.129 -27.4797 869.736 Q-24.401 874.319 -24.401 883.069 Q-24.401 891.796 -27.4797 896.402 Q-30.5352 900.986 -36.3454 900.986 Q-42.1555 900.986 -45.2342 896.402 Q-48.2897 891.796 -48.2897 883.069 Q-48.2897 874.319 -45.2342 869.736 Q-42.1555 865.129 -36.3454 865.129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-16.1834 894.435 L-11.2992 894.435 L-11.2992 900.314 L-16.1834 900.314 L-16.1834 894.435 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-0.303895 896.379 L7.33495 896.379 L7.33495 870.014 L-0.975188 871.68 L-0.975188 867.421 L7.28866 865.754 L11.9646 865.754 L11.9646 896.379 L19.6034 896.379 L19.6034 900.314 L-0.303895 900.314 L-0.303895 896.379 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M39.0477 868.833 Q35.4367 868.833 33.608 872.398 Q31.8024 875.939 31.8024 883.069 Q31.8024 890.175 33.608 893.74 Q35.4367 897.282 39.0477 897.282 Q42.682 897.282 44.4875 893.74 Q46.3162 890.175 46.3162 883.069 Q46.3162 875.939 44.4875 872.398 Q42.682 868.833 39.0477 868.833 M39.0477 865.129 Q44.8579 865.129 47.9134 869.736 Q50.9921 874.319 50.9921 883.069 Q50.9921 891.796 47.9134 896.402 Q44.8579 900.986 39.0477 900.986 Q33.2376 900.986 30.1589 896.402 Q27.1034 891.796 27.1034 883.069 Q27.1034 874.319 30.1589 869.736 Q33.2376 865.129 39.0477 865.129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-35.35 614.205 Q-38.9611 614.205 -40.7898 617.77 Q-42.5953 621.312 -42.5953 628.441 Q-42.5953 635.548 -40.7898 639.113 Q-38.9611 642.654 -35.35 642.654 Q-31.7158 642.654 -29.9102 639.113 Q-28.0815 635.548 -28.0815 628.441 Q-28.0815 621.312 -29.9102 617.77 Q-31.7158 614.205 -35.35 614.205 M-35.35 610.502 Q-29.5398 610.502 -26.4843 615.108 Q-23.4056 619.691 -23.4056 628.441 Q-23.4056 637.168 -26.4843 641.775 Q-29.5398 646.358 -35.35 646.358 Q-41.1602 646.358 -44.2388 641.775 Q-47.2944 637.168 -47.2944 628.441 Q-47.2944 619.691 -44.2388 615.108 Q-41.1602 610.502 -35.35 610.502 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-15.1881 639.807 L-10.3038 639.807 L-10.3038 645.687 L-15.1881 645.687 L-15.1881 639.807 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M0.69147 641.751 L8.33032 641.751 L8.33032 615.386 L0.0201769 617.052 L0.0201769 612.793 L8.28402 611.127 L12.9599 611.127 L12.9599 641.751 L20.5988 641.751 L20.5988 645.687 L0.69147 645.687 L0.69147 641.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M30.0895 611.127 L48.4458 611.127 L48.4458 615.062 L34.3718 615.062 L34.3718 623.534 Q35.3904 623.187 36.4089 623.025 Q37.4274 622.839 38.4459 622.839 Q44.2329 622.839 47.6125 626.011 Q50.9921 629.182 50.9921 634.599 Q50.9921 640.177 47.5199 643.279 Q44.0477 646.358 37.7283 646.358 Q35.5524 646.358 33.2839 645.987 Q31.0385 645.617 28.6311 644.876 L28.6311 640.177 Q30.7145 641.312 32.9367 641.867 Q35.1589 642.423 37.6357 642.423 Q41.6403 642.423 43.9783 640.316 Q46.3162 638.21 46.3162 634.599 Q46.3162 630.988 43.9783 628.881 Q41.6403 626.775 37.6357 626.775 Q35.7607 626.775 33.8857 627.191 Q32.0339 627.608 30.0895 628.488 L30.0895 611.127 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-36.3454 359.577 Q-39.9565 359.577 -41.7852 363.142 Q-43.5907 366.684 -43.5907 373.814 Q-43.5907 380.92 -41.7852 384.485 Q-39.9565 388.026 -36.3454 388.026 Q-32.7111 388.026 -30.9056 384.485 Q-29.0769 380.92 -29.0769 373.814 Q-29.0769 366.684 -30.9056 363.142 Q-32.7111 359.577 -36.3454 359.577 M-36.3454 355.874 Q-30.5352 355.874 -27.4797 360.48 Q-24.401 365.064 -24.401 373.814 Q-24.401 382.54 -27.4797 387.147 Q-30.5352 391.73 -36.3454 391.73 Q-42.1555 391.73 -45.2342 387.147 Q-48.2897 382.54 -48.2897 373.814 Q-48.2897 365.064 -45.2342 360.48 Q-42.1555 355.874 -36.3454 355.874 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-16.1834 385.179 L-11.2992 385.179 L-11.2992 391.059 L-16.1834 391.059 L-16.1834 385.179 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M2.91368 387.124 L19.233 387.124 L19.233 391.059 L-2.71129 391.059 L-2.71129 387.124 Q-0.0492672 384.369 4.53404 379.739 Q9.1405 375.087 10.321 373.744 Q12.5664 371.221 13.446 369.485 Q14.3488 367.726 14.3488 366.036 Q14.3488 363.281 12.4044 361.545 Q10.4831 359.809 7.38125 359.809 Q5.18219 359.809 2.7285 360.573 Q0.297953 361.337 -2.47981 362.888 L-2.47981 358.165 Q0.344249 357.031 2.79794 356.453 Q5.25163 355.874 7.28866 355.874 Q12.659 355.874 15.8534 358.559 Q19.0479 361.244 19.0479 365.735 Q19.0479 367.864 18.2377 369.786 Q17.4506 371.684 15.3442 374.276 Q14.7655 374.948 11.6636 378.165 Q8.5618 381.36 2.91368 387.124 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M39.0477 359.577 Q35.4367 359.577 33.608 363.142 Q31.8024 366.684 31.8024 373.814 Q31.8024 380.92 33.608 384.485 Q35.4367 388.026 39.0477 388.026 Q42.682 388.026 44.4875 384.485 Q46.3162 380.92 46.3162 373.814 Q46.3162 366.684 44.4875 363.142 Q42.682 359.577 39.0477 359.577 M39.0477 355.874 Q44.8579 355.874 47.9134 360.48 Q50.9921 365.064 50.9921 373.814 Q50.9921 382.54 47.9134 387.147 Q44.8579 391.73 39.0477 391.73 Q33.2376 391.73 30.1589 387.147 Q27.1034 382.54 27.1034 373.814 Q27.1034 365.064 30.1589 360.48 Q33.2376 355.874 39.0477 355.874 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-35.35 104.95 Q-38.9611 104.95 -40.7898 108.515 Q-42.5953 112.056 -42.5953 119.186 Q-42.5953 126.292 -40.7898 129.857 Q-38.9611 133.399 -35.35 133.399 Q-31.7158 133.399 -29.9102 129.857 Q-28.0815 126.292 -28.0815 119.186 Q-28.0815 112.056 -29.9102 108.515 Q-31.7158 104.95 -35.35 104.95 M-35.35 101.246 Q-29.5398 101.246 -26.4843 105.853 Q-23.4056 110.436 -23.4056 119.186 Q-23.4056 127.913 -26.4843 132.519 Q-29.5398 137.102 -35.35 137.102 Q-41.1602 137.102 -44.2388 132.519 Q-47.2944 127.913 -47.2944 119.186 Q-47.2944 110.436 -44.2388 105.853 Q-41.1602 101.246 -35.35 101.246 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M-15.1881 130.551 L-10.3038 130.551 L-10.3038 136.431 L-15.1881 136.431 L-15.1881 130.551 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M3.90904 132.496 L20.2284 132.496 L20.2284 136.431 L-1.71592 136.431 L-1.71592 132.496 Q0.946098 129.741 5.52941 125.112 Q10.1359 120.459 11.3164 119.116 Q13.5618 116.593 14.4414 114.857 Q15.3442 113.098 15.3442 111.408 Q15.3442 108.653 13.3997 106.917 Q11.4784 105.181 8.37661 105.181 Q6.17755 105.181 3.72386 105.945 Q1.29332 106.709 -1.48444 108.26 L-1.48444 103.538 Q1.33961 102.403 3.7933 101.825 Q6.247 101.246 8.28402 101.246 Q13.6544 101.246 16.8488 103.931 Q20.0432 106.616 20.0432 111.107 Q20.0432 113.237 19.233 115.158 Q18.446 117.056 16.3395 119.649 Q15.7608 120.32 12.659 123.538 Q9.55716 126.732 3.90904 132.496 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip000)" d="M30.0895 101.871 L48.4458 101.871 L48.4458 105.806 L34.3718 105.806 L34.3718 114.278 Q35.3904 113.931 36.4089 113.769 Q37.4274 113.584 38.4459 113.584 Q44.2329 113.584 47.6125 116.755 Q50.9921 119.927 50.9921 125.343 Q50.9921 130.922 47.5199 134.024 Q44.0477 137.102 37.7283 137.102 Q35.5524 137.102 33.2839 136.732 Q31.0385 136.362 28.6311 135.621 L28.6311 130.922 Q30.7145 132.056 32.9367 132.612 Q35.1589 133.167 37.6357 133.167 Q41.6403 133.167 43.9783 131.061 Q46.3162 128.954 46.3162 125.343 Q46.3162 121.732 43.9783 119.626 Q41.6403 117.519 37.6357 117.519 Q35.7607 117.519 33.8857 117.936 Q32.0339 118.352 30.0895 119.232 L30.0895 101.871 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip002)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1392.29 313.569,1392.29 540.145,1258.31 766.721,1121.58 993.298,869.66 1219.87,578.739 1446.45,497.903 1673.03,987.196 1899.6,909.547 2126.18,343.026 2352.76,88.5087 "/>
<polyline clip-path="url(#clip002)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1392.29 313.569,1370.68 540.145,1369.16 766.721,1349.47 993.298,1341.15 1219.87,1372.69 1446.45,1464 1673.03,1376.5 1899.6,1297.02 2126.18,1342.78 2352.76,1358.45 "/>
<path clip-path="url(#clip000)" d="M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip000)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 "/>
<polyline clip-path="url(#clip000)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,147.685 338.744,147.685 "/>
<path clip-path="url(#clip000)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip000)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,199.525 338.744,199.525 "/>
<path clip-path="url(#clip000)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>By default the solution provides an interface to access the simulated <code>u</code>.  That is, <code>sol.u[...] = sol[...]</code>,</p><pre><code class="language-julia hljs">sol[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.0
 0.004243499351207803</code></pre><p>Or to get the first element of the last step</p><pre><code class="language-julia hljs">sol[end][1] #first element of last step</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.25601708817136604</code></pre><p>Finally, to extract the full vector</p><pre><code class="language-julia hljs">@show sol[2,:];  # whole second vector</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
  0.004243499351207803
  0.004542442755773525
  0.008407535295718895
  0.010041621213358908
  0.0038485467439155043
 -0.014080439118260048
  0.0031007930632431825
  0.018707198866453265
  0.009722617733291588
  0.006645205152007907</code></pre><p>The results for all of <code>sol.u</code> can be loaded in a dataframe, where the column names will be the (optionally) provided symbols.</p><pre><code class="language-julia hljs">df = DataFrame(sol)</code></pre><div><div style = "float: left;"><span>11×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">timestamp</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0042435</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.0263097</td><td style = "text-align: right;">0.00454244</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.0531574</td><td style = "text-align: right;">0.00840754</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.102626</td><td style = "text-align: right;">0.0100416</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.159753</td><td style = "text-align: right;">0.00384855</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">6</td><td style = "text-align: right;">0.175626</td><td style = "text-align: right;">-0.0140804</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">7</td><td style = "text-align: right;">0.0795463</td><td style = "text-align: right;">0.00310079</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">8</td><td style = "text-align: right;">0.0947939</td><td style = "text-align: right;">0.0187072</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">9</td><td style = "text-align: right;">0.206039</td><td style = "text-align: right;">0.00972262</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">10</td><td style = "text-align: right;">0.256017</td><td style = "text-align: right;">0.00664521</td></tr></tbody></table></div><p>Other results, such as the simulated noise and observables can be extracted from the solution</p><pre><code class="language-julia hljs">sol.z # observables</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [0.14811509024299999, 0.04329959950171444]
 [-0.3855063573608048, -0.02994690865795206]
 [-0.11766329943126491, 0.42389659127522106]
 [0.6780131576661208, -0.036145395648575884]
 [0.17500855930603346, 0.608059006772456]
 [0.3520255432449338, -0.12702432804430694]
 [0.5296947608205579, 0.9222369048608421]
 [0.03452085407244951, -0.4419892914140338]
 [-0.1645694745607142, -0.03296131333570754]
 [-0.037167091704218835, 0.009140049757890623]
 [-0.20875401396437762, -0.009834849394817158]</code></pre><pre><code class="language-julia hljs">sol.W # Simulated Noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10 Matrix{Float64}:
 0.42435  0.369374  0.749905  0.836011  …  1.8087  0.598118  0.470068</code></pre><p>We can also solve the model passing in fixed noise, which will be useful for joint likelihoods.  First lets extract the noise from the previous solution, then rerun the simulation but with a different initial value</p><pre><code class="language-julia hljs">noise = sol.W
u0_2 = [0.1, 0.0]
prob2 = LinearStateSpaceProblem(A, B, u0_2, (0, T); C, observables_noise = D, syms = [:a, :b], noise)
sol2 = solve(prob2)
plot(sol2)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip060">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip060)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip061">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip060)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip062">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip060)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1405.3 2352.76,1405.3 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,988.45 2352.76,988.45 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,571.6 2352.76,571.6 "/>
<polyline clip-path="url(#clip062)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,154.749 2352.76,154.749 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1405.3 105.89,1405.3 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,988.45 105.89,988.45 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,571.6 105.89,571.6 "/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,154.749 105.89,154.749 "/>
<path clip-path="url(#clip060)" d="M-6.18349 1391.1 Q-9.79459 1391.1 -11.6233 1394.66 Q-13.4288 1398.21 -13.4288 1405.34 Q-13.4288 1412.44 -11.6233 1416.01 Q-9.79459 1419.55 -6.18349 1419.55 Q-2.54925 1419.55 -0.743708 1416.01 Q1.08499 1412.44 1.08499 1405.34 Q1.08499 1398.21 -0.743708 1394.66 Q-2.54925 1391.1 -6.18349 1391.1 M-6.18349 1387.4 Q-0.37334 1387.4 2.6822 1392 Q5.76089 1396.59 5.76089 1405.34 Q5.76089 1414.06 2.6822 1418.67 Q-0.37334 1423.25 -6.18349 1423.25 Q-11.9936 1423.25 -15.0723 1418.67 Q-18.1279 1414.06 -18.1279 1405.34 Q-18.1279 1396.59 -15.0723 1392 Q-11.9936 1387.4 -6.18349 1387.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M13.9784 1416.7 L18.8627 1416.7 L18.8627 1422.58 L13.9784 1422.58 L13.9784 1416.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M39.0477 1391.1 Q35.4367 1391.1 33.608 1394.66 Q31.8024 1398.21 31.8024 1405.34 Q31.8024 1412.44 33.608 1416.01 Q35.4367 1419.55 39.0477 1419.55 Q42.682 1419.55 44.4875 1416.01 Q46.3162 1412.44 46.3162 1405.34 Q46.3162 1398.21 44.4875 1394.66 Q42.682 1391.1 39.0477 1391.1 M39.0477 1387.4 Q44.8579 1387.4 47.9134 1392 Q50.9921 1396.59 50.9921 1405.34 Q50.9921 1414.06 47.9134 1418.67 Q44.8579 1423.25 39.0477 1423.25 Q33.2376 1423.25 30.1589 1418.67 Q27.1034 1414.06 27.1034 1405.34 Q27.1034 1396.59 30.1589 1392 Q33.2376 1387.4 39.0477 1387.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M-4.95665 974.249 Q-8.56774 974.249 -10.3964 977.814 Q-12.202 981.356 -12.202 988.485 Q-12.202 995.592 -10.3964 999.156 Q-8.56774 1002.7 -4.95665 1002.7 Q-1.32241 1002.7 0.483137 999.156 Q2.31183 995.592 2.31183 988.485 Q2.31183 981.356 0.483137 977.814 Q-1.32241 974.249 -4.95665 974.249 M-4.95665 970.545 Q0.853506 970.545 3.90904 975.152 Q6.98773 979.735 6.98773 988.485 Q6.98773 997.212 3.90904 1001.82 Q0.853506 1006.4 -4.95665 1006.4 Q-10.7668 1006.4 -13.8455 1001.82 Q-16.901 997.212 -16.901 988.485 Q-16.901 979.735 -13.8455 975.152 Q-10.7668 970.545 -4.95665 970.545 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M15.2053 999.851 L20.0895 999.851 L20.0895 1005.73 L15.2053 1005.73 L15.2053 999.851 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M31.0848 1001.8 L38.7237 1001.8 L38.7237 975.43 L30.4135 977.096 L30.4135 972.837 L38.6774 971.17 L43.3533 971.17 L43.3533 1001.8 L50.9921 1001.8 L50.9921 1005.73 L31.0848 1005.73 L31.0848 1001.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M-4.58628 557.399 Q-8.19737 557.399 -10.0261 560.963 Q-11.8316 564.505 -11.8316 571.635 Q-11.8316 578.741 -10.0261 582.306 Q-8.19737 585.848 -4.58628 585.848 Q-0.95204 585.848 0.853506 582.306 Q2.6822 578.741 2.6822 571.635 Q2.6822 564.505 0.853506 560.963 Q-0.95204 557.399 -4.58628 557.399 M-4.58628 553.695 Q1.22387 553.695 4.27941 558.301 Q7.3581 562.885 7.3581 571.635 Q7.3581 580.361 4.27941 584.968 Q1.22387 589.551 -4.58628 589.551 Q-10.3964 589.551 -13.4751 584.968 Q-16.5307 580.361 -16.5307 571.635 Q-16.5307 562.885 -13.4751 558.301 Q-10.3964 553.695 -4.58628 553.695 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M15.5756 583 L20.4599 583 L20.4599 588.88 L15.5756 588.88 L15.5756 583 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M34.6728 584.945 L50.9921 584.945 L50.9921 588.88 L29.0478 588.88 L29.0478 584.945 Q31.7098 582.19 36.2931 577.561 Q40.8996 572.908 42.0801 571.565 Q44.3255 569.042 45.2051 567.306 Q46.1079 565.547 46.1079 563.857 Q46.1079 561.102 44.1635 559.366 Q42.2422 557.63 39.1403 557.63 Q36.9413 557.63 34.4876 558.394 Q32.057 559.158 29.2793 560.709 L29.2793 555.987 Q32.1033 554.852 34.557 554.274 Q37.0107 553.695 39.0477 553.695 Q44.4181 553.695 47.6125 556.38 Q50.8069 559.065 50.8069 563.556 Q50.8069 565.686 49.9968 567.607 Q49.2097 569.505 47.1033 572.098 Q46.5246 572.769 43.4227 575.987 Q40.3209 579.181 34.6728 584.945 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M-5.53535 140.548 Q-9.14644 140.548 -10.9751 144.113 Q-12.7807 147.655 -12.7807 154.784 Q-12.7807 161.891 -10.9751 165.455 Q-9.14644 168.997 -5.53535 168.997 Q-1.90111 168.997 -0.0955632 165.455 Q1.73313 161.891 1.73313 154.784 Q1.73313 147.655 -0.0955632 144.113 Q-1.90111 140.548 -5.53535 140.548 M-5.53535 136.844 Q0.274805 136.844 3.33034 141.451 Q6.40903 146.034 6.40903 154.784 Q6.40903 163.511 3.33034 168.117 Q0.274805 172.701 -5.53535 172.701 Q-11.3455 172.701 -14.4242 168.117 Q-17.4797 163.511 -17.4797 154.784 Q-17.4797 146.034 -14.4242 141.451 Q-11.3455 136.844 -5.53535 136.844 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M14.6266 166.15 L19.5108 166.15 L19.5108 172.029 L14.6266 172.029 L14.6266 166.15 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip060)" d="M43.8625 153.395 Q47.219 154.113 49.094 156.381 Q50.9921 158.65 50.9921 161.983 Q50.9921 167.099 47.4736 169.9 Q43.9551 172.701 37.4737 172.701 Q35.2978 172.701 32.983 172.261 Q30.6913 171.844 28.2376 170.988 L28.2376 166.474 Q30.1821 167.608 32.4969 168.187 Q34.8117 168.766 37.3348 168.766 Q41.7329 168.766 44.0246 167.03 Q46.3394 165.293 46.3394 161.983 Q46.3394 158.928 44.1866 157.215 Q42.057 155.479 38.2376 155.479 L34.2098 155.479 L34.2098 151.636 L38.4227 151.636 Q41.8718 151.636 43.7005 150.27 Q45.5292 148.881 45.5292 146.289 Q45.5292 143.627 43.6311 142.215 Q41.7561 140.78 38.2376 140.78 Q36.3163 140.78 34.1172 141.196 Q31.9182 141.613 29.2793 142.493 L29.2793 138.326 Q31.9413 137.585 34.2561 137.215 Q36.5941 136.844 38.6542 136.844 Q43.9783 136.844 47.0801 139.275 Q50.1819 141.682 50.1819 145.803 Q50.1819 148.673 48.5384 150.664 Q46.8949 152.631 43.8625 153.395 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip062)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,988.45 313.569,1009.29 540.145,919.421 766.721,826.317 993.298,637.976 1219.87,416.819 1446.45,366.778 1673.03,782.61 1899.6,733.605 2126.18,283.707 2352.76,88.5087 "/>
<polyline clip-path="url(#clip062)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1405.3 313.569,1387.61 540.145,1386.37 766.721,1370.25 993.298,1363.44 1219.87,1389.26 1446.45,1464 1673.03,1392.38 1899.6,1327.32 2126.18,1364.77 2352.76,1377.6 "/>
<path clip-path="url(#clip060)" d="M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip060)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 "/>
<polyline clip-path="url(#clip060)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,147.685 338.744,147.685 "/>
<path clip-path="url(#clip060)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip060)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,199.525 338.744,199.525 "/>
<path clip-path="url(#clip060)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>To construct an IRF we can take the model and perturb just the first element of the noise,</p><pre><code class="language-julia hljs">function irf(A, B, C, T = 20)
    noise = Matrix([1.0; zeros(T-1)]&#39;)
    problem = LinearStateSpaceProblem(A, B, zeros(2), (0, T); C, noise, syms = [:a, :b])
    return solve(problem)
end
plot(irf(A, B, C))</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip120">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip120)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip121">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip120)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip122">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="653.433,1505.26 653.433,47.2441 "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1505.26 1219.87,47.2441 "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1786.31,1505.26 1786.31,47.2441 "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="653.433,1505.26 653.433,1486.36 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1505.26 1219.87,1486.36 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1786.31,1505.26 1786.31,1486.36 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip120)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M643.711 1533.1 L662.067 1533.1 L662.067 1537.04 L647.993 1537.04 L647.993 1545.51 Q649.012 1545.16 650.03 1545 Q651.049 1544.81 652.067 1544.81 Q657.854 1544.81 661.234 1547.98 Q664.614 1551.16 664.614 1556.57 Q664.614 1562.15 661.141 1565.25 Q657.669 1568.33 651.35 1568.33 Q649.174 1568.33 646.905 1567.96 Q644.66 1567.59 642.253 1566.85 L642.253 1562.15 Q644.336 1563.28 646.558 1563.84 Q648.78 1564.4 651.257 1564.4 Q655.262 1564.4 657.6 1562.29 Q659.938 1560.18 659.938 1556.57 Q659.938 1552.96 657.6 1550.85 Q655.262 1548.75 651.257 1548.75 Q649.382 1548.75 647.507 1549.16 Q645.655 1549.58 643.711 1550.46 L643.711 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1194.56 1563.72 L1202.2 1563.72 L1202.2 1537.36 L1193.89 1539.03 L1193.89 1534.77 L1202.15 1533.1 L1206.83 1533.1 L1206.83 1563.72 L1214.47 1563.72 L1214.47 1567.66 L1194.56 1567.66 L1194.56 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1233.91 1536.18 Q1230.3 1536.18 1228.47 1539.74 Q1226.67 1543.28 1226.67 1550.41 Q1226.67 1557.52 1228.47 1561.09 Q1230.3 1564.63 1233.91 1564.63 Q1237.55 1564.63 1239.35 1561.09 Q1241.18 1557.52 1241.18 1550.41 Q1241.18 1543.28 1239.35 1539.74 Q1237.55 1536.18 1233.91 1536.18 M1233.91 1532.47 Q1239.72 1532.47 1242.78 1537.08 Q1245.86 1541.66 1245.86 1550.41 Q1245.86 1559.14 1242.78 1563.75 Q1239.72 1568.33 1233.91 1568.33 Q1228.1 1568.33 1225.02 1563.75 Q1221.97 1559.14 1221.97 1550.41 Q1221.97 1541.66 1225.02 1537.08 Q1228.1 1532.47 1233.91 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1761.5 1563.72 L1769.14 1563.72 L1769.14 1537.36 L1760.83 1539.03 L1760.83 1534.77 L1769.09 1533.1 L1773.77 1533.1 L1773.77 1563.72 L1781.41 1563.72 L1781.41 1567.66 L1761.5 1567.66 L1761.5 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1790.9 1533.1 L1809.25 1533.1 L1809.25 1537.04 L1795.18 1537.04 L1795.18 1545.51 Q1796.2 1545.16 1797.22 1545 Q1798.24 1544.81 1799.25 1544.81 Q1805.04 1544.81 1808.42 1547.98 Q1811.8 1551.16 1811.8 1556.57 Q1811.8 1562.15 1808.33 1565.25 Q1804.86 1568.33 1798.54 1568.33 Q1796.36 1568.33 1794.09 1567.96 Q1791.85 1567.59 1789.44 1566.85 L1789.44 1562.15 Q1791.52 1563.28 1793.75 1563.84 Q1795.97 1564.4 1798.44 1564.4 Q1802.45 1564.4 1804.79 1562.29 Q1807.13 1560.18 1807.13 1556.57 Q1807.13 1552.96 1804.79 1550.85 Q1802.45 1548.75 1798.44 1548.75 Q1796.57 1548.75 1794.69 1549.16 Q1792.84 1549.58 1790.9 1550.46 L1790.9 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M2331.53 1563.72 L2347.85 1563.72 L2347.85 1567.66 L2325.9 1567.66 L2325.9 1563.72 Q2328.57 1560.97 2333.15 1556.34 Q2337.76 1551.69 2338.94 1550.35 Q2341.18 1547.82 2342.06 1546.09 Q2342.96 1544.33 2342.96 1542.64 Q2342.96 1539.88 2341.02 1538.15 Q2339.1 1536.41 2336 1536.41 Q2333.8 1536.41 2331.34 1537.17 Q2328.91 1537.94 2326.14 1539.49 L2326.14 1534.77 Q2328.96 1533.63 2331.41 1533.05 Q2333.87 1532.47 2335.9 1532.47 Q2341.27 1532.47 2344.47 1535.16 Q2347.66 1537.85 2347.66 1542.34 Q2347.66 1544.47 2346.85 1546.39 Q2346.07 1548.28 2343.96 1550.88 Q2343.38 1551.55 2340.28 1554.77 Q2337.18 1557.96 2331.53 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M2367.66 1536.18 Q2364.05 1536.18 2362.22 1539.74 Q2360.42 1543.28 2360.42 1550.41 Q2360.42 1557.52 2362.22 1561.09 Q2364.05 1564.63 2367.66 1564.63 Q2371.3 1564.63 2373.1 1561.09 Q2374.93 1557.52 2374.93 1550.41 Q2374.93 1543.28 2373.1 1539.74 Q2371.3 1536.18 2367.66 1536.18 M2367.66 1532.47 Q2373.47 1532.47 2376.53 1537.08 Q2379.61 1541.66 2379.61 1550.41 Q2379.61 1559.14 2376.53 1563.75 Q2373.47 1568.33 2367.66 1568.33 Q2361.85 1568.33 2358.77 1563.75 Q2355.72 1559.14 2355.72 1550.41 Q2355.72 1541.66 2358.77 1537.08 Q2361.85 1532.47 2367.66 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1078.16 2352.76,1078.16 "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,692.334 2352.76,692.334 "/>
<polyline clip-path="url(#clip122)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,306.503 2352.76,306.503 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1078.16 105.89,1078.16 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,692.334 105.89,692.334 "/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,306.503 105.89,306.503 "/>
<path clip-path="url(#clip120)" d="M-36.3454 1449.79 Q-39.9565 1449.79 -41.7852 1453.36 Q-43.5907 1456.9 -43.5907 1464.03 Q-43.5907 1471.14 -41.7852 1474.7 Q-39.9565 1478.24 -36.3454 1478.24 Q-32.7111 1478.24 -30.9056 1474.7 Q-29.0769 1471.14 -29.0769 1464.03 Q-29.0769 1456.9 -30.9056 1453.36 Q-32.7111 1449.79 -36.3454 1449.79 M-36.3454 1446.09 Q-30.5352 1446.09 -27.4797 1450.7 Q-24.401 1455.28 -24.401 1464.03 Q-24.401 1472.76 -27.4797 1477.36 Q-30.5352 1481.95 -36.3454 1481.95 Q-42.1555 1481.95 -45.2342 1477.36 Q-48.2897 1472.76 -48.2897 1464.03 Q-48.2897 1455.28 -45.2342 1450.7 Q-42.1555 1446.09 -36.3454 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-16.1834 1475.4 L-11.2992 1475.4 L-11.2992 1481.28 L-16.1834 1481.28 L-16.1834 1475.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M8.88587 1449.79 Q5.27478 1449.79 3.44608 1453.36 Q1.64054 1456.9 1.64054 1464.03 Q1.64054 1471.14 3.44608 1474.7 Q5.27478 1478.24 8.88587 1478.24 Q12.5201 1478.24 14.3257 1474.7 Q16.1543 1471.14 16.1543 1464.03 Q16.1543 1456.9 14.3257 1453.36 Q12.5201 1449.79 8.88587 1449.79 M8.88587 1446.09 Q14.696 1446.09 17.7516 1450.7 Q20.8303 1455.28 20.8303 1464.03 Q20.8303 1472.76 17.7516 1477.36 Q14.696 1481.95 8.88587 1481.95 Q3.07572 1481.95 -0.00297114 1477.36 Q-3.05851 1472.76 -3.05851 1464.03 Q-3.05851 1455.28 -0.00297114 1450.7 Q3.07572 1446.09 8.88587 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-34.7482 1063.96 Q-38.3592 1063.96 -40.1879 1067.53 Q-41.9935 1071.07 -41.9935 1078.2 Q-41.9935 1085.31 -40.1879 1088.87 Q-38.3592 1092.41 -34.7482 1092.41 Q-31.1139 1092.41 -29.3084 1088.87 Q-27.4797 1085.31 -27.4797 1078.2 Q-27.4797 1071.07 -29.3084 1067.53 Q-31.1139 1063.96 -34.7482 1063.96 M-34.7482 1060.26 Q-28.938 1060.26 -25.8825 1064.87 Q-22.8038 1069.45 -22.8038 1078.2 Q-22.8038 1086.93 -25.8825 1091.53 Q-28.938 1096.12 -34.7482 1096.12 Q-40.5583 1096.12 -43.637 1091.53 Q-46.6925 1086.93 -46.6925 1078.2 Q-46.6925 1069.45 -43.637 1064.87 Q-40.5583 1060.26 -34.7482 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-14.5862 1089.56 L-9.70199 1089.56 L-9.70199 1095.44 L-14.5862 1095.44 L-14.5862 1089.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M10.4831 1063.96 Q6.87199 1063.96 5.0433 1067.53 Q3.23775 1071.07 3.23775 1078.2 Q3.23775 1085.31 5.0433 1088.87 Q6.87199 1092.41 10.4831 1092.41 Q14.1173 1092.41 15.9229 1088.87 Q17.7516 1085.31 17.7516 1078.2 Q17.7516 1071.07 15.9229 1067.53 Q14.1173 1063.96 10.4831 1063.96 M10.4831 1060.26 Q16.2932 1060.26 19.3488 1064.87 Q22.4275 1069.45 22.4275 1078.2 Q22.4275 1086.93 19.3488 1091.53 Q16.2932 1096.12 10.4831 1096.12 Q4.67293 1096.12 1.59424 1091.53 Q-1.4613 1086.93 -1.4613 1078.2 Q-1.4613 1069.45 1.59424 1064.87 Q4.67293 1060.26 10.4831 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M34.6728 1091.51 L50.9921 1091.51 L50.9921 1095.44 L29.0478 1095.44 L29.0478 1091.51 Q31.7098 1088.75 36.2931 1084.13 Q40.8996 1079.47 42.0801 1078.13 Q44.3255 1075.61 45.2051 1073.87 Q46.1079 1072.11 46.1079 1070.42 Q46.1079 1067.67 44.1635 1065.93 Q42.2422 1064.19 39.1403 1064.19 Q36.9413 1064.19 34.4876 1064.96 Q32.057 1065.72 29.2793 1067.27 L29.2793 1062.55 Q32.1033 1061.42 34.557 1060.84 Q37.0107 1060.26 39.0477 1060.26 Q44.4181 1060.26 47.6125 1062.94 Q50.8069 1065.63 50.8069 1070.12 Q50.8069 1072.25 49.9968 1074.17 Q49.2097 1076.07 47.1033 1078.66 Q46.5246 1079.33 43.4227 1082.55 Q40.3209 1085.75 34.6728 1091.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-36.8315 678.132 Q-40.4426 678.132 -42.2713 681.697 Q-44.0768 685.239 -44.0768 692.369 Q-44.0768 699.475 -42.2713 703.04 Q-40.4426 706.581 -36.8315 706.581 Q-33.1972 706.581 -31.3917 703.04 Q-29.563 699.475 -29.563 692.369 Q-29.563 685.239 -31.3917 681.697 Q-33.1972 678.132 -36.8315 678.132 M-36.8315 674.429 Q-31.0213 674.429 -27.9658 679.035 Q-24.8871 683.619 -24.8871 692.369 Q-24.8871 701.095 -27.9658 705.702 Q-31.0213 710.285 -36.8315 710.285 Q-42.6416 710.285 -45.7203 705.702 Q-48.7759 701.095 -48.7759 692.369 Q-48.7759 683.619 -45.7203 679.035 Q-42.6416 674.429 -36.8315 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-16.6695 703.734 L-11.7853 703.734 L-11.7853 709.614 L-16.6695 709.614 L-16.6695 703.734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M8.39976 678.132 Q4.78867 678.132 2.95998 681.697 Q1.15443 685.239 1.15443 692.369 Q1.15443 699.475 2.95998 703.04 Q4.78867 706.581 8.39976 706.581 Q12.034 706.581 13.8395 703.04 Q15.6682 699.475 15.6682 692.369 Q15.6682 685.239 13.8395 681.697 Q12.034 678.132 8.39976 678.132 M8.39976 674.429 Q14.2099 674.429 17.2655 679.035 Q20.3441 683.619 20.3441 692.369 Q20.3441 701.095 17.2655 705.702 Q14.2099 710.285 8.39976 710.285 Q2.58961 710.285 -0.48908 705.702 Q-3.54462 701.095 -3.54462 692.369 Q-3.54462 683.619 -0.48908 679.035 Q2.58961 674.429 8.39976 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M41.4088 679.128 L29.6034 697.577 L41.4088 697.577 L41.4088 679.128 M40.182 675.054 L46.0616 675.054 L46.0616 697.577 L50.9921 697.577 L50.9921 701.466 L46.0616 701.466 L46.0616 709.614 L41.4088 709.614 L41.4088 701.466 L25.8071 701.466 L25.8071 696.952 L40.182 675.054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-36.5074 292.302 Q-40.1185 292.302 -41.9472 295.867 Q-43.7527 299.408 -43.7527 306.538 Q-43.7527 313.644 -41.9472 317.209 Q-40.1185 320.751 -36.5074 320.751 Q-32.8732 320.751 -31.0676 317.209 Q-29.2389 313.644 -29.2389 306.538 Q-29.2389 299.408 -31.0676 295.867 Q-32.8732 292.302 -36.5074 292.302 M-36.5074 288.598 Q-30.6973 288.598 -27.6417 293.205 Q-24.563 297.788 -24.563 306.538 Q-24.563 315.265 -27.6417 319.871 Q-30.6973 324.454 -36.5074 324.454 Q-42.3176 324.454 -45.3962 319.871 Q-48.4518 315.265 -48.4518 306.538 Q-48.4518 297.788 -45.3962 293.205 Q-42.3176 288.598 -36.5074 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M-16.3455 317.903 L-11.4612 317.903 L-11.4612 323.783 L-16.3455 323.783 L-16.3455 317.903 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M8.72383 292.302 Q5.11274 292.302 3.28405 295.867 Q1.4785 299.408 1.4785 306.538 Q1.4785 313.644 3.28405 317.209 Q5.11274 320.751 8.72383 320.751 Q12.3581 320.751 14.1636 317.209 Q15.9923 313.644 15.9923 306.538 Q15.9923 299.408 14.1636 295.867 Q12.3581 292.302 8.72383 292.302 M8.72383 288.598 Q14.534 288.598 17.5895 293.205 Q20.6682 297.788 20.6682 306.538 Q20.6682 315.265 17.5895 319.871 Q14.534 324.454 8.72383 324.454 Q2.91368 324.454 -0.165007 319.871 Q-3.22055 315.265 -3.22055 306.538 Q-3.22055 297.788 -0.165007 293.205 Q2.91368 288.598 8.72383 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip120)" d="M39.4644 304.64 Q36.3163 304.64 34.4644 306.792 Q32.6357 308.945 32.6357 312.695 Q32.6357 316.422 34.4644 318.598 Q36.3163 320.751 39.4644 320.751 Q42.6125 320.751 44.4412 318.598 Q46.2931 316.422 46.2931 312.695 Q46.2931 308.945 44.4412 306.792 Q42.6125 304.64 39.4644 304.64 M48.7468 289.987 L48.7468 294.246 Q46.9875 293.413 45.182 292.973 Q43.3996 292.533 41.6403 292.533 Q37.0107 292.533 34.557 295.658 Q32.1265 298.783 31.7793 305.103 Q33.145 303.089 35.2052 302.024 Q37.2653 300.936 39.7422 300.936 Q44.9505 300.936 47.9597 304.107 Q50.9921 307.255 50.9921 312.695 Q50.9921 318.019 47.844 321.237 Q44.6959 324.454 39.4644 324.454 Q33.4691 324.454 30.2978 319.871 Q27.1265 315.265 27.1265 306.538 Q27.1265 298.343 31.0154 293.482 Q34.9042 288.598 41.4551 288.598 Q43.2144 288.598 44.9968 288.945 Q46.8023 289.292 48.7468 289.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip122)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1464 313.569,267.92 426.857,88.5087 540.145,109.44 653.433,167.599 766.721,230.505 880.009,291.797 993.298,350.33 1106.59,405.998 1219.87,458.895 1333.16,509.149 1446.45,556.892 1559.74,602.247 1673.03,645.334 1786.31,686.267 1899.6,725.154 2012.89,762.096 2126.18,797.191 2239.47,830.531 2352.76,862.204 "/>
<polyline clip-path="url(#clip122)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1271.08 313.569,1425.41 426.857,1456.28 540.145,1462.45 653.433,1463.69 766.721,1463.93 880.009,1463.98 993.298,1463.99 1106.59,1463.99 1219.87,1464 1333.16,1464 1446.45,1464 1559.74,1464 1673.03,1464 1786.31,1464 1899.6,1464 2012.89,1464 2126.18,1464 2239.47,1464 2352.76,1464 "/>
<path clip-path="url(#clip120)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip120)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip120)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip120)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip120)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip120)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>Lets find the 2nd observable at the end of the IRF.</p><pre><code class="language-julia hljs">function last_observable_irf(A, B, C)
    sol = irf(A, B, C)
    return sol.z[end][2]  # return 2nd argument of last observable
end
last_observable_irf(A, B, C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.03119456447624772</code></pre><p>But everything in this package is differentiable.  Lets differentiate the observable of the IRF with respect to all of the parameters using <code>Zygote.jl</code>,</p><pre><code class="language-julia hljs">gradient(last_observable_irf, A, B, C)  # calculates gradient wrt all arguments</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.5822985368900442 0.0050313813671367304; 4.469834483178462 0.041592752634585235], [0.37735360253530714; 3.119456447624773;;], [0.0 0.0; 0.03119456447624772 5.242880000000006e-16])</code></pre><p>Gradients of other model elements (e.g. <code>.u</code> are also possible.  With this in mind, lets find the gradient of the mean of the 1st element of the IRF of the solution with respect to a particular noise vector.</p><pre><code class="language-julia hljs">function mean_u_1(A, B, C, noise, u0, T)
    problem = LinearStateSpaceProblem(A, B, u0, (0, T); noise, syms = [:a, :b])
    sol = solve(problem)
    u = sol.u # see issue #75 workaround
    # can have nontrivial functions and even non-mutating loops
    return mean( u[i][1] for i in 1:T)
end
u0 = [0.0, 0.0]
noise = sol.W # from simulation above
mean_u_1(A, B, C, noise, u0, T)
# dropping a few arguments from derivative
gradient((noise, u0)-&gt; mean_u_1(A, B, C, noise, u0, T), noise, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.05079876954953124 0.045314515146875 … 0.0 0.0], [0.702526121523242, 5.600882710405467])</code></pre><h2 id="Simulating-Ensembles-and-Fixing-Noise"><a class="docs-heading-anchor" href="#Simulating-Ensembles-and-Fixing-Noise">Simulating Ensembles and Fixing Noise</a><a id="Simulating-Ensembles-and-Fixing-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Ensembles-and-Fixing-Noise" title="Permalink"></a></h2><p>If you pass in a distribution for the initial condition, it will draw an initial condition.  Below we will simulate from a deterministic evolution equation and without any observation noise.</p><pre><code class="language-julia hljs">using Distributions, DiffEqBase
u0 = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = LinearStateSpaceProblem(A, nothing, u0, (0, T); C)
sol = solve(prob)
plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip180">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip180)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip181">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip180)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip182">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip180)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1461.15 2352.76,1461.15 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1254.2 2352.76,1254.2 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1047.25 2352.76,1047.25 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,840.306 2352.76,840.306 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,633.356 2352.76,633.356 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,426.407 2352.76,426.407 "/>
<polyline clip-path="url(#clip182)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,219.458 2352.76,219.458 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1461.15 105.89,1461.15 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1254.2 105.89,1254.2 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1047.25 105.89,1047.25 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,840.306 105.89,840.306 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,633.356 105.89,633.356 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,426.407 105.89,426.407 "/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,219.458 105.89,219.458 "/>
<path clip-path="url(#clip180)" d="M-6.18349 1446.95 Q-9.79459 1446.95 -11.6233 1450.52 Q-13.4288 1454.06 -13.4288 1461.19 Q-13.4288 1468.29 -11.6233 1471.86 Q-9.79459 1475.4 -6.18349 1475.4 Q-2.54925 1475.4 -0.743708 1471.86 Q1.08499 1468.29 1.08499 1461.19 Q1.08499 1454.06 -0.743708 1450.52 Q-2.54925 1446.95 -6.18349 1446.95 M-6.18349 1443.25 Q-0.37334 1443.25 2.6822 1447.85 Q5.76089 1452.44 5.76089 1461.19 Q5.76089 1469.91 2.6822 1474.52 Q-0.37334 1479.1 -6.18349 1479.1 Q-11.9936 1479.1 -15.0723 1474.52 Q-18.1279 1469.91 -18.1279 1461.19 Q-18.1279 1452.44 -15.0723 1447.85 Q-11.9936 1443.25 -6.18349 1443.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M13.9784 1472.55 L18.8627 1472.55 L18.8627 1478.43 L13.9784 1478.43 L13.9784 1472.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M39.0477 1446.95 Q35.4367 1446.95 33.608 1450.52 Q31.8024 1454.06 31.8024 1461.19 Q31.8024 1468.29 33.608 1471.86 Q35.4367 1475.4 39.0477 1475.4 Q42.682 1475.4 44.4875 1471.86 Q46.3162 1468.29 46.3162 1461.19 Q46.3162 1454.06 44.4875 1450.52 Q42.682 1446.95 39.0477 1446.95 M39.0477 1443.25 Q44.8579 1443.25 47.9134 1447.85 Q50.9921 1452.44 50.9921 1461.19 Q50.9921 1469.91 47.9134 1474.52 Q44.8579 1479.1 39.0477 1479.1 Q33.2376 1479.1 30.1589 1474.52 Q27.1034 1469.91 27.1034 1461.19 Q27.1034 1452.44 30.1589 1447.85 Q33.2376 1443.25 39.0477 1443.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M-4.95665 1240 Q-8.56774 1240 -10.3964 1243.57 Q-12.202 1247.11 -12.202 1254.24 Q-12.202 1261.35 -10.3964 1264.91 Q-8.56774 1268.45 -4.95665 1268.45 Q-1.32241 1268.45 0.483137 1264.91 Q2.31183 1261.35 2.31183 1254.24 Q2.31183 1247.11 0.483137 1243.57 Q-1.32241 1240 -4.95665 1240 M-4.95665 1236.3 Q0.853506 1236.3 3.90904 1240.91 Q6.98773 1245.49 6.98773 1254.24 Q6.98773 1262.97 3.90904 1267.57 Q0.853506 1272.16 -4.95665 1272.16 Q-10.7668 1272.16 -13.8455 1267.57 Q-16.901 1262.97 -16.901 1254.24 Q-16.901 1245.49 -13.8455 1240.91 Q-10.7668 1236.3 -4.95665 1236.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M15.2053 1265.6 L20.0895 1265.6 L20.0895 1271.48 L15.2053 1271.48 L15.2053 1265.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M31.0848 1267.55 L38.7237 1267.55 L38.7237 1241.18 L30.4135 1242.85 L30.4135 1238.59 L38.6774 1236.92 L43.3533 1236.92 L43.3533 1267.55 L50.9921 1267.55 L50.9921 1271.48 L31.0848 1271.48 L31.0848 1267.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M-4.58628 1033.05 Q-8.19737 1033.05 -10.0261 1036.62 Q-11.8316 1040.16 -11.8316 1047.29 Q-11.8316 1054.4 -10.0261 1057.96 Q-8.19737 1061.5 -4.58628 1061.5 Q-0.95204 1061.5 0.853506 1057.96 Q2.6822 1054.4 2.6822 1047.29 Q2.6822 1040.16 0.853506 1036.62 Q-0.95204 1033.05 -4.58628 1033.05 M-4.58628 1029.35 Q1.22387 1029.35 4.27941 1033.96 Q7.3581 1038.54 7.3581 1047.29 Q7.3581 1056.02 4.27941 1060.62 Q1.22387 1065.21 -4.58628 1065.21 Q-10.3964 1065.21 -13.4751 1060.62 Q-16.5307 1056.02 -16.5307 1047.29 Q-16.5307 1038.54 -13.4751 1033.96 Q-10.3964 1029.35 -4.58628 1029.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M15.5756 1058.66 L20.4599 1058.66 L20.4599 1064.53 L15.5756 1064.53 L15.5756 1058.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M34.6728 1060.6 L50.9921 1060.6 L50.9921 1064.53 L29.0478 1064.53 L29.0478 1060.6 Q31.7098 1057.84 36.2931 1053.22 Q40.8996 1048.56 42.0801 1047.22 Q44.3255 1044.7 45.2051 1042.96 Q46.1079 1041.2 46.1079 1039.51 Q46.1079 1036.76 44.1635 1035.02 Q42.2422 1033.28 39.1403 1033.28 Q36.9413 1033.28 34.4876 1034.05 Q32.057 1034.81 29.2793 1036.36 L29.2793 1031.64 Q32.1033 1030.51 34.557 1029.93 Q37.0107 1029.35 39.0477 1029.35 Q44.4181 1029.35 47.6125 1032.03 Q50.8069 1034.72 50.8069 1039.21 Q50.8069 1041.34 49.9968 1043.26 Q49.2097 1045.16 47.1033 1047.75 Q46.5246 1048.42 43.4227 1051.64 Q40.3209 1054.84 34.6728 1060.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M-5.53535 826.104 Q-9.14644 826.104 -10.9751 829.669 Q-12.7807 833.211 -12.7807 840.34 Q-12.7807 847.447 -10.9751 851.011 Q-9.14644 854.553 -5.53535 854.553 Q-1.90111 854.553 -0.0955632 851.011 Q1.73313 847.447 1.73313 840.34 Q1.73313 833.211 -0.0955632 829.669 Q-1.90111 826.104 -5.53535 826.104 M-5.53535 822.401 Q0.274805 822.401 3.33034 827.007 Q6.40903 831.59 6.40903 840.34 Q6.40903 849.067 3.33034 853.673 Q0.274805 858.257 -5.53535 858.257 Q-11.3455 858.257 -14.4242 853.673 Q-17.4797 849.067 -17.4797 840.34 Q-17.4797 831.59 -14.4242 827.007 Q-11.3455 822.401 -5.53535 822.401 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M14.6266 851.706 L19.5108 851.706 L19.5108 857.586 L14.6266 857.586 L14.6266 851.706 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M43.8625 838.951 Q47.219 839.669 49.094 841.937 Q50.9921 844.206 50.9921 847.539 Q50.9921 852.655 47.4736 855.456 Q43.9551 858.257 37.4737 858.257 Q35.2978 858.257 32.983 857.817 Q30.6913 857.4 28.2376 856.544 L28.2376 852.03 Q30.1821 853.164 32.4969 853.743 Q34.8117 854.322 37.3348 854.322 Q41.7329 854.322 44.0246 852.586 Q46.3394 850.849 46.3394 847.539 Q46.3394 844.484 44.1866 842.771 Q42.057 841.035 38.2376 841.035 L34.2098 841.035 L34.2098 837.192 L38.4227 837.192 Q41.8718 837.192 43.7005 835.826 Q45.5292 834.437 45.5292 831.845 Q45.5292 829.183 43.6311 827.771 Q41.7561 826.336 38.2376 826.336 Q36.3163 826.336 34.1172 826.752 Q31.9182 827.169 29.2793 828.049 L29.2793 823.882 Q31.9413 823.141 34.2561 822.771 Q36.5941 822.401 38.6542 822.401 Q43.9783 822.401 47.0801 824.831 Q50.1819 827.238 50.1819 831.359 Q50.1819 834.229 48.5384 836.22 Q46.8949 838.187 43.8625 838.951 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M-6.6696 619.155 Q-10.2807 619.155 -12.1094 622.72 Q-13.9149 626.261 -13.9149 633.391 Q-13.9149 640.497 -12.1094 644.062 Q-10.2807 647.604 -6.6696 647.604 Q-3.03536 647.604 -1.22982 644.062 Q0.598877 640.497 0.598877 633.391 Q0.598877 626.261 -1.22982 622.72 Q-3.03536 619.155 -6.6696 619.155 M-6.6696 615.451 Q-0.859448 615.451 2.19609 620.058 Q5.27478 624.641 5.27478 633.391 Q5.27478 642.118 2.19609 646.724 Q-0.859448 651.308 -6.6696 651.308 Q-12.4798 651.308 -15.5584 646.724 Q-18.614 642.118 -18.614 633.391 Q-18.614 624.641 -15.5584 620.058 Q-12.4798 615.451 -6.6696 615.451 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M13.4923 644.757 L18.3766 644.757 L18.3766 650.636 L13.4923 650.636 L13.4923 644.757 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M41.4088 620.15 L29.6034 638.599 L41.4088 638.599 L41.4088 620.15 M40.182 616.076 L46.0616 616.076 L46.0616 638.599 L50.9921 638.599 L50.9921 642.488 L46.0616 642.488 L46.0616 650.636 L41.4088 650.636 L41.4088 642.488 L25.8071 642.488 L25.8071 637.974 L40.182 616.076 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M-5.18813 412.206 Q-8.79922 412.206 -10.6279 415.771 Q-12.4335 419.312 -12.4335 426.442 Q-12.4335 433.548 -10.6279 437.113 Q-8.79922 440.655 -5.18813 440.655 Q-1.55389 440.655 0.251657 437.113 Q2.08035 433.548 2.08035 426.442 Q2.08035 419.312 0.251657 415.771 Q-1.55389 412.206 -5.18813 412.206 M-5.18813 408.502 Q0.622026 408.502 3.67756 413.109 Q6.75625 417.692 6.75625 426.442 Q6.75625 435.169 3.67756 439.775 Q0.622026 444.358 -5.18813 444.358 Q-10.9983 444.358 -14.077 439.775 Q-17.1325 435.169 -17.1325 426.442 Q-17.1325 417.692 -14.077 413.109 Q-10.9983 408.502 -5.18813 408.502 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M14.9738 437.808 L19.858 437.808 L19.858 443.687 L14.9738 443.687 L14.9738 437.808 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M30.0895 409.127 L48.4458 409.127 L48.4458 413.062 L34.3718 413.062 L34.3718 421.534 Q35.3904 421.187 36.4089 421.025 Q37.4274 420.84 38.4459 420.84 Q44.2329 420.84 47.6125 424.011 Q50.9921 427.183 50.9921 432.599 Q50.9921 438.178 47.5199 441.28 Q44.0477 444.358 37.7283 444.358 Q35.5524 444.358 33.2839 443.988 Q31.0385 443.618 28.6311 442.877 L28.6311 438.178 Q30.7145 439.312 32.9367 439.868 Q35.1589 440.423 37.6357 440.423 Q41.6403 440.423 43.9783 438.317 Q46.3162 436.21 46.3162 432.599 Q46.3162 428.988 43.9783 426.882 Q41.6403 424.775 37.6357 424.775 Q35.7607 424.775 33.8857 425.192 Q32.0339 425.609 30.0895 426.488 L30.0895 409.127 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M-6.34553 205.257 Q-9.95662 205.257 -11.7853 208.821 Q-13.5909 212.363 -13.5909 219.493 Q-13.5909 226.599 -11.7853 230.164 Q-9.95662 233.706 -6.34553 233.706 Q-2.71129 233.706 -0.905744 230.164 Q0.92295 226.599 0.92295 219.493 Q0.92295 212.363 -0.905744 208.821 Q-2.71129 205.257 -6.34553 205.257 M-6.34553 201.553 Q-0.535376 201.553 2.52016 206.159 Q5.59885 210.743 5.59885 219.493 Q5.59885 228.22 2.52016 232.826 Q-0.535376 237.409 -6.34553 237.409 Q-12.1557 237.409 -15.2344 232.826 Q-18.2899 228.22 -18.2899 219.493 Q-18.2899 210.743 -15.2344 206.159 Q-12.1557 201.553 -6.34553 201.553 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M13.8164 230.858 L18.7006 230.858 L18.7006 236.738 L13.8164 236.738 L13.8164 230.858 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M39.4644 217.595 Q36.3163 217.595 34.4644 219.747 Q32.6357 221.9 32.6357 225.65 Q32.6357 229.377 34.4644 231.553 Q36.3163 233.706 39.4644 233.706 Q42.6125 233.706 44.4412 231.553 Q46.2931 229.377 46.2931 225.65 Q46.2931 221.9 44.4412 219.747 Q42.6125 217.595 39.4644 217.595 M48.7468 202.942 L48.7468 207.201 Q46.9875 206.368 45.182 205.928 Q43.3996 205.488 41.6403 205.488 Q37.0107 205.488 34.557 208.613 Q32.1265 211.738 31.7793 218.058 Q33.145 216.044 35.2052 214.979 Q37.2653 213.891 39.7422 213.891 Q44.9505 213.891 47.9597 217.062 Q50.9921 220.21 50.9921 225.65 Q50.9921 230.974 47.844 234.192 Q44.6959 237.409 39.4644 237.409 Q33.4691 237.409 30.2978 232.826 Q27.1265 228.22 27.1265 219.493 Q27.1265 211.298 31.0154 206.437 Q34.9042 201.553 41.4551 201.553 Q43.2144 201.553 44.9968 201.9 Q46.8023 202.247 48.7468 202.942 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip182)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 313.569,268.019 540.145,88.5087 766.721,109.308 993.298,167.333 1219.87,230.111 1446.45,291.28 1673.03,349.697 1899.6,405.255 2126.18,458.047 2352.76,508.201 "/>
<polyline clip-path="url(#clip182)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1268.28 313.569,1422.58 540.145,1453.44 766.721,1459.61 993.298,1460.84 1219.87,1461.09 1446.45,1461.14 1673.03,1461.15 1899.6,1461.15 2126.18,1461.15 2352.76,1461.15 "/>
<path clip-path="url(#clip180)" d="M1942.97 251.365 L2277.23 251.365 L2277.23 95.8446 L1942.97 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip180)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1942.97,251.365 2277.23,251.365 2277.23,95.8446 1942.97,95.8446 1942.97,251.365 "/>
<polyline clip-path="url(#clip180)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,147.685 2119.2,147.685 "/>
<path clip-path="url(#clip180)" d="M2144.37 154.733 L2144.37 139.039 L2148.63 139.039 L2148.63 154.571 Q2148.63 158.252 2150.07 160.104 Q2151.5 161.932 2154.37 161.932 Q2157.82 161.932 2159.81 159.733 Q2161.82 157.534 2161.82 153.738 L2161.82 139.039 L2166.08 139.039 L2166.08 164.965 L2161.82 164.965 L2161.82 160.983 Q2160.27 163.344 2158.21 164.502 Q2156.18 165.636 2153.47 165.636 Q2149 165.636 2146.69 162.858 Q2144.37 160.08 2144.37 154.733 M2155.09 138.414 L2155.09 138.414 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2176.27 161.029 L2183.91 161.029 L2183.91 134.664 L2175.6 136.331 L2175.6 132.071 L2183.86 130.405 L2188.54 130.405 L2188.54 161.029 L2196.18 161.029 L2196.18 164.965 L2176.27 164.965 L2176.27 161.029 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2215.25 128.993 Q2212.15 134.317 2210.64 139.525 Q2209.14 144.733 2209.14 150.08 Q2209.14 155.428 2210.64 160.682 Q2212.17 165.914 2215.25 171.215 L2211.55 171.215 Q2208.07 165.775 2206.34 160.52 Q2204.62 155.266 2204.62 150.08 Q2204.62 144.918 2206.34 139.687 Q2208.05 134.456 2211.55 128.993 L2215.25 128.993 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2227.73 131.678 L2227.73 139.039 L2236.5 139.039 L2236.5 142.349 L2227.73 142.349 L2227.73 156.423 Q2227.73 159.594 2228.58 160.497 Q2229.46 161.4 2232.12 161.4 L2236.5 161.4 L2236.5 164.965 L2232.12 164.965 Q2227.19 164.965 2225.32 163.136 Q2223.44 161.284 2223.44 156.423 L2223.44 142.349 L2220.32 142.349 L2220.32 139.039 L2223.44 139.039 L2223.44 131.678 L2227.73 131.678 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2241.43 128.993 L2245.13 128.993 Q2248.61 134.456 2250.32 139.687 Q2252.06 144.918 2252.06 150.08 Q2252.06 155.266 2250.32 160.52 Q2248.61 165.775 2245.13 171.215 L2241.43 171.215 Q2244.51 165.914 2246.01 160.682 Q2247.54 155.428 2247.54 150.08 Q2247.54 144.733 2246.01 139.525 Q2244.51 134.317 2241.43 128.993 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip180)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,199.525 2119.2,199.525 "/>
<path clip-path="url(#clip180)" d="M2144.37 206.573 L2144.37 190.879 L2148.63 190.879 L2148.63 206.411 Q2148.63 210.092 2150.07 211.944 Q2151.5 213.772 2154.37 213.772 Q2157.82 213.772 2159.81 211.573 Q2161.82 209.374 2161.82 205.578 L2161.82 190.879 L2166.08 190.879 L2166.08 216.805 L2161.82 216.805 L2161.82 212.823 Q2160.27 215.184 2158.21 216.342 Q2156.18 217.476 2153.47 217.476 Q2149 217.476 2146.69 214.698 Q2144.37 211.92 2144.37 206.573 M2155.09 190.254 L2155.09 190.254 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2179.49 212.869 L2195.81 212.869 L2195.81 216.805 L2173.86 216.805 L2173.86 212.869 Q2176.52 210.115 2181.11 205.485 Q2185.71 200.832 2186.89 199.49 Q2189.14 196.967 2190.02 195.231 Q2190.92 193.471 2190.92 191.782 Q2190.92 189.027 2188.98 187.291 Q2187.06 185.555 2183.95 185.555 Q2181.75 185.555 2179.3 186.319 Q2176.87 187.083 2174.09 188.633 L2174.09 183.911 Q2176.92 182.777 2179.37 182.198 Q2181.82 181.62 2183.86 181.62 Q2189.23 181.62 2192.43 184.305 Q2195.62 186.99 2195.62 191.481 Q2195.62 193.61 2194.81 195.532 Q2194.02 197.43 2191.92 200.022 Q2191.34 200.694 2188.24 203.911 Q2185.13 207.106 2179.49 212.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2215.25 180.833 Q2212.15 186.157 2210.64 191.365 Q2209.14 196.573 2209.14 201.92 Q2209.14 207.268 2210.64 212.522 Q2212.17 217.754 2215.25 223.055 L2211.55 223.055 Q2208.07 217.615 2206.34 212.36 Q2204.62 207.106 2204.62 201.92 Q2204.62 196.758 2206.34 191.527 Q2208.05 186.296 2211.55 180.833 L2215.25 180.833 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2227.73 183.518 L2227.73 190.879 L2236.5 190.879 L2236.5 194.189 L2227.73 194.189 L2227.73 208.263 Q2227.73 211.434 2228.58 212.337 Q2229.46 213.24 2232.12 213.24 L2236.5 213.24 L2236.5 216.805 L2232.12 216.805 Q2227.19 216.805 2225.32 214.976 Q2223.44 213.124 2223.44 208.263 L2223.44 194.189 L2220.32 194.189 L2220.32 190.879 L2223.44 190.879 L2223.44 183.518 L2227.73 183.518 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip180)" d="M2241.43 180.833 L2245.13 180.833 Q2248.61 186.296 2250.32 191.527 Q2252.06 196.758 2252.06 201.92 Q2252.06 207.106 2250.32 212.36 Q2248.61 217.615 2245.13 223.055 L2241.43 223.055 Q2244.51 217.754 2246.01 212.522 Q2247.54 207.268 2247.54 201.92 Q2247.54 196.573 2246.01 191.365 Q2244.51 186.157 2241.43 180.833 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>With this, we can simulate an ensemble of solutions from different initial conditions (and we will turn back on the noise).  The <code>EnsembleSummary</code> calculates a set of quantiles by default.</p><pre><code class="language-julia hljs">T = 10
trajectories = 50
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C)
sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(sol)  #calculate summarize statistics from the
plot(summ)  # shows quantiles by default</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip240">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip240)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip241">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip240)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip242">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="685.496,1521.01 685.496,47.2441 "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1521.01 1219.87,47.2441 "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1754.25,1521.01 1754.25,47.2441 "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="685.496,1521.01 685.496,1502.11 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1521.01 1219.87,1502.11 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.25,1521.01 1754.25,1502.11 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip240)" d="M128.502 1551.93 Q124.891 1551.93 123.062 1555.49 Q121.257 1559.03 121.257 1566.16 Q121.257 1573.27 123.062 1576.83 Q124.891 1580.38 128.502 1580.38 Q132.136 1580.38 133.942 1576.83 Q135.77 1573.27 135.77 1566.16 Q135.77 1559.03 133.942 1555.49 Q132.136 1551.93 128.502 1551.93 M128.502 1548.22 Q134.312 1548.22 137.368 1552.83 Q140.446 1557.41 140.446 1566.16 Q140.446 1574.89 137.368 1579.5 Q134.312 1584.08 128.502 1584.08 Q122.692 1584.08 119.613 1579.5 Q116.558 1574.89 116.558 1566.16 Q116.558 1557.41 119.613 1552.83 Q122.692 1548.22 128.502 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M148.664 1577.53 L153.548 1577.53 L153.548 1583.41 L148.664 1583.41 L148.664 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M173.733 1551.93 Q170.122 1551.93 168.293 1555.49 Q166.488 1559.03 166.488 1566.16 Q166.488 1573.27 168.293 1576.83 Q170.122 1580.38 173.733 1580.38 Q177.367 1580.38 179.173 1576.83 Q181.002 1573.27 181.002 1566.16 Q181.002 1559.03 179.173 1555.49 Q177.367 1551.93 173.733 1551.93 M173.733 1548.22 Q179.543 1548.22 182.599 1552.83 Q185.678 1557.41 185.678 1566.16 Q185.678 1574.89 182.599 1579.5 Q179.543 1584.08 173.733 1584.08 Q167.923 1584.08 164.844 1579.5 Q161.789 1574.89 161.789 1566.16 Q161.789 1557.41 164.844 1552.83 Q167.923 1548.22 173.733 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M657.232 1579.47 L673.551 1579.47 L673.551 1583.41 L651.607 1583.41 L651.607 1579.47 Q654.269 1576.72 658.852 1572.09 Q663.459 1567.44 664.639 1566.09 Q666.885 1563.57 667.764 1561.83 Q668.667 1560.07 668.667 1558.38 Q668.667 1555.63 666.723 1553.89 Q664.801 1552.16 661.7 1552.16 Q659.501 1552.16 657.047 1552.92 Q654.616 1553.69 651.839 1555.24 L651.839 1550.51 Q654.663 1549.38 657.116 1548.8 Q659.57 1548.22 661.607 1548.22 Q666.977 1548.22 670.172 1550.91 Q673.366 1553.59 673.366 1558.08 Q673.366 1560.21 672.556 1562.13 Q671.769 1564.03 669.663 1566.63 Q669.084 1567.3 665.982 1570.51 Q662.88 1573.71 657.232 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M683.366 1577.53 L688.25 1577.53 L688.25 1583.41 L683.366 1583.41 L683.366 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M698.482 1548.85 L716.838 1548.85 L716.838 1552.78 L702.764 1552.78 L702.764 1561.26 Q703.783 1560.91 704.801 1560.75 Q705.82 1560.56 706.838 1560.56 Q712.625 1560.56 716.005 1563.73 Q719.384 1566.9 719.384 1572.32 Q719.384 1577.9 715.912 1581 Q712.44 1584.08 706.121 1584.08 Q703.945 1584.08 701.676 1583.71 Q699.431 1583.34 697.023 1582.6 L697.023 1577.9 Q699.107 1579.03 701.329 1579.59 Q703.551 1580.14 706.028 1580.14 Q710.033 1580.14 712.371 1578.04 Q714.709 1575.93 714.709 1572.32 Q714.709 1568.71 712.371 1566.6 Q710.033 1564.5 706.028 1564.5 Q704.153 1564.5 702.278 1564.91 Q700.426 1565.33 698.482 1566.21 L698.482 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1187.04 1548.85 L1205.39 1548.85 L1205.39 1552.78 L1191.32 1552.78 L1191.32 1561.26 Q1192.34 1560.91 1193.36 1560.75 Q1194.38 1560.56 1195.39 1560.56 Q1201.18 1560.56 1204.56 1563.73 Q1207.94 1566.9 1207.94 1572.32 Q1207.94 1577.9 1204.47 1581 Q1201 1584.08 1194.68 1584.08 Q1192.5 1584.08 1190.23 1583.71 Q1187.99 1583.34 1185.58 1582.6 L1185.58 1577.9 Q1187.66 1579.03 1189.89 1579.59 Q1192.11 1580.14 1194.58 1580.14 Q1198.59 1580.14 1200.93 1578.04 Q1203.27 1575.93 1203.27 1572.32 Q1203.27 1568.71 1200.93 1566.6 Q1198.59 1564.5 1194.58 1564.5 Q1192.71 1564.5 1190.83 1564.91 Q1188.98 1565.33 1187.04 1566.21 L1187.04 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1217.15 1577.53 L1222.04 1577.53 L1222.04 1583.41 L1217.15 1583.41 L1217.15 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1242.22 1551.93 Q1238.61 1551.93 1236.78 1555.49 Q1234.98 1559.03 1234.98 1566.16 Q1234.98 1573.27 1236.78 1576.83 Q1238.61 1580.38 1242.22 1580.38 Q1245.86 1580.38 1247.66 1576.83 Q1249.49 1573.27 1249.49 1566.16 Q1249.49 1559.03 1247.66 1555.49 Q1245.86 1551.93 1242.22 1551.93 M1242.22 1548.22 Q1248.03 1548.22 1251.09 1552.83 Q1254.17 1557.41 1254.17 1566.16 Q1254.17 1574.89 1251.09 1579.5 Q1248.03 1584.08 1242.22 1584.08 Q1236.41 1584.08 1233.33 1579.5 Q1230.28 1574.89 1230.28 1566.16 Q1230.28 1557.41 1233.33 1552.83 Q1236.41 1548.22 1242.22 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1720.57 1548.85 L1742.79 1548.85 L1742.79 1550.84 L1730.25 1583.41 L1725.36 1583.41 L1737.17 1552.78 L1720.57 1552.78 L1720.57 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1751.91 1577.53 L1756.8 1577.53 L1756.8 1583.41 L1751.91 1583.41 L1751.91 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1767.03 1548.85 L1785.39 1548.85 L1785.39 1552.78 L1771.31 1552.78 L1771.31 1561.26 Q1772.33 1560.91 1773.35 1560.75 Q1774.37 1560.56 1775.39 1560.56 Q1781.17 1560.56 1784.55 1563.73 Q1787.93 1566.9 1787.93 1572.32 Q1787.93 1577.9 1784.46 1581 Q1780.99 1584.08 1774.67 1584.08 Q1772.49 1584.08 1770.22 1583.71 Q1767.98 1583.34 1765.57 1582.6 L1765.57 1577.9 Q1767.65 1579.03 1769.88 1579.59 Q1772.1 1580.14 1774.58 1580.14 Q1778.58 1580.14 1780.92 1578.04 Q1783.26 1575.93 1783.26 1572.32 Q1783.26 1568.71 1780.92 1566.6 Q1778.58 1564.5 1774.58 1564.5 Q1772.7 1564.5 1770.83 1564.91 Q1768.97 1565.33 1767.03 1566.21 L1767.03 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M2240.7 1579.47 L2248.34 1579.47 L2248.34 1553.11 L2240.03 1554.77 L2240.03 1550.51 L2248.3 1548.85 L2252.97 1548.85 L2252.97 1579.47 L2260.61 1579.47 L2260.61 1583.41 L2240.7 1583.41 L2240.7 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M2280.05 1551.93 Q2276.44 1551.93 2274.61 1555.49 Q2272.81 1559.03 2272.81 1566.16 Q2272.81 1573.27 2274.61 1576.83 Q2276.44 1580.38 2280.05 1580.38 Q2283.69 1580.38 2285.49 1576.83 Q2287.32 1573.27 2287.32 1566.16 Q2287.32 1559.03 2285.49 1555.49 Q2283.69 1551.93 2280.05 1551.93 M2280.05 1548.22 Q2285.86 1548.22 2288.92 1552.83 Q2292 1557.41 2292 1566.16 Q2292 1574.89 2288.92 1579.5 Q2285.86 1584.08 2280.05 1584.08 Q2274.24 1584.08 2271.17 1579.5 Q2268.11 1574.89 2268.11 1566.16 Q2268.11 1557.41 2271.17 1552.83 Q2274.24 1548.22 2280.05 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M2300.22 1577.53 L2305.1 1577.53 L2305.1 1583.41 L2300.22 1583.41 L2300.22 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M2325.29 1551.93 Q2321.67 1551.93 2319.85 1555.49 Q2318.04 1559.03 2318.04 1566.16 Q2318.04 1573.27 2319.85 1576.83 Q2321.67 1580.38 2325.29 1580.38 Q2328.92 1580.38 2330.73 1576.83 Q2332.55 1573.27 2332.55 1566.16 Q2332.55 1559.03 2330.73 1555.49 Q2328.92 1551.93 2325.29 1551.93 M2325.29 1548.22 Q2331.1 1548.22 2334.15 1552.83 Q2337.23 1557.41 2337.23 1566.16 Q2337.23 1574.89 2334.15 1579.5 Q2331.1 1584.08 2325.29 1584.08 Q2319.48 1584.08 2316.4 1579.5 Q2313.34 1574.89 2313.34 1566.16 Q2313.34 1557.41 2316.4 1552.83 Q2319.48 1548.22 2325.29 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1292.37 2352.76,1292.37 "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,957.217 2352.76,957.217 "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,622.067 2352.76,622.067 "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,286.916 2352.76,286.916 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1292.37 105.89,1292.37 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,957.217 105.89,957.217 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,622.067 105.89,622.067 "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,286.916 105.89,286.916 "/>
<path clip-path="url(#clip240)" d="M-40.8824 1292.82 L-11.2066 1292.82 L-11.2066 1296.75 L-40.8824 1296.75 L-40.8824 1292.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-0.303895 1305.71 L7.33495 1305.71 L7.33495 1279.35 L-0.975188 1281.01 L-0.975188 1276.75 L7.28866 1275.09 L11.9646 1275.09 L11.9646 1305.71 L19.6034 1305.71 L19.6034 1309.65 L-0.303895 1309.65 L-0.303895 1305.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M39.0477 1278.17 Q35.4367 1278.17 33.608 1281.73 Q31.8024 1285.27 31.8024 1292.4 Q31.8024 1299.51 33.608 1303.07 Q35.4367 1306.61 39.0477 1306.61 Q42.682 1306.61 44.4875 1303.07 Q46.3162 1299.51 46.3162 1292.4 Q46.3162 1285.27 44.4875 1281.73 Q42.682 1278.17 39.0477 1278.17 M39.0477 1274.46 Q44.8579 1274.46 47.9134 1279.07 Q50.9921 1283.65 50.9921 1292.4 Q50.9921 1301.13 47.9134 1305.74 Q44.8579 1310.32 39.0477 1310.32 Q33.2376 1310.32 30.1589 1305.74 Q27.1034 1301.13 27.1034 1292.4 Q27.1034 1283.65 30.1589 1279.07 Q33.2376 1274.46 39.0477 1274.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-9.72514 957.668 L19.9506 957.668 L19.9506 961.604 L-9.72514 961.604 L-9.72514 957.668 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M30.0895 939.937 L48.4458 939.937 L48.4458 943.872 L34.3718 943.872 L34.3718 952.344 Q35.3904 951.997 36.4089 951.835 Q37.4274 951.65 38.4459 951.65 Q44.2329 951.65 47.6125 954.821 Q50.9921 957.992 50.9921 963.409 Q50.9921 968.988 47.5199 972.09 Q44.0477 975.168 37.7283 975.168 Q35.5524 975.168 33.2839 974.798 Q31.0385 974.428 28.6311 973.687 L28.6311 968.988 Q30.7145 970.122 32.9367 970.678 Q35.1589 971.233 37.6357 971.233 Q41.6403 971.233 43.9783 969.127 Q46.3162 967.02 46.3162 963.409 Q46.3162 959.798 43.9783 957.691 Q41.6403 955.585 37.6357 955.585 Q35.7607 955.585 33.8857 956.002 Q32.0339 956.418 30.0895 957.298 L30.0895 939.937 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M39.0477 607.865 Q35.4367 607.865 33.608 611.43 Q31.8024 614.972 31.8024 622.101 Q31.8024 629.208 33.608 632.773 Q35.4367 636.314 39.0477 636.314 Q42.682 636.314 44.4875 632.773 Q46.3162 629.208 46.3162 622.101 Q46.3162 614.972 44.4875 611.43 Q42.682 607.865 39.0477 607.865 M39.0477 604.162 Q44.8579 604.162 47.9134 608.768 Q50.9921 613.351 50.9921 622.101 Q50.9921 630.828 47.9134 635.435 Q44.8579 640.018 39.0477 640.018 Q33.2376 640.018 30.1589 635.435 Q27.1034 630.828 27.1034 622.101 Q27.1034 613.351 30.1589 608.768 Q33.2376 604.162 39.0477 604.162 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip240)" d="M30.0895 269.636 L48.4458 269.636 L48.4458 273.572 L34.3718 273.572 L34.3718 282.044 Q35.3904 281.697 36.4089 281.535 Q37.4274 281.349 38.4459 281.349 Q44.2329 281.349 47.6125 284.521 Q50.9921 287.692 50.9921 293.109 Q50.9921 298.687 47.5199 301.789 Q44.0477 304.868 37.7283 304.868 Q35.5524 304.868 33.2839 304.497 Q31.0385 304.127 28.6311 303.386 L28.6311 298.687 Q30.7145 299.821 32.9367 300.377 Q35.1589 300.933 37.6357 300.933 Q41.6403 300.933 43.9783 298.826 Q46.3162 296.72 46.3162 293.109 Q46.3162 289.497 43.9783 287.391 Q41.6403 285.285 37.6357 285.285 Q35.7607 285.285 33.8857 285.701 Q32.0339 286.118 30.0895 286.997 L30.0895 269.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip242)" d="M151.118 731.092 L364.869 1377.61 L578.62 1479.3 L792.371 1465.01 L1006.12 1425.27 L1219.87 1391.33 L1433.63 1350.82 L1647.38 1312.52 L1861.13 1272.5 L2074.88 1240.07 L2288.63 1204.13 L2288.63 245.385 L2074.88 222.546 L1861.13 204.67 L1647.38 187.445 L1433.63 171.711 L1219.87 150.89 L1006.12 122.001 L792.371 100.868 L578.62 88.9544 L364.869 144.882 L151.118 514.957  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip242)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,629.303 364.869,665.64 578.62,671.773 792.371,670.849 1006.12,673.654 1219.87,668.3 1433.63,660.987 1647.38,658.121 1861.13,653.158 2074.88,650.488 2288.63,646.053 "/>
<path clip-path="url(#clip242)" d="M151.118 736.913 L364.869 644.561 L578.62 626.414 L792.371 623.282 L1006.12 623.28 L1219.87 623.264 L1433.63 623.29 L1647.38 623.275 L1861.13 623.127 L2074.88 622.922 L2288.63 623.189 L2288.63 620.348 L2074.88 620.975 L1861.13 621.03 L1647.38 620.897 L1433.63 620.796 L1219.87 620.687 L1006.12 621.007 L792.371 620.837 L578.62 618.474 L364.869 606.907 L151.118 547.005  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip242)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,629.017 364.869,623.106 578.62,622.509 792.371,622.385 1006.12,622.123 1219.87,622.004 1433.63,622.036 1647.38,621.87 1861.13,621.929 2074.88,622.043 2288.63,622.006 "/>
</svg>
<h2 id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><a class="docs-heading-anchor" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter">Observables and Marginal Likelihood using a Kalman Filter</a><a id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter" title="Permalink"></a></h2><p>If you provide <code>observables</code> and provide a distribution for the <code>observables_noise</code> then the model can provide a calculation of the likelihood.  </p><p>The simplest case is if you use a gaussian prior and have gaussian observation noise.  First, lets simulate some data with included observation noise.  If passing in a matrix or vector, the <code>observables_noise</code> argument is intended to be the cholesky of the covariance matrix.  At this point, only diagonal observation noise is allowed.</p><pre><code class="language-julia hljs">u0 = MvNormal([1.0 0.1; 0.1 1.0])  # draw from mean zero initial conditions
T = 10
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)
sol.z # simulated observables with observation noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-0.24405063598891863, 1.3517563494067693]
 [-0.534742902591165, -3.2058782797526417]
 [-0.40663391048907394, -3.7600432526512626]
 [-0.6580511576129153, -3.7215786261125787]
 [-0.5673983168063168, -3.7258618526915277]
 [-0.23581151040973736, -3.850248292295328]
 [-0.056173901207991095, -3.2424733978354885]
 [-0.05853866133773178, -3.4849354549733507]
 [0.17032121548003964, -2.826854023834893]
 [-0.27036933228811016, -2.7044991351953818]
 [-0.12558453651002335, -2.5785634514811124]</code></pre><p>Next we will find the log likelihood of these simulated observables using the <code>u0</code> as a prior and with the true parameters.</p><p>The new arguments we pass to the problem creation are <code>u0_prior_variance, u0_prior_mean,</code> and <code>observables</code>.  The <code>u0</code> is ignored for the filtering problem but must match the size.  The <code>KalmanFilter()</code> argument to the <code>solve</code> is unnecessary since it can select it manually given the priors and observables.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The timing convention is such that <code>observables</code> are expected to match the predictions starting at the second time period.  As the likelihood of the first element <code>u0</code> comes from a prior, the <code>observables</code> start at the next element, and hence the observables and noise sequences should be 1 less than the tspan </p></div></div><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = copy(sol.W) # save for later
u0_prior_mean = [0.0, 0.0]
# use covariance of distribution we drew from
u0_prior_var = cov(u0)

prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
sol = solve(prob, KalmanFilter())
# plot(sol) The `u` is the sequence of posterior means.
sol.logpdf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-4.345061199251215</code></pre><p>Hence the <code>logpdf</code> provides the log likelihood marginalizing out the latent noise variables.</p><p>As before, we can differentiate the kalman filter itself.</p><pre><code class="language-julia hljs">function kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
# Find the gradient wrt the A, B, C and priors variance.
gradient((A, B, C, u0_prior_var) -&gt; kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables), A, B, C, u0_prior_var)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-2.1706598137681263 -0.1903719349960662; -67.85875334915173 5.425885508937641], [-3.5557233659703646; -37.168597018326494;;], [-6.050978286632244 0.23298152224878477; -0.8499455666568565 -0.12858858123136052], [-0.09734516126090949 3.2118836840031153; -3.407256613567252 -0.3164925569646435])</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some of the gradients, such as those for <code>observables</code>, have not been implemented so test carefully.  This is a general theme with gradients and <code>Zygote.jl</code> in general.  Your best friend in this process is the spectacular <a href="https://github.com/JuliaDiff/ChainRulesTestUtils.jl">ChainRulesTestUtils.jl</a> package. See <code>test_rrule</code> usage in the <a href="https://github.com/SciML/DifferenceEquations.jl/blob/main/test/linear_gradients.jl">linear unit tests</a>.</p></div></div><h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>A key application of these methods is to find the joint likelihood of the latent variables (i.e., the <code>noise</code>) and the model definition.</p><p>The actual calculation of the likelihood is trivial in that case, and just requires iteration of the linear system while accumulating the likelihood given the observation noise.</p><p>Crucially, the differentiability with respect to the high-dimensional noise vector enables gradient-based sampling and estimation methods which would otherwise be infeasible.</p><pre><code class="language-julia hljs">function joint_likelihood(A, B, C, D, u0, noise, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood(A, B, C, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-588.0407360200578</code></pre><p>And as always, this can be differentiated with respect to the state-space matrices and the noise.  Choosing a few parameters,</p><pre><code class="language-julia hljs">gradient((A, u0, noise) -&gt; joint_likelihood(A, B, C, D, u0, noise, observables), A, u0, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-86.28120867444588 -4.606608856955441; -445.30247348407556 -32.580121557223855], [-263.5968697952056, -2110.5766258625376], [-19.513010623112418 -17.461488991432404 … -1.6027673217323426 -0.007170576698664702])</code></pre><h2 id="Composition-of-State-Space-Models-and-AD"><a class="docs-heading-anchor" href="#Composition-of-State-Space-Models-and-AD">Composition of State Space Models and AD</a><a id="Composition-of-State-Space-Models-and-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-of-State-Space-Models-and-AD" title="Permalink"></a></h2><p>While the above gradients have been with respect to the full state space objects <code>A, B</code>, etc. those themselves could be generated through a separate procedure and the whole object differentiated.  For example, lets repeat the above examples where we generate the <code>A</code> matrix from some sort of deep parameters.</p><p>First we will generate some observations with a <code>generate_model</code> proxy–-which could be replaced with something more complicated but still differentiable</p><pre><code class="language-julia hljs">function generate_model(β)
    A = [β 6.2;
        0.0  0.2]
    B = Matrix([0.0  0.001]&#39;) # [0.0; 0.001;;] gives a zygote bug
    C = [0.09 0.67;
        1.00 0.00]
    D = [0.01, 0.01]
    return (;A,B,C,D)
end

function simulate_model(β, u0;T = 200)
    mod = generate_model(β)
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, T); mod.C, observables_noise = mod.D)
    sol = solve(prob) # simulates
    observables = hcat(sol.z...)
    observables = observables[:, 2:end] # see note above on likelihood and timing
    return observables, sol.W
end

# Fix a &quot;pseudo-true&quot; and generate noise and observables
β = 0.95
u0 = [0.0, 0.0]
observables, noise = simulate_model(β, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.09858682145666182 -0.0014057897531233989 … 0.007060323334742139 0.08325120917688897; 0.2251349762378967 -0.17488651767880703 … 0.047242834659758225 0.18380044293739878], [1.4340395645194541 1.514526469242434 … -0.15812976996966327 -1.7518317815498186])</code></pre><p>Next, we will evaluate the marginal likelihood using the kalman filter for a particular <code>β</code> value,</p><pre><code class="language-julia hljs">function kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
u0_prior_mean = [0.0, 0.0]
u0_prior_var = [1e-10 0.0;
                0.0 1e-10]  # starting with degenerate prior
kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">319.984399215164</code></pre><p>Given the observation error we would not expect the pseudo-true to exactly maximimize the log likelihood.  To show this, we can optimize it using using the Optim package and using a gradient-based optimization routine</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimJL
# Create a function to minimize only of β and use Zygote based gradients
kalman_objective(β,p) = -kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
kalman_objective(0.95, nothing)
gradient(β -&gt;kalman_objective(β, nothing),β) # Verifying it can be differentiated


optf = OptimizationFunction(kalman_objective, Optimization.AutoZygote())
β0 = [0.91] # start off of the pseudotrue
optprob = OptimizationProblem(optf, β0)
optsol = solve(optprob,LBFGS())  # reverse-mode AD is overkill here</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 1-element Vector{Float64}:
 0.9846008557651886</code></pre><p>In this way, this package composes with others such as <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">DifferentiableStateSpaceModels.jl</a> which take a set of structural parameters and an expectational difference equation and generate a state-space model.</p><p>Similarly, we can find the joint likelihood for a particular <code>β</code> value and noise.  Here we will add in prior.  Some form of a prior or regularization is generally necessary for these sorts of nonlinear models.</p><pre><code class="language-julia hljs">function joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, noise)
    return solve(prob).logpdf + sum(logpdf.(noise_prior, noise)) + logpdf(β_prior, β) # posterior
end
u0 = [0.0, 0.0]
noise_prior = Normal(0.0, 1.0)
β_prior = Normal(β, 0.03) # prior local to the true value
joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">33.752778465156325</code></pre><p>Which we can turn into a differntiable objective adding in a prior on the noise</p><pre><code class="language-julia hljs">joint_model_objective(x, p) = -joint_model_posterior(x[1], u0, Matrix(x[2:end]&#39;), observables, noise_prior, β_prior) # extract noise and parameeter from vector
x0 = vcat([0.95], noise[1,:])  # starting at the true noise
joint_model_objective(x0, nothing)
gradient(x -&gt;joint_model_objective(x, nothing),x0) # Verifying it can be differentiated

# optimize
optf = OptimizationFunction(joint_model_objective, Optimization.AutoZygote())
optprob = OptimizationProblem(optf, x0)
optsol = solve(optprob,LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 201-element Vector{Float64}:
  0.9934367295300436
 -0.09261880017229289
  0.01599808639316796
  0.05164856873786464
  0.13991712429875275
  0.23161311754945388
  0.2107324292919053
  0.20735608676508627
  0.18621495928742954
  0.14341400160347595
  ⋮
  0.07221411173850854
 -0.015044015196718555
  0.002431110478603286
 -0.041705296312008616
 -0.024304414677316134
  0.14696055851019987
  0.09140249484461013
  0.08459453097028045
  0.0052371770165599305</code></pre><p>This &quot;solves&quot; the problem relatively quickly, despite the high-dimensionality.  However, from a statistics perspective note that this last optimization process does not do especially well in recovering the pseudotrue if you increase the prior variance on the <code>β</code> parameter.  Maximizing the posterior is usually the wrong thing to do in high-dimensions because the mode is not a typical set.</p><h2 id="Caveats-on-Gradients-and-Performance"><a class="docs-heading-anchor" href="#Caveats-on-Gradients-and-Performance">Caveats on Gradients and Performance</a><a id="Caveats-on-Gradients-and-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Caveats-on-Gradients-and-Performance" title="Permalink"></a></h2><p>A few notes on performance and gradients:</p><ol><li>As this is using reverse-mode AD it will be efficient for fairly large systems as long as the ultimate value of your differentiable program.  With a little extra work and unit tests, it could support structured matrices/etc. as well.</li><li>Getting to much higher scales, where the <code>A,B,C,D</code> are so large that matrix-free operators is necessary, is feasible but will require generalizing those to LinearOperators.  This would be reasonably easy for the joint likelihood and feasible but possible for the Kalman filter</li><li>At this point, there is no support for forward-mode auto-differentiation.  For smaller systems with a kalman filter, this should dominate the alternatives, and efficient forward-mode AD rules for the kalman filter exist (see the supplementary materials in the the <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">Differentiable State Space Models</a> paper).  However, it would be a significant amount of work to add end-to-end support and fulfill standard SciML interfaces, and perhaps waiting for <a href="https://enzyme.mit.edu/julia/">Enzyme</a> or similar AD systems that provide both forward/reverse/mixed mode makes sense.</li><li>Forward-mode AD is likely inappropriate for the joint-likelihood based models since the dimensionality of the noise is always large.</li><li>The gradient rules are written using <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules.jl</a> so in theory they will work with any supporting AD.  In practice, though, Zygote is the most tested and other systems have inconsistent support on Julia at this time.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a><a class="docs-footer-nextpage" href="../quadratic_state_space_examples/">Quadratic State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 24 September 2023 17:09">Sunday 24 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
