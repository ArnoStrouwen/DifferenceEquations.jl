<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/linear_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Linear (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Simulating-Ensembles-and-Fixing-Noise"><span>Simulating Ensembles and Fixing Noise</span></a></li><li><a class="tocitem" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><span>Observables and Marginal Likelihood using a Kalman Filter</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li><li><a class="tocitem" href="#Composition-of-State-Space-Models-and-AD"><span>Composition of State Space Models and AD</span></a></li><li><a class="tocitem" href="#Caveats-on-Gradients-and-Performance"><span>Caveats on Gradients and Performance</span></a></li></ul></li><li><a class="tocitem" href="../quadratic_state_space_examples/">Quadratic State Space Examples</a></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/linear_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-State-Space-Examples"><a class="docs-heading-anchor" href="#Linear-State-Space-Examples">Linear State Space Examples</a><a id="Linear-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-State-Space-Examples" title="Permalink"></a></h1><p>This tutorial provides describes the support for linear and linear gaussian state space models.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form of the linear model is</p><p class="math-container">\[u_{n+1} = A u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.  More generally, support could be added for <span>$u_{n+1} = A(p,n) u_n + B(p,n) w_{n+1}$</span> where <span>$p$</span> is a vector of differentiable parameters, and the <span>$A$</span> and <span>$B$</span> are potentially matrix-free operators.</p><h2 id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model">Simulating a Linear (and Time-Invariant) State Space Model</a><a id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>LinearStateSpaceProblem</code> and simulating it for a simple, linear equation.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote
A = [0.95 6.2;
     0.0  0.2]
B = [0.0; 0.01;;] # matrix
C = [0.09 0.67;
     1.00 0.00]
D = [0.1, 0.1] # diagonal observation noise
u0 = zeros(2)
T = 10

prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:10
u: 11-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [0.0, 0.009082380787148387]
 [0.056310760880320006, 0.011386661349434798]
 [0.12409252320279975, -0.0026836578353042167]
 [0.10124921846377362, -0.004833399053107975]
 [0.06621968341131548, -0.0032231903514523784]
 [0.04292491906174496, -0.005221050579293366]
 [0.008408159517038837, 0.0017513478373771733]
 [0.01884610813292537, 0.006263519854996164]
 [0.05673762582725531, -0.008749246399410607]
 [-0.00034458314045322184, 0.016130221290205454]</code></pre><p>The <code>u</code> vector of the simulated solution can be plotted using standard recipes, including use of the optional <code>syms</code>.  See <a href="https://diffeq.sciml.ai/latest/basics/plot/">SciML docs</a> for more options.</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip700">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip700)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip701">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip700)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip702">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip700)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1373.4 2352.76,1373.4 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1166.32 2352.76,1166.32 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,959.23 2352.76,959.23 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,752.143 2352.76,752.143 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,545.057 2352.76,545.057 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,337.97 2352.76,337.97 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,130.884 2352.76,130.884 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1373.4 105.89,1373.4 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1166.32 105.89,1166.32 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,959.23 105.89,959.23 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,752.143 105.89,752.143 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,545.057 105.89,545.057 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,337.97 105.89,337.97 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,130.884 105.89,130.884 "/>
<path clip-path="url(#clip700)" d="M-36.3454 1359.2 Q-39.9565 1359.2 -41.7852 1362.77 Q-43.5907 1366.31 -43.5907 1373.44 Q-43.5907 1380.54 -41.7852 1384.11 Q-39.9565 1387.65 -36.3454 1387.65 Q-32.7111 1387.65 -30.9056 1384.11 Q-29.0769 1380.54 -29.0769 1373.44 Q-29.0769 1366.31 -30.9056 1362.77 Q-32.7111 1359.2 -36.3454 1359.2 M-36.3454 1355.5 Q-30.5352 1355.5 -27.4797 1360.1 Q-24.401 1364.69 -24.401 1373.44 Q-24.401 1382.16 -27.4797 1386.77 Q-30.5352 1391.35 -36.3454 1391.35 Q-42.1555 1391.35 -45.2342 1386.77 Q-48.2897 1382.16 -48.2897 1373.44 Q-48.2897 1364.69 -45.2342 1360.1 Q-42.1555 1355.5 -36.3454 1355.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.1834 1384.8 L-11.2992 1384.8 L-11.2992 1390.68 L-16.1834 1390.68 L-16.1834 1384.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M8.88587 1359.2 Q5.27478 1359.2 3.44608 1362.77 Q1.64054 1366.31 1.64054 1373.44 Q1.64054 1380.54 3.44608 1384.11 Q5.27478 1387.65 8.88587 1387.65 Q12.5201 1387.65 14.3257 1384.11 Q16.1543 1380.54 16.1543 1373.44 Q16.1543 1366.31 14.3257 1362.77 Q12.5201 1359.2 8.88587 1359.2 M8.88587 1355.5 Q14.696 1355.5 17.7516 1360.1 Q20.8303 1364.69 20.8303 1373.44 Q20.8303 1382.16 17.7516 1386.77 Q14.696 1391.35 8.88587 1391.35 Q3.07572 1391.35 -0.00297114 1386.77 Q-3.05851 1382.16 -3.05851 1373.44 Q-3.05851 1364.69 -0.00297114 1360.1 Q3.07572 1355.5 8.88587 1355.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M39.0477 1359.2 Q35.4367 1359.2 33.608 1362.77 Q31.8024 1366.31 31.8024 1373.44 Q31.8024 1380.54 33.608 1384.11 Q35.4367 1387.65 39.0477 1387.65 Q42.682 1387.65 44.4875 1384.11 Q46.3162 1380.54 46.3162 1373.44 Q46.3162 1366.31 44.4875 1362.77 Q42.682 1359.2 39.0477 1359.2 M39.0477 1355.5 Q44.8579 1355.5 47.9134 1360.1 Q50.9921 1364.69 50.9921 1373.44 Q50.9921 1382.16 47.9134 1386.77 Q44.8579 1391.35 39.0477 1391.35 Q33.2376 1391.35 30.1589 1386.77 Q27.1034 1382.16 27.1034 1373.44 Q27.1034 1364.69 30.1589 1360.1 Q33.2376 1355.5 39.0477 1355.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-34.7482 1152.11 Q-38.3592 1152.11 -40.1879 1155.68 Q-41.9935 1159.22 -41.9935 1166.35 Q-41.9935 1173.46 -40.1879 1177.02 Q-38.3592 1180.56 -34.7482 1180.56 Q-31.1139 1180.56 -29.3084 1177.02 Q-27.4797 1173.46 -27.4797 1166.35 Q-27.4797 1159.22 -29.3084 1155.68 Q-31.1139 1152.11 -34.7482 1152.11 M-34.7482 1148.41 Q-28.938 1148.41 -25.8825 1153.02 Q-22.8038 1157.6 -22.8038 1166.35 Q-22.8038 1175.08 -25.8825 1179.68 Q-28.938 1184.27 -34.7482 1184.27 Q-40.5583 1184.27 -43.637 1179.68 Q-46.6925 1175.08 -46.6925 1166.35 Q-46.6925 1157.6 -43.637 1153.02 Q-40.5583 1148.41 -34.7482 1148.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-14.5862 1177.72 L-9.70199 1177.72 L-9.70199 1183.6 L-14.5862 1183.6 L-14.5862 1177.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M10.4831 1152.11 Q6.87199 1152.11 5.0433 1155.68 Q3.23775 1159.22 3.23775 1166.35 Q3.23775 1173.46 5.0433 1177.02 Q6.87199 1180.56 10.4831 1180.56 Q14.1173 1180.56 15.9229 1177.02 Q17.7516 1173.46 17.7516 1166.35 Q17.7516 1159.22 15.9229 1155.68 Q14.1173 1152.11 10.4831 1152.11 M10.4831 1148.41 Q16.2932 1148.41 19.3488 1153.02 Q22.4275 1157.6 22.4275 1166.35 Q22.4275 1175.08 19.3488 1179.68 Q16.2932 1184.27 10.4831 1184.27 Q4.67293 1184.27 1.59424 1179.68 Q-1.4613 1175.08 -1.4613 1166.35 Q-1.4613 1157.6 1.59424 1153.02 Q4.67293 1148.41 10.4831 1148.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M34.6728 1179.66 L50.9921 1179.66 L50.9921 1183.6 L29.0478 1183.6 L29.0478 1179.66 Q31.7098 1176.91 36.2931 1172.28 Q40.8996 1167.62 42.0801 1166.28 Q44.3255 1163.76 45.2051 1162.02 Q46.1079 1160.26 46.1079 1158.57 Q46.1079 1155.82 44.1635 1154.08 Q42.2422 1152.35 39.1403 1152.35 Q36.9413 1152.35 34.4876 1153.11 Q32.057 1153.87 29.2793 1155.43 L29.2793 1150.7 Q32.1033 1149.57 34.557 1148.99 Q37.0107 1148.41 39.0477 1148.41 Q44.4181 1148.41 47.6125 1151.1 Q50.8069 1153.78 50.8069 1158.27 Q50.8069 1160.4 49.9968 1162.32 Q49.2097 1164.22 47.1033 1166.81 Q46.5246 1167.49 43.4227 1170.7 Q40.3209 1173.9 34.6728 1179.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-36.8315 945.029 Q-40.4426 945.029 -42.2713 948.593 Q-44.0768 952.135 -44.0768 959.265 Q-44.0768 966.371 -42.2713 969.936 Q-40.4426 973.477 -36.8315 973.477 Q-33.1972 973.477 -31.3917 969.936 Q-29.563 966.371 -29.563 959.265 Q-29.563 952.135 -31.3917 948.593 Q-33.1972 945.029 -36.8315 945.029 M-36.8315 941.325 Q-31.0213 941.325 -27.9658 945.931 Q-24.8871 950.515 -24.8871 959.265 Q-24.8871 967.991 -27.9658 972.598 Q-31.0213 977.181 -36.8315 977.181 Q-42.6416 977.181 -45.7203 972.598 Q-48.7759 967.991 -48.7759 959.265 Q-48.7759 950.515 -45.7203 945.931 Q-42.6416 941.325 -36.8315 941.325 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.6695 970.63 L-11.7853 970.63 L-11.7853 976.51 L-16.6695 976.51 L-16.6695 970.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M8.39976 945.029 Q4.78867 945.029 2.95998 948.593 Q1.15443 952.135 1.15443 959.265 Q1.15443 966.371 2.95998 969.936 Q4.78867 973.477 8.39976 973.477 Q12.034 973.477 13.8395 969.936 Q15.6682 966.371 15.6682 959.265 Q15.6682 952.135 13.8395 948.593 Q12.034 945.029 8.39976 945.029 M8.39976 941.325 Q14.2099 941.325 17.2655 945.931 Q20.3441 950.515 20.3441 959.265 Q20.3441 967.991 17.2655 972.598 Q14.2099 977.181 8.39976 977.181 Q2.58961 977.181 -0.48908 972.598 Q-3.54462 967.991 -3.54462 959.265 Q-3.54462 950.515 -0.48908 945.931 Q2.58961 941.325 8.39976 941.325 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M41.4088 946.024 L29.6034 964.473 L41.4088 964.473 L41.4088 946.024 M40.182 941.95 L46.0616 941.95 L46.0616 964.473 L50.9921 964.473 L50.9921 968.362 L46.0616 968.362 L46.0616 976.51 L41.4088 976.51 L41.4088 968.362 L25.8071 968.362 L25.8071 963.848 L40.182 941.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-36.5074 737.942 Q-40.1185 737.942 -41.9472 741.507 Q-43.7527 745.048 -43.7527 752.178 Q-43.7527 759.285 -41.9472 762.849 Q-40.1185 766.391 -36.5074 766.391 Q-32.8732 766.391 -31.0676 762.849 Q-29.2389 759.285 -29.2389 752.178 Q-29.2389 745.048 -31.0676 741.507 Q-32.8732 737.942 -36.5074 737.942 M-36.5074 734.238 Q-30.6973 734.238 -27.6417 738.845 Q-24.563 743.428 -24.563 752.178 Q-24.563 760.905 -27.6417 765.511 Q-30.6973 770.095 -36.5074 770.095 Q-42.3176 770.095 -45.3962 765.511 Q-48.4518 760.905 -48.4518 752.178 Q-48.4518 743.428 -45.3962 738.845 Q-42.3176 734.238 -36.5074 734.238 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.3455 763.544 L-11.4612 763.544 L-11.4612 769.423 L-16.3455 769.423 L-16.3455 763.544 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M8.72383 737.942 Q5.11274 737.942 3.28405 741.507 Q1.4785 745.048 1.4785 752.178 Q1.4785 759.285 3.28405 762.849 Q5.11274 766.391 8.72383 766.391 Q12.3581 766.391 14.1636 762.849 Q15.9923 759.285 15.9923 752.178 Q15.9923 745.048 14.1636 741.507 Q12.3581 737.942 8.72383 737.942 M8.72383 734.238 Q14.534 734.238 17.5895 738.845 Q20.6682 743.428 20.6682 752.178 Q20.6682 760.905 17.5895 765.511 Q14.534 770.095 8.72383 770.095 Q2.91368 770.095 -0.165007 765.511 Q-3.22055 760.905 -3.22055 752.178 Q-3.22055 743.428 -0.165007 738.845 Q2.91368 734.238 8.72383 734.238 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M39.4644 750.28 Q36.3163 750.28 34.4644 752.433 Q32.6357 754.585 32.6357 758.335 Q32.6357 762.062 34.4644 764.238 Q36.3163 766.391 39.4644 766.391 Q42.6125 766.391 44.4412 764.238 Q46.2931 762.062 46.2931 758.335 Q46.2931 754.585 44.4412 752.433 Q42.6125 750.28 39.4644 750.28 M48.7468 735.627 L48.7468 739.886 Q46.9875 739.053 45.182 738.613 Q43.3996 738.174 41.6403 738.174 Q37.0107 738.174 34.557 741.299 Q32.1265 744.423 31.7793 750.743 Q33.145 748.729 35.2052 747.664 Q37.2653 746.576 39.7422 746.576 Q44.9505 746.576 47.9597 749.748 Q50.9921 752.896 50.9921 758.335 Q50.9921 763.66 47.844 766.877 Q44.6959 770.095 39.4644 770.095 Q33.4691 770.095 30.2978 765.511 Q27.1265 760.905 27.1265 752.178 Q27.1265 743.984 31.0154 739.123 Q34.9042 734.238 41.4551 734.238 Q43.2144 734.238 44.9968 734.586 Q46.8023 734.933 48.7468 735.627 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-36.2528 530.856 Q-39.8639 530.856 -41.6926 534.42 Q-43.4981 537.962 -43.4981 545.092 Q-43.4981 552.198 -41.6926 555.763 Q-39.8639 559.305 -36.2528 559.305 Q-32.6185 559.305 -30.813 555.763 Q-28.9843 552.198 -28.9843 545.092 Q-28.9843 537.962 -30.813 534.42 Q-32.6185 530.856 -36.2528 530.856 M-36.2528 527.152 Q-30.4426 527.152 -27.3871 531.758 Q-24.3084 536.342 -24.3084 545.092 Q-24.3084 553.818 -27.3871 558.425 Q-30.4426 563.008 -36.2528 563.008 Q-42.0629 563.008 -45.1416 558.425 Q-48.1972 553.818 -48.1972 545.092 Q-48.1972 536.342 -45.1416 531.758 Q-42.0629 527.152 -36.2528 527.152 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.0908 556.457 L-11.2066 556.457 L-11.2066 562.337 L-16.0908 562.337 L-16.0908 556.457 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M8.97846 530.856 Q5.36737 530.856 3.53868 534.42 Q1.73313 537.962 1.73313 545.092 Q1.73313 552.198 3.53868 555.763 Q5.36737 559.305 8.97846 559.305 Q12.6127 559.305 14.4182 555.763 Q16.2469 552.198 16.2469 545.092 Q16.2469 537.962 14.4182 534.42 Q12.6127 530.856 8.97846 530.856 M8.97846 527.152 Q14.7886 527.152 17.8442 531.758 Q20.9228 536.342 20.9228 545.092 Q20.9228 553.818 17.8442 558.425 Q14.7886 563.008 8.97846 563.008 Q3.16831 563.008 0.089621 558.425 Q-2.96592 553.818 -2.96592 545.092 Q-2.96592 536.342 0.089621 531.758 Q3.16831 527.152 8.97846 527.152 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M39.1403 545.925 Q35.807 545.925 33.8857 547.707 Q31.9876 549.49 31.9876 552.615 Q31.9876 555.74 33.8857 557.522 Q35.807 559.305 39.1403 559.305 Q42.4737 559.305 44.3949 557.522 Q46.3162 555.717 46.3162 552.615 Q46.3162 549.49 44.3949 547.707 Q42.4968 545.925 39.1403 545.925 M34.4644 543.934 Q31.4552 543.193 29.7654 541.133 Q28.0987 539.073 28.0987 536.11 Q28.0987 531.967 31.0385 529.559 Q34.0015 527.152 39.1403 527.152 Q44.3023 527.152 47.2421 529.559 Q50.1819 531.967 50.1819 536.11 Q50.1819 539.073 48.4921 541.133 Q46.8255 543.193 43.8394 543.934 Q47.219 544.721 49.094 547.013 Q50.9921 549.305 50.9921 552.615 Q50.9921 557.638 47.9134 560.323 Q44.8579 563.008 39.1403 563.008 Q33.4228 563.008 30.3441 560.323 Q27.2885 557.638 27.2885 552.615 Q27.2885 549.305 29.1867 547.013 Q31.0848 544.721 34.4644 543.934 M32.7515 536.55 Q32.7515 539.235 34.4181 540.74 Q36.1079 542.244 39.1403 542.244 Q42.1496 542.244 43.8394 540.74 Q45.5523 539.235 45.5523 536.55 Q45.5523 533.865 43.8394 532.36 Q42.1496 530.856 39.1403 530.856 Q36.1079 530.856 34.4181 532.36 Q32.7515 533.865 32.7515 536.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-36.3454 323.769 Q-39.9565 323.769 -41.7852 327.334 Q-43.5907 330.876 -43.5907 338.005 Q-43.5907 345.112 -41.7852 348.676 Q-39.9565 352.218 -36.3454 352.218 Q-32.7111 352.218 -30.9056 348.676 Q-29.0769 345.112 -29.0769 338.005 Q-29.0769 330.876 -30.9056 327.334 Q-32.7111 323.769 -36.3454 323.769 M-36.3454 320.065 Q-30.5352 320.065 -27.4797 324.672 Q-24.401 329.255 -24.401 338.005 Q-24.401 346.732 -27.4797 351.338 Q-30.5352 355.922 -36.3454 355.922 Q-42.1555 355.922 -45.2342 351.338 Q-48.2897 346.732 -48.2897 338.005 Q-48.2897 329.255 -45.2342 324.672 Q-42.1555 320.065 -36.3454 320.065 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.1834 349.371 L-11.2992 349.371 L-11.2992 355.25 L-16.1834 355.25 L-16.1834 349.371 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-0.303895 351.315 L7.33495 351.315 L7.33495 324.95 L-0.975188 326.616 L-0.975188 322.357 L7.28866 320.69 L11.9646 320.69 L11.9646 351.315 L19.6034 351.315 L19.6034 355.25 L-0.303895 355.25 L-0.303895 351.315 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M39.0477 323.769 Q35.4367 323.769 33.608 327.334 Q31.8024 330.876 31.8024 338.005 Q31.8024 345.112 33.608 348.676 Q35.4367 352.218 39.0477 352.218 Q42.682 352.218 44.4875 348.676 Q46.3162 345.112 46.3162 338.005 Q46.3162 330.876 44.4875 327.334 Q42.682 323.769 39.0477 323.769 M39.0477 320.065 Q44.8579 320.065 47.9134 324.672 Q50.9921 329.255 50.9921 338.005 Q50.9921 346.732 47.9134 351.338 Q44.8579 355.922 39.0477 355.922 Q33.2376 355.922 30.1589 351.338 Q27.1034 346.732 27.1034 338.005 Q27.1034 329.255 30.1589 324.672 Q33.2376 320.065 39.0477 320.065 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-34.7482 116.683 Q-38.3592 116.683 -40.1879 120.247 Q-41.9935 123.789 -41.9935 130.919 Q-41.9935 138.025 -40.1879 141.59 Q-38.3592 145.132 -34.7482 145.132 Q-31.1139 145.132 -29.3084 141.59 Q-27.4797 138.025 -27.4797 130.919 Q-27.4797 123.789 -29.3084 120.247 Q-31.1139 116.683 -34.7482 116.683 M-34.7482 112.979 Q-28.938 112.979 -25.8825 117.585 Q-22.8038 122.169 -22.8038 130.919 Q-22.8038 139.646 -25.8825 144.252 Q-28.938 148.835 -34.7482 148.835 Q-40.5583 148.835 -43.637 144.252 Q-46.6925 139.646 -46.6925 130.919 Q-46.6925 122.169 -43.637 117.585 Q-40.5583 112.979 -34.7482 112.979 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-14.5862 142.284 L-9.70199 142.284 L-9.70199 148.164 L-14.5862 148.164 L-14.5862 142.284 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M1.29332 144.229 L8.93217 144.229 L8.93217 117.863 L0.622026 119.53 L0.622026 115.271 L8.88587 113.604 L13.5618 113.604 L13.5618 144.229 L21.2006 144.229 L21.2006 148.164 L1.29332 148.164 L1.29332 144.229 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M34.6728 144.229 L50.9921 144.229 L50.9921 148.164 L29.0478 148.164 L29.0478 144.229 Q31.7098 141.474 36.2931 136.845 Q40.8996 132.192 42.0801 130.849 Q44.3255 128.326 45.2051 126.59 Q46.1079 124.831 46.1079 123.141 Q46.1079 120.386 44.1635 118.65 Q42.2422 116.914 39.1403 116.914 Q36.9413 116.914 34.4876 117.678 Q32.057 118.442 29.2793 119.993 L29.2793 115.271 Q32.1033 114.136 34.557 113.558 Q37.0107 112.979 39.0477 112.979 Q44.4181 112.979 47.6125 115.664 Q50.8069 118.349 50.8069 122.84 Q50.8069 124.97 49.9968 126.891 Q49.2097 128.789 47.1033 131.382 Q46.5246 132.053 43.4227 135.271 Q40.3209 138.465 34.6728 144.229 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip702)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1373.4 313.569,1373.4 540.145,790.343 766.721,88.5087 993.298,325.036 1219.87,687.743 1446.45,928.944 1673.03,1286.34 1899.6,1178.26 2126.18,785.923 2352.76,1376.97 "/>
<polyline clip-path="url(#clip702)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1373.4 313.569,1279.36 540.145,1255.5 766.721,1401.19 993.298,1423.45 1219.87,1406.78 1446.45,1427.46 1673.03,1355.27 1899.6,1308.55 2126.18,1464 2352.76,1206.39 "/>
<path clip-path="url(#clip700)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip700)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip700)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip700)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip700)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>By default the solution provides an interface to access the simulated <code>u</code>.  That is, <code>sol.u[...] = sol[...]</code>,</p><pre><code class="language-julia hljs">sol[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.0
 0.009082380787148387</code></pre><p>Or to get the first element of the last step</p><pre><code class="language-julia hljs">sol[end][1] #first element of last step</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-0.00034458314045322184</code></pre><p>Finally, to extract the full vector</p><pre><code class="language-julia hljs">@show sol[2,:];  # whole second vector</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
  0.009082380787148387
  0.011386661349434798
 -0.0026836578353042167
 -0.004833399053107975
 -0.0032231903514523784
 -0.005221050579293366
  0.0017513478373771733
  0.006263519854996164
 -0.008749246399410607
  0.016130221290205454</code></pre><p>The results for all of <code>sol.u</code> can be loaded in a dataframe, where the column names will be the (optionally) provided symbols.</p><pre><code class="language-julia hljs">df = DataFrame(sol)</code></pre><div><div style = "float: left;"><span>11×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">timestamp</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.00908238</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.0563108</td><td style = "text-align: right;">0.0113867</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.124093</td><td style = "text-align: right;">-0.00268366</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.101249</td><td style = "text-align: right;">-0.0048334</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.0662197</td><td style = "text-align: right;">-0.00322319</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">6</td><td style = "text-align: right;">0.0429249</td><td style = "text-align: right;">-0.00522105</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">7</td><td style = "text-align: right;">0.00840816</td><td style = "text-align: right;">0.00175135</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">8</td><td style = "text-align: right;">0.0188461</td><td style = "text-align: right;">0.00626352</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">9</td><td style = "text-align: right;">0.0567376</td><td style = "text-align: right;">-0.00874925</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">10</td><td style = "text-align: right;">-0.000344583</td><td style = "text-align: right;">0.0161302</td></tr></tbody></table></div><p>Other results, such as the simulated noise and observables can be extracted from the solution</p><pre><code class="language-julia hljs">sol.z # observables</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [0.13995692869895976, 0.08551987722055959]
 [0.23301339380674443, 0.31420886394921244]
 [0.7195888697635492, -0.3252714429630233]
 [-0.03326422332185158, -0.011371115135128548]
 [-0.4588748839889362, -0.5453863167015193]
 [-0.12069122565119707, -0.048491743948022276]
 [0.5449498721957129, 0.10249877859098988]
 [0.021105398641246786, -0.0398244904915499]
 [-0.14645548584347884, 0.18807472599304784]
 [-0.616415163108397, -0.06672736257090783]
 [-0.2621042781181151, -0.005561960613100867]</code></pre><pre><code class="language-julia hljs">sol.W # Simulated Noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10 Matrix{Float64}:
 0.908238  0.957019  -0.496099  -0.429667  …  0.591325  -1.0002  1.78801</code></pre><p>We can also solve the model passing in fixed noise, which will be useful for joint likelihoods.  First lets extract the noise from the previous solution, then rerun the simulation but with a different initial value</p><pre><code class="language-julia hljs">noise = sol.W
u0_2 = [0.1, 0.0]
prob2 = LinearStateSpaceProblem(A, B, u0_2, (0, T); C, observables_noise = D, syms = [:a, :b], noise)
sol2 = solve(prob2)
plot(sol2)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip760">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip760)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip761">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip760)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip762">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip760)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1408.94 2352.76,1408.94 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1094.3 2352.76,1094.3 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,779.653 2352.76,779.653 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,465.01 2352.76,465.01 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,150.368 2352.76,150.368 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1408.94 105.89,1408.94 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1094.3 105.89,1094.3 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,779.653 105.89,779.653 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,465.01 105.89,465.01 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,150.368 105.89,150.368 "/>
<path clip-path="url(#clip760)" d="M-36.3454 1394.74 Q-39.9565 1394.74 -41.7852 1398.3 Q-43.5907 1401.84 -43.5907 1408.97 Q-43.5907 1416.08 -41.7852 1419.64 Q-39.9565 1423.19 -36.3454 1423.19 Q-32.7111 1423.19 -30.9056 1419.64 Q-29.0769 1416.08 -29.0769 1408.97 Q-29.0769 1401.84 -30.9056 1398.3 Q-32.7111 1394.74 -36.3454 1394.74 M-36.3454 1391.03 Q-30.5352 1391.03 -27.4797 1395.64 Q-24.401 1400.22 -24.401 1408.97 Q-24.401 1417.7 -27.4797 1422.31 Q-30.5352 1426.89 -36.3454 1426.89 Q-42.1555 1426.89 -45.2342 1422.31 Q-48.2897 1417.7 -48.2897 1408.97 Q-48.2897 1400.22 -45.2342 1395.64 Q-42.1555 1391.03 -36.3454 1391.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-16.1834 1420.34 L-11.2992 1420.34 L-11.2992 1426.22 L-16.1834 1426.22 L-16.1834 1420.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M8.88587 1394.74 Q5.27478 1394.74 3.44608 1398.3 Q1.64054 1401.84 1.64054 1408.97 Q1.64054 1416.08 3.44608 1419.64 Q5.27478 1423.19 8.88587 1423.19 Q12.5201 1423.19 14.3257 1419.64 Q16.1543 1416.08 16.1543 1408.97 Q16.1543 1401.84 14.3257 1398.3 Q12.5201 1394.74 8.88587 1394.74 M8.88587 1391.03 Q14.696 1391.03 17.7516 1395.64 Q20.8303 1400.22 20.8303 1408.97 Q20.8303 1417.7 17.7516 1422.31 Q14.696 1426.89 8.88587 1426.89 Q3.07572 1426.89 -0.00297114 1422.31 Q-3.05851 1417.7 -3.05851 1408.97 Q-3.05851 1400.22 -0.00297114 1395.64 Q3.07572 1391.03 8.88587 1391.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M39.0477 1394.74 Q35.4367 1394.74 33.608 1398.3 Q31.8024 1401.84 31.8024 1408.97 Q31.8024 1416.08 33.608 1419.64 Q35.4367 1423.19 39.0477 1423.19 Q42.682 1423.19 44.4875 1419.64 Q46.3162 1416.08 46.3162 1408.97 Q46.3162 1401.84 44.4875 1398.3 Q42.682 1394.74 39.0477 1394.74 M39.0477 1391.03 Q44.8579 1391.03 47.9134 1395.64 Q50.9921 1400.22 50.9921 1408.97 Q50.9921 1417.7 47.9134 1422.31 Q44.8579 1426.89 39.0477 1426.89 Q33.2376 1426.89 30.1589 1422.31 Q27.1034 1417.7 27.1034 1408.97 Q27.1034 1400.22 30.1589 1395.64 Q33.2376 1391.03 39.0477 1391.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-35.35 1080.09 Q-38.9611 1080.09 -40.7898 1083.66 Q-42.5953 1087.2 -42.5953 1094.33 Q-42.5953 1101.44 -40.7898 1105 Q-38.9611 1108.54 -35.35 1108.54 Q-31.7158 1108.54 -29.9102 1105 Q-28.0815 1101.44 -28.0815 1094.33 Q-28.0815 1087.2 -29.9102 1083.66 Q-31.7158 1080.09 -35.35 1080.09 M-35.35 1076.39 Q-29.5398 1076.39 -26.4843 1081 Q-23.4056 1085.58 -23.4056 1094.33 Q-23.4056 1103.06 -26.4843 1107.66 Q-29.5398 1112.25 -35.35 1112.25 Q-41.1602 1112.25 -44.2388 1107.66 Q-47.2944 1103.06 -47.2944 1094.33 Q-47.2944 1085.58 -44.2388 1081 Q-41.1602 1076.39 -35.35 1076.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-15.1881 1105.7 L-10.3038 1105.7 L-10.3038 1111.58 L-15.1881 1111.58 L-15.1881 1105.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M9.88124 1080.09 Q6.27014 1080.09 4.44145 1083.66 Q2.6359 1087.2 2.6359 1094.33 Q2.6359 1101.44 4.44145 1105 Q6.27014 1108.54 9.88124 1108.54 Q13.5155 1108.54 15.321 1105 Q17.1497 1101.44 17.1497 1094.33 Q17.1497 1087.2 15.321 1083.66 Q13.5155 1080.09 9.88124 1080.09 M9.88124 1076.39 Q15.6914 1076.39 18.7469 1081 Q21.8256 1085.58 21.8256 1094.33 Q21.8256 1103.06 18.7469 1107.66 Q15.6914 1112.25 9.88124 1112.25 Q4.07108 1112.25 0.992394 1107.66 Q-2.06315 1103.06 -2.06315 1094.33 Q-2.06315 1085.58 0.992394 1081 Q4.07108 1076.39 9.88124 1076.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M30.0895 1077.02 L48.4458 1077.02 L48.4458 1080.95 L34.3718 1080.95 L34.3718 1089.42 Q35.3904 1089.08 36.4089 1088.91 Q37.4274 1088.73 38.4459 1088.73 Q44.2329 1088.73 47.6125 1091.9 Q50.9921 1095.07 50.9921 1100.49 Q50.9921 1106.07 47.5199 1109.17 Q44.0477 1112.25 37.7283 1112.25 Q35.5524 1112.25 33.2839 1111.88 Q31.0385 1111.51 28.6311 1110.76 L28.6311 1106.07 Q30.7145 1107.2 32.9367 1107.76 Q35.1589 1108.31 37.6357 1108.31 Q41.6403 1108.31 43.9783 1106.2 Q46.3162 1104.1 46.3162 1100.49 Q46.3162 1096.88 43.9783 1094.77 Q41.6403 1092.66 37.6357 1092.66 Q35.7607 1092.66 33.8857 1093.08 Q32.0339 1093.5 30.0895 1094.38 L30.0895 1077.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-36.3454 765.451 Q-39.9565 765.451 -41.7852 769.016 Q-43.5907 772.558 -43.5907 779.687 Q-43.5907 786.794 -41.7852 790.359 Q-39.9565 793.9 -36.3454 793.9 Q-32.7111 793.9 -30.9056 790.359 Q-29.0769 786.794 -29.0769 779.687 Q-29.0769 772.558 -30.9056 769.016 Q-32.7111 765.451 -36.3454 765.451 M-36.3454 761.748 Q-30.5352 761.748 -27.4797 766.354 Q-24.401 770.937 -24.401 779.687 Q-24.401 788.414 -27.4797 793.021 Q-30.5352 797.604 -36.3454 797.604 Q-42.1555 797.604 -45.2342 793.021 Q-48.2897 788.414 -48.2897 779.687 Q-48.2897 770.937 -45.2342 766.354 Q-42.1555 761.748 -36.3454 761.748 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-16.1834 791.053 L-11.2992 791.053 L-11.2992 796.933 L-16.1834 796.933 L-16.1834 791.053 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-0.303895 792.997 L7.33495 792.997 L7.33495 766.632 L-0.975188 768.298 L-0.975188 764.039 L7.28866 762.373 L11.9646 762.373 L11.9646 792.997 L19.6034 792.997 L19.6034 796.933 L-0.303895 796.933 L-0.303895 792.997 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M39.0477 765.451 Q35.4367 765.451 33.608 769.016 Q31.8024 772.558 31.8024 779.687 Q31.8024 786.794 33.608 790.359 Q35.4367 793.9 39.0477 793.9 Q42.682 793.9 44.4875 790.359 Q46.3162 786.794 46.3162 779.687 Q46.3162 772.558 44.4875 769.016 Q42.682 765.451 39.0477 765.451 M39.0477 761.748 Q44.8579 761.748 47.9134 766.354 Q50.9921 770.937 50.9921 779.687 Q50.9921 788.414 47.9134 793.021 Q44.8579 797.604 39.0477 797.604 Q33.2376 797.604 30.1589 793.021 Q27.1034 788.414 27.1034 779.687 Q27.1034 770.937 30.1589 766.354 Q33.2376 761.748 39.0477 761.748 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-35.35 450.809 Q-38.9611 450.809 -40.7898 454.374 Q-42.5953 457.915 -42.5953 465.045 Q-42.5953 472.151 -40.7898 475.716 Q-38.9611 479.258 -35.35 479.258 Q-31.7158 479.258 -29.9102 475.716 Q-28.0815 472.151 -28.0815 465.045 Q-28.0815 457.915 -29.9102 454.374 Q-31.7158 450.809 -35.35 450.809 M-35.35 447.105 Q-29.5398 447.105 -26.4843 451.712 Q-23.4056 456.295 -23.4056 465.045 Q-23.4056 473.772 -26.4843 478.378 Q-29.5398 482.961 -35.35 482.961 Q-41.1602 482.961 -44.2388 478.378 Q-47.2944 473.772 -47.2944 465.045 Q-47.2944 456.295 -44.2388 451.712 Q-41.1602 447.105 -35.35 447.105 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-15.1881 476.41 L-10.3038 476.41 L-10.3038 482.29 L-15.1881 482.29 L-15.1881 476.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M0.69147 478.355 L8.33032 478.355 L8.33032 451.989 L0.0201769 453.656 L0.0201769 449.397 L8.28402 447.73 L12.9599 447.73 L12.9599 478.355 L20.5988 478.355 L20.5988 482.29 L0.69147 482.29 L0.69147 478.355 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M30.0895 447.73 L48.4458 447.73 L48.4458 451.665 L34.3718 451.665 L34.3718 460.137 Q35.3904 459.79 36.4089 459.628 Q37.4274 459.443 38.4459 459.443 Q44.2329 459.443 47.6125 462.614 Q50.9921 465.786 50.9921 471.202 Q50.9921 476.781 47.5199 479.883 Q44.0477 482.961 37.7283 482.961 Q35.5524 482.961 33.2839 482.591 Q31.0385 482.221 28.6311 481.48 L28.6311 476.781 Q30.7145 477.915 32.9367 478.471 Q35.1589 479.026 37.6357 479.026 Q41.6403 479.026 43.9783 476.92 Q46.3162 474.813 46.3162 471.202 Q46.3162 467.591 43.9783 465.485 Q41.6403 463.378 37.6357 463.378 Q35.7607 463.378 33.8857 463.795 Q32.0339 464.211 30.0895 465.091 L30.0895 447.73 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-36.3454 136.166 Q-39.9565 136.166 -41.7852 139.731 Q-43.5907 143.273 -43.5907 150.402 Q-43.5907 157.509 -41.7852 161.074 Q-39.9565 164.615 -36.3454 164.615 Q-32.7111 164.615 -30.9056 161.074 Q-29.0769 157.509 -29.0769 150.402 Q-29.0769 143.273 -30.9056 139.731 Q-32.7111 136.166 -36.3454 136.166 M-36.3454 132.463 Q-30.5352 132.463 -27.4797 137.069 Q-24.401 141.652 -24.401 150.402 Q-24.401 159.129 -27.4797 163.736 Q-30.5352 168.319 -36.3454 168.319 Q-42.1555 168.319 -45.2342 163.736 Q-48.2897 159.129 -48.2897 150.402 Q-48.2897 141.652 -45.2342 137.069 Q-42.1555 132.463 -36.3454 132.463 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-16.1834 161.768 L-11.2992 161.768 L-11.2992 167.648 L-16.1834 167.648 L-16.1834 161.768 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M2.91368 163.712 L19.233 163.712 L19.233 167.648 L-2.71129 167.648 L-2.71129 163.712 Q-0.0492672 160.958 4.53404 156.328 Q9.1405 151.675 10.321 150.333 Q12.5664 147.81 13.446 146.074 Q14.3488 144.314 14.3488 142.625 Q14.3488 139.87 12.4044 138.134 Q10.4831 136.398 7.38125 136.398 Q5.18219 136.398 2.7285 137.162 Q0.297953 137.925 -2.47981 139.476 L-2.47981 134.754 Q0.344249 133.62 2.79794 133.041 Q5.25163 132.463 7.28866 132.463 Q12.659 132.463 15.8534 135.148 Q19.0479 137.833 19.0479 142.324 Q19.0479 144.453 18.2377 146.375 Q17.4506 148.273 15.3442 150.865 Q14.7655 151.537 11.6636 154.754 Q8.5618 157.949 2.91368 163.712 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M39.0477 136.166 Q35.4367 136.166 33.608 139.731 Q31.8024 143.273 31.8024 150.402 Q31.8024 157.509 33.608 161.074 Q35.4367 164.615 39.0477 164.615 Q42.682 164.615 44.4875 161.074 Q46.3162 157.509 46.3162 150.402 Q46.3162 143.273 44.4875 139.731 Q42.682 136.166 39.0477 136.166 M39.0477 132.463 Q44.8579 132.463 47.9134 137.069 Q50.9921 141.652 50.9921 150.402 Q50.9921 159.129 47.9134 163.736 Q44.8579 168.319 39.0477 168.319 Q33.2376 168.319 30.1589 163.736 Q27.1034 159.129 27.1034 150.402 Q27.1034 141.652 30.1589 137.069 Q33.2376 132.463 39.0477 132.463 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip762)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,779.653 313.569,811.117 540.145,486.653 766.721,88.5087 993.298,259.235 1219.87,505.298 1446.45,676.235 1673.03,916.573 1899.6,872.861 2126.18,655.29 2352.76,1034.33 "/>
<polyline clip-path="url(#clip762)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1408.94 313.569,1351.78 540.145,1337.28 766.721,1425.83 993.298,1439.35 1219.87,1429.22 1446.45,1441.79 1673.03,1397.92 1899.6,1369.52 2126.18,1464 2352.76,1307.43 "/>
<path clip-path="url(#clip760)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip760)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip760)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip760)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip760)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>To construct an IRF we can take the model and perturb just the first element of the noise,</p><pre><code class="language-julia hljs">function irf(A, B, C, T = 20)
    noise = Matrix([1.0; zeros(T-1)]&#39;)
    problem = LinearStateSpaceProblem(A, B, zeros(2), (0, T); C, noise, syms = [:a, :b])
    return solve(problem)
end
plot(irf(A, B, C))</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip820">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip821">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip822">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="653.433,1505.26 653.433,47.2441 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1505.26 1219.87,47.2441 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1786.31,1505.26 1786.31,47.2441 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="653.433,1505.26 653.433,1486.36 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1505.26 1219.87,1486.36 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1786.31,1505.26 1786.31,1486.36 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip820)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M643.711 1533.1 L662.067 1533.1 L662.067 1537.04 L647.993 1537.04 L647.993 1545.51 Q649.012 1545.16 650.03 1545 Q651.049 1544.81 652.067 1544.81 Q657.854 1544.81 661.234 1547.98 Q664.614 1551.16 664.614 1556.57 Q664.614 1562.15 661.141 1565.25 Q657.669 1568.33 651.35 1568.33 Q649.174 1568.33 646.905 1567.96 Q644.66 1567.59 642.253 1566.85 L642.253 1562.15 Q644.336 1563.28 646.558 1563.84 Q648.78 1564.4 651.257 1564.4 Q655.262 1564.4 657.6 1562.29 Q659.938 1560.18 659.938 1556.57 Q659.938 1552.96 657.6 1550.85 Q655.262 1548.75 651.257 1548.75 Q649.382 1548.75 647.507 1549.16 Q645.655 1549.58 643.711 1550.46 L643.711 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1194.56 1563.72 L1202.2 1563.72 L1202.2 1537.36 L1193.89 1539.03 L1193.89 1534.77 L1202.15 1533.1 L1206.83 1533.1 L1206.83 1563.72 L1214.47 1563.72 L1214.47 1567.66 L1194.56 1567.66 L1194.56 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1233.91 1536.18 Q1230.3 1536.18 1228.47 1539.74 Q1226.67 1543.28 1226.67 1550.41 Q1226.67 1557.52 1228.47 1561.09 Q1230.3 1564.63 1233.91 1564.63 Q1237.55 1564.63 1239.35 1561.09 Q1241.18 1557.52 1241.18 1550.41 Q1241.18 1543.28 1239.35 1539.74 Q1237.55 1536.18 1233.91 1536.18 M1233.91 1532.47 Q1239.72 1532.47 1242.78 1537.08 Q1245.86 1541.66 1245.86 1550.41 Q1245.86 1559.14 1242.78 1563.75 Q1239.72 1568.33 1233.91 1568.33 Q1228.1 1568.33 1225.02 1563.75 Q1221.97 1559.14 1221.97 1550.41 Q1221.97 1541.66 1225.02 1537.08 Q1228.1 1532.47 1233.91 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1761.5 1563.72 L1769.14 1563.72 L1769.14 1537.36 L1760.83 1539.03 L1760.83 1534.77 L1769.09 1533.1 L1773.77 1533.1 L1773.77 1563.72 L1781.41 1563.72 L1781.41 1567.66 L1761.5 1567.66 L1761.5 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1790.9 1533.1 L1809.25 1533.1 L1809.25 1537.04 L1795.18 1537.04 L1795.18 1545.51 Q1796.2 1545.16 1797.22 1545 Q1798.24 1544.81 1799.25 1544.81 Q1805.04 1544.81 1808.42 1547.98 Q1811.8 1551.16 1811.8 1556.57 Q1811.8 1562.15 1808.33 1565.25 Q1804.86 1568.33 1798.54 1568.33 Q1796.36 1568.33 1794.09 1567.96 Q1791.85 1567.59 1789.44 1566.85 L1789.44 1562.15 Q1791.52 1563.28 1793.75 1563.84 Q1795.97 1564.4 1798.44 1564.4 Q1802.45 1564.4 1804.79 1562.29 Q1807.13 1560.18 1807.13 1556.57 Q1807.13 1552.96 1804.79 1550.85 Q1802.45 1548.75 1798.44 1548.75 Q1796.57 1548.75 1794.69 1549.16 Q1792.84 1549.58 1790.9 1550.46 L1790.9 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M2331.53 1563.72 L2347.85 1563.72 L2347.85 1567.66 L2325.9 1567.66 L2325.9 1563.72 Q2328.57 1560.97 2333.15 1556.34 Q2337.76 1551.69 2338.94 1550.35 Q2341.18 1547.82 2342.06 1546.09 Q2342.96 1544.33 2342.96 1542.64 Q2342.96 1539.88 2341.02 1538.15 Q2339.1 1536.41 2336 1536.41 Q2333.8 1536.41 2331.34 1537.17 Q2328.91 1537.94 2326.14 1539.49 L2326.14 1534.77 Q2328.96 1533.63 2331.41 1533.05 Q2333.87 1532.47 2335.9 1532.47 Q2341.27 1532.47 2344.47 1535.16 Q2347.66 1537.85 2347.66 1542.34 Q2347.66 1544.47 2346.85 1546.39 Q2346.07 1548.28 2343.96 1550.88 Q2343.38 1551.55 2340.28 1554.77 Q2337.18 1557.96 2331.53 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M2367.66 1536.18 Q2364.05 1536.18 2362.22 1539.74 Q2360.42 1543.28 2360.42 1550.41 Q2360.42 1557.52 2362.22 1561.09 Q2364.05 1564.63 2367.66 1564.63 Q2371.3 1564.63 2373.1 1561.09 Q2374.93 1557.52 2374.93 1550.41 Q2374.93 1543.28 2373.1 1539.74 Q2371.3 1536.18 2367.66 1536.18 M2367.66 1532.47 Q2373.47 1532.47 2376.53 1537.08 Q2379.61 1541.66 2379.61 1550.41 Q2379.61 1559.14 2376.53 1563.75 Q2373.47 1568.33 2367.66 1568.33 Q2361.85 1568.33 2358.77 1563.75 Q2355.72 1559.14 2355.72 1550.41 Q2355.72 1541.66 2358.77 1537.08 Q2361.85 1532.47 2367.66 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1078.16 2352.76,1078.16 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,692.334 2352.76,692.334 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,306.503 2352.76,306.503 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1078.16 105.89,1078.16 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,692.334 105.89,692.334 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,306.503 105.89,306.503 "/>
<path clip-path="url(#clip820)" d="M-36.3454 1449.79 Q-39.9565 1449.79 -41.7852 1453.36 Q-43.5907 1456.9 -43.5907 1464.03 Q-43.5907 1471.14 -41.7852 1474.7 Q-39.9565 1478.24 -36.3454 1478.24 Q-32.7111 1478.24 -30.9056 1474.7 Q-29.0769 1471.14 -29.0769 1464.03 Q-29.0769 1456.9 -30.9056 1453.36 Q-32.7111 1449.79 -36.3454 1449.79 M-36.3454 1446.09 Q-30.5352 1446.09 -27.4797 1450.7 Q-24.401 1455.28 -24.401 1464.03 Q-24.401 1472.76 -27.4797 1477.36 Q-30.5352 1481.95 -36.3454 1481.95 Q-42.1555 1481.95 -45.2342 1477.36 Q-48.2897 1472.76 -48.2897 1464.03 Q-48.2897 1455.28 -45.2342 1450.7 Q-42.1555 1446.09 -36.3454 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-16.1834 1475.4 L-11.2992 1475.4 L-11.2992 1481.28 L-16.1834 1481.28 L-16.1834 1475.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M8.88587 1449.79 Q5.27478 1449.79 3.44608 1453.36 Q1.64054 1456.9 1.64054 1464.03 Q1.64054 1471.14 3.44608 1474.7 Q5.27478 1478.24 8.88587 1478.24 Q12.5201 1478.24 14.3257 1474.7 Q16.1543 1471.14 16.1543 1464.03 Q16.1543 1456.9 14.3257 1453.36 Q12.5201 1449.79 8.88587 1449.79 M8.88587 1446.09 Q14.696 1446.09 17.7516 1450.7 Q20.8303 1455.28 20.8303 1464.03 Q20.8303 1472.76 17.7516 1477.36 Q14.696 1481.95 8.88587 1481.95 Q3.07572 1481.95 -0.00297114 1477.36 Q-3.05851 1472.76 -3.05851 1464.03 Q-3.05851 1455.28 -0.00297114 1450.7 Q3.07572 1446.09 8.88587 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-34.7482 1063.96 Q-38.3592 1063.96 -40.1879 1067.53 Q-41.9935 1071.07 -41.9935 1078.2 Q-41.9935 1085.31 -40.1879 1088.87 Q-38.3592 1092.41 -34.7482 1092.41 Q-31.1139 1092.41 -29.3084 1088.87 Q-27.4797 1085.31 -27.4797 1078.2 Q-27.4797 1071.07 -29.3084 1067.53 Q-31.1139 1063.96 -34.7482 1063.96 M-34.7482 1060.26 Q-28.938 1060.26 -25.8825 1064.87 Q-22.8038 1069.45 -22.8038 1078.2 Q-22.8038 1086.93 -25.8825 1091.53 Q-28.938 1096.12 -34.7482 1096.12 Q-40.5583 1096.12 -43.637 1091.53 Q-46.6925 1086.93 -46.6925 1078.2 Q-46.6925 1069.45 -43.637 1064.87 Q-40.5583 1060.26 -34.7482 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-14.5862 1089.56 L-9.70199 1089.56 L-9.70199 1095.44 L-14.5862 1095.44 L-14.5862 1089.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M10.4831 1063.96 Q6.87199 1063.96 5.0433 1067.53 Q3.23775 1071.07 3.23775 1078.2 Q3.23775 1085.31 5.0433 1088.87 Q6.87199 1092.41 10.4831 1092.41 Q14.1173 1092.41 15.9229 1088.87 Q17.7516 1085.31 17.7516 1078.2 Q17.7516 1071.07 15.9229 1067.53 Q14.1173 1063.96 10.4831 1063.96 M10.4831 1060.26 Q16.2932 1060.26 19.3488 1064.87 Q22.4275 1069.45 22.4275 1078.2 Q22.4275 1086.93 19.3488 1091.53 Q16.2932 1096.12 10.4831 1096.12 Q4.67293 1096.12 1.59424 1091.53 Q-1.4613 1086.93 -1.4613 1078.2 Q-1.4613 1069.45 1.59424 1064.87 Q4.67293 1060.26 10.4831 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M34.6728 1091.51 L50.9921 1091.51 L50.9921 1095.44 L29.0478 1095.44 L29.0478 1091.51 Q31.7098 1088.75 36.2931 1084.13 Q40.8996 1079.47 42.0801 1078.13 Q44.3255 1075.61 45.2051 1073.87 Q46.1079 1072.11 46.1079 1070.42 Q46.1079 1067.67 44.1635 1065.93 Q42.2422 1064.19 39.1403 1064.19 Q36.9413 1064.19 34.4876 1064.96 Q32.057 1065.72 29.2793 1067.27 L29.2793 1062.55 Q32.1033 1061.42 34.557 1060.84 Q37.0107 1060.26 39.0477 1060.26 Q44.4181 1060.26 47.6125 1062.94 Q50.8069 1065.63 50.8069 1070.12 Q50.8069 1072.25 49.9968 1074.17 Q49.2097 1076.07 47.1033 1078.66 Q46.5246 1079.33 43.4227 1082.55 Q40.3209 1085.75 34.6728 1091.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-36.8315 678.132 Q-40.4426 678.132 -42.2713 681.697 Q-44.0768 685.239 -44.0768 692.369 Q-44.0768 699.475 -42.2713 703.04 Q-40.4426 706.581 -36.8315 706.581 Q-33.1972 706.581 -31.3917 703.04 Q-29.563 699.475 -29.563 692.369 Q-29.563 685.239 -31.3917 681.697 Q-33.1972 678.132 -36.8315 678.132 M-36.8315 674.429 Q-31.0213 674.429 -27.9658 679.035 Q-24.8871 683.619 -24.8871 692.369 Q-24.8871 701.095 -27.9658 705.702 Q-31.0213 710.285 -36.8315 710.285 Q-42.6416 710.285 -45.7203 705.702 Q-48.7759 701.095 -48.7759 692.369 Q-48.7759 683.619 -45.7203 679.035 Q-42.6416 674.429 -36.8315 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-16.6695 703.734 L-11.7853 703.734 L-11.7853 709.614 L-16.6695 709.614 L-16.6695 703.734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M8.39976 678.132 Q4.78867 678.132 2.95998 681.697 Q1.15443 685.239 1.15443 692.369 Q1.15443 699.475 2.95998 703.04 Q4.78867 706.581 8.39976 706.581 Q12.034 706.581 13.8395 703.04 Q15.6682 699.475 15.6682 692.369 Q15.6682 685.239 13.8395 681.697 Q12.034 678.132 8.39976 678.132 M8.39976 674.429 Q14.2099 674.429 17.2655 679.035 Q20.3441 683.619 20.3441 692.369 Q20.3441 701.095 17.2655 705.702 Q14.2099 710.285 8.39976 710.285 Q2.58961 710.285 -0.48908 705.702 Q-3.54462 701.095 -3.54462 692.369 Q-3.54462 683.619 -0.48908 679.035 Q2.58961 674.429 8.39976 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M41.4088 679.128 L29.6034 697.577 L41.4088 697.577 L41.4088 679.128 M40.182 675.054 L46.0616 675.054 L46.0616 697.577 L50.9921 697.577 L50.9921 701.466 L46.0616 701.466 L46.0616 709.614 L41.4088 709.614 L41.4088 701.466 L25.8071 701.466 L25.8071 696.952 L40.182 675.054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-36.5074 292.302 Q-40.1185 292.302 -41.9472 295.867 Q-43.7527 299.408 -43.7527 306.538 Q-43.7527 313.644 -41.9472 317.209 Q-40.1185 320.751 -36.5074 320.751 Q-32.8732 320.751 -31.0676 317.209 Q-29.2389 313.644 -29.2389 306.538 Q-29.2389 299.408 -31.0676 295.867 Q-32.8732 292.302 -36.5074 292.302 M-36.5074 288.598 Q-30.6973 288.598 -27.6417 293.205 Q-24.563 297.788 -24.563 306.538 Q-24.563 315.265 -27.6417 319.871 Q-30.6973 324.454 -36.5074 324.454 Q-42.3176 324.454 -45.3962 319.871 Q-48.4518 315.265 -48.4518 306.538 Q-48.4518 297.788 -45.3962 293.205 Q-42.3176 288.598 -36.5074 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-16.3455 317.903 L-11.4612 317.903 L-11.4612 323.783 L-16.3455 323.783 L-16.3455 317.903 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M8.72383 292.302 Q5.11274 292.302 3.28405 295.867 Q1.4785 299.408 1.4785 306.538 Q1.4785 313.644 3.28405 317.209 Q5.11274 320.751 8.72383 320.751 Q12.3581 320.751 14.1636 317.209 Q15.9923 313.644 15.9923 306.538 Q15.9923 299.408 14.1636 295.867 Q12.3581 292.302 8.72383 292.302 M8.72383 288.598 Q14.534 288.598 17.5895 293.205 Q20.6682 297.788 20.6682 306.538 Q20.6682 315.265 17.5895 319.871 Q14.534 324.454 8.72383 324.454 Q2.91368 324.454 -0.165007 319.871 Q-3.22055 315.265 -3.22055 306.538 Q-3.22055 297.788 -0.165007 293.205 Q2.91368 288.598 8.72383 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M39.4644 304.64 Q36.3163 304.64 34.4644 306.792 Q32.6357 308.945 32.6357 312.695 Q32.6357 316.422 34.4644 318.598 Q36.3163 320.751 39.4644 320.751 Q42.6125 320.751 44.4412 318.598 Q46.2931 316.422 46.2931 312.695 Q46.2931 308.945 44.4412 306.792 Q42.6125 304.64 39.4644 304.64 M48.7468 289.987 L48.7468 294.246 Q46.9875 293.413 45.182 292.973 Q43.3996 292.533 41.6403 292.533 Q37.0107 292.533 34.557 295.658 Q32.1265 298.783 31.7793 305.103 Q33.145 303.089 35.2052 302.024 Q37.2653 300.936 39.7422 300.936 Q44.9505 300.936 47.9597 304.107 Q50.9921 307.255 50.9921 312.695 Q50.9921 318.019 47.844 321.237 Q44.6959 324.454 39.4644 324.454 Q33.4691 324.454 30.2978 319.871 Q27.1265 315.265 27.1265 306.538 Q27.1265 298.343 31.0154 293.482 Q34.9042 288.598 41.4551 288.598 Q43.2144 288.598 44.9968 288.945 Q46.8023 289.292 48.7468 289.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip822)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1464 313.569,267.92 426.857,88.5087 540.145,109.44 653.433,167.599 766.721,230.505 880.009,291.797 993.298,350.33 1106.59,405.998 1219.87,458.895 1333.16,509.149 1446.45,556.892 1559.74,602.247 1673.03,645.334 1786.31,686.267 1899.6,725.154 2012.89,762.096 2126.18,797.191 2239.47,830.531 2352.76,862.204 "/>
<polyline clip-path="url(#clip822)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1271.08 313.569,1425.41 426.857,1456.28 540.145,1462.45 653.433,1463.69 766.721,1463.93 880.009,1463.98 993.298,1463.99 1106.59,1463.99 1219.87,1464 1333.16,1464 1446.45,1464 1559.74,1464 1673.03,1464 1786.31,1464 1899.6,1464 2012.89,1464 2126.18,1464 2239.47,1464 2352.76,1464 "/>
<path clip-path="url(#clip820)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip820)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip820)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip820)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip820)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>Lets find the 2nd observable at the end of the IRF.</p><pre><code class="language-julia hljs">function last_observable_irf(A, B, C)
    sol = irf(A, B, C)
    return sol.z[end][2]  # return 2nd argument of last observable
end
last_observable_irf(A, B, C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.03119456447624772</code></pre><p>But everything in this package is differentiable.  Lets differentiate the observable of the IRF with respect to all of the parameters using <code>Zygote.jl</code>,</p><pre><code class="language-julia hljs">gradient(last_observable_irf, A, B, C)  # calculates gradient wrt all arguments</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.5822985368900442 0.0050313813671367304; 4.469834483178462 0.041592752634585235], [0.37735360253530714; 3.119456447624773;;], [0.0 0.0; 0.03119456447624772 5.242880000000006e-16])</code></pre><p>Gradients of other model elements (e.g. <code>.u</code> are also possible.  With this in mind, lets find the gradient of the mean of the 1st element of the IRF of the solution with respect to a particular noise vector.</p><pre><code class="language-julia hljs">function mean_u_1(A, B, C, noise, u0, T)
    problem = LinearStateSpaceProblem(A, B, u0, (0, T); noise, syms = [:a, :b])
    sol = solve(problem)
    u = sol.u # see issue #75 workaround
    # can have nontrivial functions and even non-mutating loops
    return mean( u[i][1] for i in 1:T)
end
u0 = [0.0, 0.0]
noise = sol.W # from simulation above
mean_u_1(A, B, C, noise, u0, T)
# dropping a few arguments from derivative
gradient((noise, u0)-&gt; mean_u_1(A, B, C, noise, u0, T), noise, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.05079876954953124 0.045314515146875 … 0.0 0.0], [0.702526121523242, 5.600882710405467])</code></pre><h2 id="Simulating-Ensembles-and-Fixing-Noise"><a class="docs-heading-anchor" href="#Simulating-Ensembles-and-Fixing-Noise">Simulating Ensembles and Fixing Noise</a><a id="Simulating-Ensembles-and-Fixing-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Ensembles-and-Fixing-Noise" title="Permalink"></a></h2><p>If you pass in a distribution for the initial condition, it will draw an initial condition.  Below we will simulate from a deterministic evolution equation and without any observation noise.</p><pre><code class="language-julia hljs">using Distributions, DiffEqBase
u0 = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = LinearStateSpaceProblem(A, nothing, u0, (0, T); C)
sol = solve(prob)
plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip880">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip880)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip881">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip880)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip882">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip880)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1361.54 2352.76,1361.54 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1149.37 2352.76,1149.37 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,937.198 2352.76,937.198 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,725.026 2352.76,725.026 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,512.854 2352.76,512.854 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,300.681 2352.76,300.681 "/>
<polyline clip-path="url(#clip882)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,88.5087 2352.76,88.5087 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1361.54 105.89,1361.54 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1149.37 105.89,1149.37 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,937.198 105.89,937.198 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,725.026 105.89,725.026 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,512.854 105.89,512.854 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,300.681 105.89,300.681 "/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,88.5087 105.89,88.5087 "/>
<path clip-path="url(#clip880)" d="M-54.3545 1361.99 L-24.6788 1361.99 L-24.6788 1365.93 L-54.3545 1365.93 L-54.3545 1361.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-13.776 1374.89 L-6.1372 1374.89 L-6.1372 1348.52 L-14.4473 1350.19 L-14.4473 1345.93 L-6.18349 1344.26 L-1.50759 1344.26 L-1.50759 1374.89 L6.13126 1374.89 L6.13126 1378.82 L-13.776 1378.82 L-13.776 1374.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M15.5756 1372.94 L20.4599 1372.94 L20.4599 1378.82 L15.5756 1378.82 L15.5756 1372.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M34.6728 1374.89 L50.9921 1374.89 L50.9921 1378.82 L29.0478 1378.82 L29.0478 1374.89 Q31.7098 1372.13 36.2931 1367.5 Q40.8996 1362.85 42.0801 1361.51 Q44.3255 1358.99 45.2051 1357.25 Q46.1079 1355.49 46.1079 1353.8 Q46.1079 1351.05 44.1635 1349.31 Q42.2422 1347.57 39.1403 1347.57 Q36.9413 1347.57 34.4876 1348.34 Q32.057 1349.1 29.2793 1350.65 L29.2793 1345.93 Q32.1033 1344.8 34.557 1344.22 Q37.0107 1343.64 39.0477 1343.64 Q44.4181 1343.64 47.6125 1346.32 Q50.8069 1349.01 50.8069 1353.5 Q50.8069 1355.63 49.9968 1357.55 Q49.2097 1359.45 47.1033 1362.04 Q46.5246 1362.71 43.4227 1365.93 Q40.3209 1369.12 34.6728 1374.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-55.9517 1149.82 L-26.276 1149.82 L-26.276 1153.76 L-55.9517 1153.76 L-55.9517 1149.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-15.3733 1162.72 L-7.73441 1162.72 L-7.73441 1136.35 L-16.0446 1138.02 L-16.0446 1133.76 L-7.78071 1132.09 L-3.10481 1132.09 L-3.10481 1162.72 L4.53404 1162.72 L4.53404 1166.65 L-15.3733 1166.65 L-15.3733 1162.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M13.9784 1160.77 L18.8627 1160.77 L18.8627 1166.65 L13.9784 1166.65 L13.9784 1160.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M39.0477 1135.17 Q35.4367 1135.17 33.608 1138.73 Q31.8024 1142.28 31.8024 1149.41 Q31.8024 1156.51 33.608 1160.08 Q35.4367 1163.62 39.0477 1163.62 Q42.682 1163.62 44.4875 1160.08 Q46.3162 1156.51 46.3162 1149.41 Q46.3162 1142.28 44.4875 1138.73 Q42.682 1135.17 39.0477 1135.17 M39.0477 1131.47 Q44.8579 1131.47 47.9134 1136.07 Q50.9921 1140.66 50.9921 1149.41 Q50.9921 1158.13 47.9134 1162.74 Q44.8579 1167.32 39.0477 1167.32 Q33.2376 1167.32 30.1589 1162.74 Q27.1034 1158.13 27.1034 1149.41 Q27.1034 1140.66 30.1589 1136.07 Q33.2376 1131.47 39.0477 1131.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-55.8592 937.65 L-26.1834 937.65 L-26.1834 941.585 L-55.8592 941.585 L-55.8592 937.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-6.0909 922.997 Q-9.70199 922.997 -11.5307 926.562 Q-13.3362 930.104 -13.3362 937.233 Q-13.3362 944.34 -11.5307 947.904 Q-9.70199 951.446 -6.0909 951.446 Q-2.45666 951.446 -0.651116 947.904 Q1.17758 944.34 1.17758 937.233 Q1.17758 930.104 -0.651116 926.562 Q-2.45666 922.997 -6.0909 922.997 M-6.0909 919.293 Q-0.280747 919.293 2.77479 923.9 Q5.85348 928.483 5.85348 937.233 Q5.85348 945.96 2.77479 950.566 Q-0.280747 955.15 -6.0909 955.15 Q-11.9011 955.15 -14.9797 950.566 Q-18.0353 945.96 -18.0353 937.233 Q-18.0353 928.483 -14.9797 923.9 Q-11.9011 919.293 -6.0909 919.293 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M14.071 948.599 L18.9553 948.599 L18.9553 954.478 L14.071 954.478 L14.071 948.599 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M39.1403 938.067 Q35.807 938.067 33.8857 939.849 Q31.9876 941.631 31.9876 944.756 Q31.9876 947.881 33.8857 949.664 Q35.807 951.446 39.1403 951.446 Q42.4737 951.446 44.3949 949.664 Q46.3162 947.858 46.3162 944.756 Q46.3162 941.631 44.3949 939.849 Q42.4968 938.067 39.1403 938.067 M34.4644 936.076 Q31.4552 935.335 29.7654 933.275 Q28.0987 931.215 28.0987 928.252 Q28.0987 924.108 31.0385 921.701 Q34.0015 919.293 39.1403 919.293 Q44.3023 919.293 47.2421 921.701 Q50.1819 924.108 50.1819 928.252 Q50.1819 931.215 48.4921 933.275 Q46.8255 935.335 43.8394 936.076 Q47.219 936.863 49.094 939.154 Q50.9921 941.446 50.9921 944.756 Q50.9921 949.779 47.9134 952.465 Q44.8579 955.15 39.1403 955.15 Q33.4228 955.15 30.3441 952.465 Q27.2885 949.779 27.2885 944.756 Q27.2885 941.446 29.1867 939.154 Q31.0848 936.863 34.4644 936.076 M32.7515 928.692 Q32.7515 931.377 34.4181 932.881 Q36.1079 934.386 39.1403 934.386 Q42.1496 934.386 43.8394 932.881 Q45.5523 931.377 45.5523 928.692 Q45.5523 926.006 43.8394 924.502 Q42.1496 922.997 39.1403 922.997 Q36.1079 922.997 34.4181 924.502 Q32.7515 926.006 32.7515 928.692 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-56.1138 725.477 L-26.438 725.477 L-26.438 729.413 L-56.1138 729.413 L-56.1138 725.477 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-6.34553 710.825 Q-9.95662 710.825 -11.7853 714.39 Q-13.5909 717.931 -13.5909 725.061 Q-13.5909 732.167 -11.7853 735.732 Q-9.95662 739.274 -6.34553 739.274 Q-2.71129 739.274 -0.905744 735.732 Q0.92295 732.167 0.92295 725.061 Q0.92295 717.931 -0.905744 714.39 Q-2.71129 710.825 -6.34553 710.825 M-6.34553 707.121 Q-0.535376 707.121 2.52016 711.727 Q5.59885 716.311 5.59885 725.061 Q5.59885 733.788 2.52016 738.394 Q-0.535376 742.977 -6.34553 742.977 Q-12.1557 742.977 -15.2344 738.394 Q-18.2899 733.788 -18.2899 725.061 Q-18.2899 716.311 -15.2344 711.727 Q-12.1557 707.121 -6.34553 707.121 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M13.8164 736.426 L18.7006 736.426 L18.7006 742.306 L13.8164 742.306 L13.8164 736.426 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M39.4644 723.163 Q36.3163 723.163 34.4644 725.315 Q32.6357 727.468 32.6357 731.218 Q32.6357 734.945 34.4644 737.121 Q36.3163 739.274 39.4644 739.274 Q42.6125 739.274 44.4412 737.121 Q46.2931 734.945 46.2931 731.218 Q46.2931 727.468 44.4412 725.315 Q42.6125 723.163 39.4644 723.163 M48.7468 708.51 L48.7468 712.769 Q46.9875 711.936 45.182 711.496 Q43.3996 711.056 41.6403 711.056 Q37.0107 711.056 34.557 714.181 Q32.1265 717.306 31.7793 723.626 Q33.145 721.612 35.2052 720.547 Q37.2653 719.459 39.7422 719.459 Q44.9505 719.459 47.9597 722.63 Q50.9921 725.778 50.9921 731.218 Q50.9921 736.542 47.844 739.76 Q44.6959 742.977 39.4644 742.977 Q33.4691 742.977 30.2978 738.394 Q27.1265 733.788 27.1265 725.061 Q27.1265 716.866 31.0154 712.005 Q34.9042 707.121 41.4551 707.121 Q43.2144 707.121 44.9968 707.468 Q46.8023 707.815 48.7468 708.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-56.4379 513.305 L-26.7621 513.305 L-26.7621 517.24 L-56.4379 517.24 L-56.4379 513.305 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-6.6696 498.652 Q-10.2807 498.652 -12.1094 502.217 Q-13.9149 505.759 -13.9149 512.888 Q-13.9149 519.995 -12.1094 523.56 Q-10.2807 527.101 -6.6696 527.101 Q-3.03536 527.101 -1.22982 523.56 Q0.598877 519.995 0.598877 512.888 Q0.598877 505.759 -1.22982 502.217 Q-3.03536 498.652 -6.6696 498.652 M-6.6696 494.949 Q-0.859448 494.949 2.19609 499.555 Q5.27478 504.138 5.27478 512.888 Q5.27478 521.615 2.19609 526.222 Q-0.859448 530.805 -6.6696 530.805 Q-12.4798 530.805 -15.5584 526.222 Q-18.614 521.615 -18.614 512.888 Q-18.614 504.138 -15.5584 499.555 Q-12.4798 494.949 -6.6696 494.949 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M13.4923 524.254 L18.3766 524.254 L18.3766 530.134 L13.4923 530.134 L13.4923 524.254 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M41.4088 499.648 L29.6034 518.097 L41.4088 518.097 L41.4088 499.648 M40.182 495.574 L46.0616 495.574 L46.0616 518.097 L50.9921 518.097 L50.9921 521.985 L46.0616 521.985 L46.0616 530.134 L41.4088 530.134 L41.4088 521.985 L25.8071 521.985 L25.8071 517.472 L40.182 495.574 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-54.3545 301.133 L-24.6788 301.133 L-24.6788 305.068 L-54.3545 305.068 L-54.3545 301.133 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-4.58628 286.48 Q-8.19737 286.48 -10.0261 290.045 Q-11.8316 293.586 -11.8316 300.716 Q-11.8316 307.822 -10.0261 311.387 Q-8.19737 314.929 -4.58628 314.929 Q-0.95204 314.929 0.853506 311.387 Q2.6822 307.822 2.6822 300.716 Q2.6822 293.586 0.853506 290.045 Q-0.95204 286.48 -4.58628 286.48 M-4.58628 282.776 Q1.22387 282.776 4.27941 287.383 Q7.3581 291.966 7.3581 300.716 Q7.3581 309.443 4.27941 314.049 Q1.22387 318.632 -4.58628 318.632 Q-10.3964 318.632 -13.4751 314.049 Q-16.5307 309.443 -16.5307 300.716 Q-16.5307 291.966 -13.4751 287.383 Q-10.3964 282.776 -4.58628 282.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M15.5756 312.082 L20.4599 312.082 L20.4599 317.961 L15.5756 317.961 L15.5756 312.082 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M34.6728 314.026 L50.9921 314.026 L50.9921 317.961 L29.0478 317.961 L29.0478 314.026 Q31.7098 311.271 36.2931 306.642 Q40.8996 301.989 42.0801 300.646 Q44.3255 298.123 45.2051 296.387 Q46.1079 294.628 46.1079 292.938 Q46.1079 290.183 44.1635 288.447 Q42.2422 286.711 39.1403 286.711 Q36.9413 286.711 34.4876 287.475 Q32.057 288.239 29.2793 289.79 L29.2793 285.068 Q32.1033 283.934 34.557 283.355 Q37.0107 282.776 39.0477 282.776 Q44.4181 282.776 47.6125 285.461 Q50.8069 288.146 50.8069 292.637 Q50.8069 294.767 49.9968 296.688 Q49.2097 298.586 47.1033 301.179 Q46.5246 301.85 43.4227 305.068 Q40.3209 308.262 34.6728 314.026 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M-6.18349 74.3074 Q-9.79459 74.3074 -11.6233 77.8722 Q-13.4288 81.4138 -13.4288 88.5434 Q-13.4288 95.6498 -11.6233 99.2146 Q-9.79459 102.756 -6.18349 102.756 Q-2.54925 102.756 -0.743708 99.2146 Q1.08499 95.6498 1.08499 88.5434 Q1.08499 81.4138 -0.743708 77.8722 Q-2.54925 74.3074 -6.18349 74.3074 M-6.18349 70.6037 Q-0.37334 70.6037 2.6822 75.2101 Q5.76089 79.7934 5.76089 88.5434 Q5.76089 97.2702 2.6822 101.877 Q-0.37334 106.46 -6.18349 106.46 Q-11.9936 106.46 -15.0723 101.877 Q-18.1279 97.2702 -18.1279 88.5434 Q-18.1279 79.7934 -15.0723 75.2101 Q-11.9936 70.6037 -6.18349 70.6037 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M13.9784 99.9091 L18.8627 99.9091 L18.8627 105.789 L13.9784 105.789 L13.9784 99.9091 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M39.0477 74.3074 Q35.4367 74.3074 33.608 77.8722 Q31.8024 81.4138 31.8024 88.5434 Q31.8024 95.6498 33.608 99.2146 Q35.4367 102.756 39.0477 102.756 Q42.682 102.756 44.4875 99.2146 Q46.3162 95.6498 46.3162 88.5434 Q46.3162 81.4138 44.4875 77.8722 Q42.682 74.3074 39.0477 74.3074 M39.0477 70.6037 Q44.8579 70.6037 47.9134 75.2101 Q50.9921 79.7934 50.9921 88.5434 Q50.9921 97.2702 47.9134 101.877 Q44.8579 106.46 39.0477 106.46 Q33.2376 106.46 30.1589 101.877 Q27.1034 97.2702 27.1034 88.5434 Q27.1034 79.7934 30.1589 75.2101 Q33.2376 70.6037 39.0477 70.6037 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip882)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,355.667 313.569,1328.72 540.145,1464 766.721,1434.68 993.298,1375.26 1219.87,1312.5 1446.45,1251.62 1673.03,1193.52 1899.6,1138.29 2126.18,1085.8 2352.76,1035.94 "/>
<polyline clip-path="url(#clip882)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,247.608 313.569,120.328 540.145,94.8726 766.721,89.7815 993.298,88.7632 1219.87,88.5596 1446.45,88.5189 1673.03,88.5107 1899.6,88.5091 2126.18,88.5088 2352.76,88.5087 "/>
<path clip-path="url(#clip880)" d="M1942.97 1456.66 L2277.23 1456.66 L2277.23 1301.14 L1942.97 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip880)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1942.97,1456.66 2277.23,1456.66 2277.23,1301.14 1942.97,1301.14 1942.97,1456.66 "/>
<polyline clip-path="url(#clip880)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,1352.98 2119.2,1352.98 "/>
<path clip-path="url(#clip880)" d="M2144.37 1360.03 L2144.37 1344.33 L2148.63 1344.33 L2148.63 1359.87 Q2148.63 1363.55 2150.07 1365.4 Q2151.5 1367.23 2154.37 1367.23 Q2157.82 1367.23 2159.81 1365.03 Q2161.82 1362.83 2161.82 1359.03 L2161.82 1344.33 L2166.08 1344.33 L2166.08 1370.26 L2161.82 1370.26 L2161.82 1366.28 Q2160.27 1368.64 2158.21 1369.8 Q2156.18 1370.93 2153.47 1370.93 Q2149 1370.93 2146.69 1368.15 Q2144.37 1365.38 2144.37 1360.03 M2155.09 1343.71 L2155.09 1343.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2176.27 1366.32 L2183.91 1366.32 L2183.91 1339.96 L2175.6 1341.63 L2175.6 1337.37 L2183.86 1335.7 L2188.54 1335.7 L2188.54 1366.32 L2196.18 1366.32 L2196.18 1370.26 L2176.27 1370.26 L2176.27 1366.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2215.25 1334.29 Q2212.15 1339.61 2210.64 1344.82 Q2209.14 1350.03 2209.14 1355.38 Q2209.14 1360.72 2210.64 1365.98 Q2212.17 1371.21 2215.25 1376.51 L2211.55 1376.51 Q2208.07 1371.07 2206.34 1365.81 Q2204.62 1360.56 2204.62 1355.38 Q2204.62 1350.21 2206.34 1344.98 Q2208.05 1339.75 2211.55 1334.29 L2215.25 1334.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2227.73 1336.97 L2227.73 1344.33 L2236.5 1344.33 L2236.5 1347.64 L2227.73 1347.64 L2227.73 1361.72 Q2227.73 1364.89 2228.58 1365.79 Q2229.46 1366.69 2232.12 1366.69 L2236.5 1366.69 L2236.5 1370.26 L2232.12 1370.26 Q2227.19 1370.26 2225.32 1368.43 Q2223.44 1366.58 2223.44 1361.72 L2223.44 1347.64 L2220.32 1347.64 L2220.32 1344.33 L2223.44 1344.33 L2223.44 1336.97 L2227.73 1336.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2241.43 1334.29 L2245.13 1334.29 Q2248.61 1339.75 2250.32 1344.98 Q2252.06 1350.21 2252.06 1355.38 Q2252.06 1360.56 2250.32 1365.81 Q2248.61 1371.07 2245.13 1376.51 L2241.43 1376.51 Q2244.51 1371.21 2246.01 1365.98 Q2247.54 1360.72 2247.54 1355.38 Q2247.54 1350.03 2246.01 1344.82 Q2244.51 1339.61 2241.43 1334.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip880)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,1404.82 2119.2,1404.82 "/>
<path clip-path="url(#clip880)" d="M2144.37 1411.87 L2144.37 1396.17 L2148.63 1396.17 L2148.63 1411.71 Q2148.63 1415.39 2150.07 1417.24 Q2151.5 1419.07 2154.37 1419.07 Q2157.82 1419.07 2159.81 1416.87 Q2161.82 1414.67 2161.82 1410.87 L2161.82 1396.17 L2166.08 1396.17 L2166.08 1422.1 L2161.82 1422.1 L2161.82 1418.12 Q2160.27 1420.48 2158.21 1421.64 Q2156.18 1422.77 2153.47 1422.77 Q2149 1422.77 2146.69 1419.99 Q2144.37 1417.22 2144.37 1411.87 M2155.09 1395.55 L2155.09 1395.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2179.49 1418.16 L2195.81 1418.16 L2195.81 1422.1 L2173.86 1422.1 L2173.86 1418.16 Q2176.52 1415.41 2181.11 1410.78 Q2185.71 1406.13 2186.89 1404.78 Q2189.14 1402.26 2190.02 1400.53 Q2190.92 1398.77 2190.92 1397.08 Q2190.92 1394.32 2188.98 1392.59 Q2187.06 1390.85 2183.95 1390.85 Q2181.75 1390.85 2179.3 1391.61 Q2176.87 1392.38 2174.09 1393.93 L2174.09 1389.21 Q2176.92 1388.07 2179.37 1387.49 Q2181.82 1386.91 2183.86 1386.91 Q2189.23 1386.91 2192.43 1389.6 Q2195.62 1392.28 2195.62 1396.78 Q2195.62 1398.9 2194.81 1400.83 Q2194.02 1402.72 2191.92 1405.32 Q2191.34 1405.99 2188.24 1409.21 Q2185.13 1412.4 2179.49 1418.16 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2215.25 1386.13 Q2212.15 1391.45 2210.64 1396.66 Q2209.14 1401.87 2209.14 1407.22 Q2209.14 1412.56 2210.64 1417.82 Q2212.17 1423.05 2215.25 1428.35 L2211.55 1428.35 Q2208.07 1422.91 2206.34 1417.65 Q2204.62 1412.4 2204.62 1407.22 Q2204.62 1402.05 2206.34 1396.82 Q2208.05 1391.59 2211.55 1386.13 L2215.25 1386.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2227.73 1388.81 L2227.73 1396.17 L2236.5 1396.17 L2236.5 1399.48 L2227.73 1399.48 L2227.73 1413.56 Q2227.73 1416.73 2228.58 1417.63 Q2229.46 1418.53 2232.12 1418.53 L2236.5 1418.53 L2236.5 1422.1 L2232.12 1422.1 Q2227.19 1422.1 2225.32 1420.27 Q2223.44 1418.42 2223.44 1413.56 L2223.44 1399.48 L2220.32 1399.48 L2220.32 1396.17 L2223.44 1396.17 L2223.44 1388.81 L2227.73 1388.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip880)" d="M2241.43 1386.13 L2245.13 1386.13 Q2248.61 1391.59 2250.32 1396.82 Q2252.06 1402.05 2252.06 1407.22 Q2252.06 1412.4 2250.32 1417.65 Q2248.61 1422.91 2245.13 1428.35 L2241.43 1428.35 Q2244.51 1423.05 2246.01 1417.82 Q2247.54 1412.56 2247.54 1407.22 Q2247.54 1401.87 2246.01 1396.66 Q2244.51 1391.45 2241.43 1386.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>With this, we can simulate an ensemble of solutions from different initial conditions (and we will turn back on the noise).  The <code>EnsembleSummary</code> calculates a set of quantiles by default.</p><pre><code class="language-julia hljs">T = 10
trajectories = 50
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C)
sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(sol)  #calculate summarize statistics from the
plot(summ)  # shows quantiles by default</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip940">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip940)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip941">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip940)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip942">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="685.496,1521.01 685.496,47.2441 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1521.01 1219.87,47.2441 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1754.25,1521.01 1754.25,47.2441 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="685.496,1521.01 685.496,1502.11 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1521.01 1219.87,1502.11 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.25,1521.01 1754.25,1502.11 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip940)" d="M128.502 1551.93 Q124.891 1551.93 123.062 1555.49 Q121.257 1559.03 121.257 1566.16 Q121.257 1573.27 123.062 1576.83 Q124.891 1580.38 128.502 1580.38 Q132.136 1580.38 133.942 1576.83 Q135.77 1573.27 135.77 1566.16 Q135.77 1559.03 133.942 1555.49 Q132.136 1551.93 128.502 1551.93 M128.502 1548.22 Q134.312 1548.22 137.368 1552.83 Q140.446 1557.41 140.446 1566.16 Q140.446 1574.89 137.368 1579.5 Q134.312 1584.08 128.502 1584.08 Q122.692 1584.08 119.613 1579.5 Q116.558 1574.89 116.558 1566.16 Q116.558 1557.41 119.613 1552.83 Q122.692 1548.22 128.502 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M148.664 1577.53 L153.548 1577.53 L153.548 1583.41 L148.664 1583.41 L148.664 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M173.733 1551.93 Q170.122 1551.93 168.293 1555.49 Q166.488 1559.03 166.488 1566.16 Q166.488 1573.27 168.293 1576.83 Q170.122 1580.38 173.733 1580.38 Q177.367 1580.38 179.173 1576.83 Q181.002 1573.27 181.002 1566.16 Q181.002 1559.03 179.173 1555.49 Q177.367 1551.93 173.733 1551.93 M173.733 1548.22 Q179.543 1548.22 182.599 1552.83 Q185.678 1557.41 185.678 1566.16 Q185.678 1574.89 182.599 1579.5 Q179.543 1584.08 173.733 1584.08 Q167.923 1584.08 164.844 1579.5 Q161.789 1574.89 161.789 1566.16 Q161.789 1557.41 164.844 1552.83 Q167.923 1548.22 173.733 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M657.232 1579.47 L673.551 1579.47 L673.551 1583.41 L651.607 1583.41 L651.607 1579.47 Q654.269 1576.72 658.852 1572.09 Q663.459 1567.44 664.639 1566.09 Q666.885 1563.57 667.764 1561.83 Q668.667 1560.07 668.667 1558.38 Q668.667 1555.63 666.723 1553.89 Q664.801 1552.16 661.7 1552.16 Q659.501 1552.16 657.047 1552.92 Q654.616 1553.69 651.839 1555.24 L651.839 1550.51 Q654.663 1549.38 657.116 1548.8 Q659.57 1548.22 661.607 1548.22 Q666.977 1548.22 670.172 1550.91 Q673.366 1553.59 673.366 1558.08 Q673.366 1560.21 672.556 1562.13 Q671.769 1564.03 669.663 1566.63 Q669.084 1567.3 665.982 1570.51 Q662.88 1573.71 657.232 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M683.366 1577.53 L688.25 1577.53 L688.25 1583.41 L683.366 1583.41 L683.366 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M698.482 1548.85 L716.838 1548.85 L716.838 1552.78 L702.764 1552.78 L702.764 1561.26 Q703.783 1560.91 704.801 1560.75 Q705.82 1560.56 706.838 1560.56 Q712.625 1560.56 716.005 1563.73 Q719.384 1566.9 719.384 1572.32 Q719.384 1577.9 715.912 1581 Q712.44 1584.08 706.121 1584.08 Q703.945 1584.08 701.676 1583.71 Q699.431 1583.34 697.023 1582.6 L697.023 1577.9 Q699.107 1579.03 701.329 1579.59 Q703.551 1580.14 706.028 1580.14 Q710.033 1580.14 712.371 1578.04 Q714.709 1575.93 714.709 1572.32 Q714.709 1568.71 712.371 1566.6 Q710.033 1564.5 706.028 1564.5 Q704.153 1564.5 702.278 1564.91 Q700.426 1565.33 698.482 1566.21 L698.482 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M1187.04 1548.85 L1205.39 1548.85 L1205.39 1552.78 L1191.32 1552.78 L1191.32 1561.26 Q1192.34 1560.91 1193.36 1560.75 Q1194.38 1560.56 1195.39 1560.56 Q1201.18 1560.56 1204.56 1563.73 Q1207.94 1566.9 1207.94 1572.32 Q1207.94 1577.9 1204.47 1581 Q1201 1584.08 1194.68 1584.08 Q1192.5 1584.08 1190.23 1583.71 Q1187.99 1583.34 1185.58 1582.6 L1185.58 1577.9 Q1187.66 1579.03 1189.89 1579.59 Q1192.11 1580.14 1194.58 1580.14 Q1198.59 1580.14 1200.93 1578.04 Q1203.27 1575.93 1203.27 1572.32 Q1203.27 1568.71 1200.93 1566.6 Q1198.59 1564.5 1194.58 1564.5 Q1192.71 1564.5 1190.83 1564.91 Q1188.98 1565.33 1187.04 1566.21 L1187.04 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M1217.15 1577.53 L1222.04 1577.53 L1222.04 1583.41 L1217.15 1583.41 L1217.15 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M1242.22 1551.93 Q1238.61 1551.93 1236.78 1555.49 Q1234.98 1559.03 1234.98 1566.16 Q1234.98 1573.27 1236.78 1576.83 Q1238.61 1580.38 1242.22 1580.38 Q1245.86 1580.38 1247.66 1576.83 Q1249.49 1573.27 1249.49 1566.16 Q1249.49 1559.03 1247.66 1555.49 Q1245.86 1551.93 1242.22 1551.93 M1242.22 1548.22 Q1248.03 1548.22 1251.09 1552.83 Q1254.17 1557.41 1254.17 1566.16 Q1254.17 1574.89 1251.09 1579.5 Q1248.03 1584.08 1242.22 1584.08 Q1236.41 1584.08 1233.33 1579.5 Q1230.28 1574.89 1230.28 1566.16 Q1230.28 1557.41 1233.33 1552.83 Q1236.41 1548.22 1242.22 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M1720.57 1548.85 L1742.79 1548.85 L1742.79 1550.84 L1730.25 1583.41 L1725.36 1583.41 L1737.17 1552.78 L1720.57 1552.78 L1720.57 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M1751.91 1577.53 L1756.8 1577.53 L1756.8 1583.41 L1751.91 1583.41 L1751.91 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M1767.03 1548.85 L1785.39 1548.85 L1785.39 1552.78 L1771.31 1552.78 L1771.31 1561.26 Q1772.33 1560.91 1773.35 1560.75 Q1774.37 1560.56 1775.39 1560.56 Q1781.17 1560.56 1784.55 1563.73 Q1787.93 1566.9 1787.93 1572.32 Q1787.93 1577.9 1784.46 1581 Q1780.99 1584.08 1774.67 1584.08 Q1772.49 1584.08 1770.22 1583.71 Q1767.98 1583.34 1765.57 1582.6 L1765.57 1577.9 Q1767.65 1579.03 1769.88 1579.59 Q1772.1 1580.14 1774.58 1580.14 Q1778.58 1580.14 1780.92 1578.04 Q1783.26 1575.93 1783.26 1572.32 Q1783.26 1568.71 1780.92 1566.6 Q1778.58 1564.5 1774.58 1564.5 Q1772.7 1564.5 1770.83 1564.91 Q1768.97 1565.33 1767.03 1566.21 L1767.03 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M2240.7 1579.47 L2248.34 1579.47 L2248.34 1553.11 L2240.03 1554.77 L2240.03 1550.51 L2248.3 1548.85 L2252.97 1548.85 L2252.97 1579.47 L2260.61 1579.47 L2260.61 1583.41 L2240.7 1583.41 L2240.7 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M2280.05 1551.93 Q2276.44 1551.93 2274.61 1555.49 Q2272.81 1559.03 2272.81 1566.16 Q2272.81 1573.27 2274.61 1576.83 Q2276.44 1580.38 2280.05 1580.38 Q2283.69 1580.38 2285.49 1576.83 Q2287.32 1573.27 2287.32 1566.16 Q2287.32 1559.03 2285.49 1555.49 Q2283.69 1551.93 2280.05 1551.93 M2280.05 1548.22 Q2285.86 1548.22 2288.92 1552.83 Q2292 1557.41 2292 1566.16 Q2292 1574.89 2288.92 1579.5 Q2285.86 1584.08 2280.05 1584.08 Q2274.24 1584.08 2271.17 1579.5 Q2268.11 1574.89 2268.11 1566.16 Q2268.11 1557.41 2271.17 1552.83 Q2274.24 1548.22 2280.05 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M2300.22 1577.53 L2305.1 1577.53 L2305.1 1583.41 L2300.22 1583.41 L2300.22 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M2325.29 1551.93 Q2321.67 1551.93 2319.85 1555.49 Q2318.04 1559.03 2318.04 1566.16 Q2318.04 1573.27 2319.85 1576.83 Q2321.67 1580.38 2325.29 1580.38 Q2328.92 1580.38 2330.73 1576.83 Q2332.55 1573.27 2332.55 1566.16 Q2332.55 1559.03 2330.73 1555.49 Q2328.92 1551.93 2325.29 1551.93 M2325.29 1548.22 Q2331.1 1548.22 2334.15 1552.83 Q2337.23 1557.41 2337.23 1566.16 Q2337.23 1574.89 2334.15 1579.5 Q2331.1 1584.08 2325.29 1584.08 Q2319.48 1584.08 2316.4 1579.5 Q2313.34 1574.89 2313.34 1566.16 Q2313.34 1557.41 2316.4 1552.83 Q2319.48 1548.22 2325.29 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1236.29 2352.76,1236.29 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,944.189 2352.76,944.189 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,652.09 2352.76,652.09 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,359.992 2352.76,359.992 "/>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,67.8929 2352.76,67.8929 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1236.29 105.89,1236.29 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,944.189 105.89,944.189 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,652.09 105.89,652.09 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,359.992 105.89,359.992 "/>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,67.8929 105.89,67.8929 "/>
<path clip-path="url(#clip940)" d="M-9.72514 1236.74 L19.9506 1236.74 L19.9506 1240.67 L-9.72514 1240.67 L-9.72514 1236.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M30.0895 1219.01 L48.4458 1219.01 L48.4458 1222.94 L34.3718 1222.94 L34.3718 1231.41 Q35.3904 1231.07 36.4089 1230.91 Q37.4274 1230.72 38.4459 1230.72 Q44.2329 1230.72 47.6125 1233.89 Q50.9921 1237.06 50.9921 1242.48 Q50.9921 1248.06 47.5199 1251.16 Q44.0477 1254.24 37.7283 1254.24 Q35.5524 1254.24 33.2839 1253.87 Q31.0385 1253.5 28.6311 1252.76 L28.6311 1248.06 Q30.7145 1249.19 32.9367 1249.75 Q35.1589 1250.3 37.6357 1250.3 Q41.6403 1250.3 43.9783 1248.2 Q46.3162 1246.09 46.3162 1242.48 Q46.3162 1238.87 43.9783 1236.76 Q41.6403 1234.66 37.6357 1234.66 Q35.7607 1234.66 33.8857 1235.07 Q32.0339 1235.49 30.0895 1236.37 L30.0895 1219.01 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M39.0477 929.988 Q35.4367 929.988 33.608 933.552 Q31.8024 937.094 31.8024 944.224 Q31.8024 951.33 33.608 954.895 Q35.4367 958.436 39.0477 958.436 Q42.682 958.436 44.4875 954.895 Q46.3162 951.33 46.3162 944.224 Q46.3162 937.094 44.4875 933.552 Q42.682 929.988 39.0477 929.988 M39.0477 926.284 Q44.8579 926.284 47.9134 930.89 Q50.9921 935.474 50.9921 944.224 Q50.9921 952.95 47.9134 957.557 Q44.8579 962.14 39.0477 962.14 Q33.2376 962.14 30.1589 957.557 Q27.1034 952.95 27.1034 944.224 Q27.1034 935.474 30.1589 930.89 Q33.2376 926.284 39.0477 926.284 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M30.0895 634.81 L48.4458 634.81 L48.4458 638.745 L34.3718 638.745 L34.3718 647.218 Q35.3904 646.87 36.4089 646.708 Q37.4274 646.523 38.4459 646.523 Q44.2329 646.523 47.6125 649.694 Q50.9921 652.866 50.9921 658.282 Q50.9921 663.861 47.5199 666.963 Q44.0477 670.041 37.7283 670.041 Q35.5524 670.041 33.2839 669.671 Q31.0385 669.301 28.6311 668.56 L28.6311 663.861 Q30.7145 664.995 32.9367 665.551 Q35.1589 666.106 37.6357 666.106 Q41.6403 666.106 43.9783 664 Q46.3162 661.893 46.3162 658.282 Q46.3162 654.671 43.9783 652.565 Q41.6403 650.458 37.6357 650.458 Q35.7607 650.458 33.8857 650.875 Q32.0339 651.292 30.0895 652.171 L30.0895 634.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M-0.303895 373.336 L7.33495 373.336 L7.33495 346.971 L-0.975188 348.637 L-0.975188 344.378 L7.28866 342.712 L11.9646 342.712 L11.9646 373.336 L19.6034 373.336 L19.6034 377.272 L-0.303895 377.272 L-0.303895 373.336 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M39.0477 345.79 Q35.4367 345.79 33.608 349.355 Q31.8024 352.897 31.8024 360.026 Q31.8024 367.133 33.608 370.698 Q35.4367 374.239 39.0477 374.239 Q42.682 374.239 44.4875 370.698 Q46.3162 367.133 46.3162 360.026 Q46.3162 352.897 44.4875 349.355 Q42.682 345.79 39.0477 345.79 M39.0477 342.087 Q44.8579 342.087 47.9134 346.693 Q50.9921 351.276 50.9921 360.026 Q50.9921 368.753 47.9134 373.36 Q44.8579 377.943 39.0477 377.943 Q33.2376 377.943 30.1589 373.36 Q27.1034 368.753 27.1034 360.026 Q27.1034 351.276 30.1589 346.693 Q33.2376 342.087 39.0477 342.087 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M0.69147 81.2377 L8.33032 81.2377 L8.33032 54.8721 L0.0201769 56.5388 L0.0201769 52.2796 L8.28402 50.6129 L12.9599 50.6129 L12.9599 81.2377 L20.5988 81.2377 L20.5988 85.1729 L0.69147 85.1729 L0.69147 81.2377 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip940)" d="M30.0895 50.6129 L48.4458 50.6129 L48.4458 54.5481 L34.3718 54.5481 L34.3718 63.0202 Q35.3904 62.673 36.4089 62.511 Q37.4274 62.3258 38.4459 62.3258 Q44.2329 62.3258 47.6125 65.4971 Q50.9921 68.6684 50.9921 74.085 Q50.9921 79.6637 47.5199 82.7655 Q44.0477 85.8442 37.7283 85.8442 Q35.5524 85.8442 33.2839 85.4738 Q31.0385 85.1035 28.6311 84.3627 L28.6311 79.6637 Q30.7145 80.7979 32.9367 81.3535 Q35.1589 81.909 37.6357 81.909 Q41.6403 81.909 43.9783 79.8026 Q46.3162 77.6961 46.3162 74.085 Q46.3162 70.4739 43.9783 68.3674 Q41.6403 66.261 37.6357 66.261 Q35.7607 66.261 33.8857 66.6776 Q32.0339 67.0943 30.0895 67.9739 L30.0895 50.6129 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip942)" d="M151.118 1020.05 L364.869 1416.94 L578.62 1479.3 L792.371 1466.85 L1006.12 1442.02 L1219.87 1417.61 L1433.63 1394.44 L1647.38 1371.6 L1861.13 1354.25 L2074.88 1330.47 L2288.63 1311.02 L2288.63 350.923 L2074.88 318.107 L1861.13 283.214 L1647.38 251.826 L1433.63 216.497 L1219.87 177.161 L1006.12 136.103 L792.371 99.0391 L578.62 88.9544 L364.869 203.479 L151.118 822.139  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip942)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,949.991 364.869,793.33 578.62,773.928 792.371,773.698 1006.12,781.021 1219.87,788.302 1433.63,792.987 1647.38,803.137 1861.13,810.686 2074.88,815.995 2288.63,821.004 "/>
<path clip-path="url(#clip942)" d="M151.118 1015.75 L364.869 958.536 L578.62 946.595 L792.371 945.019 L1006.12 945.042 L1219.87 945.271 L1433.63 944.961 L1647.38 945.296 L1861.13 945.025 L2074.88 945.331 L2288.63 945.165 L2288.63 943.421 L2074.88 943.244 L1861.13 942.992 L1647.38 943.137 L1433.63 942.991 L1219.87 943.187 L1006.12 943.446 L792.371 942.7 L578.62 939.069 L364.869 919.867 L151.118 822.85  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip942)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,921.54 364.869,939.316 578.62,942.957 792.371,943.865 1006.12,944.087 1219.87,944.215 1433.63,944.28 1647.38,944.323 1861.13,944.06 2074.88,944.15 2288.63,944.246 "/>
</svg>
<h2 id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><a class="docs-heading-anchor" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter">Observables and Marginal Likelihood using a Kalman Filter</a><a id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter" title="Permalink"></a></h2><p>If you provide <code>observables</code> and provide a distribution for the <code>observables_noise</code> then the model can provide a calculation of the likelihood.  </p><p>The simplest case is if you use a gaussian prior and have gaussian observation noise.  First, lets simulate some data with included observation noise.  If passing in a matrix or vector, the <code>observables_noise</code> argument is intended to be the cholesky of the covariance matrix.  At this point, only diagonal observation noise is allowed.</p><pre><code class="language-julia hljs">u0 = MvNormal([1.0 0.1; 0.1 1.0])  # draw from mean zero initial conditions
T = 10
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)
sol.z # simulated observables with observation noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-1.0036769489195396, 0.16025046993533776]
 [-1.2074661980718424, -11.753497416258641]
 [-0.9912618915102793, -14.78264578980199]
 [-1.502843226713893, -13.845106541196367]
 [-1.3884183895969595, -13.549068451587663]
 [-1.077202817300313, -12.733352313363055]
 [-0.7093335207764255, -12.427546822191738]
 [-0.7609410529194728, -12.230593864346655]
 [-0.5932027381053507, -11.309339677982006]
 [-0.8089875365652445, -10.445124743277258]
 [-1.3355629148240244, -10.18002040268775]</code></pre><p>Next we will find the log likelihood of these simulated observables using the <code>u0</code> as a prior and with the true parameters.</p><p>The new arguments we pass to the problem creation are <code>u0_prior_variance, u0_prior_mean,</code> and <code>observables</code>.  The <code>u0</code> is ignored for the filtering problem but must match the size.  The <code>KalmanFilter()</code> argument to the <code>solve</code> is unnecessary since it can select it manually given the priors and observables.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The timing convention is such that <code>observables</code> are expected to match the predictions starting at the second time period.  As the likelihood of the first element <code>u0</code> comes from a prior, the <code>observables</code> start at the next element, and hence the observables and noise sequences should be 1 less than the tspan </p></div></div><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = copy(sol.W) # save for later
u0_prior_mean = [0.0, 0.0]
# use covariance of distribution we drew from
u0_prior_var = cov(u0)

prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
sol = solve(prob, KalmanFilter())
# plot(sol) The `u` is the sequence of posterior means.
sol.logpdf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-12.132513459965521</code></pre><p>Hence the <code>logpdf</code> provides the log likelihood marginalizing out the latent noise variables.</p><p>As before, we can differentiate the kalman filter itself.</p><pre><code class="language-julia hljs">function kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
# Find the gradient wrt the A, B, C and priors variance.
gradient((A, B, C, u0_prior_var) -&gt; kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables), A, B, C, u0_prior_var)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([379.7063189589275 0.6950727289806284; 2357.4668934372417 80.26514612153436], [1.5308346412775355; 12.977595230972458;;], [-133.98635964986215 -1.045092464003469; 16.532554346799998 -2.079210525844047], [0.16720117341494817 -15.257080945549937; 13.556368063585307 1.8247671523422326])</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some of the gradients, such as those for <code>observables</code>, have not been implemented so test carefully.  This is a general theme with gradients and <code>Zygote.jl</code> in general.  Your best friend in this process is the spectacular <a href="https://github.com/JuliaDiff/ChainRulesTestUtils.jl">ChainRulesTestUtils.jl</a> package. See <code>test_rrule</code> usage in the <a href="https://github.com/SciML/DifferenceEquations.jl/blob/main/test/linear_gradients.jl">linear unit tests</a>.</p></div></div><h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>A key application of these methods is to find the joint likelihood of the latent variables (i.e., the <code>noise</code>) and the model definition.</p><p>The actual calculation of the likelihood is trivial in that case, and just requires iteration of the linear system while accumulating the likelihood given the observation noise.</p><p>Crucially, the differentiability with respect to the high-dimensional noise vector enables gradient-based sampling and estimation methods which would otherwise be infeasible.</p><pre><code class="language-julia hljs">function joint_likelihood(A, B, C, D, u0, noise, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood(A, B, C, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-7598.404690699212</code></pre><p>And as always, this can be differentiated with respect to the state-space matrices and the noise.  Choosing a few parameters,</p><pre><code class="language-julia hljs">gradient((A, u0, noise) -&gt; joint_likelihood(A, B, C, D, u0, noise, observables), A, u0, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([426.5128861485847 23.852479262038333; 2223.701163398196 158.76437702154232], [-949.5631822241555, -7595.0146180058055], [-69.89327143767109 -61.60424981359401 … -6.4054386017856455 -0.0899730620978111])</code></pre><h2 id="Composition-of-State-Space-Models-and-AD"><a class="docs-heading-anchor" href="#Composition-of-State-Space-Models-and-AD">Composition of State Space Models and AD</a><a id="Composition-of-State-Space-Models-and-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-of-State-Space-Models-and-AD" title="Permalink"></a></h2><p>While the above gradients have been with respect to the full state space objects <code>A, B</code>, etc. those themselves could be generated through a separate procedure and the whole object differentiated.  For example, lets repeat the above examples where we generate the <code>A</code> matrix from some sort of deep parameters.</p><p>First we will generate some observations with a <code>generate_model</code> proxy–-which could be replaced with something more complicated but still differentiable</p><pre><code class="language-julia hljs">function generate_model(β)
    A = [β 6.2;
        0.0  0.2]
    B = Matrix([0.0  0.001]&#39;) # [0.0; 0.001;;] gives a zygote bug
    C = [0.09 0.67;
        1.00 0.00]
    D = [0.01, 0.01]
    return (;A,B,C,D)
end

function simulate_model(β, u0;T = 200)
    mod = generate_model(β)
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, T); mod.C, observables_noise = mod.D)
    sol = solve(prob) # simulates
    observables = hcat(sol.z...)
    observables = observables[:, 2:end] # see note above on likelihood and timing
    return observables, sol.W
end

# Fix a &quot;pseudo-true&quot; and generate noise and observables
β = 0.95
u0 = [0.0, 0.0]
observables, noise = simulate_model(β, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.03570391768457254 -0.020209358882787427 … 0.023494952337486236 -0.04143227119666152; -0.11439835521279379 -0.02335117244787252 … 0.07070638591864584 0.11998922309971165], [1.3190788038519157 0.4967300282585163 … -2.359963855868355 -0.9770324156660312])</code></pre><p>Next, we will evaluate the marginal likelihood using the kalman filter for a particular <code>β</code> value,</p><pre><code class="language-julia hljs">function kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
u0_prior_mean = [0.0, 0.0]
u0_prior_var = [1e-10 0.0;
                0.0 1e-10]  # starting with degenerate prior
kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">350.6095257255651</code></pre><p>Given the observation error we would not expect the pseudo-true to exactly maximimize the log likelihood.  To show this, we can optimize it using using the Optim package and using a gradient-based optimization routine</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimJL
# Create a function to minimize only of β and use Zygote based gradients
kalman_objective(β,p) = -kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
kalman_objective(0.95, nothing)
gradient(β -&gt;kalman_objective(β, nothing),β) # Verifying it can be differentiated


optf = OptimizationFunction(kalman_objective, Optimization.AutoZygote())
β0 = [0.91] # start off of the pseudotrue
optprob = OptimizationProblem(optf, β0)
optsol = solve(optprob,LBFGS())  # reverse-mode AD is overkill here</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 1-element Vector{Float64}:
 0.015251023428915609</code></pre><p>In this way, this package composes with others such as <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">DifferentiableStateSpaceModels.jl</a> which take a set of structural parameters and an expectational difference equation and generate a state-space model.</p><p>Similarly, we can find the joint likelihood for a particular <code>β</code> value and noise.  Here we will add in prior.  Some form of a prior or regularization is generally necessary for these sorts of nonlinear models.</p><pre><code class="language-julia hljs">function joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, noise)
    return solve(prob).logpdf + sum(logpdf.(noise_prior, noise)) + logpdf(β_prior, β) # posterior
end
u0 = [0.0, 0.0]
noise_prior = Normal(0.0, 1.0)
β_prior = Normal(β, 0.03) # prior local to the true value
joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">88.02120941043887</code></pre><p>Which we can turn into a differntiable objective adding in a prior on the noise</p><pre><code class="language-julia hljs">joint_model_objective(x, p) = -joint_model_posterior(x[1], u0, Matrix(x[2:end]&#39;), observables, noise_prior, β_prior) # extract noise and parameeter from vector
x0 = vcat([0.95], noise[1,:])  # starting at the true noise
joint_model_objective(x0, nothing)
gradient(x -&gt;joint_model_objective(x, nothing),x0) # Verifying it can be differentiated

# optimize
optf = OptimizationFunction(joint_model_objective, Optimization.AutoZygote())
optprob = OptimizationProblem(optf, x0)
optsol = solve(optprob,LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 201-element Vector{Float64}:
  0.9578111688222618
 -0.10699159841985188
 -0.09633339619580997
 -0.08376241195951527
  0.00922083471861786
  0.00366864117091977
  0.10297158440244479
  0.15422192204139845
  0.14288980553339797
  0.07984156054121591
  ⋮
  0.09568679499441193
  0.1389253561004804
  0.12197183859311211
  0.11162473022373205
  0.1400071165950636
  0.16707829945776007
  0.12484786318283596
  0.06994988199935871
 -0.002806788783370749</code></pre><p>This &quot;solves&quot; the problem relatively quickly, despite the high-dimensionality.  However, from a statistics perspective note that this last optimization process does not do especially well in recovering the pseudotrue if you increase the prior variance on the <code>β</code> parameter.  Maximizing the posterior is usually the wrong thing to do in high-dimensions because the mode is not a typical set.</p><h2 id="Caveats-on-Gradients-and-Performance"><a class="docs-heading-anchor" href="#Caveats-on-Gradients-and-Performance">Caveats on Gradients and Performance</a><a id="Caveats-on-Gradients-and-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Caveats-on-Gradients-and-Performance" title="Permalink"></a></h2><p>A few notes on performance and gradients:</p><ol><li>As this is using reverse-mode AD it will be efficient for fairly large systems as long as the ultimate value of your differentiable program.  With a little extra work and unit tests, it could support structured matrices/etc. as well.</li><li>Getting to much higher scales, where the <code>A,B,C,D</code> are so large that matrix-free operators is necessary, is feasible but will require generalizing those to LinearOperators.  This would be reasonably easy for the joint likelihood and feasible but possible for the Kalman filter</li><li>At this point, there is no support for forward-mode auto-differentiation.  For smaller systems with a kalman filter, this should dominate the alternatives, and efficient forward-mode AD rules for the kalman filter exist (see the supplementary materials in the the <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">Differentiable State Space Models</a> paper).  However, it would be a significant amount of work to add end-to-end support and fulfill standard SciML interfaces, and perhaps waiting for <a href="https://enzyme.mit.edu/julia/">Enzyme</a> or similar AD systems that provide both forward/reverse/mixed mode makes sense.</li><li>Forward-mode AD is likely inappropriate for the joint-likelihood based models since the dimensionality of the noise is always large.</li><li>The gradient rules are written using <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules.jl</a> so in theory they will work with any supporting AD.  In practice, though, Zygote is the most tested and other systems have inconsistent support on Julia at this time.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a><a class="docs-footer-nextpage" href="../quadratic_state_space_examples/">Quadratic State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 18 March 2023 08:56">Saturday 18 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
