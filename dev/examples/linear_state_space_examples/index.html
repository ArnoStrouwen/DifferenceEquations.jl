<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/linear_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Linear (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Simulating-Ensembles-and-Fixing-Noise"><span>Simulating Ensembles and Fixing Noise</span></a></li><li><a class="tocitem" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><span>Observables and Marginal Likelihood using a Kalman Filter</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li><li><a class="tocitem" href="#Composition-of-State-Space-Models-and-AD"><span>Composition of State Space Models and AD</span></a></li><li><a class="tocitem" href="#Caveats-on-Gradients-and-Performance"><span>Caveats on Gradients and Performance</span></a></li></ul></li><li><a class="tocitem" href="../quadratic_state_space_examples/">Quadratic State Space Examples</a></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/linear_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-State-Space-Examples"><a class="docs-heading-anchor" href="#Linear-State-Space-Examples">Linear State Space Examples</a><a id="Linear-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-State-Space-Examples" title="Permalink"></a></h1><p>This tutorial provides describes the support for linear and linear gaussian state space models.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form of the linear model is</p><p class="math-container">\[u_{n+1} = A u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.  More generally, support could be added for <span>$u_{n+1} = A(p,n) u_n + B(p,n) w_{n+1}$</span> where <span>$p$</span> is a vector of differentiable parameters, and the <span>$A$</span> and <span>$B$</span> are potentially matrix-free operators.</p><h2 id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model">Simulating a Linear (and Time-Invariant) State Space Model</a><a id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>LinearStateSpaceProblem</code> and simulating it for a simple, linear equation.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote
A = [0.95 6.2;
     0.0  0.2]
B = [0.0; 0.01;;] # matrix
C = [0.09 0.67;
     1.00 0.00]
D = [0.1, 0.1] # diagonal observation noise
u0 = zeros(2)
T = 10

prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:10
u: 11-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [0.0, 0.0006890345972806833]
 [0.004272014503140236, 0.024757632226858166]
 [0.15755573358450387, 0.002031257720295038]
 [0.1622717447711079, -0.018285454585547138]
 [0.04078833910216023, -0.007878687770129093]
 [-0.010098942027748163, -0.01708263727262486]
 [-0.1155063460166349, 0.004404872765645494]
 [-0.08242081756880108, 0.008032239284547132]
 [-0.028499893126168796, 0.0073071250587317055]
 [0.01822927689427622, 0.009867735063375177]</code></pre><p>The <code>u</code> vector of the simulated solution can be plotted using standard recipes, including use of the optional <code>syms</code>.  See <a href="https://diffeq.sciml.ai/latest/basics/plot/">SciML docs</a> for more options.</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip690">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip690)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip691">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip690)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip692">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip690)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1387.21 2352.76,1387.21 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1139.62 2352.76,1139.62 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,892.037 2352.76,892.037 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,644.45 2352.76,644.45 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,396.863 2352.76,396.863 "/>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,149.275 2352.76,149.275 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1387.21 105.89,1387.21 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1139.62 105.89,1139.62 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,892.037 105.89,892.037 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,644.45 105.89,644.45 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,396.863 105.89,396.863 "/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,149.275 105.89,149.275 "/>
<path clip-path="url(#clip690)" d="M-86.1136 1387.66 L-56.4379 1387.66 L-56.4379 1391.6 L-86.1136 1391.6 L-86.1136 1387.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-36.3454 1373.01 Q-39.9565 1373.01 -41.7852 1376.58 Q-43.5907 1380.12 -43.5907 1387.25 Q-43.5907 1394.35 -41.7852 1397.92 Q-39.9565 1401.46 -36.3454 1401.46 Q-32.7111 1401.46 -30.9056 1397.92 Q-29.0769 1394.35 -29.0769 1387.25 Q-29.0769 1380.12 -30.9056 1376.58 Q-32.7111 1373.01 -36.3454 1373.01 M-36.3454 1369.31 Q-30.5352 1369.31 -27.4797 1373.91 Q-24.401 1378.5 -24.401 1387.25 Q-24.401 1395.97 -27.4797 1400.58 Q-30.5352 1405.16 -36.3454 1405.16 Q-42.1555 1405.16 -45.2342 1400.58 Q-48.2897 1395.97 -48.2897 1387.25 Q-48.2897 1378.5 -45.2342 1373.91 Q-42.1555 1369.31 -36.3454 1369.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-16.1834 1398.61 L-11.2992 1398.61 L-11.2992 1404.49 L-16.1834 1404.49 L-16.1834 1398.61 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-0.303895 1400.56 L7.33495 1400.56 L7.33495 1374.19 L-0.975188 1375.86 L-0.975188 1371.6 L7.28866 1369.93 L11.9646 1369.93 L11.9646 1400.56 L19.6034 1400.56 L19.6034 1404.49 L-0.303895 1404.49 L-0.303895 1400.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M39.0477 1373.01 Q35.4367 1373.01 33.608 1376.58 Q31.8024 1380.12 31.8024 1387.25 Q31.8024 1394.35 33.608 1397.92 Q35.4367 1401.46 39.0477 1401.46 Q42.682 1401.46 44.4875 1397.92 Q46.3162 1394.35 46.3162 1387.25 Q46.3162 1380.12 44.4875 1376.58 Q42.682 1373.01 39.0477 1373.01 M39.0477 1369.31 Q44.8579 1369.31 47.9134 1373.91 Q50.9921 1378.5 50.9921 1387.25 Q50.9921 1395.97 47.9134 1400.58 Q44.8579 1405.16 39.0477 1405.16 Q33.2376 1405.16 30.1589 1400.58 Q27.1034 1395.97 27.1034 1387.25 Q27.1034 1378.5 30.1589 1373.91 Q33.2376 1369.31 39.0477 1369.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-85.1183 1140.08 L-55.4425 1140.08 L-55.4425 1144.01 L-85.1183 1144.01 L-85.1183 1140.08 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-35.35 1125.42 Q-38.9611 1125.42 -40.7898 1128.99 Q-42.5953 1132.53 -42.5953 1139.66 Q-42.5953 1146.77 -40.7898 1150.33 Q-38.9611 1153.87 -35.35 1153.87 Q-31.7158 1153.87 -29.9102 1150.33 Q-28.0815 1146.77 -28.0815 1139.66 Q-28.0815 1132.53 -29.9102 1128.99 Q-31.7158 1125.42 -35.35 1125.42 M-35.35 1121.72 Q-29.5398 1121.72 -26.4843 1126.33 Q-23.4056 1130.91 -23.4056 1139.66 Q-23.4056 1148.39 -26.4843 1152.99 Q-29.5398 1157.58 -35.35 1157.58 Q-41.1602 1157.58 -44.2388 1152.99 Q-47.2944 1148.39 -47.2944 1139.66 Q-47.2944 1130.91 -44.2388 1126.33 Q-41.1602 1121.72 -35.35 1121.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-15.1881 1151.02 L-10.3038 1151.02 L-10.3038 1156.9 L-15.1881 1156.9 L-15.1881 1151.02 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M9.88124 1125.42 Q6.27014 1125.42 4.44145 1128.99 Q2.6359 1132.53 2.6359 1139.66 Q2.6359 1146.77 4.44145 1150.33 Q6.27014 1153.87 9.88124 1153.87 Q13.5155 1153.87 15.321 1150.33 Q17.1497 1146.77 17.1497 1139.66 Q17.1497 1132.53 15.321 1128.99 Q13.5155 1125.42 9.88124 1125.42 M9.88124 1121.72 Q15.6914 1121.72 18.7469 1126.33 Q21.8256 1130.91 21.8256 1139.66 Q21.8256 1148.39 18.7469 1152.99 Q15.6914 1157.58 9.88124 1157.58 Q4.07108 1157.58 0.992394 1152.99 Q-2.06315 1148.39 -2.06315 1139.66 Q-2.06315 1130.91 0.992394 1126.33 Q4.07108 1121.72 9.88124 1121.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M30.0895 1122.34 L48.4458 1122.34 L48.4458 1126.28 L34.3718 1126.28 L34.3718 1134.75 Q35.3904 1134.4 36.4089 1134.24 Q37.4274 1134.06 38.4459 1134.06 Q44.2329 1134.06 47.6125 1137.23 Q50.9921 1140.4 50.9921 1145.82 Q50.9921 1151.4 47.5199 1154.5 Q44.0477 1157.58 37.7283 1157.58 Q35.5524 1157.58 33.2839 1157.21 Q31.0385 1156.84 28.6311 1156.09 L28.6311 1151.4 Q30.7145 1152.53 32.9367 1153.09 Q35.1589 1153.64 37.6357 1153.64 Q41.6403 1153.64 43.9783 1151.53 Q46.3162 1149.43 46.3162 1145.82 Q46.3162 1142.21 43.9783 1140.1 Q41.6403 1137.99 37.6357 1137.99 Q35.7607 1137.99 33.8857 1138.41 Q32.0339 1138.83 30.0895 1139.71 L30.0895 1122.34 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-36.3454 877.836 Q-39.9565 877.836 -41.7852 881.401 Q-43.5907 884.942 -43.5907 892.072 Q-43.5907 899.178 -41.7852 902.743 Q-39.9565 906.285 -36.3454 906.285 Q-32.7111 906.285 -30.9056 902.743 Q-29.0769 899.178 -29.0769 892.072 Q-29.0769 884.942 -30.9056 881.401 Q-32.7111 877.836 -36.3454 877.836 M-36.3454 874.132 Q-30.5352 874.132 -27.4797 878.739 Q-24.401 883.322 -24.401 892.072 Q-24.401 900.799 -27.4797 905.405 Q-30.5352 909.988 -36.3454 909.988 Q-42.1555 909.988 -45.2342 905.405 Q-48.2897 900.799 -48.2897 892.072 Q-48.2897 883.322 -45.2342 878.739 Q-42.1555 874.132 -36.3454 874.132 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-16.1834 903.438 L-11.2992 903.438 L-11.2992 909.317 L-16.1834 909.317 L-16.1834 903.438 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M8.88587 877.836 Q5.27478 877.836 3.44608 881.401 Q1.64054 884.942 1.64054 892.072 Q1.64054 899.178 3.44608 902.743 Q5.27478 906.285 8.88587 906.285 Q12.5201 906.285 14.3257 902.743 Q16.1543 899.178 16.1543 892.072 Q16.1543 884.942 14.3257 881.401 Q12.5201 877.836 8.88587 877.836 M8.88587 874.132 Q14.696 874.132 17.7516 878.739 Q20.8303 883.322 20.8303 892.072 Q20.8303 900.799 17.7516 905.405 Q14.696 909.988 8.88587 909.988 Q3.07572 909.988 -0.00297114 905.405 Q-3.05851 900.799 -3.05851 892.072 Q-3.05851 883.322 -0.00297114 878.739 Q3.07572 874.132 8.88587 874.132 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M39.0477 877.836 Q35.4367 877.836 33.608 881.401 Q31.8024 884.942 31.8024 892.072 Q31.8024 899.178 33.608 902.743 Q35.4367 906.285 39.0477 906.285 Q42.682 906.285 44.4875 902.743 Q46.3162 899.178 46.3162 892.072 Q46.3162 884.942 44.4875 881.401 Q42.682 877.836 39.0477 877.836 M39.0477 874.132 Q44.8579 874.132 47.9134 878.739 Q50.9921 883.322 50.9921 892.072 Q50.9921 900.799 47.9134 905.405 Q44.8579 909.988 39.0477 909.988 Q33.2376 909.988 30.1589 905.405 Q27.1034 900.799 27.1034 892.072 Q27.1034 883.322 30.1589 878.739 Q33.2376 874.132 39.0477 874.132 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-35.35 630.249 Q-38.9611 630.249 -40.7898 633.813 Q-42.5953 637.355 -42.5953 644.485 Q-42.5953 651.591 -40.7898 655.156 Q-38.9611 658.697 -35.35 658.697 Q-31.7158 658.697 -29.9102 655.156 Q-28.0815 651.591 -28.0815 644.485 Q-28.0815 637.355 -29.9102 633.813 Q-31.7158 630.249 -35.35 630.249 M-35.35 626.545 Q-29.5398 626.545 -26.4843 631.151 Q-23.4056 635.735 -23.4056 644.485 Q-23.4056 653.211 -26.4843 657.818 Q-29.5398 662.401 -35.35 662.401 Q-41.1602 662.401 -44.2388 657.818 Q-47.2944 653.211 -47.2944 644.485 Q-47.2944 635.735 -44.2388 631.151 Q-41.1602 626.545 -35.35 626.545 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-15.1881 655.85 L-10.3038 655.85 L-10.3038 661.73 L-15.1881 661.73 L-15.1881 655.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M9.88124 630.249 Q6.27014 630.249 4.44145 633.813 Q2.6359 637.355 2.6359 644.485 Q2.6359 651.591 4.44145 655.156 Q6.27014 658.697 9.88124 658.697 Q13.5155 658.697 15.321 655.156 Q17.1497 651.591 17.1497 644.485 Q17.1497 637.355 15.321 633.813 Q13.5155 630.249 9.88124 630.249 M9.88124 626.545 Q15.6914 626.545 18.7469 631.151 Q21.8256 635.735 21.8256 644.485 Q21.8256 653.211 18.7469 657.818 Q15.6914 662.401 9.88124 662.401 Q4.07108 662.401 0.992394 657.818 Q-2.06315 653.211 -2.06315 644.485 Q-2.06315 635.735 0.992394 631.151 Q4.07108 626.545 9.88124 626.545 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M30.0895 627.17 L48.4458 627.17 L48.4458 631.105 L34.3718 631.105 L34.3718 639.577 Q35.3904 639.23 36.4089 639.068 Q37.4274 638.883 38.4459 638.883 Q44.2329 638.883 47.6125 642.054 Q50.9921 645.225 50.9921 650.642 Q50.9921 656.221 47.5199 659.322 Q44.0477 662.401 37.7283 662.401 Q35.5524 662.401 33.2839 662.031 Q31.0385 661.66 28.6311 660.92 L28.6311 656.221 Q30.7145 657.355 32.9367 657.91 Q35.1589 658.466 37.6357 658.466 Q41.6403 658.466 43.9783 656.36 Q46.3162 654.253 46.3162 650.642 Q46.3162 647.031 43.9783 644.924 Q41.6403 642.818 37.6357 642.818 Q35.7607 642.818 33.8857 643.235 Q32.0339 643.651 30.0895 644.531 L30.0895 627.17 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-36.3454 382.661 Q-39.9565 382.661 -41.7852 386.226 Q-43.5907 389.768 -43.5907 396.897 Q-43.5907 404.004 -41.7852 407.569 Q-39.9565 411.11 -36.3454 411.11 Q-32.7111 411.11 -30.9056 407.569 Q-29.0769 404.004 -29.0769 396.897 Q-29.0769 389.768 -30.9056 386.226 Q-32.7111 382.661 -36.3454 382.661 M-36.3454 378.958 Q-30.5352 378.958 -27.4797 383.564 Q-24.401 388.147 -24.401 396.897 Q-24.401 405.624 -27.4797 410.231 Q-30.5352 414.814 -36.3454 414.814 Q-42.1555 414.814 -45.2342 410.231 Q-48.2897 405.624 -48.2897 396.897 Q-48.2897 388.147 -45.2342 383.564 Q-42.1555 378.958 -36.3454 378.958 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-16.1834 408.263 L-11.2992 408.263 L-11.2992 414.143 L-16.1834 414.143 L-16.1834 408.263 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-0.303895 410.207 L7.33495 410.207 L7.33495 383.842 L-0.975188 385.508 L-0.975188 381.249 L7.28866 379.583 L11.9646 379.583 L11.9646 410.207 L19.6034 410.207 L19.6034 414.143 L-0.303895 414.143 L-0.303895 410.207 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M39.0477 382.661 Q35.4367 382.661 33.608 386.226 Q31.8024 389.768 31.8024 396.897 Q31.8024 404.004 33.608 407.569 Q35.4367 411.11 39.0477 411.11 Q42.682 411.11 44.4875 407.569 Q46.3162 404.004 46.3162 396.897 Q46.3162 389.768 44.4875 386.226 Q42.682 382.661 39.0477 382.661 M39.0477 378.958 Q44.8579 378.958 47.9134 383.564 Q50.9921 388.147 50.9921 396.897 Q50.9921 405.624 47.9134 410.231 Q44.8579 414.814 39.0477 414.814 Q33.2376 414.814 30.1589 410.231 Q27.1034 405.624 27.1034 396.897 Q27.1034 388.147 30.1589 383.564 Q33.2376 378.958 39.0477 378.958 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-35.35 135.074 Q-38.9611 135.074 -40.7898 138.639 Q-42.5953 142.18 -42.5953 149.31 Q-42.5953 156.416 -40.7898 159.981 Q-38.9611 163.523 -35.35 163.523 Q-31.7158 163.523 -29.9102 159.981 Q-28.0815 156.416 -28.0815 149.31 Q-28.0815 142.18 -29.9102 138.639 Q-31.7158 135.074 -35.35 135.074 M-35.35 131.37 Q-29.5398 131.37 -26.4843 135.977 Q-23.4056 140.56 -23.4056 149.31 Q-23.4056 158.037 -26.4843 162.643 Q-29.5398 167.227 -35.35 167.227 Q-41.1602 167.227 -44.2388 162.643 Q-47.2944 158.037 -47.2944 149.31 Q-47.2944 140.56 -44.2388 135.977 Q-41.1602 131.37 -35.35 131.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M-15.1881 160.676 L-10.3038 160.676 L-10.3038 166.555 L-15.1881 166.555 L-15.1881 160.676 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M0.69147 162.62 L8.33032 162.62 L8.33032 136.254 L0.0201769 137.921 L0.0201769 133.662 L8.28402 131.995 L12.9599 131.995 L12.9599 162.62 L20.5988 162.62 L20.5988 166.555 L0.69147 166.555 L0.69147 162.62 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip690)" d="M30.0895 131.995 L48.4458 131.995 L48.4458 135.93 L34.3718 135.93 L34.3718 144.403 Q35.3904 144.055 36.4089 143.893 Q37.4274 143.708 38.4459 143.708 Q44.2329 143.708 47.6125 146.879 Q50.9921 150.051 50.9921 155.467 Q50.9921 161.046 47.5199 164.148 Q44.0477 167.227 37.7283 167.227 Q35.5524 167.227 33.2839 166.856 Q31.0385 166.486 28.6311 165.745 L28.6311 161.046 Q30.7145 162.18 32.9367 162.736 Q35.1589 163.291 37.6357 163.291 Q41.6403 163.291 43.9783 161.185 Q46.3162 159.078 46.3162 155.467 Q46.3162 151.856 43.9783 149.75 Q41.6403 147.643 37.6357 147.643 Q35.7607 147.643 33.8857 148.06 Q32.0339 148.477 30.0895 149.356 L30.0895 131.995 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip692)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,892.037 313.569,892.037 540.145,870.883 766.721,111.861 993.298,88.5087 1219.87,690.064 1446.45,942.045 1673.03,1464 1899.6,1300.16 2126.18,1033.16 2352.76,801.77 "/>
<polyline clip-path="url(#clip692)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,892.037 313.569,888.625 540.145,769.444 766.721,881.979 993.298,982.582 1219.87,931.05 1446.45,976.626 1673.03,870.225 1899.6,852.264 2126.18,855.854 2352.76,843.175 "/>
<path clip-path="url(#clip690)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip690)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip690)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip690)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip690)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>By default the solution provides an interface to access the simulated <code>u</code>.  That is, <code>sol.u[...] = sol[...]</code>,</p><pre><code class="language-julia hljs">sol[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.0
 0.0006890345972806833</code></pre><p>Or to get the first element of the last step</p><pre><code class="language-julia hljs">sol[end][1] #first element of last step</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.01822927689427622</code></pre><p>Finally, to extract the full vector</p><pre><code class="language-julia hljs">@show sol[2,:];  # whole second vector</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
  0.0006890345972806833
  0.024757632226858166
  0.002031257720295038
 -0.018285454585547138
 -0.007878687770129093
 -0.01708263727262486
  0.004404872765645494
  0.008032239284547132
  0.0073071250587317055
  0.009867735063375177</code></pre><p>The results for all of <code>sol.u</code> can be loaded in a dataframe, where the column names will be the (optionally) provided symbols.</p><pre><code class="language-julia hljs">df = DataFrame(sol)</code></pre><div><div style = "float: left;"><span>11×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">timestamp</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.000689035</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.00427201</td><td style = "text-align: right;">0.0247576</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.157556</td><td style = "text-align: right;">0.00203126</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.162272</td><td style = "text-align: right;">-0.0182855</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.0407883</td><td style = "text-align: right;">-0.00787869</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">6</td><td style = "text-align: right;">-0.0100989</td><td style = "text-align: right;">-0.0170826</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">7</td><td style = "text-align: right;">-0.115506</td><td style = "text-align: right;">0.00440487</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">8</td><td style = "text-align: right;">-0.0824208</td><td style = "text-align: right;">0.00803224</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">9</td><td style = "text-align: right;">-0.0284999</td><td style = "text-align: right;">0.00730713</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">10</td><td style = "text-align: right;">0.0182293</td><td style = "text-align: right;">0.00986774</td></tr></tbody></table></div><p>Other results, such as the simulated noise and observables can be extracted from the solution</p><pre><code class="language-julia hljs">sol.z # observables</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-0.24542748797764272, -0.20311810704287375]
 [-0.4191755674250531, 0.5581942311825024]
 [-0.08133429611464046, 0.07113905273803879]
 [0.5111247785982513, 0.06932311649287226]
 [-0.07096311241916019, 0.12644555315331243]
 [-0.4616869465916447, -0.14668390133230555]
 [-0.22084436084657527, 0.26912176484464867]
 [0.0683646828719788, 0.21271260046878365]
 [-0.1363869447383272, -0.06588943208549172]
 [-0.28240459424182907, -0.4402143285794025]
 [0.09308862422993044, 0.29904408102964186]</code></pre><pre><code class="language-julia hljs">sol.W # Simulated Noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10 Matrix{Float64}:
 0.0689035  2.46198  -0.292027  -1.86917  …  0.715126  0.570068  0.840631</code></pre><p>We can also solve the model passing in fixed noise, which will be useful for joint likelihoods.  First lets extract the noise from the previous solution, then rerun the simulation but with a different initial value</p><pre><code class="language-julia hljs">noise = sol.W
u0_2 = [0.1, 0.0]
prob2 = LinearStateSpaceProblem(A, B, u0_2, (0, T); C, observables_noise = D, syms = [:a, :b], noise)
sol2 = solve(prob2)
plot(sol2)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip750">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip750)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip751">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip750)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip752">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip750)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1484.56 2352.76,1484.56 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1246.91 2352.76,1246.91 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1009.27 2352.76,1009.27 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,771.617 2352.76,771.617 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,533.969 2352.76,533.969 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,296.32 2352.76,296.32 "/>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,58.6713 2352.76,58.6713 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1484.56 105.89,1484.56 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1246.91 105.89,1246.91 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1009.27 105.89,1009.27 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,771.617 105.89,771.617 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,533.969 105.89,533.969 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,296.32 105.89,296.32 "/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,58.6713 105.89,58.6713 "/>
<path clip-path="url(#clip750)" d="M-85.1183 1485.01 L-55.4425 1485.01 L-55.4425 1488.95 L-85.1183 1488.95 L-85.1183 1485.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 1470.36 Q-38.9611 1470.36 -40.7898 1473.93 Q-42.5953 1477.47 -42.5953 1484.6 Q-42.5953 1491.7 -40.7898 1495.27 Q-38.9611 1498.81 -35.35 1498.81 Q-31.7158 1498.81 -29.9102 1495.27 Q-28.0815 1491.7 -28.0815 1484.6 Q-28.0815 1477.47 -29.9102 1473.93 Q-31.7158 1470.36 -35.35 1470.36 M-35.35 1466.66 Q-29.5398 1466.66 -26.4843 1471.26 Q-23.4056 1475.85 -23.4056 1484.6 Q-23.4056 1493.32 -26.4843 1497.93 Q-29.5398 1502.51 -35.35 1502.51 Q-41.1602 1502.51 -44.2388 1497.93 Q-47.2944 1493.32 -47.2944 1484.6 Q-47.2944 1475.85 -44.2388 1471.26 Q-41.1602 1466.66 -35.35 1466.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 1495.96 L-10.3038 1495.96 L-10.3038 1501.84 L-15.1881 1501.84 L-15.1881 1495.96 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M9.88124 1470.36 Q6.27014 1470.36 4.44145 1473.93 Q2.6359 1477.47 2.6359 1484.6 Q2.6359 1491.7 4.44145 1495.27 Q6.27014 1498.81 9.88124 1498.81 Q13.5155 1498.81 15.321 1495.27 Q17.1497 1491.7 17.1497 1484.6 Q17.1497 1477.47 15.321 1473.93 Q13.5155 1470.36 9.88124 1470.36 M9.88124 1466.66 Q15.6914 1466.66 18.7469 1471.26 Q21.8256 1475.85 21.8256 1484.6 Q21.8256 1493.32 18.7469 1497.93 Q15.6914 1502.51 9.88124 1502.51 Q4.07108 1502.51 0.992394 1497.93 Q-2.06315 1493.32 -2.06315 1484.6 Q-2.06315 1475.85 0.992394 1471.26 Q4.07108 1466.66 9.88124 1466.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 1467.28 L48.4458 1467.28 L48.4458 1471.22 L34.3718 1471.22 L34.3718 1479.69 Q35.3904 1479.34 36.4089 1479.18 Q37.4274 1479 38.4459 1479 Q44.2329 1479 47.6125 1482.17 Q50.9921 1485.34 50.9921 1490.76 Q50.9921 1496.33 47.5199 1499.44 Q44.0477 1502.51 37.7283 1502.51 Q35.5524 1502.51 33.2839 1502.14 Q31.0385 1501.77 28.6311 1501.03 L28.6311 1496.33 Q30.7145 1497.47 32.9367 1498.02 Q35.1589 1498.58 37.6357 1498.58 Q41.6403 1498.58 43.9783 1496.47 Q46.3162 1494.37 46.3162 1490.76 Q46.3162 1487.14 43.9783 1485.04 Q41.6403 1482.93 37.6357 1482.93 Q35.7607 1482.93 33.8857 1483.35 Q32.0339 1483.76 30.0895 1484.64 L30.0895 1467.28 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-36.3454 1232.71 Q-39.9565 1232.71 -41.7852 1236.28 Q-43.5907 1239.82 -43.5907 1246.95 Q-43.5907 1254.06 -41.7852 1257.62 Q-39.9565 1261.16 -36.3454 1261.16 Q-32.7111 1261.16 -30.9056 1257.62 Q-29.0769 1254.06 -29.0769 1246.95 Q-29.0769 1239.82 -30.9056 1236.28 Q-32.7111 1232.71 -36.3454 1232.71 M-36.3454 1229.01 Q-30.5352 1229.01 -27.4797 1233.62 Q-24.401 1238.2 -24.401 1246.95 Q-24.401 1255.68 -27.4797 1260.28 Q-30.5352 1264.87 -36.3454 1264.87 Q-42.1555 1264.87 -45.2342 1260.28 Q-48.2897 1255.68 -48.2897 1246.95 Q-48.2897 1238.2 -45.2342 1233.62 Q-42.1555 1229.01 -36.3454 1229.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-16.1834 1258.31 L-11.2992 1258.31 L-11.2992 1264.19 L-16.1834 1264.19 L-16.1834 1258.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M8.88587 1232.71 Q5.27478 1232.71 3.44608 1236.28 Q1.64054 1239.82 1.64054 1246.95 Q1.64054 1254.06 3.44608 1257.62 Q5.27478 1261.16 8.88587 1261.16 Q12.5201 1261.16 14.3257 1257.62 Q16.1543 1254.06 16.1543 1246.95 Q16.1543 1239.82 14.3257 1236.28 Q12.5201 1232.71 8.88587 1232.71 M8.88587 1229.01 Q14.696 1229.01 17.7516 1233.62 Q20.8303 1238.2 20.8303 1246.95 Q20.8303 1255.68 17.7516 1260.28 Q14.696 1264.87 8.88587 1264.87 Q3.07572 1264.87 -0.00297114 1260.28 Q-3.05851 1255.68 -3.05851 1246.95 Q-3.05851 1238.2 -0.00297114 1233.62 Q3.07572 1229.01 8.88587 1229.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 1232.71 Q35.4367 1232.71 33.608 1236.28 Q31.8024 1239.82 31.8024 1246.95 Q31.8024 1254.06 33.608 1257.62 Q35.4367 1261.16 39.0477 1261.16 Q42.682 1261.16 44.4875 1257.62 Q46.3162 1254.06 46.3162 1246.95 Q46.3162 1239.82 44.4875 1236.28 Q42.682 1232.71 39.0477 1232.71 M39.0477 1229.01 Q44.8579 1229.01 47.9134 1233.62 Q50.9921 1238.2 50.9921 1246.95 Q50.9921 1255.68 47.9134 1260.28 Q44.8579 1264.87 39.0477 1264.87 Q33.2376 1264.87 30.1589 1260.28 Q27.1034 1255.68 27.1034 1246.95 Q27.1034 1238.2 30.1589 1233.62 Q33.2376 1229.01 39.0477 1229.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 995.065 Q-38.9611 995.065 -40.7898 998.629 Q-42.5953 1002.17 -42.5953 1009.3 Q-42.5953 1016.41 -40.7898 1019.97 Q-38.9611 1023.51 -35.35 1023.51 Q-31.7158 1023.51 -29.9102 1019.97 Q-28.0815 1016.41 -28.0815 1009.3 Q-28.0815 1002.17 -29.9102 998.629 Q-31.7158 995.065 -35.35 995.065 M-35.35 991.361 Q-29.5398 991.361 -26.4843 995.967 Q-23.4056 1000.55 -23.4056 1009.3 Q-23.4056 1018.03 -26.4843 1022.63 Q-29.5398 1027.22 -35.35 1027.22 Q-41.1602 1027.22 -44.2388 1022.63 Q-47.2944 1018.03 -47.2944 1009.3 Q-47.2944 1000.55 -44.2388 995.967 Q-41.1602 991.361 -35.35 991.361 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 1020.67 L-10.3038 1020.67 L-10.3038 1026.55 L-15.1881 1026.55 L-15.1881 1020.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M9.88124 995.065 Q6.27014 995.065 4.44145 998.629 Q2.6359 1002.17 2.6359 1009.3 Q2.6359 1016.41 4.44145 1019.97 Q6.27014 1023.51 9.88124 1023.51 Q13.5155 1023.51 15.321 1019.97 Q17.1497 1016.41 17.1497 1009.3 Q17.1497 1002.17 15.321 998.629 Q13.5155 995.065 9.88124 995.065 M9.88124 991.361 Q15.6914 991.361 18.7469 995.967 Q21.8256 1000.55 21.8256 1009.3 Q21.8256 1018.03 18.7469 1022.63 Q15.6914 1027.22 9.88124 1027.22 Q4.07108 1027.22 0.992394 1022.63 Q-2.06315 1018.03 -2.06315 1009.3 Q-2.06315 1000.55 0.992394 995.967 Q4.07108 991.361 9.88124 991.361 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 991.986 L48.4458 991.986 L48.4458 995.921 L34.3718 995.921 L34.3718 1004.39 Q35.3904 1004.05 36.4089 1003.88 Q37.4274 1003.7 38.4459 1003.7 Q44.2329 1003.7 47.6125 1006.87 Q50.9921 1010.04 50.9921 1015.46 Q50.9921 1021.04 47.5199 1024.14 Q44.0477 1027.22 37.7283 1027.22 Q35.5524 1027.22 33.2839 1026.85 Q31.0385 1026.48 28.6311 1025.74 L28.6311 1021.04 Q30.7145 1022.17 32.9367 1022.73 Q35.1589 1023.28 37.6357 1023.28 Q41.6403 1023.28 43.9783 1021.18 Q46.3162 1019.07 46.3162 1015.46 Q46.3162 1011.85 43.9783 1009.74 Q41.6403 1007.63 37.6357 1007.63 Q35.7607 1007.63 33.8857 1008.05 Q32.0339 1008.47 30.0895 1009.35 L30.0895 991.986 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-36.3454 757.416 Q-39.9565 757.416 -41.7852 760.981 Q-43.5907 764.522 -43.5907 771.652 Q-43.5907 778.758 -41.7852 782.323 Q-39.9565 785.865 -36.3454 785.865 Q-32.7111 785.865 -30.9056 782.323 Q-29.0769 778.758 -29.0769 771.652 Q-29.0769 764.522 -30.9056 760.981 Q-32.7111 757.416 -36.3454 757.416 M-36.3454 753.712 Q-30.5352 753.712 -27.4797 758.319 Q-24.401 762.902 -24.401 771.652 Q-24.401 780.379 -27.4797 784.985 Q-30.5352 789.569 -36.3454 789.569 Q-42.1555 789.569 -45.2342 784.985 Q-48.2897 780.379 -48.2897 771.652 Q-48.2897 762.902 -45.2342 758.319 Q-42.1555 753.712 -36.3454 753.712 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-16.1834 783.018 L-11.2992 783.018 L-11.2992 788.897 L-16.1834 788.897 L-16.1834 783.018 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-0.303895 784.962 L7.33495 784.962 L7.33495 758.596 L-0.975188 760.263 L-0.975188 756.004 L7.28866 754.337 L11.9646 754.337 L11.9646 784.962 L19.6034 784.962 L19.6034 788.897 L-0.303895 788.897 L-0.303895 784.962 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 757.416 Q35.4367 757.416 33.608 760.981 Q31.8024 764.522 31.8024 771.652 Q31.8024 778.758 33.608 782.323 Q35.4367 785.865 39.0477 785.865 Q42.682 785.865 44.4875 782.323 Q46.3162 778.758 46.3162 771.652 Q46.3162 764.522 44.4875 760.981 Q42.682 757.416 39.0477 757.416 M39.0477 753.712 Q44.8579 753.712 47.9134 758.319 Q50.9921 762.902 50.9921 771.652 Q50.9921 780.379 47.9134 784.985 Q44.8579 789.569 39.0477 789.569 Q33.2376 789.569 30.1589 784.985 Q27.1034 780.379 27.1034 771.652 Q27.1034 762.902 30.1589 758.319 Q33.2376 753.712 39.0477 753.712 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 519.767 Q-38.9611 519.767 -40.7898 523.332 Q-42.5953 526.874 -42.5953 534.003 Q-42.5953 541.11 -40.7898 544.675 Q-38.9611 548.216 -35.35 548.216 Q-31.7158 548.216 -29.9102 544.675 Q-28.0815 541.11 -28.0815 534.003 Q-28.0815 526.874 -29.9102 523.332 Q-31.7158 519.767 -35.35 519.767 M-35.35 516.064 Q-29.5398 516.064 -26.4843 520.67 Q-23.4056 525.253 -23.4056 534.003 Q-23.4056 542.73 -26.4843 547.337 Q-29.5398 551.92 -35.35 551.92 Q-41.1602 551.92 -44.2388 547.337 Q-47.2944 542.73 -47.2944 534.003 Q-47.2944 525.253 -44.2388 520.67 Q-41.1602 516.064 -35.35 516.064 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 545.369 L-10.3038 545.369 L-10.3038 551.249 L-15.1881 551.249 L-15.1881 545.369 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M0.69147 547.313 L8.33032 547.313 L8.33032 520.948 L0.0201769 522.614 L0.0201769 518.355 L8.28402 516.689 L12.9599 516.689 L12.9599 547.313 L20.5988 547.313 L20.5988 551.249 L0.69147 551.249 L0.69147 547.313 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 516.689 L48.4458 516.689 L48.4458 520.624 L34.3718 520.624 L34.3718 529.096 Q35.3904 528.749 36.4089 528.587 Q37.4274 528.401 38.4459 528.401 Q44.2329 528.401 47.6125 531.573 Q50.9921 534.744 50.9921 540.161 Q50.9921 545.739 47.5199 548.841 Q44.0477 551.92 37.7283 551.92 Q35.5524 551.92 33.2839 551.55 Q31.0385 551.179 28.6311 550.438 L28.6311 545.739 Q30.7145 546.874 32.9367 547.429 Q35.1589 547.985 37.6357 547.985 Q41.6403 547.985 43.9783 545.878 Q46.3162 543.772 46.3162 540.161 Q46.3162 536.55 43.9783 534.443 Q41.6403 532.337 37.6357 532.337 Q35.7607 532.337 33.8857 532.753 Q32.0339 533.17 30.0895 534.05 L30.0895 516.689 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-36.3454 282.119 Q-39.9565 282.119 -41.7852 285.683 Q-43.5907 289.225 -43.5907 296.355 Q-43.5907 303.461 -41.7852 307.026 Q-39.9565 310.568 -36.3454 310.568 Q-32.7111 310.568 -30.9056 307.026 Q-29.0769 303.461 -29.0769 296.355 Q-29.0769 289.225 -30.9056 285.683 Q-32.7111 282.119 -36.3454 282.119 M-36.3454 278.415 Q-30.5352 278.415 -27.4797 283.021 Q-24.401 287.605 -24.401 296.355 Q-24.401 305.081 -27.4797 309.688 Q-30.5352 314.271 -36.3454 314.271 Q-42.1555 314.271 -45.2342 309.688 Q-48.2897 305.081 -48.2897 296.355 Q-48.2897 287.605 -45.2342 283.021 Q-42.1555 278.415 -36.3454 278.415 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-16.1834 307.72 L-11.2992 307.72 L-11.2992 313.6 L-16.1834 313.6 L-16.1834 307.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M2.91368 309.665 L19.233 309.665 L19.233 313.6 L-2.71129 313.6 L-2.71129 309.665 Q-0.0492672 306.91 4.53404 302.281 Q9.1405 297.628 10.321 296.285 Q12.5664 293.762 13.446 292.026 Q14.3488 290.267 14.3488 288.577 Q14.3488 285.822 12.4044 284.086 Q10.4831 282.35 7.38125 282.35 Q5.18219 282.35 2.7285 283.114 Q0.297953 283.878 -2.47981 285.429 L-2.47981 280.707 Q0.344249 279.572 2.79794 278.994 Q5.25163 278.415 7.28866 278.415 Q12.659 278.415 15.8534 281.1 Q19.0479 283.785 19.0479 288.276 Q19.0479 290.406 18.2377 292.327 Q17.4506 294.225 15.3442 296.818 Q14.7655 297.489 11.6636 300.706 Q8.5618 303.901 2.91368 309.665 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M39.0477 282.119 Q35.4367 282.119 33.608 285.683 Q31.8024 289.225 31.8024 296.355 Q31.8024 303.461 33.608 307.026 Q35.4367 310.568 39.0477 310.568 Q42.682 310.568 44.4875 307.026 Q46.3162 303.461 46.3162 296.355 Q46.3162 289.225 44.4875 285.683 Q42.682 282.119 39.0477 282.119 M39.0477 278.415 Q44.8579 278.415 47.9134 283.021 Q50.9921 287.605 50.9921 296.355 Q50.9921 305.081 47.9134 309.688 Q44.8579 314.271 39.0477 314.271 Q33.2376 314.271 30.1589 309.688 Q27.1034 305.081 27.1034 296.355 Q27.1034 287.605 30.1589 283.021 Q33.2376 278.415 39.0477 278.415 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-35.35 44.47 Q-38.9611 44.47 -40.7898 48.0348 Q-42.5953 51.5764 -42.5953 58.706 Q-42.5953 65.8124 -40.7898 69.3772 Q-38.9611 72.9189 -35.35 72.9189 Q-31.7158 72.9189 -29.9102 69.3772 Q-28.0815 65.8124 -28.0815 58.706 Q-28.0815 51.5764 -29.9102 48.0348 Q-31.7158 44.47 -35.35 44.47 M-35.35 40.7663 Q-29.5398 40.7663 -26.4843 45.3727 Q-23.4056 49.9561 -23.4056 58.706 Q-23.4056 67.4328 -26.4843 72.0393 Q-29.5398 76.6226 -35.35 76.6226 Q-41.1602 76.6226 -44.2388 72.0393 Q-47.2944 67.4328 -47.2944 58.706 Q-47.2944 49.9561 -44.2388 45.3727 Q-41.1602 40.7663 -35.35 40.7663 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M-15.1881 70.0717 L-10.3038 70.0717 L-10.3038 75.9513 L-15.1881 75.9513 L-15.1881 70.0717 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M3.90904 72.0161 L20.2284 72.0161 L20.2284 75.9513 L-1.71592 75.9513 L-1.71592 72.0161 Q0.946098 69.2615 5.52941 64.6319 Q10.1359 59.9791 11.3164 58.6366 Q13.5618 56.1134 14.4414 54.3773 Q15.3442 52.6181 15.3442 50.9283 Q15.3442 48.1737 13.3997 46.4376 Q11.4784 44.7015 8.37661 44.7015 Q6.17755 44.7015 3.72386 45.4653 Q1.29332 46.2292 -1.48444 47.7801 L-1.48444 43.0579 Q1.33961 41.9237 3.7933 41.345 Q6.247 40.7663 8.28402 40.7663 Q13.6544 40.7663 16.8488 43.4515 Q20.0432 46.1366 20.0432 50.6273 Q20.0432 52.757 19.233 54.6783 Q18.446 56.5764 16.3395 59.169 Q15.7608 59.8403 12.659 63.0578 Q9.55716 66.2523 3.90904 72.0161 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip750)" d="M30.0895 41.3913 L48.4458 41.3913 L48.4458 45.3264 L34.3718 45.3264 L34.3718 53.7986 Q35.3904 53.4514 36.4089 53.2894 Q37.4274 53.1042 38.4459 53.1042 Q44.2329 53.1042 47.6125 56.2755 Q50.9921 59.4467 50.9921 64.8634 Q50.9921 70.4421 47.5199 73.5439 Q44.0477 76.6226 37.7283 76.6226 Q35.5524 76.6226 33.2839 76.2522 Q31.0385 75.8818 28.6311 75.1411 L28.6311 70.4421 Q30.7145 71.5763 32.9367 72.1319 Q35.1589 72.6874 37.6357 72.6874 Q41.6403 72.6874 43.9783 70.5809 Q46.3162 68.4745 46.3162 64.8634 Q46.3162 61.2523 43.9783 59.1458 Q41.6403 57.0393 37.6357 57.0393 Q35.7607 57.0393 33.8857 57.456 Q32.0339 57.8727 30.0895 58.7523 L30.0895 41.3913 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip752)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,771.617 313.569,795.382 540.145,797.654 766.721,90.5484 993.298,88.5087 1219.87,685.273 1446.45,945.527 1673.03,1464 1899.6,1323.34 2126.18,1082.82 2352.76,875.693 "/>
<polyline clip-path="url(#clip752)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1246.91 313.569,1243.64 540.145,1129.24 766.721,1237.26 993.298,1333.82 1219.87,1284.36 1446.45,1328.11 1673.03,1225.98 1899.6,1208.74 2126.18,1212.18 2352.76,1200.01 "/>
<path clip-path="url(#clip750)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip750)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip750)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip750)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip750)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>To construct an IRF we can take the model and perturb just the first element of the noise,</p><pre><code class="language-julia hljs">function irf(A, B, C, T = 20)
    noise = Matrix([1.0; zeros(T-1)]&#39;)
    problem = LinearStateSpaceProblem(A, B, zeros(2), (0, T); C, noise, syms = [:a, :b])
    return solve(problem)
end
plot(irf(A, B, C))</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip810">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip810)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip811">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip810)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip812">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="653.433,1505.26 653.433,47.2441 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1505.26 1219.87,47.2441 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1786.31,1505.26 1786.31,47.2441 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="653.433,1505.26 653.433,1486.36 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1505.26 1219.87,1486.36 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1786.31,1505.26 1786.31,1486.36 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip810)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M643.711 1533.1 L662.067 1533.1 L662.067 1537.04 L647.993 1537.04 L647.993 1545.51 Q649.012 1545.16 650.03 1545 Q651.049 1544.81 652.067 1544.81 Q657.854 1544.81 661.234 1547.98 Q664.614 1551.16 664.614 1556.57 Q664.614 1562.15 661.141 1565.25 Q657.669 1568.33 651.35 1568.33 Q649.174 1568.33 646.905 1567.96 Q644.66 1567.59 642.253 1566.85 L642.253 1562.15 Q644.336 1563.28 646.558 1563.84 Q648.78 1564.4 651.257 1564.4 Q655.262 1564.4 657.6 1562.29 Q659.938 1560.18 659.938 1556.57 Q659.938 1552.96 657.6 1550.85 Q655.262 1548.75 651.257 1548.75 Q649.382 1548.75 647.507 1549.16 Q645.655 1549.58 643.711 1550.46 L643.711 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M1194.56 1563.72 L1202.2 1563.72 L1202.2 1537.36 L1193.89 1539.03 L1193.89 1534.77 L1202.15 1533.1 L1206.83 1533.1 L1206.83 1563.72 L1214.47 1563.72 L1214.47 1567.66 L1194.56 1567.66 L1194.56 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M1233.91 1536.18 Q1230.3 1536.18 1228.47 1539.74 Q1226.67 1543.28 1226.67 1550.41 Q1226.67 1557.52 1228.47 1561.09 Q1230.3 1564.63 1233.91 1564.63 Q1237.55 1564.63 1239.35 1561.09 Q1241.18 1557.52 1241.18 1550.41 Q1241.18 1543.28 1239.35 1539.74 Q1237.55 1536.18 1233.91 1536.18 M1233.91 1532.47 Q1239.72 1532.47 1242.78 1537.08 Q1245.86 1541.66 1245.86 1550.41 Q1245.86 1559.14 1242.78 1563.75 Q1239.72 1568.33 1233.91 1568.33 Q1228.1 1568.33 1225.02 1563.75 Q1221.97 1559.14 1221.97 1550.41 Q1221.97 1541.66 1225.02 1537.08 Q1228.1 1532.47 1233.91 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M1761.5 1563.72 L1769.14 1563.72 L1769.14 1537.36 L1760.83 1539.03 L1760.83 1534.77 L1769.09 1533.1 L1773.77 1533.1 L1773.77 1563.72 L1781.41 1563.72 L1781.41 1567.66 L1761.5 1567.66 L1761.5 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M1790.9 1533.1 L1809.25 1533.1 L1809.25 1537.04 L1795.18 1537.04 L1795.18 1545.51 Q1796.2 1545.16 1797.22 1545 Q1798.24 1544.81 1799.25 1544.81 Q1805.04 1544.81 1808.42 1547.98 Q1811.8 1551.16 1811.8 1556.57 Q1811.8 1562.15 1808.33 1565.25 Q1804.86 1568.33 1798.54 1568.33 Q1796.36 1568.33 1794.09 1567.96 Q1791.85 1567.59 1789.44 1566.85 L1789.44 1562.15 Q1791.52 1563.28 1793.75 1563.84 Q1795.97 1564.4 1798.44 1564.4 Q1802.45 1564.4 1804.79 1562.29 Q1807.13 1560.18 1807.13 1556.57 Q1807.13 1552.96 1804.79 1550.85 Q1802.45 1548.75 1798.44 1548.75 Q1796.57 1548.75 1794.69 1549.16 Q1792.84 1549.58 1790.9 1550.46 L1790.9 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M2331.53 1563.72 L2347.85 1563.72 L2347.85 1567.66 L2325.9 1567.66 L2325.9 1563.72 Q2328.57 1560.97 2333.15 1556.34 Q2337.76 1551.69 2338.94 1550.35 Q2341.18 1547.82 2342.06 1546.09 Q2342.96 1544.33 2342.96 1542.64 Q2342.96 1539.88 2341.02 1538.15 Q2339.1 1536.41 2336 1536.41 Q2333.8 1536.41 2331.34 1537.17 Q2328.91 1537.94 2326.14 1539.49 L2326.14 1534.77 Q2328.96 1533.63 2331.41 1533.05 Q2333.87 1532.47 2335.9 1532.47 Q2341.27 1532.47 2344.47 1535.16 Q2347.66 1537.85 2347.66 1542.34 Q2347.66 1544.47 2346.85 1546.39 Q2346.07 1548.28 2343.96 1550.88 Q2343.38 1551.55 2340.28 1554.77 Q2337.18 1557.96 2331.53 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M2367.66 1536.18 Q2364.05 1536.18 2362.22 1539.74 Q2360.42 1543.28 2360.42 1550.41 Q2360.42 1557.52 2362.22 1561.09 Q2364.05 1564.63 2367.66 1564.63 Q2371.3 1564.63 2373.1 1561.09 Q2374.93 1557.52 2374.93 1550.41 Q2374.93 1543.28 2373.1 1539.74 Q2371.3 1536.18 2367.66 1536.18 M2367.66 1532.47 Q2373.47 1532.47 2376.53 1537.08 Q2379.61 1541.66 2379.61 1550.41 Q2379.61 1559.14 2376.53 1563.75 Q2373.47 1568.33 2367.66 1568.33 Q2361.85 1568.33 2358.77 1563.75 Q2355.72 1559.14 2355.72 1550.41 Q2355.72 1541.66 2358.77 1537.08 Q2361.85 1532.47 2367.66 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1078.16 2352.76,1078.16 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,692.334 2352.76,692.334 "/>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,306.503 2352.76,306.503 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1078.16 105.89,1078.16 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,692.334 105.89,692.334 "/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,306.503 105.89,306.503 "/>
<path clip-path="url(#clip810)" d="M-36.3454 1449.79 Q-39.9565 1449.79 -41.7852 1453.36 Q-43.5907 1456.9 -43.5907 1464.03 Q-43.5907 1471.14 -41.7852 1474.7 Q-39.9565 1478.24 -36.3454 1478.24 Q-32.7111 1478.24 -30.9056 1474.7 Q-29.0769 1471.14 -29.0769 1464.03 Q-29.0769 1456.9 -30.9056 1453.36 Q-32.7111 1449.79 -36.3454 1449.79 M-36.3454 1446.09 Q-30.5352 1446.09 -27.4797 1450.7 Q-24.401 1455.28 -24.401 1464.03 Q-24.401 1472.76 -27.4797 1477.36 Q-30.5352 1481.95 -36.3454 1481.95 Q-42.1555 1481.95 -45.2342 1477.36 Q-48.2897 1472.76 -48.2897 1464.03 Q-48.2897 1455.28 -45.2342 1450.7 Q-42.1555 1446.09 -36.3454 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-16.1834 1475.4 L-11.2992 1475.4 L-11.2992 1481.28 L-16.1834 1481.28 L-16.1834 1475.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M8.88587 1449.79 Q5.27478 1449.79 3.44608 1453.36 Q1.64054 1456.9 1.64054 1464.03 Q1.64054 1471.14 3.44608 1474.7 Q5.27478 1478.24 8.88587 1478.24 Q12.5201 1478.24 14.3257 1474.7 Q16.1543 1471.14 16.1543 1464.03 Q16.1543 1456.9 14.3257 1453.36 Q12.5201 1449.79 8.88587 1449.79 M8.88587 1446.09 Q14.696 1446.09 17.7516 1450.7 Q20.8303 1455.28 20.8303 1464.03 Q20.8303 1472.76 17.7516 1477.36 Q14.696 1481.95 8.88587 1481.95 Q3.07572 1481.95 -0.00297114 1477.36 Q-3.05851 1472.76 -3.05851 1464.03 Q-3.05851 1455.28 -0.00297114 1450.7 Q3.07572 1446.09 8.88587 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-34.7482 1063.96 Q-38.3592 1063.96 -40.1879 1067.53 Q-41.9935 1071.07 -41.9935 1078.2 Q-41.9935 1085.31 -40.1879 1088.87 Q-38.3592 1092.41 -34.7482 1092.41 Q-31.1139 1092.41 -29.3084 1088.87 Q-27.4797 1085.31 -27.4797 1078.2 Q-27.4797 1071.07 -29.3084 1067.53 Q-31.1139 1063.96 -34.7482 1063.96 M-34.7482 1060.26 Q-28.938 1060.26 -25.8825 1064.87 Q-22.8038 1069.45 -22.8038 1078.2 Q-22.8038 1086.93 -25.8825 1091.53 Q-28.938 1096.12 -34.7482 1096.12 Q-40.5583 1096.12 -43.637 1091.53 Q-46.6925 1086.93 -46.6925 1078.2 Q-46.6925 1069.45 -43.637 1064.87 Q-40.5583 1060.26 -34.7482 1060.26 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-14.5862 1089.56 L-9.70199 1089.56 L-9.70199 1095.44 L-14.5862 1095.44 L-14.5862 1089.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M10.4831 1063.96 Q6.87199 1063.96 5.0433 1067.53 Q3.23775 1071.07 3.23775 1078.2 Q3.23775 1085.31 5.0433 1088.87 Q6.87199 1092.41 10.4831 1092.41 Q14.1173 1092.41 15.9229 1088.87 Q17.7516 1085.31 17.7516 1078.2 Q17.7516 1071.07 15.9229 1067.53 Q14.1173 1063.96 10.4831 1063.96 M10.4831 1060.26 Q16.2932 1060.26 19.3488 1064.87 Q22.4275 1069.45 22.4275 1078.2 Q22.4275 1086.93 19.3488 1091.53 Q16.2932 1096.12 10.4831 1096.12 Q4.67293 1096.12 1.59424 1091.53 Q-1.4613 1086.93 -1.4613 1078.2 Q-1.4613 1069.45 1.59424 1064.87 Q4.67293 1060.26 10.4831 1060.26 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M34.6728 1091.51 L50.9921 1091.51 L50.9921 1095.44 L29.0478 1095.44 L29.0478 1091.51 Q31.7098 1088.75 36.2931 1084.13 Q40.8996 1079.47 42.0801 1078.13 Q44.3255 1075.61 45.2051 1073.87 Q46.1079 1072.11 46.1079 1070.42 Q46.1079 1067.67 44.1635 1065.93 Q42.2422 1064.19 39.1403 1064.19 Q36.9413 1064.19 34.4876 1064.96 Q32.057 1065.72 29.2793 1067.27 L29.2793 1062.55 Q32.1033 1061.42 34.557 1060.84 Q37.0107 1060.26 39.0477 1060.26 Q44.4181 1060.26 47.6125 1062.94 Q50.8069 1065.63 50.8069 1070.12 Q50.8069 1072.25 49.9968 1074.17 Q49.2097 1076.07 47.1033 1078.66 Q46.5246 1079.33 43.4227 1082.55 Q40.3209 1085.75 34.6728 1091.51 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-36.8315 678.132 Q-40.4426 678.132 -42.2713 681.697 Q-44.0768 685.239 -44.0768 692.369 Q-44.0768 699.475 -42.2713 703.04 Q-40.4426 706.581 -36.8315 706.581 Q-33.1972 706.581 -31.3917 703.04 Q-29.563 699.475 -29.563 692.369 Q-29.563 685.239 -31.3917 681.697 Q-33.1972 678.132 -36.8315 678.132 M-36.8315 674.429 Q-31.0213 674.429 -27.9658 679.035 Q-24.8871 683.619 -24.8871 692.369 Q-24.8871 701.095 -27.9658 705.702 Q-31.0213 710.285 -36.8315 710.285 Q-42.6416 710.285 -45.7203 705.702 Q-48.7759 701.095 -48.7759 692.369 Q-48.7759 683.619 -45.7203 679.035 Q-42.6416 674.429 -36.8315 674.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-16.6695 703.734 L-11.7853 703.734 L-11.7853 709.614 L-16.6695 709.614 L-16.6695 703.734 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M8.39976 678.132 Q4.78867 678.132 2.95998 681.697 Q1.15443 685.239 1.15443 692.369 Q1.15443 699.475 2.95998 703.04 Q4.78867 706.581 8.39976 706.581 Q12.034 706.581 13.8395 703.04 Q15.6682 699.475 15.6682 692.369 Q15.6682 685.239 13.8395 681.697 Q12.034 678.132 8.39976 678.132 M8.39976 674.429 Q14.2099 674.429 17.2655 679.035 Q20.3441 683.619 20.3441 692.369 Q20.3441 701.095 17.2655 705.702 Q14.2099 710.285 8.39976 710.285 Q2.58961 710.285 -0.48908 705.702 Q-3.54462 701.095 -3.54462 692.369 Q-3.54462 683.619 -0.48908 679.035 Q2.58961 674.429 8.39976 674.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M41.4088 679.128 L29.6034 697.577 L41.4088 697.577 L41.4088 679.128 M40.182 675.054 L46.0616 675.054 L46.0616 697.577 L50.9921 697.577 L50.9921 701.466 L46.0616 701.466 L46.0616 709.614 L41.4088 709.614 L41.4088 701.466 L25.8071 701.466 L25.8071 696.952 L40.182 675.054 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-36.5074 292.302 Q-40.1185 292.302 -41.9472 295.867 Q-43.7527 299.408 -43.7527 306.538 Q-43.7527 313.644 -41.9472 317.209 Q-40.1185 320.751 -36.5074 320.751 Q-32.8732 320.751 -31.0676 317.209 Q-29.2389 313.644 -29.2389 306.538 Q-29.2389 299.408 -31.0676 295.867 Q-32.8732 292.302 -36.5074 292.302 M-36.5074 288.598 Q-30.6973 288.598 -27.6417 293.205 Q-24.563 297.788 -24.563 306.538 Q-24.563 315.265 -27.6417 319.871 Q-30.6973 324.454 -36.5074 324.454 Q-42.3176 324.454 -45.3962 319.871 Q-48.4518 315.265 -48.4518 306.538 Q-48.4518 297.788 -45.3962 293.205 Q-42.3176 288.598 -36.5074 288.598 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M-16.3455 317.903 L-11.4612 317.903 L-11.4612 323.783 L-16.3455 323.783 L-16.3455 317.903 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M8.72383 292.302 Q5.11274 292.302 3.28405 295.867 Q1.4785 299.408 1.4785 306.538 Q1.4785 313.644 3.28405 317.209 Q5.11274 320.751 8.72383 320.751 Q12.3581 320.751 14.1636 317.209 Q15.9923 313.644 15.9923 306.538 Q15.9923 299.408 14.1636 295.867 Q12.3581 292.302 8.72383 292.302 M8.72383 288.598 Q14.534 288.598 17.5895 293.205 Q20.6682 297.788 20.6682 306.538 Q20.6682 315.265 17.5895 319.871 Q14.534 324.454 8.72383 324.454 Q2.91368 324.454 -0.165007 319.871 Q-3.22055 315.265 -3.22055 306.538 Q-3.22055 297.788 -0.165007 293.205 Q2.91368 288.598 8.72383 288.598 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip810)" d="M39.4644 304.64 Q36.3163 304.64 34.4644 306.792 Q32.6357 308.945 32.6357 312.695 Q32.6357 316.422 34.4644 318.598 Q36.3163 320.751 39.4644 320.751 Q42.6125 320.751 44.4412 318.598 Q46.2931 316.422 46.2931 312.695 Q46.2931 308.945 44.4412 306.792 Q42.6125 304.64 39.4644 304.64 M48.7468 289.987 L48.7468 294.246 Q46.9875 293.413 45.182 292.973 Q43.3996 292.533 41.6403 292.533 Q37.0107 292.533 34.557 295.658 Q32.1265 298.783 31.7793 305.103 Q33.145 303.089 35.2052 302.024 Q37.2653 300.936 39.7422 300.936 Q44.9505 300.936 47.9597 304.107 Q50.9921 307.255 50.9921 312.695 Q50.9921 318.019 47.844 321.237 Q44.6959 324.454 39.4644 324.454 Q33.4691 324.454 30.2978 319.871 Q27.1265 315.265 27.1265 306.538 Q27.1265 298.343 31.0154 293.482 Q34.9042 288.598 41.4551 288.598 Q43.2144 288.598 44.9968 288.945 Q46.8023 289.292 48.7468 289.987 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip812)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1464 313.569,267.92 426.857,88.5087 540.145,109.44 653.433,167.599 766.721,230.505 880.009,291.797 993.298,350.33 1106.59,405.998 1219.87,458.895 1333.16,509.149 1446.45,556.892 1559.74,602.247 1673.03,645.334 1786.31,686.267 1899.6,725.154 2012.89,762.096 2126.18,797.191 2239.47,830.531 2352.76,862.204 "/>
<polyline clip-path="url(#clip812)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1271.08 313.569,1425.41 426.857,1456.28 540.145,1462.45 653.433,1463.69 766.721,1463.93 880.009,1463.98 993.298,1463.99 1106.59,1463.99 1219.87,1464 1333.16,1464 1446.45,1464 1559.74,1464 1673.03,1464 1786.31,1464 1899.6,1464 2012.89,1464 2126.18,1464 2239.47,1464 2352.76,1464 "/>
<path clip-path="url(#clip810)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip810)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip810)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip810)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip810)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>Lets find the 2nd observable at the end of the IRF.</p><pre><code class="language-julia hljs">function last_observable_irf(A, B, C)
    sol = irf(A, B, C)
    return sol.z[end][2]  # return 2nd argument of last observable
end
last_observable_irf(A, B, C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.03119456447624772</code></pre><p>But everything in this package is differentiable.  Lets differentiate the observable of the IRF with respect to all of the parameters using <code>Zygote.jl</code>,</p><pre><code class="language-julia hljs">gradient(last_observable_irf, A, B, C)  # calculates gradient wrt all arguments</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.5822985368900442 0.0050313813671367304; 4.469834483178462 0.041592752634585235], [0.37735360253530714; 3.119456447624773;;], [0.0 0.0; 0.03119456447624772 5.242880000000006e-16])</code></pre><p>Gradients of other model elements (e.g. <code>.u</code> are also possible.  With this in mind, lets find the gradient of the mean of the 1st element of the IRF of the solution with respect to a particular noise vector.</p><pre><code class="language-julia hljs">function mean_u_1(A, B, C, noise, u0, T)
    problem = LinearStateSpaceProblem(A, B, u0, (0, T); noise, syms = [:a, :b])
    sol = solve(problem)
    u = sol.u # see issue #75 workaround
    # can have nontrivial functions and even non-mutating loops
    return mean( u[i][1] for i in 1:T)
end
u0 = [0.0, 0.0]
noise = sol.W # from simulation above
mean_u_1(A, B, C, noise, u0, T)
# dropping a few arguments from derivative
gradient((noise, u0)-&gt; mean_u_1(A, B, C, noise, u0, T), noise, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.05079876954953124 0.045314515146875 … 0.0 0.0], [0.702526121523242, 5.600882710405467])</code></pre><h2 id="Simulating-Ensembles-and-Fixing-Noise"><a class="docs-heading-anchor" href="#Simulating-Ensembles-and-Fixing-Noise">Simulating Ensembles and Fixing Noise</a><a id="Simulating-Ensembles-and-Fixing-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Ensembles-and-Fixing-Noise" title="Permalink"></a></h2><p>If you pass in a distribution for the initial condition, it will draw an initial condition.  Below we will simulate from a deterministic evolution equation and without any observation noise.</p><pre><code class="language-julia hljs">using Distributions, DiffEqBase
u0 = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = LinearStateSpaceProblem(A, nothing, u0, (0, T); C)
sol = solve(prob)
plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip870">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip870)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip871">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip870)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip872">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip870)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1297.38 2352.76,1297.38 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,894.421 2352.76,894.421 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,491.465 2352.76,491.465 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,88.5087 2352.76,88.5087 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1297.38 105.89,1297.38 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,894.421 105.89,894.421 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,491.465 105.89,491.465 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,88.5087 105.89,88.5087 "/>
<path clip-path="url(#clip870)" d="M-54.9564 1297.83 L-25.2806 1297.83 L-25.2806 1301.76 L-54.9564 1301.76 L-54.9564 1297.83 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-14.3779 1310.72 L-6.73905 1310.72 L-6.73905 1284.36 L-15.0492 1286.02 L-15.0492 1281.76 L-6.78534 1280.1 L-2.10944 1280.1 L-2.10944 1310.72 L5.52941 1310.72 L5.52941 1314.66 L-14.3779 1314.66 L-14.3779 1310.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M14.9738 1308.78 L19.858 1308.78 L19.858 1314.66 L14.9738 1314.66 L14.9738 1308.78 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M30.0895 1280.1 L48.4458 1280.1 L48.4458 1284.03 L34.3718 1284.03 L34.3718 1292.5 Q35.3904 1292.16 36.4089 1292 Q37.4274 1291.81 38.4459 1291.81 Q44.2329 1291.81 47.6125 1294.98 Q50.9921 1298.15 50.9921 1303.57 Q50.9921 1309.15 47.5199 1312.25 Q44.0477 1315.33 37.7283 1315.33 Q35.5524 1315.33 33.2839 1314.96 Q31.0385 1314.59 28.6311 1313.85 L28.6311 1309.15 Q30.7145 1310.28 32.9367 1310.84 Q35.1589 1311.39 37.6357 1311.39 Q41.6403 1311.39 43.9783 1309.29 Q46.3162 1307.18 46.3162 1303.57 Q46.3162 1299.96 43.9783 1297.85 Q41.6403 1295.75 37.6357 1295.75 Q35.7607 1295.75 33.8857 1296.16 Q32.0339 1296.58 30.0895 1297.46 L30.0895 1280.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-55.9517 894.872 L-26.276 894.872 L-26.276 898.808 L-55.9517 898.808 L-55.9517 894.872 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-15.3733 907.766 L-7.73441 907.766 L-7.73441 881.4 L-16.0446 883.067 L-16.0446 878.808 L-7.78071 877.141 L-3.10481 877.141 L-3.10481 907.766 L4.53404 907.766 L4.53404 911.701 L-15.3733 911.701 L-15.3733 907.766 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M13.9784 905.821 L18.8627 905.821 L18.8627 911.701 L13.9784 911.701 L13.9784 905.821 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M39.0477 880.22 Q35.4367 880.22 33.608 883.785 Q31.8024 887.326 31.8024 894.456 Q31.8024 901.562 33.608 905.127 Q35.4367 908.669 39.0477 908.669 Q42.682 908.669 44.4875 905.127 Q46.3162 901.562 46.3162 894.456 Q46.3162 887.326 44.4875 883.785 Q42.682 880.22 39.0477 880.22 M39.0477 876.516 Q44.8579 876.516 47.9134 881.123 Q50.9921 885.706 50.9921 894.456 Q50.9921 903.183 47.9134 907.789 Q44.8579 912.372 39.0477 912.372 Q33.2376 912.372 30.1589 907.789 Q27.1034 903.183 27.1034 894.456 Q27.1034 885.706 30.1589 881.123 Q33.2376 876.516 39.0477 876.516 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-54.9564 491.916 L-25.2806 491.916 L-25.2806 495.851 L-54.9564 495.851 L-54.9564 491.916 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-5.18813 477.264 Q-8.79922 477.264 -10.6279 480.828 Q-12.4335 484.37 -12.4335 491.5 Q-12.4335 498.606 -10.6279 502.171 Q-8.79922 505.712 -5.18813 505.712 Q-1.55389 505.712 0.251657 502.171 Q2.08035 498.606 2.08035 491.5 Q2.08035 484.37 0.251657 480.828 Q-1.55389 477.264 -5.18813 477.264 M-5.18813 473.56 Q0.622026 473.56 3.67756 478.166 Q6.75625 482.75 6.75625 491.5 Q6.75625 500.226 3.67756 504.833 Q0.622026 509.416 -5.18813 509.416 Q-10.9983 509.416 -14.077 504.833 Q-17.1325 500.226 -17.1325 491.5 Q-17.1325 482.75 -14.077 478.166 Q-10.9983 473.56 -5.18813 473.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M14.9738 502.865 L19.858 502.865 L19.858 508.745 L14.9738 508.745 L14.9738 502.865 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M30.0895 474.185 L48.4458 474.185 L48.4458 478.12 L34.3718 478.12 L34.3718 486.592 Q35.3904 486.245 36.4089 486.083 Q37.4274 485.898 38.4459 485.898 Q44.2329 485.898 47.6125 489.069 Q50.9921 492.24 50.9921 497.657 Q50.9921 503.236 47.5199 506.337 Q44.0477 509.416 37.7283 509.416 Q35.5524 509.416 33.2839 509.046 Q31.0385 508.675 28.6311 507.935 L28.6311 503.236 Q30.7145 504.37 32.9367 504.925 Q35.1589 505.481 37.6357 505.481 Q41.6403 505.481 43.9783 503.375 Q46.3162 501.268 46.3162 497.657 Q46.3162 494.046 43.9783 491.939 Q41.6403 489.833 37.6357 489.833 Q35.7607 489.833 33.8857 490.25 Q32.0339 490.666 30.0895 491.546 L30.0895 474.185 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-6.18349 74.3074 Q-9.79459 74.3074 -11.6233 77.8722 Q-13.4288 81.4138 -13.4288 88.5434 Q-13.4288 95.6498 -11.6233 99.2146 Q-9.79459 102.756 -6.18349 102.756 Q-2.54925 102.756 -0.743708 99.2146 Q1.08499 95.6498 1.08499 88.5434 Q1.08499 81.4138 -0.743708 77.8722 Q-2.54925 74.3074 -6.18349 74.3074 M-6.18349 70.6037 Q-0.37334 70.6037 2.6822 75.2101 Q5.76089 79.7934 5.76089 88.5434 Q5.76089 97.2702 2.6822 101.877 Q-0.37334 106.46 -6.18349 106.46 Q-11.9936 106.46 -15.0723 101.877 Q-18.1279 97.2702 -18.1279 88.5434 Q-18.1279 79.7934 -15.0723 75.2101 Q-11.9936 70.6037 -6.18349 70.6037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M13.9784 99.9091 L18.8627 99.9091 L18.8627 105.789 L13.9784 105.789 L13.9784 99.9091 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M39.0477 74.3074 Q35.4367 74.3074 33.608 77.8722 Q31.8024 81.4138 31.8024 88.5434 Q31.8024 95.6498 33.608 99.2146 Q35.4367 102.756 39.0477 102.756 Q42.682 102.756 44.4875 99.2146 Q46.3162 95.6498 46.3162 88.5434 Q46.3162 81.4138 44.4875 77.8722 Q42.682 74.3074 39.0477 74.3074 M39.0477 70.6037 Q44.8579 70.6037 47.9134 75.2101 Q50.9921 79.7934 50.9921 88.5434 Q50.9921 97.2702 47.9134 101.877 Q44.8579 106.46 39.0477 106.46 Q33.2376 106.46 30.1589 101.877 Q27.1034 97.2702 27.1034 88.5434 Q27.1034 79.7934 30.1589 75.2101 Q33.2376 70.6037 39.0477 70.6037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip872)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,661.366 313.569,1379.23 540.145,1464 766.721,1425.08 993.298,1364.22 1219.87,1301.63 1446.45,1241.22 1673.03,1183.63 1899.6,1128.88 2126.18,1076.87 2352.76,1027.45 "/>
<polyline clip-path="url(#clip872)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,208.913 313.569,112.59 540.145,93.3249 766.721,89.4719 993.298,88.7013 1219.87,88.5472 1446.45,88.5164 1673.03,88.5102 1899.6,88.509 2126.18,88.5087 2352.76,88.5087 "/>
<path clip-path="url(#clip870)" d="M1942.97 1456.66 L2277.23 1456.66 L2277.23 1301.14 L1942.97 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1942.97,1456.66 2277.23,1456.66 2277.23,1301.14 1942.97,1301.14 1942.97,1456.66 "/>
<polyline clip-path="url(#clip870)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,1352.98 2119.2,1352.98 "/>
<path clip-path="url(#clip870)" d="M2144.37 1360.03 L2144.37 1344.33 L2148.63 1344.33 L2148.63 1359.87 Q2148.63 1363.55 2150.07 1365.4 Q2151.5 1367.23 2154.37 1367.23 Q2157.82 1367.23 2159.81 1365.03 Q2161.82 1362.83 2161.82 1359.03 L2161.82 1344.33 L2166.08 1344.33 L2166.08 1370.26 L2161.82 1370.26 L2161.82 1366.28 Q2160.27 1368.64 2158.21 1369.8 Q2156.18 1370.93 2153.47 1370.93 Q2149 1370.93 2146.69 1368.15 Q2144.37 1365.38 2144.37 1360.03 M2155.09 1343.71 L2155.09 1343.71 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2176.27 1366.32 L2183.91 1366.32 L2183.91 1339.96 L2175.6 1341.63 L2175.6 1337.37 L2183.86 1335.7 L2188.54 1335.7 L2188.54 1366.32 L2196.18 1366.32 L2196.18 1370.26 L2176.27 1370.26 L2176.27 1366.32 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2215.25 1334.29 Q2212.15 1339.61 2210.64 1344.82 Q2209.14 1350.03 2209.14 1355.38 Q2209.14 1360.72 2210.64 1365.98 Q2212.17 1371.21 2215.25 1376.51 L2211.55 1376.51 Q2208.07 1371.07 2206.34 1365.81 Q2204.62 1360.56 2204.62 1355.38 Q2204.62 1350.21 2206.34 1344.98 Q2208.05 1339.75 2211.55 1334.29 L2215.25 1334.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2227.73 1336.97 L2227.73 1344.33 L2236.5 1344.33 L2236.5 1347.64 L2227.73 1347.64 L2227.73 1361.72 Q2227.73 1364.89 2228.58 1365.79 Q2229.46 1366.69 2232.12 1366.69 L2236.5 1366.69 L2236.5 1370.26 L2232.12 1370.26 Q2227.19 1370.26 2225.32 1368.43 Q2223.44 1366.58 2223.44 1361.72 L2223.44 1347.64 L2220.32 1347.64 L2220.32 1344.33 L2223.44 1344.33 L2223.44 1336.97 L2227.73 1336.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2241.43 1334.29 L2245.13 1334.29 Q2248.61 1339.75 2250.32 1344.98 Q2252.06 1350.21 2252.06 1355.38 Q2252.06 1360.56 2250.32 1365.81 Q2248.61 1371.07 2245.13 1376.51 L2241.43 1376.51 Q2244.51 1371.21 2246.01 1365.98 Q2247.54 1360.72 2247.54 1355.38 Q2247.54 1350.03 2246.01 1344.82 Q2244.51 1339.61 2241.43 1334.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip870)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,1404.82 2119.2,1404.82 "/>
<path clip-path="url(#clip870)" d="M2144.37 1411.87 L2144.37 1396.17 L2148.63 1396.17 L2148.63 1411.71 Q2148.63 1415.39 2150.07 1417.24 Q2151.5 1419.07 2154.37 1419.07 Q2157.82 1419.07 2159.81 1416.87 Q2161.82 1414.67 2161.82 1410.87 L2161.82 1396.17 L2166.08 1396.17 L2166.08 1422.1 L2161.82 1422.1 L2161.82 1418.12 Q2160.27 1420.48 2158.21 1421.64 Q2156.18 1422.77 2153.47 1422.77 Q2149 1422.77 2146.69 1419.99 Q2144.37 1417.22 2144.37 1411.87 M2155.09 1395.55 L2155.09 1395.55 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2179.49 1418.16 L2195.81 1418.16 L2195.81 1422.1 L2173.86 1422.1 L2173.86 1418.16 Q2176.52 1415.41 2181.11 1410.78 Q2185.71 1406.13 2186.89 1404.78 Q2189.14 1402.26 2190.02 1400.53 Q2190.92 1398.77 2190.92 1397.08 Q2190.92 1394.32 2188.98 1392.59 Q2187.06 1390.85 2183.95 1390.85 Q2181.75 1390.85 2179.3 1391.61 Q2176.87 1392.38 2174.09 1393.93 L2174.09 1389.21 Q2176.92 1388.07 2179.37 1387.49 Q2181.82 1386.91 2183.86 1386.91 Q2189.23 1386.91 2192.43 1389.6 Q2195.62 1392.28 2195.62 1396.78 Q2195.62 1398.9 2194.81 1400.83 Q2194.02 1402.72 2191.92 1405.32 Q2191.34 1405.99 2188.24 1409.21 Q2185.13 1412.4 2179.49 1418.16 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2215.25 1386.13 Q2212.15 1391.45 2210.64 1396.66 Q2209.14 1401.87 2209.14 1407.22 Q2209.14 1412.56 2210.64 1417.82 Q2212.17 1423.05 2215.25 1428.35 L2211.55 1428.35 Q2208.07 1422.91 2206.34 1417.65 Q2204.62 1412.4 2204.62 1407.22 Q2204.62 1402.05 2206.34 1396.82 Q2208.05 1391.59 2211.55 1386.13 L2215.25 1386.13 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2227.73 1388.81 L2227.73 1396.17 L2236.5 1396.17 L2236.5 1399.48 L2227.73 1399.48 L2227.73 1413.56 Q2227.73 1416.73 2228.58 1417.63 Q2229.46 1418.53 2232.12 1418.53 L2236.5 1418.53 L2236.5 1422.1 L2232.12 1422.1 Q2227.19 1422.1 2225.32 1420.27 Q2223.44 1418.42 2223.44 1413.56 L2223.44 1399.48 L2220.32 1399.48 L2220.32 1396.17 L2223.44 1396.17 L2223.44 1388.81 L2227.73 1388.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2241.43 1386.13 L2245.13 1386.13 Q2248.61 1391.59 2250.32 1396.82 Q2252.06 1402.05 2252.06 1407.22 Q2252.06 1412.4 2250.32 1417.65 Q2248.61 1422.91 2245.13 1428.35 L2241.43 1428.35 Q2244.51 1423.05 2246.01 1417.82 Q2247.54 1412.56 2247.54 1407.22 Q2247.54 1401.87 2246.01 1396.66 Q2244.51 1391.45 2241.43 1386.13 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>With this, we can simulate an ensemble of solutions from different initial conditions (and we will turn back on the noise).  The <code>EnsembleSummary</code> calculates a set of quantiles by default.</p><pre><code class="language-julia hljs">T = 10
trajectories = 50
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C)
sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(sol)  #calculate summarize statistics from the
plot(summ)  # shows quantiles by default</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip930">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip930)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip931">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip930)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip932">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="685.496,1521.01 685.496,47.2441 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1521.01 1219.87,47.2441 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1754.25,1521.01 1754.25,47.2441 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="685.496,1521.01 685.496,1502.11 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1521.01 1219.87,1502.11 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.25,1521.01 1754.25,1502.11 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip930)" d="M128.502 1551.93 Q124.891 1551.93 123.062 1555.49 Q121.257 1559.03 121.257 1566.16 Q121.257 1573.27 123.062 1576.83 Q124.891 1580.38 128.502 1580.38 Q132.136 1580.38 133.942 1576.83 Q135.77 1573.27 135.77 1566.16 Q135.77 1559.03 133.942 1555.49 Q132.136 1551.93 128.502 1551.93 M128.502 1548.22 Q134.312 1548.22 137.368 1552.83 Q140.446 1557.41 140.446 1566.16 Q140.446 1574.89 137.368 1579.5 Q134.312 1584.08 128.502 1584.08 Q122.692 1584.08 119.613 1579.5 Q116.558 1574.89 116.558 1566.16 Q116.558 1557.41 119.613 1552.83 Q122.692 1548.22 128.502 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M148.664 1577.53 L153.548 1577.53 L153.548 1583.41 L148.664 1583.41 L148.664 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M173.733 1551.93 Q170.122 1551.93 168.293 1555.49 Q166.488 1559.03 166.488 1566.16 Q166.488 1573.27 168.293 1576.83 Q170.122 1580.38 173.733 1580.38 Q177.367 1580.38 179.173 1576.83 Q181.002 1573.27 181.002 1566.16 Q181.002 1559.03 179.173 1555.49 Q177.367 1551.93 173.733 1551.93 M173.733 1548.22 Q179.543 1548.22 182.599 1552.83 Q185.678 1557.41 185.678 1566.16 Q185.678 1574.89 182.599 1579.5 Q179.543 1584.08 173.733 1584.08 Q167.923 1584.08 164.844 1579.5 Q161.789 1574.89 161.789 1566.16 Q161.789 1557.41 164.844 1552.83 Q167.923 1548.22 173.733 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M657.232 1579.47 L673.551 1579.47 L673.551 1583.41 L651.607 1583.41 L651.607 1579.47 Q654.269 1576.72 658.852 1572.09 Q663.459 1567.44 664.639 1566.09 Q666.885 1563.57 667.764 1561.83 Q668.667 1560.07 668.667 1558.38 Q668.667 1555.63 666.723 1553.89 Q664.801 1552.16 661.7 1552.16 Q659.501 1552.16 657.047 1552.92 Q654.616 1553.69 651.839 1555.24 L651.839 1550.51 Q654.663 1549.38 657.116 1548.8 Q659.57 1548.22 661.607 1548.22 Q666.977 1548.22 670.172 1550.91 Q673.366 1553.59 673.366 1558.08 Q673.366 1560.21 672.556 1562.13 Q671.769 1564.03 669.663 1566.63 Q669.084 1567.3 665.982 1570.51 Q662.88 1573.71 657.232 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M683.366 1577.53 L688.25 1577.53 L688.25 1583.41 L683.366 1583.41 L683.366 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M698.482 1548.85 L716.838 1548.85 L716.838 1552.78 L702.764 1552.78 L702.764 1561.26 Q703.783 1560.91 704.801 1560.75 Q705.82 1560.56 706.838 1560.56 Q712.625 1560.56 716.005 1563.73 Q719.384 1566.9 719.384 1572.32 Q719.384 1577.9 715.912 1581 Q712.44 1584.08 706.121 1584.08 Q703.945 1584.08 701.676 1583.71 Q699.431 1583.34 697.023 1582.6 L697.023 1577.9 Q699.107 1579.03 701.329 1579.59 Q703.551 1580.14 706.028 1580.14 Q710.033 1580.14 712.371 1578.04 Q714.709 1575.93 714.709 1572.32 Q714.709 1568.71 712.371 1566.6 Q710.033 1564.5 706.028 1564.5 Q704.153 1564.5 702.278 1564.91 Q700.426 1565.33 698.482 1566.21 L698.482 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1187.04 1548.85 L1205.39 1548.85 L1205.39 1552.78 L1191.32 1552.78 L1191.32 1561.26 Q1192.34 1560.91 1193.36 1560.75 Q1194.38 1560.56 1195.39 1560.56 Q1201.18 1560.56 1204.56 1563.73 Q1207.94 1566.9 1207.94 1572.32 Q1207.94 1577.9 1204.47 1581 Q1201 1584.08 1194.68 1584.08 Q1192.5 1584.08 1190.23 1583.71 Q1187.99 1583.34 1185.58 1582.6 L1185.58 1577.9 Q1187.66 1579.03 1189.89 1579.59 Q1192.11 1580.14 1194.58 1580.14 Q1198.59 1580.14 1200.93 1578.04 Q1203.27 1575.93 1203.27 1572.32 Q1203.27 1568.71 1200.93 1566.6 Q1198.59 1564.5 1194.58 1564.5 Q1192.71 1564.5 1190.83 1564.91 Q1188.98 1565.33 1187.04 1566.21 L1187.04 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1217.15 1577.53 L1222.04 1577.53 L1222.04 1583.41 L1217.15 1583.41 L1217.15 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1242.22 1551.93 Q1238.61 1551.93 1236.78 1555.49 Q1234.98 1559.03 1234.98 1566.16 Q1234.98 1573.27 1236.78 1576.83 Q1238.61 1580.38 1242.22 1580.38 Q1245.86 1580.38 1247.66 1576.83 Q1249.49 1573.27 1249.49 1566.16 Q1249.49 1559.03 1247.66 1555.49 Q1245.86 1551.93 1242.22 1551.93 M1242.22 1548.22 Q1248.03 1548.22 1251.09 1552.83 Q1254.17 1557.41 1254.17 1566.16 Q1254.17 1574.89 1251.09 1579.5 Q1248.03 1584.08 1242.22 1584.08 Q1236.41 1584.08 1233.33 1579.5 Q1230.28 1574.89 1230.28 1566.16 Q1230.28 1557.41 1233.33 1552.83 Q1236.41 1548.22 1242.22 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1720.57 1548.85 L1742.79 1548.85 L1742.79 1550.84 L1730.25 1583.41 L1725.36 1583.41 L1737.17 1552.78 L1720.57 1552.78 L1720.57 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1751.91 1577.53 L1756.8 1577.53 L1756.8 1583.41 L1751.91 1583.41 L1751.91 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1767.03 1548.85 L1785.39 1548.85 L1785.39 1552.78 L1771.31 1552.78 L1771.31 1561.26 Q1772.33 1560.91 1773.35 1560.75 Q1774.37 1560.56 1775.39 1560.56 Q1781.17 1560.56 1784.55 1563.73 Q1787.93 1566.9 1787.93 1572.32 Q1787.93 1577.9 1784.46 1581 Q1780.99 1584.08 1774.67 1584.08 Q1772.49 1584.08 1770.22 1583.71 Q1767.98 1583.34 1765.57 1582.6 L1765.57 1577.9 Q1767.65 1579.03 1769.88 1579.59 Q1772.1 1580.14 1774.58 1580.14 Q1778.58 1580.14 1780.92 1578.04 Q1783.26 1575.93 1783.26 1572.32 Q1783.26 1568.71 1780.92 1566.6 Q1778.58 1564.5 1774.58 1564.5 Q1772.7 1564.5 1770.83 1564.91 Q1768.97 1565.33 1767.03 1566.21 L1767.03 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M2240.7 1579.47 L2248.34 1579.47 L2248.34 1553.11 L2240.03 1554.77 L2240.03 1550.51 L2248.3 1548.85 L2252.97 1548.85 L2252.97 1579.47 L2260.61 1579.47 L2260.61 1583.41 L2240.7 1583.41 L2240.7 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M2280.05 1551.93 Q2276.44 1551.93 2274.61 1555.49 Q2272.81 1559.03 2272.81 1566.16 Q2272.81 1573.27 2274.61 1576.83 Q2276.44 1580.38 2280.05 1580.38 Q2283.69 1580.38 2285.49 1576.83 Q2287.32 1573.27 2287.32 1566.16 Q2287.32 1559.03 2285.49 1555.49 Q2283.69 1551.93 2280.05 1551.93 M2280.05 1548.22 Q2285.86 1548.22 2288.92 1552.83 Q2292 1557.41 2292 1566.16 Q2292 1574.89 2288.92 1579.5 Q2285.86 1584.08 2280.05 1584.08 Q2274.24 1584.08 2271.17 1579.5 Q2268.11 1574.89 2268.11 1566.16 Q2268.11 1557.41 2271.17 1552.83 Q2274.24 1548.22 2280.05 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M2300.22 1577.53 L2305.1 1577.53 L2305.1 1583.41 L2300.22 1583.41 L2300.22 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M2325.29 1551.93 Q2321.67 1551.93 2319.85 1555.49 Q2318.04 1559.03 2318.04 1566.16 Q2318.04 1573.27 2319.85 1576.83 Q2321.67 1580.38 2325.29 1580.38 Q2328.92 1580.38 2330.73 1576.83 Q2332.55 1573.27 2332.55 1566.16 Q2332.55 1559.03 2330.73 1555.49 Q2328.92 1551.93 2325.29 1551.93 M2325.29 1548.22 Q2331.1 1548.22 2334.15 1552.83 Q2337.23 1557.41 2337.23 1566.16 Q2337.23 1574.89 2334.15 1579.5 Q2331.1 1584.08 2325.29 1584.08 Q2319.48 1584.08 2316.4 1579.5 Q2313.34 1574.89 2313.34 1566.16 Q2313.34 1557.41 2316.4 1552.83 Q2319.48 1548.22 2325.29 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1483.94 2352.76,1483.94 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1242.77 2352.76,1242.77 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1001.6 2352.76,1001.6 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,760.433 2352.76,760.433 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,519.266 2352.76,519.266 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,278.098 2352.76,278.098 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1483.94 105.89,1483.94 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1242.77 105.89,1242.77 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1001.6 105.89,1001.6 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,760.433 105.89,760.433 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,519.266 105.89,519.266 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,278.098 105.89,278.098 "/>
<path clip-path="url(#clip930)" d="M-39.887 1484.39 L-10.2112 1484.39 L-10.2112 1488.32 L-39.887 1488.32 L-39.887 1484.39 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M0.69147 1497.28 L8.33032 1497.28 L8.33032 1470.91 L0.0201769 1472.58 L0.0201769 1468.32 L8.28402 1466.66 L12.9599 1466.66 L12.9599 1497.28 L20.5988 1497.28 L20.5988 1501.22 L0.69147 1501.22 L0.69147 1497.28 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M30.0895 1466.66 L48.4458 1466.66 L48.4458 1470.59 L34.3718 1470.59 L34.3718 1479.06 Q35.3904 1478.72 36.4089 1478.55 Q37.4274 1478.37 38.4459 1478.37 Q44.2329 1478.37 47.6125 1481.54 Q50.9921 1484.71 50.9921 1490.13 Q50.9921 1495.71 47.5199 1498.81 Q44.0477 1501.89 37.7283 1501.89 Q35.5524 1501.89 33.2839 1501.52 Q31.0385 1501.15 28.6311 1500.41 L28.6311 1495.71 Q30.7145 1496.84 32.9367 1497.4 Q35.1589 1497.95 37.6357 1497.95 Q41.6403 1497.95 43.9783 1495.85 Q46.3162 1493.74 46.3162 1490.13 Q46.3162 1486.52 43.9783 1484.41 Q41.6403 1482.3 37.6357 1482.3 Q35.7607 1482.3 33.8857 1482.72 Q32.0339 1483.14 30.0895 1484.02 L30.0895 1466.66 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M-40.8824 1243.22 L-11.2066 1243.22 L-11.2066 1247.15 L-40.8824 1247.15 L-40.8824 1243.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M-0.303895 1256.11 L7.33495 1256.11 L7.33495 1229.75 L-0.975188 1231.41 L-0.975188 1227.15 L7.28866 1225.49 L11.9646 1225.49 L11.9646 1256.11 L19.6034 1256.11 L19.6034 1260.05 L-0.303895 1260.05 L-0.303895 1256.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M39.0477 1228.57 Q35.4367 1228.57 33.608 1232.13 Q31.8024 1235.67 31.8024 1242.8 Q31.8024 1249.91 33.608 1253.47 Q35.4367 1257.02 39.0477 1257.02 Q42.682 1257.02 44.4875 1253.47 Q46.3162 1249.91 46.3162 1242.8 Q46.3162 1235.67 44.4875 1232.13 Q42.682 1228.57 39.0477 1228.57 M39.0477 1224.86 Q44.8579 1224.86 47.9134 1229.47 Q50.9921 1234.05 50.9921 1242.8 Q50.9921 1251.53 47.9134 1256.14 Q44.8579 1260.72 39.0477 1260.72 Q33.2376 1260.72 30.1589 1256.14 Q27.1034 1251.53 27.1034 1242.8 Q27.1034 1234.05 30.1589 1229.47 Q33.2376 1224.86 39.0477 1224.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M-9.72514 1002.05 L19.9506 1002.05 L19.9506 1005.99 L-9.72514 1005.99 L-9.72514 1002.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M30.0895 984.321 L48.4458 984.321 L48.4458 988.256 L34.3718 988.256 L34.3718 996.728 Q35.3904 996.381 36.4089 996.219 Q37.4274 996.033 38.4459 996.033 Q44.2329 996.033 47.6125 999.205 Q50.9921 1002.38 50.9921 1007.79 Q50.9921 1013.37 47.5199 1016.47 Q44.0477 1019.55 37.7283 1019.55 Q35.5524 1019.55 33.2839 1019.18 Q31.0385 1018.81 28.6311 1018.07 L28.6311 1013.37 Q30.7145 1014.51 32.9367 1015.06 Q35.1589 1015.62 37.6357 1015.62 Q41.6403 1015.62 43.9783 1013.51 Q46.3162 1011.4 46.3162 1007.79 Q46.3162 1004.18 43.9783 1002.08 Q41.6403 999.969 37.6357 999.969 Q35.7607 999.969 33.8857 1000.39 Q32.0339 1000.8 30.0895 1001.68 L30.0895 984.321 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M39.0477 746.232 Q35.4367 746.232 33.608 749.797 Q31.8024 753.338 31.8024 760.468 Q31.8024 767.574 33.608 771.139 Q35.4367 774.681 39.0477 774.681 Q42.682 774.681 44.4875 771.139 Q46.3162 767.574 46.3162 760.468 Q46.3162 753.338 44.4875 749.797 Q42.682 746.232 39.0477 746.232 M39.0477 742.528 Q44.8579 742.528 47.9134 747.135 Q50.9921 751.718 50.9921 760.468 Q50.9921 769.195 47.9134 773.801 Q44.8579 778.384 39.0477 778.384 Q33.2376 778.384 30.1589 773.801 Q27.1034 769.195 27.1034 760.468 Q27.1034 751.718 30.1589 747.135 Q33.2376 742.528 39.0477 742.528 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M30.0895 501.986 L48.4458 501.986 L48.4458 505.921 L34.3718 505.921 L34.3718 514.393 Q35.3904 514.046 36.4089 513.884 Q37.4274 513.698 38.4459 513.698 Q44.2329 513.698 47.6125 516.87 Q50.9921 520.041 50.9921 525.458 Q50.9921 531.036 47.5199 534.138 Q44.0477 537.217 37.7283 537.217 Q35.5524 537.217 33.2839 536.847 Q31.0385 536.476 28.6311 535.735 L28.6311 531.036 Q30.7145 532.171 32.9367 532.726 Q35.1589 533.282 37.6357 533.282 Q41.6403 533.282 43.9783 531.175 Q46.3162 529.069 46.3162 525.458 Q46.3162 521.847 43.9783 519.74 Q41.6403 517.634 37.6357 517.634 Q35.7607 517.634 33.8857 518.05 Q32.0339 518.467 30.0895 519.347 L30.0895 501.986 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M-0.303895 291.443 L7.33495 291.443 L7.33495 265.077 L-0.975188 266.744 L-0.975188 262.485 L7.28866 260.818 L11.9646 260.818 L11.9646 291.443 L19.6034 291.443 L19.6034 295.378 L-0.303895 295.378 L-0.303895 291.443 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip930)" d="M39.0477 263.897 Q35.4367 263.897 33.608 267.462 Q31.8024 271.003 31.8024 278.133 Q31.8024 285.239 33.608 288.804 Q35.4367 292.346 39.0477 292.346 Q42.682 292.346 44.4875 288.804 Q46.3162 285.239 46.3162 278.133 Q46.3162 271.003 44.4875 267.462 Q42.682 263.897 39.0477 263.897 M39.0477 260.193 Q44.8579 260.193 47.9134 264.8 Q50.9921 269.383 50.9921 278.133 Q50.9921 286.86 47.9134 291.466 Q44.8579 296.049 39.0477 296.049 Q33.2376 296.049 30.1589 291.466 Q27.1034 286.86 27.1034 278.133 Q27.1034 269.383 30.1589 264.8 Q33.2376 260.193 39.0477 260.193 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip932)" d="M151.118 860.838 L364.869 1382.24 L578.62 1479.3 L792.371 1472.55 L1006.12 1444.8 L1219.87 1407.57 L1433.63 1373.45 L1647.38 1341.6 L1861.13 1315.08 L2074.88 1287.11 L2288.63 1259.09 L2288.63 283.654 L2074.88 258.232 L1861.13 233.44 L1647.38 207.863 L1433.63 183.868 L1219.87 158.466 L1006.12 129.469 L792.371 100.437 L578.62 88.9544 L364.869 165.205 L151.118 664.318  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip932)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,757.098 364.869,749.384 578.62,747.162 792.371,747.699 1006.12,745.069 1219.87,742.628 1433.63,742.756 1647.38,745.604 1861.13,746.773 2074.88,750.865 2288.63,751.019 "/>
<path clip-path="url(#clip932)" d="M151.118 861.153 L364.869 781.05 L578.62 764.25 L792.371 761.129 L1006.12 761.185 L1219.87 761.241 L1433.63 761.079 L1647.38 761.382 L1861.13 761.346 L2074.88 761.249 L2288.63 760.934 L2288.63 759.453 L2074.88 759.552 L1861.13 759.701 L1647.38 759.497 L1433.63 759.559 L1219.87 759.547 L1006.12 759.899 L792.371 759.314 L578.62 756.825 L364.869 743.241 L151.118 676.801  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip932)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,754.844 364.869,759.121 578.62,760.572 792.371,760.409 1006.12,760.475 1219.87,760.415 1433.63,760.384 1647.38,760.374 1861.13,760.496 2074.88,760.586 2288.63,760.362 "/>
</svg>
<h2 id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><a class="docs-heading-anchor" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter">Observables and Marginal Likelihood using a Kalman Filter</a><a id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter" title="Permalink"></a></h2><p>If you provide <code>observables</code> and provide a distribution for the <code>observables_noise</code> then the model can provide a calculation of the likelihood.  </p><p>The simplest case is if you use a gaussian prior and have gaussian observation noise.  First, lets simulate some data with included observation noise.  If passing in a matrix or vector, the <code>observables_noise</code> argument is intended to be the cholesky of the covariance matrix.  At this point, only diagonal observation noise is allowed.</p><pre><code class="language-julia hljs">u0 = MvNormal([1.0 0.1; 0.1 1.0])  # draw from mean zero initial conditions
T = 10
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)
sol.z # simulated observables with observation noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-0.2716091143963828, -0.0014792703283575681]
 [-0.8285513590701137, -3.377386646137607]
 [-0.40894234436267807, -4.0970432006727515]
 [-0.6625109750244647, -3.931943519677295]
 [-0.47805373863170664, -4.220470093841508]
 [-0.611637552969684, -3.1113400299315352]
 [-0.8774711501275985, -2.9990784829317403]
 [-0.7469313986338324, -2.647114475094573]
 [-0.029724057338567367, -3.3569109910774846]
 [-0.2838492432709407, -3.394677500647095]
 [-0.0679649249824868, -2.7995481606891937]</code></pre><p>Next we will find the log likelihood of these simulated observables using the <code>u0</code> as a prior and with the true parameters.</p><p>The new arguments we pass to the problem creation are <code>u0_prior_variance, u0_prior_mean,</code> and <code>observables</code>.  The <code>u0</code> is ignored for the filtering problem but must match the size.  The <code>KalmanFilter()</code> argument to the <code>solve</code> is unnecessary since it can select it manually given the priors and observables.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The timing convention is such that <code>observables</code> are expected to match the predictions starting at the second time period.  As the likelihood of the first element <code>u0</code> comes from a prior, the <code>observables</code> start at the next element, and hence the observables and noise sequences should be 1 less than the tspan </p></div></div><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = copy(sol.W) # save for later
u0_prior_mean = [0.0, 0.0]
# use covariance of distribution we drew from
u0_prior_var = cov(u0)

prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
sol = solve(prob, KalmanFilter())
# plot(sol) The `u` is the sequence of posterior means.
sol.logpdf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-11.284662680674169</code></pre><p>Hence the <code>logpdf</code> provides the log likelihood marginalizing out the latent noise variables.</p><p>As before, we can differentiate the kalman filter itself.</p><pre><code class="language-julia hljs">function kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
# Find the gradient wrt the A, B, C and priors variance.
gradient((A, B, C, u0_prior_var) -&gt; kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables), A, B, C, u0_prior_var)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-0.1050049783827185 -0.17745195190846236; 63.948238612412915 -0.6913833330333574], [-2.664413787638595; -8.743521986977555;;], [65.9001728950869 0.5261901479379687; -7.27750516311616 -0.07203640981552883], [-0.11776519619712343 4.1072125651098625; -4.21478364842651 -0.324731187256301])</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some of the gradients, such as those for <code>observables</code>, have not been implemented so test carefully.  This is a general theme with gradients and <code>Zygote.jl</code> in general.  Your best friend in this process is the spectacular <a href="https://github.com/JuliaDiff/ChainRulesTestUtils.jl">ChainRulesTestUtils.jl</a> package. See <code>test_rrule</code> usage in the <a href="https://github.com/SciML/DifferenceEquations.jl/blob/main/test/linear_gradients.jl">linear unit tests</a>.</p></div></div><h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>A key application of these methods is to find the joint likelihood of the latent variables (i.e., the <code>noise</code>) and the model definition.</p><p>The actual calculation of the likelihood is trivial in that case, and just requires iteration of the linear system while accumulating the likelihood given the observation noise.</p><p>Crucially, the differentiability with respect to the high-dimensional noise vector enables gradient-based sampling and estimation methods which would otherwise be infeasible.</p><pre><code class="language-julia hljs">function joint_likelihood(A, B, C, D, u0, noise, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood(A, B, C, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-584.2056199144162</code></pre><p>And as always, this can be differentiated with respect to the state-space matrices and the noise.  Choosing a few parameters,</p><pre><code class="language-julia hljs">gradient((A, u0, noise) -&gt; joint_likelihood(A, B, C, D, u0, noise, observables), A, u0, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([39.32298771017102 2.579256675139731; 222.37121785921255 12.532467950396608], [-262.40351871070106, -2096.712764817267], [-19.20922687210825 -16.900033757014953 … -1.6442119564910644 -0.003123024405763589])</code></pre><h2 id="Composition-of-State-Space-Models-and-AD"><a class="docs-heading-anchor" href="#Composition-of-State-Space-Models-and-AD">Composition of State Space Models and AD</a><a id="Composition-of-State-Space-Models-and-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-of-State-Space-Models-and-AD" title="Permalink"></a></h2><p>While the above gradients have been with respect to the full state space objects <code>A, B</code>, etc. those themselves could be generated through a separate procedure and the whole object differentiated.  For example, lets repeat the above examples where we generate the <code>A</code> matrix from some sort of deep parameters.</p><p>First we will generate some observations with a <code>generate_model</code> proxy–-which could be replaced with something more complicated but still differentiable</p><pre><code class="language-julia hljs">function generate_model(β)
    A = [β 6.2;
        0.0  0.2]
    B = Matrix([0.0  0.001]&#39;) # [0.0; 0.001;;] gives a zygote bug
    C = [0.09 0.67;
        1.00 0.00]
    D = [0.01, 0.01]
    return (;A,B,C,D)
end

function simulate_model(β, u0;T = 200)
    mod = generate_model(β)
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, T); mod.C, observables_noise = mod.D)
    sol = solve(prob) # simulates
    observables = hcat(sol.z...)
    observables = observables[:, 2:end] # see note above on likelihood and timing
    return observables, sol.W
end

# Fix a &quot;pseudo-true&quot; and generate noise and observables
β = 0.95
u0 = [0.0, 0.0]
observables, noise = simulate_model(β, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.08737284706659106 0.09219105222667147 … -0.09709557384690096 -0.0021607396603118517; 0.11265200736198398 -0.050570995120295906 … 0.025183495251780857 0.06672599144167626], [1.1288078858431798 0.6294202439853087 … 0.7790448323910715 -0.954798841404945])</code></pre><p>Next, we will evaluate the marginal likelihood using the kalman filter for a particular <code>β</code> value,</p><pre><code class="language-julia hljs">function kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
u0_prior_mean = [0.0, 0.0]
u0_prior_var = [1e-10 0.0;
                0.0 1e-10]  # starting with degenerate prior
kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">335.2327990952242</code></pre><p>Given the observation error we would not expect the pseudo-true to exactly maximimize the log likelihood.  To show this, we can optimize it using using the Optim package and using a gradient-based optimization routine</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimJL
# Create a function to minimize only of β and use Zygote based gradients
kalman_objective(β,p) = -kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
kalman_objective(0.95, nothing)
gradient(β -&gt;kalman_objective(β, nothing),β) # Verifying it can be differentiated


optf = OptimizationFunction(kalman_objective, Optimization.AutoZygote())
β0 = [0.91] # start off of the pseudotrue
optprob = OptimizationProblem(optf, β0)
optsol = solve(optprob,LBFGS())  # reverse-mode AD is overkill here</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 1-element Vector{Float64}:
 0.9209371373817815</code></pre><p>In this way, this package composes with others such as <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">DifferentiableStateSpaceModels.jl</a> which take a set of structural parameters and an expectational difference equation and generate a state-space model.</p><p>Similarly, we can find the joint likelihood for a particular <code>β</code> value and noise.  Here we will add in prior.  Some form of a prior or regularization is generally necessary for these sorts of nonlinear models.</p><pre><code class="language-julia hljs">function joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, noise)
    return solve(prob).logpdf + sum(logpdf.(noise_prior, noise)) + logpdf(β_prior, β) # posterior
end
u0 = [0.0, 0.0]
noise_prior = Normal(0.0, 1.0)
β_prior = Normal(β, 0.03) # prior local to the true value
joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">58.99595390966317</code></pre><p>Which we can turn into a differntiable objective adding in a prior on the noise</p><pre><code class="language-julia hljs">joint_model_objective(x, p) = -joint_model_posterior(x[1], u0, Matrix(x[2:end]&#39;), observables, noise_prior, β_prior) # extract noise and parameeter from vector
x0 = vcat([0.95], noise[1,:])  # starting at the true noise
joint_model_objective(x0, nothing)
gradient(x -&gt;joint_model_objective(x, nothing),x0) # Verifying it can be differentiated

# optimize
optf = OptimizationFunction(joint_model_objective, Optimization.AutoZygote())
optprob = OptimizationProblem(optf, x0)
optsol = solve(optprob,LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 201-element Vector{Float64}:
  0.9718784206647295
  0.1842792028565033
  0.21798413325852736
  0.2268737000229651
  0.24960513265953257
  0.2904391248649157
  0.2949100219527173
  0.25966115450448607
  0.23382445888202213
  0.14521205202963186
  ⋮
  0.026793454105220275
  0.0315406568248974
 -0.04297311585264
  0.05609236759962263
  0.15243958911141167
  0.03998983448844568
  0.04639726165590875
  0.025342761476887698
 -0.00023445302272136635</code></pre><p>This &quot;solves&quot; the problem relatively quickly, despite the high-dimensionality.  However, from a statistics perspective note that this last optimization process does not do especially well in recovering the pseudotrue if you increase the prior variance on the <code>β</code> parameter.  Maximizing the posterior is usually the wrong thing to do in high-dimensions because the mode is not a typical set.</p><h2 id="Caveats-on-Gradients-and-Performance"><a class="docs-heading-anchor" href="#Caveats-on-Gradients-and-Performance">Caveats on Gradients and Performance</a><a id="Caveats-on-Gradients-and-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Caveats-on-Gradients-and-Performance" title="Permalink"></a></h2><p>A few notes on performance and gradients:</p><ol><li>As this is using reverse-mode AD it will be efficient for fairly large systems as long as the ultimate value of your differentiable program.  With a little extra work and unit tests, it could support structured matrices/etc. as well.</li><li>Getting to much higher scales, where the <code>A,B,C,D</code> are so large that matrix-free operators is necessary, is feasible but will require generalizing those to LinearOperators.  This would be reasonably easy for the joint likelihood and feasible but possible for the Kalman filter</li><li>At this point, there is no support for forward-mode auto-differentiation.  For smaller systems with a kalman filter, this should dominate the alternatives, and efficient forward-mode AD rules for the kalman filter exist (see the supplementary materials in the the <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">Differentiable State Space Models</a> paper).  However, it would be a significant amount of work to add end-to-end support and fulfill standard SciML interfaces, and perhaps waiting for <a href="https://enzyme.mit.edu/julia/">Enzyme</a> or similar AD systems that provide both forward/reverse/mixed mode makes sense.</li><li>Forward-mode AD is likely inappropriate for the joint-likelihood based models since the dimensionality of the noise is always large.</li><li>The gradient rules are written using <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules.jl</a> so in theory they will work with any supporting AD.  In practice, though, Zygote is the most tested and other systems have inconsistent support on Julia at this time.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a><a class="docs-footer-nextpage" href="../quadratic_state_space_examples/">Quadratic State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 13 March 2023 21:54">Monday 13 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
