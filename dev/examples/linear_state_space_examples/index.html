<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/linear_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Linear (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Simulating-Ensembles-and-Fixing-Noise"><span>Simulating Ensembles and Fixing Noise</span></a></li><li><a class="tocitem" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><span>Observables and Marginal Likelihood using a Kalman Filter</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li><li><a class="tocitem" href="#Composition-of-State-Space-Models-and-AD"><span>Composition of State Space Models and AD</span></a></li><li><a class="tocitem" href="#Caveats-on-Gradients-and-Performance"><span>Caveats on Gradients and Performance</span></a></li></ul></li><li><a class="tocitem" href="../quadratic_state_space_examples/">Quadratic State Space Examples</a></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/linear_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-State-Space-Examples"><a class="docs-heading-anchor" href="#Linear-State-Space-Examples">Linear State Space Examples</a><a id="Linear-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-State-Space-Examples" title="Permalink"></a></h1><p>This tutorial provides describes the support for linear and linear gaussian state space models.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form of the linear model is</p><p class="math-container">\[u_{n+1} = A u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.  More generally, support could be added for <span>$u_{n+1} = A(p,n) u_n + B(p,n) w_{n+1}$</span> where <span>$p$</span> is a vector of differentiable parameters, and the <span>$A$</span> and <span>$B$</span> are potentially matrix-free operators.</p><h2 id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model">Simulating a Linear (and Time-Invariant) State Space Model</a><a id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>LinearStateSpaceProblem</code> and simulating it for a simple, linear equation.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote
A = [0.95 6.2;
     0.0  0.2]
B = [0.0; 0.01;;] # matrix
C = [0.09 0.67;
     1.00 0.00]
D = [0.1, 0.1] # diagonal observation noise
u0 = zeros(2)
T = 10

prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:10
u: 11-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [0.0, -0.015067101751249246]
 [-0.09341603085774533, -0.0070772361057572395]
 [-0.13262409317055296, 0.0018706452979174834]
 [-0.11439488766493691, -0.0013527636876471787]
 [-0.11706227814510257, 0.003064696143241206]
 [-0.09220804814975196, -0.0041335278716261165]
 [-0.11322551854634628, 0.0013144195450591292]
 [-0.09941484143966237, -0.01050322487894101]
 [-0.15956409361711352, 0.01805813195967153]
 [-0.039625470786294324, 0.021885517278067545]</code></pre><p>The <code>u</code> vector of the simulated solution can be plotted using standard recipes, including use of the optional <code>syms</code>.  See <a href="https://diffeq.sciml.ai/latest/basics/plot/">SciML docs</a> for more options.</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip100">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip100)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip101">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip100)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip102">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip100)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1391.49 2352.76,1391.49 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1012.47 2352.76,1012.47 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,633.44 2352.76,633.44 "/>
<polyline clip-path="url(#clip102)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,254.413 2352.76,254.413 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1391.49 105.89,1391.49 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1012.47 105.89,1012.47 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,633.44 105.89,633.44 "/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,254.413 105.89,254.413 "/>
<path clip-path="url(#clip100)" d="M-85.1183 1391.95 L-55.4425 1391.95 L-55.4425 1395.88 L-85.1183 1395.88 L-85.1183 1391.95 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-35.35 1377.29 Q-38.9611 1377.29 -40.7898 1380.86 Q-42.5953 1384.4 -42.5953 1391.53 Q-42.5953 1398.64 -40.7898 1402.2 Q-38.9611 1405.74 -35.35 1405.74 Q-31.7158 1405.74 -29.9102 1402.2 Q-28.0815 1398.64 -28.0815 1391.53 Q-28.0815 1384.4 -29.9102 1380.86 Q-31.7158 1377.29 -35.35 1377.29 M-35.35 1373.59 Q-29.5398 1373.59 -26.4843 1378.2 Q-23.4056 1382.78 -23.4056 1391.53 Q-23.4056 1400.26 -26.4843 1404.86 Q-29.5398 1409.45 -35.35 1409.45 Q-41.1602 1409.45 -44.2388 1404.86 Q-47.2944 1400.26 -47.2944 1391.53 Q-47.2944 1382.78 -44.2388 1378.2 Q-41.1602 1373.59 -35.35 1373.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-15.1881 1402.89 L-10.3038 1402.89 L-10.3038 1408.77 L-15.1881 1408.77 L-15.1881 1402.89 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M0.69147 1404.84 L8.33032 1404.84 L8.33032 1378.47 L0.0201769 1380.14 L0.0201769 1375.88 L8.28402 1374.21 L12.9599 1374.21 L12.9599 1404.84 L20.5988 1404.84 L20.5988 1408.77 L0.69147 1408.77 L0.69147 1404.84 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M30.0895 1374.21 L48.4458 1374.21 L48.4458 1378.15 L34.3718 1378.15 L34.3718 1386.62 Q35.3904 1386.27 36.4089 1386.11 Q37.4274 1385.93 38.4459 1385.93 Q44.2329 1385.93 47.6125 1389.1 Q50.9921 1392.27 50.9921 1397.69 Q50.9921 1403.26 47.5199 1406.37 Q44.0477 1409.45 37.7283 1409.45 Q35.5524 1409.45 33.2839 1409.08 Q31.0385 1408.7 28.6311 1407.96 L28.6311 1403.26 Q30.7145 1404.4 32.9367 1404.95 Q35.1589 1405.51 37.6357 1405.51 Q41.6403 1405.51 43.9783 1403.4 Q46.3162 1401.3 46.3162 1397.69 Q46.3162 1394.08 43.9783 1391.97 Q41.6403 1389.86 37.6357 1389.86 Q35.7607 1389.86 33.8857 1390.28 Q32.0339 1390.7 30.0895 1391.58 L30.0895 1374.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-86.1136 1012.92 L-56.4379 1012.92 L-56.4379 1016.85 L-86.1136 1016.85 L-86.1136 1012.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-36.3454 998.266 Q-39.9565 998.266 -41.7852 1001.83 Q-43.5907 1005.37 -43.5907 1012.5 Q-43.5907 1019.61 -41.7852 1023.17 Q-39.9565 1026.71 -36.3454 1026.71 Q-32.7111 1026.71 -30.9056 1023.17 Q-29.0769 1019.61 -29.0769 1012.5 Q-29.0769 1005.37 -30.9056 1001.83 Q-32.7111 998.266 -36.3454 998.266 M-36.3454 994.562 Q-30.5352 994.562 -27.4797 999.169 Q-24.401 1003.75 -24.401 1012.5 Q-24.401 1021.23 -27.4797 1025.84 Q-30.5352 1030.42 -36.3454 1030.42 Q-42.1555 1030.42 -45.2342 1025.84 Q-48.2897 1021.23 -48.2897 1012.5 Q-48.2897 1003.75 -45.2342 999.169 Q-42.1555 994.562 -36.3454 994.562 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-16.1834 1023.87 L-11.2992 1023.87 L-11.2992 1029.75 L-16.1834 1029.75 L-16.1834 1023.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-0.303895 1025.81 L7.33495 1025.81 L7.33495 999.446 L-0.975188 1001.11 L-0.975188 996.854 L7.28866 995.187 L11.9646 995.187 L11.9646 1025.81 L19.6034 1025.81 L19.6034 1029.75 L-0.303895 1029.75 L-0.303895 1025.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M39.0477 998.266 Q35.4367 998.266 33.608 1001.83 Q31.8024 1005.37 31.8024 1012.5 Q31.8024 1019.61 33.608 1023.17 Q35.4367 1026.71 39.0477 1026.71 Q42.682 1026.71 44.4875 1023.17 Q46.3162 1019.61 46.3162 1012.5 Q46.3162 1005.37 44.4875 1001.83 Q42.682 998.266 39.0477 998.266 M39.0477 994.562 Q44.8579 994.562 47.9134 999.169 Q50.9921 1003.75 50.9921 1012.5 Q50.9921 1021.23 47.9134 1025.84 Q44.8579 1030.42 39.0477 1030.42 Q33.2376 1030.42 30.1589 1025.84 Q27.1034 1021.23 27.1034 1012.5 Q27.1034 1003.75 30.1589 999.169 Q33.2376 994.562 39.0477 994.562 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-85.1183 633.891 L-55.4425 633.891 L-55.4425 637.826 L-85.1183 637.826 L-85.1183 633.891 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-35.35 619.239 Q-38.9611 619.239 -40.7898 622.803 Q-42.5953 626.345 -42.5953 633.475 Q-42.5953 640.581 -40.7898 644.146 Q-38.9611 647.688 -35.35 647.688 Q-31.7158 647.688 -29.9102 644.146 Q-28.0815 640.581 -28.0815 633.475 Q-28.0815 626.345 -29.9102 622.803 Q-31.7158 619.239 -35.35 619.239 M-35.35 615.535 Q-29.5398 615.535 -26.4843 620.141 Q-23.4056 624.725 -23.4056 633.475 Q-23.4056 642.201 -26.4843 646.808 Q-29.5398 651.391 -35.35 651.391 Q-41.1602 651.391 -44.2388 646.808 Q-47.2944 642.201 -47.2944 633.475 Q-47.2944 624.725 -44.2388 620.141 Q-41.1602 615.535 -35.35 615.535 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-15.1881 644.84 L-10.3038 644.84 L-10.3038 650.72 L-15.1881 650.72 L-15.1881 644.84 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M9.88124 619.239 Q6.27014 619.239 4.44145 622.803 Q2.6359 626.345 2.6359 633.475 Q2.6359 640.581 4.44145 644.146 Q6.27014 647.688 9.88124 647.688 Q13.5155 647.688 15.321 644.146 Q17.1497 640.581 17.1497 633.475 Q17.1497 626.345 15.321 622.803 Q13.5155 619.239 9.88124 619.239 M9.88124 615.535 Q15.6914 615.535 18.7469 620.141 Q21.8256 624.725 21.8256 633.475 Q21.8256 642.201 18.7469 646.808 Q15.6914 651.391 9.88124 651.391 Q4.07108 651.391 0.992394 646.808 Q-2.06315 642.201 -2.06315 633.475 Q-2.06315 624.725 0.992394 620.141 Q4.07108 615.535 9.88124 615.535 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M30.0895 616.16 L48.4458 616.16 L48.4458 620.095 L34.3718 620.095 L34.3718 628.567 Q35.3904 628.22 36.4089 628.058 Q37.4274 627.873 38.4459 627.873 Q44.2329 627.873 47.6125 631.044 Q50.9921 634.215 50.9921 639.632 Q50.9921 645.211 47.5199 648.313 Q44.0477 651.391 37.7283 651.391 Q35.5524 651.391 33.2839 651.021 Q31.0385 650.65 28.6311 649.91 L28.6311 645.211 Q30.7145 646.345 32.9367 646.901 Q35.1589 647.456 37.6357 647.456 Q41.6403 647.456 43.9783 645.35 Q46.3162 643.243 46.3162 639.632 Q46.3162 636.021 43.9783 633.914 Q41.6403 631.808 37.6357 631.808 Q35.7607 631.808 33.8857 632.225 Q32.0339 632.641 30.0895 633.521 L30.0895 616.16 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-36.3454 240.211 Q-39.9565 240.211 -41.7852 243.776 Q-43.5907 247.318 -43.5907 254.448 Q-43.5907 261.554 -41.7852 265.119 Q-39.9565 268.66 -36.3454 268.66 Q-32.7111 268.66 -30.9056 265.119 Q-29.0769 261.554 -29.0769 254.448 Q-29.0769 247.318 -30.9056 243.776 Q-32.7111 240.211 -36.3454 240.211 M-36.3454 236.508 Q-30.5352 236.508 -27.4797 241.114 Q-24.401 245.698 -24.401 254.448 Q-24.401 263.174 -27.4797 267.781 Q-30.5352 272.364 -36.3454 272.364 Q-42.1555 272.364 -45.2342 267.781 Q-48.2897 263.174 -48.2897 254.448 Q-48.2897 245.698 -45.2342 241.114 Q-42.1555 236.508 -36.3454 236.508 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M-16.1834 265.813 L-11.2992 265.813 L-11.2992 271.693 L-16.1834 271.693 L-16.1834 265.813 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M8.88587 240.211 Q5.27478 240.211 3.44608 243.776 Q1.64054 247.318 1.64054 254.448 Q1.64054 261.554 3.44608 265.119 Q5.27478 268.66 8.88587 268.66 Q12.5201 268.66 14.3257 265.119 Q16.1543 261.554 16.1543 254.448 Q16.1543 247.318 14.3257 243.776 Q12.5201 240.211 8.88587 240.211 M8.88587 236.508 Q14.696 236.508 17.7516 241.114 Q20.8303 245.698 20.8303 254.448 Q20.8303 263.174 17.7516 267.781 Q14.696 272.364 8.88587 272.364 Q3.07572 272.364 -0.00297114 267.781 Q-3.05851 263.174 -3.05851 254.448 Q-3.05851 245.698 -0.00297114 241.114 Q3.07572 236.508 8.88587 236.508 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip100)" d="M39.0477 240.211 Q35.4367 240.211 33.608 243.776 Q31.8024 247.318 31.8024 254.448 Q31.8024 261.554 33.608 265.119 Q35.4367 268.66 39.0477 268.66 Q42.682 268.66 44.4875 265.119 Q46.3162 261.554 46.3162 254.448 Q46.3162 247.318 44.4875 243.776 Q42.682 240.211 39.0477 240.211 M39.0477 236.508 Q44.8579 236.508 47.9134 241.114 Q50.9921 245.698 50.9921 254.448 Q50.9921 263.174 47.9134 267.781 Q44.8579 272.364 39.0477 272.364 Q33.2376 272.364 30.1589 267.781 Q27.1034 263.174 27.1034 254.448 Q27.1034 245.698 30.1589 241.114 Q33.2376 236.508 39.0477 236.508 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip102)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,254.413 313.569,254.413 540.145,962.557 766.721,1259.78 993.298,1121.59 1219.87,1141.81 1446.45,953.4 1673.03,1112.72 1899.6,1008.03 2126.18,1464 2352.76,554.795 "/>
<polyline clip-path="url(#clip102)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,254.413 313.569,368.63 540.145,308.062 766.721,240.232 993.298,264.667 1219.87,231.181 1446.45,285.747 1673.03,244.449 1899.6,334.033 2126.18,117.522 2352.76,88.5087 "/>
<path clip-path="url(#clip100)" d="M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip100)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 "/>
<polyline clip-path="url(#clip100)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1352.98 338.744,1352.98 "/>
<path clip-path="url(#clip100)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip100)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1404.82 338.744,1404.82 "/>
<path clip-path="url(#clip100)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>By default the solution provides an interface to access the simulated <code>u</code>.  That is, <code>sol.u[...] = sol[...]</code>,</p><pre><code class="language-julia hljs">sol[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
  0.0
 -0.015067101751249246</code></pre><p>Or to get the first element of the last step</p><pre><code class="language-julia hljs">sol[end][1] #first element of last step</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-0.039625470786294324</code></pre><p>Finally, to extract the full vector</p><pre><code class="language-julia hljs">@show sol[2,:];  # whole second vector</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
 -0.015067101751249246
 -0.0070772361057572395
  0.0018706452979174834
 -0.0013527636876471787
  0.003064696143241206
 -0.0041335278716261165
  0.0013144195450591292
 -0.01050322487894101
  0.01805813195967153
  0.021885517278067545</code></pre><p>The results for all of <code>sol.u</code> can be loaded in a dataframe, where the column names will be the (optionally) provided symbols.</p><pre><code class="language-julia hljs">df = DataFrame(sol)</code></pre><div><div style = "float: left;"><span>11×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">timestamp</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-0.0150671</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">2</td><td style = "text-align: right;">-0.093416</td><td style = "text-align: right;">-0.00707724</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">3</td><td style = "text-align: right;">-0.132624</td><td style = "text-align: right;">0.00187065</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">4</td><td style = "text-align: right;">-0.114395</td><td style = "text-align: right;">-0.00135276</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">5</td><td style = "text-align: right;">-0.117062</td><td style = "text-align: right;">0.0030647</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">6</td><td style = "text-align: right;">-0.092208</td><td style = "text-align: right;">-0.00413353</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">7</td><td style = "text-align: right;">-0.113226</td><td style = "text-align: right;">0.00131442</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">8</td><td style = "text-align: right;">-0.0994148</td><td style = "text-align: right;">-0.0105032</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">9</td><td style = "text-align: right;">-0.159564</td><td style = "text-align: right;">0.0180581</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">10</td><td style = "text-align: right;">-0.0396255</td><td style = "text-align: right;">0.0218855</td></tr></tbody></table></div><p>Other results, such as the simulated noise and observables can be extracted from the solution</p><pre><code class="language-julia hljs">sol.z # observables</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-0.4193842119420927, -0.05848456882340426]
 [0.17492987482904948, 0.5176506348726345]
 [-0.004632116793819887, -0.5214322492470403]
 [-0.022850759164664666, -0.32546986102523284]
 [0.465511240676303, -0.27467549369380984]
 [-0.5386306119903328, 0.3020003520064372]
 [-0.30418851965397636, -0.10659475171344027]
 [0.1108702184993531, 0.12249536326194947]
 [0.09401821060236662, -0.17859282201009247]
 [-0.4932908470721776, -0.27031000378707976]
 [0.06569644257813159, 0.18028540145707647]</code></pre><pre><code class="language-julia hljs">sol.W # Simulated Noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10 Matrix{Float64}:
 -1.50671  -0.406382  0.328609  -0.172689  …  -1.07661  2.01588  1.82739</code></pre><p>We can also solve the model passing in fixed noise, which will be useful for joint likelihoods.  First lets extract the noise from the previous solution, then rerun the simulation but with a different initial value</p><pre><code class="language-julia hljs">noise = sol.W
u0_2 = [0.1, 0.0]
prob2 = LinearStateSpaceProblem(A, B, u0_2, (0, T); C, observables_noise = D, syms = [:a, :b], noise)
sol2 = solve(prob2)
plot(sol2)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip160">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip160)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip161">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip160)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip162">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip160)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1488.22 2352.76,1488.22 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1138.29 2352.76,1138.29 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,788.362 2352.76,788.362 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,438.436 2352.76,438.436 "/>
<polyline clip-path="url(#clip162)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,88.5087 2352.76,88.5087 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1488.22 105.89,1488.22 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1138.29 105.89,1138.29 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,788.362 105.89,788.362 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,438.436 105.89,438.436 "/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,88.5087 105.89,88.5087 "/>
<path clip-path="url(#clip160)" d="M-86.1136 1488.67 L-56.4379 1488.67 L-56.4379 1492.6 L-86.1136 1492.6 L-86.1136 1488.67 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-36.3454 1474.01 Q-39.9565 1474.01 -41.7852 1477.58 Q-43.5907 1481.12 -43.5907 1488.25 Q-43.5907 1495.36 -41.7852 1498.92 Q-39.9565 1502.46 -36.3454 1502.46 Q-32.7111 1502.46 -30.9056 1498.92 Q-29.0769 1495.36 -29.0769 1488.25 Q-29.0769 1481.12 -30.9056 1477.58 Q-32.7111 1474.01 -36.3454 1474.01 M-36.3454 1470.31 Q-30.5352 1470.31 -27.4797 1474.92 Q-24.401 1479.5 -24.401 1488.25 Q-24.401 1496.98 -27.4797 1501.58 Q-30.5352 1506.17 -36.3454 1506.17 Q-42.1555 1506.17 -45.2342 1501.58 Q-48.2897 1496.98 -48.2897 1488.25 Q-48.2897 1479.5 -45.2342 1474.92 Q-42.1555 1470.31 -36.3454 1470.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-16.1834 1499.62 L-11.2992 1499.62 L-11.2992 1505.5 L-16.1834 1505.5 L-16.1834 1499.62 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-0.303895 1501.56 L7.33495 1501.56 L7.33495 1475.2 L-0.975188 1476.86 L-0.975188 1472.6 L7.28866 1470.94 L11.9646 1470.94 L11.9646 1501.56 L19.6034 1501.56 L19.6034 1505.5 L-0.303895 1505.5 L-0.303895 1501.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M39.0477 1474.01 Q35.4367 1474.01 33.608 1477.58 Q31.8024 1481.12 31.8024 1488.25 Q31.8024 1495.36 33.608 1498.92 Q35.4367 1502.46 39.0477 1502.46 Q42.682 1502.46 44.4875 1498.92 Q46.3162 1495.36 46.3162 1488.25 Q46.3162 1481.12 44.4875 1477.58 Q42.682 1474.01 39.0477 1474.01 M39.0477 1470.31 Q44.8579 1470.31 47.9134 1474.92 Q50.9921 1479.5 50.9921 1488.25 Q50.9921 1496.98 47.9134 1501.58 Q44.8579 1506.17 39.0477 1506.17 Q33.2376 1506.17 30.1589 1501.58 Q27.1034 1496.98 27.1034 1488.25 Q27.1034 1479.5 30.1589 1474.92 Q33.2376 1470.31 39.0477 1470.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-85.1183 1138.74 L-55.4425 1138.74 L-55.4425 1142.68 L-85.1183 1142.68 L-85.1183 1138.74 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-35.35 1124.09 Q-38.9611 1124.09 -40.7898 1127.65 Q-42.5953 1131.19 -42.5953 1138.32 Q-42.5953 1145.43 -40.7898 1149 Q-38.9611 1152.54 -35.35 1152.54 Q-31.7158 1152.54 -29.9102 1149 Q-28.0815 1145.43 -28.0815 1138.32 Q-28.0815 1131.19 -29.9102 1127.65 Q-31.7158 1124.09 -35.35 1124.09 M-35.35 1120.38 Q-29.5398 1120.38 -26.4843 1124.99 Q-23.4056 1129.57 -23.4056 1138.32 Q-23.4056 1147.05 -26.4843 1151.66 Q-29.5398 1156.24 -35.35 1156.24 Q-41.1602 1156.24 -44.2388 1151.66 Q-47.2944 1147.05 -47.2944 1138.32 Q-47.2944 1129.57 -44.2388 1124.99 Q-41.1602 1120.38 -35.35 1120.38 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-15.1881 1149.69 L-10.3038 1149.69 L-10.3038 1155.57 L-15.1881 1155.57 L-15.1881 1149.69 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M9.88124 1124.09 Q6.27014 1124.09 4.44145 1127.65 Q2.6359 1131.19 2.6359 1138.32 Q2.6359 1145.43 4.44145 1149 Q6.27014 1152.54 9.88124 1152.54 Q13.5155 1152.54 15.321 1149 Q17.1497 1145.43 17.1497 1138.32 Q17.1497 1131.19 15.321 1127.65 Q13.5155 1124.09 9.88124 1124.09 M9.88124 1120.38 Q15.6914 1120.38 18.7469 1124.99 Q21.8256 1129.57 21.8256 1138.32 Q21.8256 1147.05 18.7469 1151.66 Q15.6914 1156.24 9.88124 1156.24 Q4.07108 1156.24 0.992394 1151.66 Q-2.06315 1147.05 -2.06315 1138.32 Q-2.06315 1129.57 0.992394 1124.99 Q4.07108 1120.38 9.88124 1120.38 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M30.0895 1121.01 L48.4458 1121.01 L48.4458 1124.94 L34.3718 1124.94 L34.3718 1133.42 Q35.3904 1133.07 36.4089 1132.91 Q37.4274 1132.72 38.4459 1132.72 Q44.2329 1132.72 47.6125 1135.89 Q50.9921 1139.06 50.9921 1144.48 Q50.9921 1150.06 47.5199 1153.16 Q44.0477 1156.24 37.7283 1156.24 Q35.5524 1156.24 33.2839 1155.87 Q31.0385 1155.5 28.6311 1154.76 L28.6311 1150.06 Q30.7145 1151.19 32.9367 1151.75 Q35.1589 1152.31 37.6357 1152.31 Q41.6403 1152.31 43.9783 1150.2 Q46.3162 1148.09 46.3162 1144.48 Q46.3162 1140.87 43.9783 1138.76 Q41.6403 1136.66 37.6357 1136.66 Q35.7607 1136.66 33.8857 1137.07 Q32.0339 1137.49 30.0895 1138.37 L30.0895 1121.01 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-36.3454 774.161 Q-39.9565 774.161 -41.7852 777.726 Q-43.5907 781.268 -43.5907 788.397 Q-43.5907 795.504 -41.7852 799.068 Q-39.9565 802.61 -36.3454 802.61 Q-32.7111 802.61 -30.9056 799.068 Q-29.0769 795.504 -29.0769 788.397 Q-29.0769 781.268 -30.9056 777.726 Q-32.7111 774.161 -36.3454 774.161 M-36.3454 770.457 Q-30.5352 770.457 -27.4797 775.064 Q-24.401 779.647 -24.401 788.397 Q-24.401 797.124 -27.4797 801.73 Q-30.5352 806.314 -36.3454 806.314 Q-42.1555 806.314 -45.2342 801.73 Q-48.2897 797.124 -48.2897 788.397 Q-48.2897 779.647 -45.2342 775.064 Q-42.1555 770.457 -36.3454 770.457 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-16.1834 799.763 L-11.2992 799.763 L-11.2992 805.642 L-16.1834 805.642 L-16.1834 799.763 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M8.88587 774.161 Q5.27478 774.161 3.44608 777.726 Q1.64054 781.268 1.64054 788.397 Q1.64054 795.504 3.44608 799.068 Q5.27478 802.61 8.88587 802.61 Q12.5201 802.61 14.3257 799.068 Q16.1543 795.504 16.1543 788.397 Q16.1543 781.268 14.3257 777.726 Q12.5201 774.161 8.88587 774.161 M8.88587 770.457 Q14.696 770.457 17.7516 775.064 Q20.8303 779.647 20.8303 788.397 Q20.8303 797.124 17.7516 801.73 Q14.696 806.314 8.88587 806.314 Q3.07572 806.314 -0.00297114 801.73 Q-3.05851 797.124 -3.05851 788.397 Q-3.05851 779.647 -0.00297114 775.064 Q3.07572 770.457 8.88587 770.457 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M39.0477 774.161 Q35.4367 774.161 33.608 777.726 Q31.8024 781.268 31.8024 788.397 Q31.8024 795.504 33.608 799.068 Q35.4367 802.61 39.0477 802.61 Q42.682 802.61 44.4875 799.068 Q46.3162 795.504 46.3162 788.397 Q46.3162 781.268 44.4875 777.726 Q42.682 774.161 39.0477 774.161 M39.0477 770.457 Q44.8579 770.457 47.9134 775.064 Q50.9921 779.647 50.9921 788.397 Q50.9921 797.124 47.9134 801.73 Q44.8579 806.314 39.0477 806.314 Q33.2376 806.314 30.1589 801.73 Q27.1034 797.124 27.1034 788.397 Q27.1034 779.647 30.1589 775.064 Q33.2376 770.457 39.0477 770.457 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-35.35 424.234 Q-38.9611 424.234 -40.7898 427.799 Q-42.5953 431.341 -42.5953 438.47 Q-42.5953 445.577 -40.7898 449.142 Q-38.9611 452.683 -35.35 452.683 Q-31.7158 452.683 -29.9102 449.142 Q-28.0815 445.577 -28.0815 438.47 Q-28.0815 431.341 -29.9102 427.799 Q-31.7158 424.234 -35.35 424.234 M-35.35 420.531 Q-29.5398 420.531 -26.4843 425.137 Q-23.4056 429.72 -23.4056 438.47 Q-23.4056 447.197 -26.4843 451.804 Q-29.5398 456.387 -35.35 456.387 Q-41.1602 456.387 -44.2388 451.804 Q-47.2944 447.197 -47.2944 438.47 Q-47.2944 429.72 -44.2388 425.137 Q-41.1602 420.531 -35.35 420.531 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-15.1881 449.836 L-10.3038 449.836 L-10.3038 455.716 L-15.1881 455.716 L-15.1881 449.836 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M9.88124 424.234 Q6.27014 424.234 4.44145 427.799 Q2.6359 431.341 2.6359 438.47 Q2.6359 445.577 4.44145 449.142 Q6.27014 452.683 9.88124 452.683 Q13.5155 452.683 15.321 449.142 Q17.1497 445.577 17.1497 438.47 Q17.1497 431.341 15.321 427.799 Q13.5155 424.234 9.88124 424.234 M9.88124 420.531 Q15.6914 420.531 18.7469 425.137 Q21.8256 429.72 21.8256 438.47 Q21.8256 447.197 18.7469 451.804 Q15.6914 456.387 9.88124 456.387 Q4.07108 456.387 0.992394 451.804 Q-2.06315 447.197 -2.06315 438.47 Q-2.06315 429.72 0.992394 425.137 Q4.07108 420.531 9.88124 420.531 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M30.0895 421.156 L48.4458 421.156 L48.4458 425.091 L34.3718 425.091 L34.3718 433.563 Q35.3904 433.216 36.4089 433.054 Q37.4274 432.868 38.4459 432.868 Q44.2329 432.868 47.6125 436.04 Q50.9921 439.211 50.9921 444.628 Q50.9921 450.206 47.5199 453.308 Q44.0477 456.387 37.7283 456.387 Q35.5524 456.387 33.2839 456.016 Q31.0385 455.646 28.6311 454.905 L28.6311 450.206 Q30.7145 451.341 32.9367 451.896 Q35.1589 452.452 37.6357 452.452 Q41.6403 452.452 43.9783 450.345 Q46.3162 448.239 46.3162 444.628 Q46.3162 441.017 43.9783 438.91 Q41.6403 436.804 37.6357 436.804 Q35.7607 436.804 33.8857 437.22 Q32.0339 437.637 30.0895 438.517 L30.0895 421.156 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-36.3454 74.3074 Q-39.9565 74.3074 -41.7852 77.8722 Q-43.5907 81.4138 -43.5907 88.5434 Q-43.5907 95.6499 -41.7852 99.2147 Q-39.9565 102.756 -36.3454 102.756 Q-32.7111 102.756 -30.9056 99.2147 Q-29.0769 95.6499 -29.0769 88.5434 Q-29.0769 81.4138 -30.9056 77.8722 Q-32.7111 74.3074 -36.3454 74.3074 M-36.3454 70.6037 Q-30.5352 70.6037 -27.4797 75.2102 Q-24.401 79.7935 -24.401 88.5434 Q-24.401 97.2702 -27.4797 101.877 Q-30.5352 106.46 -36.3454 106.46 Q-42.1555 106.46 -45.2342 101.877 Q-48.2897 97.2702 -48.2897 88.5434 Q-48.2897 79.7935 -45.2342 75.2102 Q-42.1555 70.6037 -36.3454 70.6037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-16.1834 99.9091 L-11.2992 99.9091 L-11.2992 105.789 L-16.1834 105.789 L-16.1834 99.9091 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M-0.303895 101.854 L7.33495 101.854 L7.33495 75.4879 L-0.975188 77.1546 L-0.975188 72.8953 L7.28866 71.2287 L11.9646 71.2287 L11.9646 101.854 L19.6034 101.854 L19.6034 105.789 L-0.303895 105.789 L-0.303895 101.854 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip160)" d="M39.0477 74.3074 Q35.4367 74.3074 33.608 77.8722 Q31.8024 81.4138 31.8024 88.5434 Q31.8024 95.6499 33.608 99.2147 Q35.4367 102.756 39.0477 102.756 Q42.682 102.756 44.4875 99.2147 Q46.3162 95.6499 46.3162 88.5434 Q46.3162 81.4138 44.4875 77.8722 Q42.682 74.3074 39.0477 74.3074 M39.0477 70.6037 Q44.8579 70.6037 47.9134 75.2102 Q50.9921 79.7935 50.9921 88.5434 Q50.9921 97.2702 47.9134 101.877 Q44.8579 106.46 39.0477 106.46 Q33.2376 106.46 30.1589 101.877 Q27.1034 97.2702 27.1034 88.5434 Q27.1034 79.7935 30.1589 75.2102 Q33.2376 70.6037 39.0477 70.6037 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip162)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,88.5087 313.569,123.501 540.145,810.52 766.721,1116.5 993.298,1018.92 1219.87,1066.09 1446.45,919.227 1673.03,1092.04 1899.6,1019.82 2126.18,1464 2352.76,646.654 "/>
<polyline clip-path="url(#clip162)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,788.362 313.569,893.81 540.145,837.893 766.721,775.271 993.298,797.83 1219.87,766.914 1446.45,817.291 1673.03,779.163 1899.6,861.87 2126.18,661.982 2352.76,635.196 "/>
<path clip-path="url(#clip160)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip160)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip160)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip160)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip160)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip160)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>To construct an IRF we can take the model and perturb just the first element of the noise,</p><pre><code class="language-julia hljs">function irf(A, B, C, T = 20)
    noise = Matrix([1.0; zeros(T-1)]&#39;)
    problem = LinearStateSpaceProblem(A, B, zeros(2), (0, T); C, noise, syms = [:a, :b])
    return solve(problem)
end
plot(irf(A, B, C))</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip220">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip220)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip221">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip220)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip222">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="653.433,1505.26 653.433,47.2441 "/>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1505.26 1219.87,47.2441 "/>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1786.31,1505.26 1786.31,47.2441 "/>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="653.433,1505.26 653.433,1486.36 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1505.26 1219.87,1486.36 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1786.31,1505.26 1786.31,1486.36 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip220)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M643.711 1533.1 L662.067 1533.1 L662.067 1537.04 L647.993 1537.04 L647.993 1545.51 Q649.012 1545.16 650.03 1545 Q651.049 1544.81 652.067 1544.81 Q657.854 1544.81 661.234 1547.98 Q664.614 1551.16 664.614 1556.57 Q664.614 1562.15 661.141 1565.25 Q657.669 1568.33 651.35 1568.33 Q649.174 1568.33 646.905 1567.96 Q644.66 1567.59 642.253 1566.85 L642.253 1562.15 Q644.336 1563.28 646.558 1563.84 Q648.78 1564.4 651.257 1564.4 Q655.262 1564.4 657.6 1562.29 Q659.938 1560.18 659.938 1556.57 Q659.938 1552.96 657.6 1550.85 Q655.262 1548.75 651.257 1548.75 Q649.382 1548.75 647.507 1549.16 Q645.655 1549.58 643.711 1550.46 L643.711 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M1194.56 1563.72 L1202.2 1563.72 L1202.2 1537.36 L1193.89 1539.03 L1193.89 1534.77 L1202.15 1533.1 L1206.83 1533.1 L1206.83 1563.72 L1214.47 1563.72 L1214.47 1567.66 L1194.56 1567.66 L1194.56 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M1233.91 1536.18 Q1230.3 1536.18 1228.47 1539.74 Q1226.67 1543.28 1226.67 1550.41 Q1226.67 1557.52 1228.47 1561.09 Q1230.3 1564.63 1233.91 1564.63 Q1237.55 1564.63 1239.35 1561.09 Q1241.18 1557.52 1241.18 1550.41 Q1241.18 1543.28 1239.35 1539.74 Q1237.55 1536.18 1233.91 1536.18 M1233.91 1532.47 Q1239.72 1532.47 1242.78 1537.08 Q1245.86 1541.66 1245.86 1550.41 Q1245.86 1559.14 1242.78 1563.75 Q1239.72 1568.33 1233.91 1568.33 Q1228.1 1568.33 1225.02 1563.75 Q1221.97 1559.14 1221.97 1550.41 Q1221.97 1541.66 1225.02 1537.08 Q1228.1 1532.47 1233.91 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M1761.5 1563.72 L1769.14 1563.72 L1769.14 1537.36 L1760.83 1539.03 L1760.83 1534.77 L1769.09 1533.1 L1773.77 1533.1 L1773.77 1563.72 L1781.41 1563.72 L1781.41 1567.66 L1761.5 1567.66 L1761.5 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M1790.9 1533.1 L1809.25 1533.1 L1809.25 1537.04 L1795.18 1537.04 L1795.18 1545.51 Q1796.2 1545.16 1797.22 1545 Q1798.24 1544.81 1799.25 1544.81 Q1805.04 1544.81 1808.42 1547.98 Q1811.8 1551.16 1811.8 1556.57 Q1811.8 1562.15 1808.33 1565.25 Q1804.86 1568.33 1798.54 1568.33 Q1796.36 1568.33 1794.09 1567.96 Q1791.85 1567.59 1789.44 1566.85 L1789.44 1562.15 Q1791.52 1563.28 1793.75 1563.84 Q1795.97 1564.4 1798.44 1564.4 Q1802.45 1564.4 1804.79 1562.29 Q1807.13 1560.18 1807.13 1556.57 Q1807.13 1552.96 1804.79 1550.85 Q1802.45 1548.75 1798.44 1548.75 Q1796.57 1548.75 1794.69 1549.16 Q1792.84 1549.58 1790.9 1550.46 L1790.9 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M2331.53 1563.72 L2347.85 1563.72 L2347.85 1567.66 L2325.9 1567.66 L2325.9 1563.72 Q2328.57 1560.97 2333.15 1556.34 Q2337.76 1551.69 2338.94 1550.35 Q2341.18 1547.82 2342.06 1546.09 Q2342.96 1544.33 2342.96 1542.64 Q2342.96 1539.88 2341.02 1538.15 Q2339.1 1536.41 2336 1536.41 Q2333.8 1536.41 2331.34 1537.17 Q2328.91 1537.94 2326.14 1539.49 L2326.14 1534.77 Q2328.96 1533.63 2331.41 1533.05 Q2333.87 1532.47 2335.9 1532.47 Q2341.27 1532.47 2344.47 1535.16 Q2347.66 1537.85 2347.66 1542.34 Q2347.66 1544.47 2346.85 1546.39 Q2346.07 1548.28 2343.96 1550.88 Q2343.38 1551.55 2340.28 1554.77 Q2337.18 1557.96 2331.53 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M2367.66 1536.18 Q2364.05 1536.18 2362.22 1539.74 Q2360.42 1543.28 2360.42 1550.41 Q2360.42 1557.52 2362.22 1561.09 Q2364.05 1564.63 2367.66 1564.63 Q2371.3 1564.63 2373.1 1561.09 Q2374.93 1557.52 2374.93 1550.41 Q2374.93 1543.28 2373.1 1539.74 Q2371.3 1536.18 2367.66 1536.18 M2367.66 1532.47 Q2373.47 1532.47 2376.53 1537.08 Q2379.61 1541.66 2379.61 1550.41 Q2379.61 1559.14 2376.53 1563.75 Q2373.47 1568.33 2367.66 1568.33 Q2361.85 1568.33 2358.77 1563.75 Q2355.72 1559.14 2355.72 1550.41 Q2355.72 1541.66 2358.77 1537.08 Q2361.85 1532.47 2367.66 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1078.16 2352.76,1078.16 "/>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,692.334 2352.76,692.334 "/>
<polyline clip-path="url(#clip222)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,306.503 2352.76,306.503 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1078.16 105.89,1078.16 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,692.334 105.89,692.334 "/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,306.503 105.89,306.503 "/>
<path clip-path="url(#clip220)" d="M-36.3454 1449.79 Q-39.9565 1449.79 -41.7852 1453.36 Q-43.5907 1456.9 -43.5907 1464.03 Q-43.5907 1471.14 -41.7852 1474.7 Q-39.9565 1478.24 -36.3454 1478.24 Q-32.7111 1478.24 -30.9056 1474.7 Q-29.0769 1471.14 -29.0769 1464.03 Q-29.0769 1456.9 -30.9056 1453.36 Q-32.7111 1449.79 -36.3454 1449.79 M-36.3454 1446.09 Q-30.5352 1446.09 -27.4797 1450.7 Q-24.401 1455.28 -24.401 1464.03 Q-24.401 1472.76 -27.4797 1477.36 Q-30.5352 1481.95 -36.3454 1481.95 Q-42.1555 1481.95 -45.2342 1477.36 Q-48.2897 1472.76 -48.2897 1464.03 Q-48.2897 1455.28 -45.2342 1450.7 Q-42.1555 1446.09 -36.3454 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M-16.1834 1475.4 L-11.2992 1475.4 L-11.2992 1481.28 L-16.1834 1481.28 L-16.1834 1475.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M8.88587 1449.79 Q5.27478 1449.79 3.44608 1453.36 Q1.64054 1456.9 1.64054 1464.03 Q1.64054 1471.14 3.44608 1474.7 Q5.27478 1478.24 8.88587 1478.24 Q12.5201 1478.24 14.3257 1474.7 Q16.1543 1471.14 16.1543 1464.03 Q16.1543 1456.9 14.3257 1453.36 Q12.5201 1449.79 8.88587 1449.79 M8.88587 1446.09 Q14.696 1446.09 17.7516 1450.7 Q20.8303 1455.28 20.8303 1464.03 Q20.8303 1472.76 17.7516 1477.36 Q14.696 1481.95 8.88587 1481.95 Q3.07572 1481.95 -0.00297114 1477.36 Q-3.05851 1472.76 -3.05851 1464.03 Q-3.05851 1455.28 -0.00297114 1450.7 Q3.07572 1446.09 8.88587 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M-34.7482 1063.96 Q-38.3592 1063.96 -40.1879 1067.53 Q-41.9935 1071.07 -41.9935 1078.2 Q-41.9935 1085.31 -40.1879 1088.87 Q-38.3592 1092.41 -34.7482 1092.41 Q-31.1139 1092.41 -29.3084 1088.87 Q-27.4797 1085.31 -27.4797 1078.2 Q-27.4797 1071.07 -29.3084 1067.53 Q-31.1139 1063.96 -34.7482 1063.96 M-34.7482 1060.26 Q-28.938 1060.26 -25.8825 1064.87 Q-22.8038 1069.45 -22.8038 1078.2 Q-22.8038 1086.93 -25.8825 1091.53 Q-28.938 1096.12 -34.7482 1096.12 Q-40.5583 1096.12 -43.637 1091.53 Q-46.6925 1086.93 -46.6925 1078.2 Q-46.6925 1069.45 -43.637 1064.87 Q-40.5583 1060.26 -34.7482 1060.26 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M-14.5862 1089.56 L-9.70199 1089.56 L-9.70199 1095.44 L-14.5862 1095.44 L-14.5862 1089.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M10.4831 1063.96 Q6.87199 1063.96 5.0433 1067.53 Q3.23775 1071.07 3.23775 1078.2 Q3.23775 1085.31 5.0433 1088.87 Q6.87199 1092.41 10.4831 1092.41 Q14.1173 1092.41 15.9229 1088.87 Q17.7516 1085.31 17.7516 1078.2 Q17.7516 1071.07 15.9229 1067.53 Q14.1173 1063.96 10.4831 1063.96 M10.4831 1060.26 Q16.2932 1060.26 19.3488 1064.87 Q22.4275 1069.45 22.4275 1078.2 Q22.4275 1086.93 19.3488 1091.53 Q16.2932 1096.12 10.4831 1096.12 Q4.67293 1096.12 1.59424 1091.53 Q-1.4613 1086.93 -1.4613 1078.2 Q-1.4613 1069.45 1.59424 1064.87 Q4.67293 1060.26 10.4831 1060.26 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M34.6728 1091.51 L50.9921 1091.51 L50.9921 1095.44 L29.0478 1095.44 L29.0478 1091.51 Q31.7098 1088.75 36.2931 1084.13 Q40.8996 1079.47 42.0801 1078.13 Q44.3255 1075.61 45.2051 1073.87 Q46.1079 1072.11 46.1079 1070.42 Q46.1079 1067.67 44.1635 1065.93 Q42.2422 1064.19 39.1403 1064.19 Q36.9413 1064.19 34.4876 1064.96 Q32.057 1065.72 29.2793 1067.27 L29.2793 1062.55 Q32.1033 1061.42 34.557 1060.84 Q37.0107 1060.26 39.0477 1060.26 Q44.4181 1060.26 47.6125 1062.94 Q50.8069 1065.63 50.8069 1070.12 Q50.8069 1072.25 49.9968 1074.17 Q49.2097 1076.07 47.1033 1078.66 Q46.5246 1079.33 43.4227 1082.55 Q40.3209 1085.75 34.6728 1091.51 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M-36.8315 678.132 Q-40.4426 678.132 -42.2713 681.697 Q-44.0768 685.239 -44.0768 692.369 Q-44.0768 699.475 -42.2713 703.04 Q-40.4426 706.581 -36.8315 706.581 Q-33.1972 706.581 -31.3917 703.04 Q-29.563 699.475 -29.563 692.369 Q-29.563 685.239 -31.3917 681.697 Q-33.1972 678.132 -36.8315 678.132 M-36.8315 674.429 Q-31.0213 674.429 -27.9658 679.035 Q-24.8871 683.619 -24.8871 692.369 Q-24.8871 701.095 -27.9658 705.702 Q-31.0213 710.285 -36.8315 710.285 Q-42.6416 710.285 -45.7203 705.702 Q-48.7759 701.095 -48.7759 692.369 Q-48.7759 683.619 -45.7203 679.035 Q-42.6416 674.429 -36.8315 674.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M-16.6695 703.734 L-11.7853 703.734 L-11.7853 709.614 L-16.6695 709.614 L-16.6695 703.734 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M8.39976 678.132 Q4.78867 678.132 2.95998 681.697 Q1.15443 685.239 1.15443 692.369 Q1.15443 699.475 2.95998 703.04 Q4.78867 706.581 8.39976 706.581 Q12.034 706.581 13.8395 703.04 Q15.6682 699.475 15.6682 692.369 Q15.6682 685.239 13.8395 681.697 Q12.034 678.132 8.39976 678.132 M8.39976 674.429 Q14.2099 674.429 17.2655 679.035 Q20.3441 683.619 20.3441 692.369 Q20.3441 701.095 17.2655 705.702 Q14.2099 710.285 8.39976 710.285 Q2.58961 710.285 -0.48908 705.702 Q-3.54462 701.095 -3.54462 692.369 Q-3.54462 683.619 -0.48908 679.035 Q2.58961 674.429 8.39976 674.429 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M41.4088 679.128 L29.6034 697.577 L41.4088 697.577 L41.4088 679.128 M40.182 675.054 L46.0616 675.054 L46.0616 697.577 L50.9921 697.577 L50.9921 701.466 L46.0616 701.466 L46.0616 709.614 L41.4088 709.614 L41.4088 701.466 L25.8071 701.466 L25.8071 696.952 L40.182 675.054 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M-36.5074 292.302 Q-40.1185 292.302 -41.9472 295.867 Q-43.7527 299.408 -43.7527 306.538 Q-43.7527 313.644 -41.9472 317.209 Q-40.1185 320.751 -36.5074 320.751 Q-32.8732 320.751 -31.0676 317.209 Q-29.2389 313.644 -29.2389 306.538 Q-29.2389 299.408 -31.0676 295.867 Q-32.8732 292.302 -36.5074 292.302 M-36.5074 288.598 Q-30.6973 288.598 -27.6417 293.205 Q-24.563 297.788 -24.563 306.538 Q-24.563 315.265 -27.6417 319.871 Q-30.6973 324.454 -36.5074 324.454 Q-42.3176 324.454 -45.3962 319.871 Q-48.4518 315.265 -48.4518 306.538 Q-48.4518 297.788 -45.3962 293.205 Q-42.3176 288.598 -36.5074 288.598 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M-16.3455 317.903 L-11.4612 317.903 L-11.4612 323.783 L-16.3455 323.783 L-16.3455 317.903 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M8.72383 292.302 Q5.11274 292.302 3.28405 295.867 Q1.4785 299.408 1.4785 306.538 Q1.4785 313.644 3.28405 317.209 Q5.11274 320.751 8.72383 320.751 Q12.3581 320.751 14.1636 317.209 Q15.9923 313.644 15.9923 306.538 Q15.9923 299.408 14.1636 295.867 Q12.3581 292.302 8.72383 292.302 M8.72383 288.598 Q14.534 288.598 17.5895 293.205 Q20.6682 297.788 20.6682 306.538 Q20.6682 315.265 17.5895 319.871 Q14.534 324.454 8.72383 324.454 Q2.91368 324.454 -0.165007 319.871 Q-3.22055 315.265 -3.22055 306.538 Q-3.22055 297.788 -0.165007 293.205 Q2.91368 288.598 8.72383 288.598 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip220)" d="M39.4644 304.64 Q36.3163 304.64 34.4644 306.792 Q32.6357 308.945 32.6357 312.695 Q32.6357 316.422 34.4644 318.598 Q36.3163 320.751 39.4644 320.751 Q42.6125 320.751 44.4412 318.598 Q46.2931 316.422 46.2931 312.695 Q46.2931 308.945 44.4412 306.792 Q42.6125 304.64 39.4644 304.64 M48.7468 289.987 L48.7468 294.246 Q46.9875 293.413 45.182 292.973 Q43.3996 292.533 41.6403 292.533 Q37.0107 292.533 34.557 295.658 Q32.1265 298.783 31.7793 305.103 Q33.145 303.089 35.2052 302.024 Q37.2653 300.936 39.7422 300.936 Q44.9505 300.936 47.9597 304.107 Q50.9921 307.255 50.9921 312.695 Q50.9921 318.019 47.844 321.237 Q44.6959 324.454 39.4644 324.454 Q33.4691 324.454 30.2978 319.871 Q27.1265 315.265 27.1265 306.538 Q27.1265 298.343 31.0154 293.482 Q34.9042 288.598 41.4551 288.598 Q43.2144 288.598 44.9968 288.945 Q46.8023 289.292 48.7468 289.987 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip222)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1464 313.569,267.92 426.857,88.5087 540.145,109.44 653.433,167.599 766.721,230.505 880.009,291.797 993.298,350.33 1106.59,405.998 1219.87,458.895 1333.16,509.149 1446.45,556.892 1559.74,602.247 1673.03,645.334 1786.31,686.267 1899.6,725.154 2012.89,762.096 2126.18,797.191 2239.47,830.531 2352.76,862.204 "/>
<polyline clip-path="url(#clip222)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1271.08 313.569,1425.41 426.857,1456.28 540.145,1462.45 653.433,1463.69 766.721,1463.93 880.009,1463.98 993.298,1463.99 1106.59,1463.99 1219.87,1464 1333.16,1464 1446.45,1464 1559.74,1464 1673.03,1464 1786.31,1464 1899.6,1464 2012.89,1464 2126.18,1464 2239.47,1464 2352.76,1464 "/>
<path clip-path="url(#clip220)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip220)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip220)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip220)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip220)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip220)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>Lets find the 2nd observable at the end of the IRF.</p><pre><code class="language-julia hljs">function last_observable_irf(A, B, C)
    sol = irf(A, B, C)
    return sol.z[end][2]  # return 2nd argument of last observable
end
last_observable_irf(A, B, C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.03119456447624772</code></pre><p>But everything in this package is differentiable.  Lets differentiate the observable of the IRF with respect to all of the parameters using <code>Zygote.jl</code>,</p><pre><code class="language-julia hljs">gradient(last_observable_irf, A, B, C)  # calculates gradient wrt all arguments</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.5822985368900442 0.0050313813671367304; 4.469834483178462 0.041592752634585235], [0.37735360253530714; 3.119456447624773;;], [0.0 0.0; 0.03119456447624772 5.242880000000006e-16])</code></pre><p>Gradients of other model elements (e.g. <code>.u</code> are also possible.  With this in mind, lets find the gradient of the mean of the 1st element of the IRF of the solution with respect to a particular noise vector.</p><pre><code class="language-julia hljs">function mean_u_1(A, B, C, noise, u0, T)
    problem = LinearStateSpaceProblem(A, B, u0, (0, T); noise, syms = [:a, :b])
    sol = solve(problem)
    u = sol.u # see issue #75 workaround
    # can have nontrivial functions and even non-mutating loops
    return mean( u[i][1] for i in 1:T)
end
u0 = [0.0, 0.0]
noise = sol.W # from simulation above
mean_u_1(A, B, C, noise, u0, T)
# dropping a few arguments from derivative
gradient((noise, u0)-&gt; mean_u_1(A, B, C, noise, u0, T), noise, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.05079876954953124 0.045314515146875 … 0.0 0.0], [0.702526121523242, 5.600882710405467])</code></pre><h2 id="Simulating-Ensembles-and-Fixing-Noise"><a class="docs-heading-anchor" href="#Simulating-Ensembles-and-Fixing-Noise">Simulating Ensembles and Fixing Noise</a><a id="Simulating-Ensembles-and-Fixing-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Ensembles-and-Fixing-Noise" title="Permalink"></a></h2><p>If you pass in a distribution for the initial condition, it will draw an initial condition.  Below we will simulate from a deterministic evolution equation and without any observation noise.</p><pre><code class="language-julia hljs">using Distributions, DiffEqBase
u0 = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = LinearStateSpaceProblem(A, nothing, u0, (0, T); C)
sol = solve(prob)
plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip280">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip280)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip281">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip280)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip282">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip280)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1096.17 2352.76,1096.17 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,728.345 2352.76,728.345 "/>
<polyline clip-path="url(#clip282)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,360.52 2352.76,360.52 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1096.17 105.89,1096.17 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,728.345 105.89,728.345 "/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,360.52 105.89,360.52 "/>
<path clip-path="url(#clip280)" d="M-6.18349 1449.79 Q-9.79459 1449.79 -11.6233 1453.36 Q-13.4288 1456.9 -13.4288 1464.03 Q-13.4288 1471.14 -11.6233 1474.7 Q-9.79459 1478.24 -6.18349 1478.24 Q-2.54925 1478.24 -0.743708 1474.7 Q1.08499 1471.14 1.08499 1464.03 Q1.08499 1456.9 -0.743708 1453.36 Q-2.54925 1449.79 -6.18349 1449.79 M-6.18349 1446.09 Q-0.37334 1446.09 2.6822 1450.7 Q5.76089 1455.28 5.76089 1464.03 Q5.76089 1472.76 2.6822 1477.36 Q-0.37334 1481.95 -6.18349 1481.95 Q-11.9936 1481.95 -15.0723 1477.36 Q-18.1279 1472.76 -18.1279 1464.03 Q-18.1279 1455.28 -15.0723 1450.7 Q-11.9936 1446.09 -6.18349 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M13.9784 1475.4 L18.8627 1475.4 L18.8627 1481.28 L13.9784 1481.28 L13.9784 1475.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M-4.58628 1081.97 Q-8.19737 1081.97 -10.0261 1085.53 Q-11.8316 1089.08 -11.8316 1096.2 Q-11.8316 1103.31 -10.0261 1106.88 Q-8.19737 1110.42 -4.58628 1110.42 Q-0.95204 1110.42 0.853506 1106.88 Q2.6822 1103.31 2.6822 1096.2 Q2.6822 1089.08 0.853506 1085.53 Q-0.95204 1081.97 -4.58628 1081.97 M-4.58628 1078.27 Q1.22387 1078.27 4.27941 1082.87 Q7.3581 1087.45 7.3581 1096.2 Q7.3581 1104.93 4.27941 1109.54 Q1.22387 1114.12 -4.58628 1114.12 Q-10.3964 1114.12 -13.4751 1109.54 Q-16.5307 1104.93 -16.5307 1096.2 Q-16.5307 1087.45 -13.4751 1082.87 Q-10.3964 1078.27 -4.58628 1078.27 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M15.5756 1107.57 L20.4599 1107.57 L20.4599 1113.45 L15.5756 1113.45 L15.5756 1107.57 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M34.6728 1109.51 L50.9921 1109.51 L50.9921 1113.45 L29.0478 1113.45 L29.0478 1109.51 Q31.7098 1106.76 36.2931 1102.13 Q40.8996 1097.48 42.0801 1096.14 Q44.3255 1093.61 45.2051 1091.88 Q46.1079 1090.12 46.1079 1088.43 Q46.1079 1085.67 44.1635 1083.94 Q42.2422 1082.2 39.1403 1082.2 Q36.9413 1082.2 34.4876 1082.96 Q32.057 1083.73 29.2793 1085.28 L29.2793 1080.56 Q32.1033 1079.42 34.557 1078.84 Q37.0107 1078.27 39.0477 1078.27 Q44.4181 1078.27 47.6125 1080.95 Q50.8069 1083.64 50.8069 1088.13 Q50.8069 1090.26 49.9968 1092.18 Q49.2097 1094.08 47.1033 1096.67 Q46.5246 1097.34 43.4227 1100.56 Q40.3209 1103.75 34.6728 1109.51 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M-6.6696 714.143 Q-10.2807 714.143 -12.1094 717.708 Q-13.9149 721.25 -13.9149 728.379 Q-13.9149 735.486 -12.1094 739.051 Q-10.2807 742.592 -6.6696 742.592 Q-3.03536 742.592 -1.22982 739.051 Q0.598877 735.486 0.598877 728.379 Q0.598877 721.25 -1.22982 717.708 Q-3.03536 714.143 -6.6696 714.143 M-6.6696 710.44 Q-0.859448 710.44 2.19609 715.046 Q5.27478 719.63 5.27478 728.379 Q5.27478 737.106 2.19609 741.713 Q-0.859448 746.296 -6.6696 746.296 Q-12.4798 746.296 -15.5584 741.713 Q-18.614 737.106 -18.614 728.379 Q-18.614 719.63 -15.5584 715.046 Q-12.4798 710.44 -6.6696 710.44 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M13.4923 739.745 L18.3766 739.745 L18.3766 745.625 L13.4923 745.625 L13.4923 739.745 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M41.4088 715.139 L29.6034 733.588 L41.4088 733.588 L41.4088 715.139 M40.182 711.065 L46.0616 711.065 L46.0616 733.588 L50.9921 733.588 L50.9921 737.477 L46.0616 737.477 L46.0616 745.625 L41.4088 745.625 L41.4088 737.477 L25.8071 737.477 L25.8071 732.963 L40.182 711.065 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M-6.34553 346.318 Q-9.95662 346.318 -11.7853 349.883 Q-13.5909 353.425 -13.5909 360.554 Q-13.5909 367.661 -11.7853 371.225 Q-9.95662 374.767 -6.34553 374.767 Q-2.71129 374.767 -0.905744 371.225 Q0.92295 367.661 0.92295 360.554 Q0.92295 353.425 -0.905744 349.883 Q-2.71129 346.318 -6.34553 346.318 M-6.34553 342.615 Q-0.535376 342.615 2.52016 347.221 Q5.59885 351.804 5.59885 360.554 Q5.59885 369.281 2.52016 373.888 Q-0.535376 378.471 -6.34553 378.471 Q-12.1557 378.471 -15.2344 373.888 Q-18.2899 369.281 -18.2899 360.554 Q-18.2899 351.804 -15.2344 347.221 Q-12.1557 342.615 -6.34553 342.615 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M13.8164 371.92 L18.7006 371.92 L18.7006 377.8 L13.8164 377.8 L13.8164 371.92 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M39.4644 358.656 Q36.3163 358.656 34.4644 360.809 Q32.6357 362.962 32.6357 366.712 Q32.6357 370.438 34.4644 372.614 Q36.3163 374.767 39.4644 374.767 Q42.6125 374.767 44.4412 372.614 Q46.2931 370.438 46.2931 366.712 Q46.2931 362.962 44.4412 360.809 Q42.6125 358.656 39.4644 358.656 M48.7468 344.003 L48.7468 348.263 Q46.9875 347.429 45.182 346.99 Q43.3996 346.55 41.6403 346.55 Q37.0107 346.55 34.557 349.675 Q32.1265 352.8 31.7793 359.119 Q33.145 357.105 35.2052 356.04 Q37.2653 354.952 39.7422 354.952 Q44.9505 354.952 47.9597 358.124 Q50.9921 361.272 50.9921 366.712 Q50.9921 372.036 47.844 375.253 Q44.6959 378.471 39.4644 378.471 Q33.4691 378.471 30.2978 373.888 Q27.1265 369.281 27.1265 360.554 Q27.1265 352.36 31.0154 347.499 Q34.9042 342.615 41.4551 342.615 Q43.2144 342.615 44.9968 342.962 Q46.8023 343.309 48.7468 344.003 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip282)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,489.106 313.569,106.851 540.145,88.5087 766.721,140.043 993.298,202.793 1219.87,265.163 1446.45,324.967 1673.03,381.891 1899.6,435.99 2126.18,487.39 2352.76,536.22 "/>
<polyline clip-path="url(#clip282)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1394.48 313.569,1450.09 540.145,1461.21 766.721,1463.44 993.298,1463.88 1219.87,1463.97 1446.45,1463.99 1673.03,1463.99 1899.6,1464 2126.18,1464 2352.76,1464 "/>
<path clip-path="url(#clip280)" d="M1942.97 251.365 L2277.23 251.365 L2277.23 95.8446 L1942.97 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip280)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1942.97,251.365 2277.23,251.365 2277.23,95.8446 1942.97,95.8446 1942.97,251.365 "/>
<polyline clip-path="url(#clip280)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,147.685 2119.2,147.685 "/>
<path clip-path="url(#clip280)" d="M2144.37 154.733 L2144.37 139.039 L2148.63 139.039 L2148.63 154.571 Q2148.63 158.252 2150.07 160.104 Q2151.5 161.932 2154.37 161.932 Q2157.82 161.932 2159.81 159.733 Q2161.82 157.534 2161.82 153.738 L2161.82 139.039 L2166.08 139.039 L2166.08 164.965 L2161.82 164.965 L2161.82 160.983 Q2160.27 163.344 2158.21 164.502 Q2156.18 165.636 2153.47 165.636 Q2149 165.636 2146.69 162.858 Q2144.37 160.08 2144.37 154.733 M2155.09 138.414 L2155.09 138.414 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2176.27 161.029 L2183.91 161.029 L2183.91 134.664 L2175.6 136.331 L2175.6 132.071 L2183.86 130.405 L2188.54 130.405 L2188.54 161.029 L2196.18 161.029 L2196.18 164.965 L2176.27 164.965 L2176.27 161.029 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2215.25 128.993 Q2212.15 134.317 2210.64 139.525 Q2209.14 144.733 2209.14 150.08 Q2209.14 155.428 2210.64 160.682 Q2212.17 165.914 2215.25 171.215 L2211.55 171.215 Q2208.07 165.775 2206.34 160.52 Q2204.62 155.266 2204.62 150.08 Q2204.62 144.918 2206.34 139.687 Q2208.05 134.456 2211.55 128.993 L2215.25 128.993 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2227.73 131.678 L2227.73 139.039 L2236.5 139.039 L2236.5 142.349 L2227.73 142.349 L2227.73 156.423 Q2227.73 159.594 2228.58 160.497 Q2229.46 161.4 2232.12 161.4 L2236.5 161.4 L2236.5 164.965 L2232.12 164.965 Q2227.19 164.965 2225.32 163.136 Q2223.44 161.284 2223.44 156.423 L2223.44 142.349 L2220.32 142.349 L2220.32 139.039 L2223.44 139.039 L2223.44 131.678 L2227.73 131.678 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2241.43 128.993 L2245.13 128.993 Q2248.61 134.456 2250.32 139.687 Q2252.06 144.918 2252.06 150.08 Q2252.06 155.266 2250.32 160.52 Q2248.61 165.775 2245.13 171.215 L2241.43 171.215 Q2244.51 165.914 2246.01 160.682 Q2247.54 155.428 2247.54 150.08 Q2247.54 144.733 2246.01 139.525 Q2244.51 134.317 2241.43 128.993 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip280)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,199.525 2119.2,199.525 "/>
<path clip-path="url(#clip280)" d="M2144.37 206.573 L2144.37 190.879 L2148.63 190.879 L2148.63 206.411 Q2148.63 210.092 2150.07 211.944 Q2151.5 213.772 2154.37 213.772 Q2157.82 213.772 2159.81 211.573 Q2161.82 209.374 2161.82 205.578 L2161.82 190.879 L2166.08 190.879 L2166.08 216.805 L2161.82 216.805 L2161.82 212.823 Q2160.27 215.184 2158.21 216.342 Q2156.18 217.476 2153.47 217.476 Q2149 217.476 2146.69 214.698 Q2144.37 211.92 2144.37 206.573 M2155.09 190.254 L2155.09 190.254 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2179.49 212.869 L2195.81 212.869 L2195.81 216.805 L2173.86 216.805 L2173.86 212.869 Q2176.52 210.115 2181.11 205.485 Q2185.71 200.832 2186.89 199.49 Q2189.14 196.967 2190.02 195.231 Q2190.92 193.471 2190.92 191.782 Q2190.92 189.027 2188.98 187.291 Q2187.06 185.555 2183.95 185.555 Q2181.75 185.555 2179.3 186.319 Q2176.87 187.083 2174.09 188.633 L2174.09 183.911 Q2176.92 182.777 2179.37 182.198 Q2181.82 181.62 2183.86 181.62 Q2189.23 181.62 2192.43 184.305 Q2195.62 186.99 2195.62 191.481 Q2195.62 193.61 2194.81 195.532 Q2194.02 197.43 2191.92 200.022 Q2191.34 200.694 2188.24 203.911 Q2185.13 207.106 2179.49 212.869 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2215.25 180.833 Q2212.15 186.157 2210.64 191.365 Q2209.14 196.573 2209.14 201.92 Q2209.14 207.268 2210.64 212.522 Q2212.17 217.754 2215.25 223.055 L2211.55 223.055 Q2208.07 217.615 2206.34 212.36 Q2204.62 207.106 2204.62 201.92 Q2204.62 196.758 2206.34 191.527 Q2208.05 186.296 2211.55 180.833 L2215.25 180.833 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2227.73 183.518 L2227.73 190.879 L2236.5 190.879 L2236.5 194.189 L2227.73 194.189 L2227.73 208.263 Q2227.73 211.434 2228.58 212.337 Q2229.46 213.24 2232.12 213.24 L2236.5 213.24 L2236.5 216.805 L2232.12 216.805 Q2227.19 216.805 2225.32 214.976 Q2223.44 213.124 2223.44 208.263 L2223.44 194.189 L2220.32 194.189 L2220.32 190.879 L2223.44 190.879 L2223.44 183.518 L2227.73 183.518 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip280)" d="M2241.43 180.833 L2245.13 180.833 Q2248.61 186.296 2250.32 191.527 Q2252.06 196.758 2252.06 201.92 Q2252.06 207.106 2250.32 212.36 Q2248.61 217.615 2245.13 223.055 L2241.43 223.055 Q2244.51 217.754 2246.01 212.522 Q2247.54 207.268 2247.54 201.92 Q2247.54 196.573 2246.01 191.365 Q2244.51 186.157 2241.43 180.833 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>With this, we can simulate an ensemble of solutions from different initial conditions (and we will turn back on the noise).  The <code>EnsembleSummary</code> calculates a set of quantiles by default.</p><pre><code class="language-julia hljs">T = 10
trajectories = 50
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C)
sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(sol)  #calculate summarize statistics from the
plot(summ)  # shows quantiles by default</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip340">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip340)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip341">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip340)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip342">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="685.496,1521.01 685.496,47.2441 "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1521.01 1219.87,47.2441 "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1754.25,1521.01 1754.25,47.2441 "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="685.496,1521.01 685.496,1502.11 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1521.01 1219.87,1502.11 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.25,1521.01 1754.25,1502.11 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip340)" d="M128.502 1551.93 Q124.891 1551.93 123.062 1555.49 Q121.257 1559.03 121.257 1566.16 Q121.257 1573.27 123.062 1576.83 Q124.891 1580.38 128.502 1580.38 Q132.136 1580.38 133.942 1576.83 Q135.77 1573.27 135.77 1566.16 Q135.77 1559.03 133.942 1555.49 Q132.136 1551.93 128.502 1551.93 M128.502 1548.22 Q134.312 1548.22 137.368 1552.83 Q140.446 1557.41 140.446 1566.16 Q140.446 1574.89 137.368 1579.5 Q134.312 1584.08 128.502 1584.08 Q122.692 1584.08 119.613 1579.5 Q116.558 1574.89 116.558 1566.16 Q116.558 1557.41 119.613 1552.83 Q122.692 1548.22 128.502 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M148.664 1577.53 L153.548 1577.53 L153.548 1583.41 L148.664 1583.41 L148.664 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M173.733 1551.93 Q170.122 1551.93 168.293 1555.49 Q166.488 1559.03 166.488 1566.16 Q166.488 1573.27 168.293 1576.83 Q170.122 1580.38 173.733 1580.38 Q177.367 1580.38 179.173 1576.83 Q181.002 1573.27 181.002 1566.16 Q181.002 1559.03 179.173 1555.49 Q177.367 1551.93 173.733 1551.93 M173.733 1548.22 Q179.543 1548.22 182.599 1552.83 Q185.678 1557.41 185.678 1566.16 Q185.678 1574.89 182.599 1579.5 Q179.543 1584.08 173.733 1584.08 Q167.923 1584.08 164.844 1579.5 Q161.789 1574.89 161.789 1566.16 Q161.789 1557.41 164.844 1552.83 Q167.923 1548.22 173.733 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M657.232 1579.47 L673.551 1579.47 L673.551 1583.41 L651.607 1583.41 L651.607 1579.47 Q654.269 1576.72 658.852 1572.09 Q663.459 1567.44 664.639 1566.09 Q666.885 1563.57 667.764 1561.83 Q668.667 1560.07 668.667 1558.38 Q668.667 1555.63 666.723 1553.89 Q664.801 1552.16 661.7 1552.16 Q659.501 1552.16 657.047 1552.92 Q654.616 1553.69 651.839 1555.24 L651.839 1550.51 Q654.663 1549.38 657.116 1548.8 Q659.57 1548.22 661.607 1548.22 Q666.977 1548.22 670.172 1550.91 Q673.366 1553.59 673.366 1558.08 Q673.366 1560.21 672.556 1562.13 Q671.769 1564.03 669.663 1566.63 Q669.084 1567.3 665.982 1570.51 Q662.88 1573.71 657.232 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M683.366 1577.53 L688.25 1577.53 L688.25 1583.41 L683.366 1583.41 L683.366 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M698.482 1548.85 L716.838 1548.85 L716.838 1552.78 L702.764 1552.78 L702.764 1561.26 Q703.783 1560.91 704.801 1560.75 Q705.82 1560.56 706.838 1560.56 Q712.625 1560.56 716.005 1563.73 Q719.384 1566.9 719.384 1572.32 Q719.384 1577.9 715.912 1581 Q712.44 1584.08 706.121 1584.08 Q703.945 1584.08 701.676 1583.71 Q699.431 1583.34 697.023 1582.6 L697.023 1577.9 Q699.107 1579.03 701.329 1579.59 Q703.551 1580.14 706.028 1580.14 Q710.033 1580.14 712.371 1578.04 Q714.709 1575.93 714.709 1572.32 Q714.709 1568.71 712.371 1566.6 Q710.033 1564.5 706.028 1564.5 Q704.153 1564.5 702.278 1564.91 Q700.426 1565.33 698.482 1566.21 L698.482 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1187.04 1548.85 L1205.39 1548.85 L1205.39 1552.78 L1191.32 1552.78 L1191.32 1561.26 Q1192.34 1560.91 1193.36 1560.75 Q1194.38 1560.56 1195.39 1560.56 Q1201.18 1560.56 1204.56 1563.73 Q1207.94 1566.9 1207.94 1572.32 Q1207.94 1577.9 1204.47 1581 Q1201 1584.08 1194.68 1584.08 Q1192.5 1584.08 1190.23 1583.71 Q1187.99 1583.34 1185.58 1582.6 L1185.58 1577.9 Q1187.66 1579.03 1189.89 1579.59 Q1192.11 1580.14 1194.58 1580.14 Q1198.59 1580.14 1200.93 1578.04 Q1203.27 1575.93 1203.27 1572.32 Q1203.27 1568.71 1200.93 1566.6 Q1198.59 1564.5 1194.58 1564.5 Q1192.71 1564.5 1190.83 1564.91 Q1188.98 1565.33 1187.04 1566.21 L1187.04 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1217.15 1577.53 L1222.04 1577.53 L1222.04 1583.41 L1217.15 1583.41 L1217.15 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1242.22 1551.93 Q1238.61 1551.93 1236.78 1555.49 Q1234.98 1559.03 1234.98 1566.16 Q1234.98 1573.27 1236.78 1576.83 Q1238.61 1580.38 1242.22 1580.38 Q1245.86 1580.38 1247.66 1576.83 Q1249.49 1573.27 1249.49 1566.16 Q1249.49 1559.03 1247.66 1555.49 Q1245.86 1551.93 1242.22 1551.93 M1242.22 1548.22 Q1248.03 1548.22 1251.09 1552.83 Q1254.17 1557.41 1254.17 1566.16 Q1254.17 1574.89 1251.09 1579.5 Q1248.03 1584.08 1242.22 1584.08 Q1236.41 1584.08 1233.33 1579.5 Q1230.28 1574.89 1230.28 1566.16 Q1230.28 1557.41 1233.33 1552.83 Q1236.41 1548.22 1242.22 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1720.57 1548.85 L1742.79 1548.85 L1742.79 1550.84 L1730.25 1583.41 L1725.36 1583.41 L1737.17 1552.78 L1720.57 1552.78 L1720.57 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1751.91 1577.53 L1756.8 1577.53 L1756.8 1583.41 L1751.91 1583.41 L1751.91 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1767.03 1548.85 L1785.39 1548.85 L1785.39 1552.78 L1771.31 1552.78 L1771.31 1561.26 Q1772.33 1560.91 1773.35 1560.75 Q1774.37 1560.56 1775.39 1560.56 Q1781.17 1560.56 1784.55 1563.73 Q1787.93 1566.9 1787.93 1572.32 Q1787.93 1577.9 1784.46 1581 Q1780.99 1584.08 1774.67 1584.08 Q1772.49 1584.08 1770.22 1583.71 Q1767.98 1583.34 1765.57 1582.6 L1765.57 1577.9 Q1767.65 1579.03 1769.88 1579.59 Q1772.1 1580.14 1774.58 1580.14 Q1778.58 1580.14 1780.92 1578.04 Q1783.26 1575.93 1783.26 1572.32 Q1783.26 1568.71 1780.92 1566.6 Q1778.58 1564.5 1774.58 1564.5 Q1772.7 1564.5 1770.83 1564.91 Q1768.97 1565.33 1767.03 1566.21 L1767.03 1548.85 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M2240.7 1579.47 L2248.34 1579.47 L2248.34 1553.11 L2240.03 1554.77 L2240.03 1550.51 L2248.3 1548.85 L2252.97 1548.85 L2252.97 1579.47 L2260.61 1579.47 L2260.61 1583.41 L2240.7 1583.41 L2240.7 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M2280.05 1551.93 Q2276.44 1551.93 2274.61 1555.49 Q2272.81 1559.03 2272.81 1566.16 Q2272.81 1573.27 2274.61 1576.83 Q2276.44 1580.38 2280.05 1580.38 Q2283.69 1580.38 2285.49 1576.83 Q2287.32 1573.27 2287.32 1566.16 Q2287.32 1559.03 2285.49 1555.49 Q2283.69 1551.93 2280.05 1551.93 M2280.05 1548.22 Q2285.86 1548.22 2288.92 1552.83 Q2292 1557.41 2292 1566.16 Q2292 1574.89 2288.92 1579.5 Q2285.86 1584.08 2280.05 1584.08 Q2274.24 1584.08 2271.17 1579.5 Q2268.11 1574.89 2268.11 1566.16 Q2268.11 1557.41 2271.17 1552.83 Q2274.24 1548.22 2280.05 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M2300.22 1577.53 L2305.1 1577.53 L2305.1 1583.41 L2300.22 1583.41 L2300.22 1577.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M2325.29 1551.93 Q2321.67 1551.93 2319.85 1555.49 Q2318.04 1559.03 2318.04 1566.16 Q2318.04 1573.27 2319.85 1576.83 Q2321.67 1580.38 2325.29 1580.38 Q2328.92 1580.38 2330.73 1576.83 Q2332.55 1573.27 2332.55 1566.16 Q2332.55 1559.03 2330.73 1555.49 Q2328.92 1551.93 2325.29 1551.93 M2325.29 1548.22 Q2331.1 1548.22 2334.15 1552.83 Q2337.23 1557.41 2337.23 1566.16 Q2337.23 1574.89 2334.15 1579.5 Q2331.1 1584.08 2325.29 1584.08 Q2319.48 1584.08 2316.4 1579.5 Q2313.34 1574.89 2313.34 1566.16 Q2313.34 1557.41 2316.4 1552.83 Q2319.48 1548.22 2325.29 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1278.14 2352.76,1278.14 "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,964.154 2352.76,964.154 "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,650.171 2352.76,650.171 "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,336.188 2352.76,336.188 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1278.14 105.89,1278.14 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,964.154 105.89,964.154 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,650.171 105.89,650.171 "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,336.188 105.89,336.188 "/>
<path clip-path="url(#clip340)" d="M-40.8824 1278.59 L-11.2066 1278.59 L-11.2066 1282.52 L-40.8824 1282.52 L-40.8824 1278.59 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M-0.303895 1291.48 L7.33495 1291.48 L7.33495 1265.12 L-0.975188 1266.78 L-0.975188 1262.52 L7.28866 1260.86 L11.9646 1260.86 L11.9646 1291.48 L19.6034 1291.48 L19.6034 1295.42 L-0.303895 1295.42 L-0.303895 1291.48 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M39.0477 1263.94 Q35.4367 1263.94 33.608 1267.5 Q31.8024 1271.04 31.8024 1278.17 Q31.8024 1285.28 33.608 1288.84 Q35.4367 1292.38 39.0477 1292.38 Q42.682 1292.38 44.4875 1288.84 Q46.3162 1285.28 46.3162 1278.17 Q46.3162 1271.04 44.4875 1267.5 Q42.682 1263.94 39.0477 1263.94 M39.0477 1260.23 Q44.8579 1260.23 47.9134 1264.84 Q50.9921 1269.42 50.9921 1278.17 Q50.9921 1286.9 47.9134 1291.5 Q44.8579 1296.09 39.0477 1296.09 Q33.2376 1296.09 30.1589 1291.5 Q27.1034 1286.9 27.1034 1278.17 Q27.1034 1269.42 30.1589 1264.84 Q33.2376 1260.23 39.0477 1260.23 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M-9.72514 964.605 L19.9506 964.605 L19.9506 968.54 L-9.72514 968.54 L-9.72514 964.605 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M30.0895 946.874 L48.4458 946.874 L48.4458 950.809 L34.3718 950.809 L34.3718 959.281 Q35.3904 958.934 36.4089 958.772 Q37.4274 958.587 38.4459 958.587 Q44.2329 958.587 47.6125 961.758 Q50.9921 964.929 50.9921 970.346 Q50.9921 975.925 47.5199 979.026 Q44.0477 982.105 37.7283 982.105 Q35.5524 982.105 33.2839 981.735 Q31.0385 981.364 28.6311 980.624 L28.6311 975.925 Q30.7145 977.059 32.9367 977.614 Q35.1589 978.17 37.6357 978.17 Q41.6403 978.17 43.9783 976.063 Q46.3162 973.957 46.3162 970.346 Q46.3162 966.735 43.9783 964.628 Q41.6403 962.522 37.6357 962.522 Q35.7607 962.522 33.8857 962.939 Q32.0339 963.355 30.0895 964.235 L30.0895 946.874 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M39.0477 635.969 Q35.4367 635.969 33.608 639.534 Q31.8024 643.076 31.8024 650.205 Q31.8024 657.312 33.608 660.877 Q35.4367 664.418 39.0477 664.418 Q42.682 664.418 44.4875 660.877 Q46.3162 657.312 46.3162 650.205 Q46.3162 643.076 44.4875 639.534 Q42.682 635.969 39.0477 635.969 M39.0477 632.266 Q44.8579 632.266 47.9134 636.872 Q50.9921 641.456 50.9921 650.205 Q50.9921 658.932 47.9134 663.539 Q44.8579 668.122 39.0477 668.122 Q33.2376 668.122 30.1589 663.539 Q27.1034 658.932 27.1034 650.205 Q27.1034 641.456 30.1589 636.872 Q33.2376 632.266 39.0477 632.266 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M30.0895 318.908 L48.4458 318.908 L48.4458 322.843 L34.3718 322.843 L34.3718 331.315 Q35.3904 330.968 36.4089 330.806 Q37.4274 330.621 38.4459 330.621 Q44.2329 330.621 47.6125 333.792 Q50.9921 336.963 50.9921 342.38 Q50.9921 347.959 47.5199 351.06 Q44.0477 354.139 37.7283 354.139 Q35.5524 354.139 33.2839 353.769 Q31.0385 353.398 28.6311 352.658 L28.6311 347.959 Q30.7145 349.093 32.9367 349.648 Q35.1589 350.204 37.6357 350.204 Q41.6403 350.204 43.9783 348.097 Q46.3162 345.991 46.3162 342.38 Q46.3162 338.769 43.9783 336.662 Q41.6403 334.556 37.6357 334.556 Q35.7607 334.556 33.8857 334.972 Q32.0339 335.389 30.0895 336.269 L30.0895 318.908 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip342)" d="M151.118 772.927 L364.869 1374.23 L578.62 1479.3 L792.371 1465.64 L1006.12 1430.29 L1219.87 1389.12 L1433.63 1349.54 L1647.38 1315.84 L1861.13 1285.67 L2074.88 1261.69 L2288.63 1233.94 L2288.63 261.598 L2074.88 240.772 L1861.13 215.809 L1647.38 187.916 L1433.63 163.739 L1219.87 140.698 L1006.12 114.251 L792.371 92.5848 L578.62 88.9544 L364.869 161.16 L151.118 536.811  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip342)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,657.244 364.869,695.215 578.62,712.923 792.371,710.962 1006.12,710.176 1219.87,702.003 1433.63,701.064 1647.38,701.231 1861.13,697.462 2074.88,696.379 2288.63,695.164 "/>
<path clip-path="url(#clip342)" d="M151.118 767.348 L364.869 673.419 L578.62 654.852 L792.371 651.489 L1006.12 651.085 L1219.87 651.088 L1433.63 651.506 L1647.38 651.232 L1861.13 651.214 L2074.88 651.104 L2288.63 650.783 L2288.63 649.384 L2074.88 649.21 L1861.13 649.144 L1647.38 649.158 L1433.63 649.401 L1219.87 648.992 L1006.12 649.158 L792.371 649.023 L578.62 646.853 L364.869 634.551 L151.118 572.246  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip342)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,652.942 364.869,650.83 578.62,650.301 792.371,650.134 1006.12,650.186 1219.87,650.254 1433.63,650.338 1647.38,650.112 1861.13,650.263 2074.88,650.31 2288.63,650.009 "/>
</svg>
<h2 id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><a class="docs-heading-anchor" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter">Observables and Marginal Likelihood using a Kalman Filter</a><a id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter" title="Permalink"></a></h2><p>If you provide <code>observables</code> and provide a distribution for the <code>observables_noise</code> then the model can provide a calculation of the likelihood.  </p><p>The simplest case is if you use a gaussian prior and have gaussian observation noise.  First, lets simulate some data with included observation noise.  If passing in a matrix or vector, the <code>observables_noise</code> argument is intended to be the cholesky of the covariance matrix.  At this point, only diagonal observation noise is allowed.</p><pre><code class="language-julia hljs">u0 = MvNormal([1.0 0.1; 0.1 1.0])  # draw from mean zero initial conditions
T = 10
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)
sol.z # simulated observables with observation noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-0.01182511356456728, 0.12338723533619109]
 [0.042033701109684796, -1.9574630781962692]
 [-0.256490815280698, -2.113059925274945]
 [-0.26227903320287255, -2.234074592048089]
 [-0.29135836203086624, -1.5089287512119463]
 [-0.29724180465583994, -1.774240933152328]
 [0.09714960121685928, -1.5294965139661953]
 [0.08537425274222647, -1.8484872614789138]
 [0.13472216539228418, -0.7721652338273124]
 [-0.24376910281513425, -1.0872603050422283]
 [-0.07214903477606932, -0.619882038655669]</code></pre><p>Next we will find the log likelihood of these simulated observables using the <code>u0</code> as a prior and with the true parameters.</p><p>The new arguments we pass to the problem creation are <code>u0_prior_variance, u0_prior_mean,</code> and <code>observables</code>.  The <code>u0</code> is ignored for the filtering problem but must match the size.  The <code>KalmanFilter()</code> argument to the <code>solve</code> is unnecessary since it can select it manually given the priors and observables.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The timing convention is such that <code>observables</code> are expected to match the predictions starting at the second time period.  As the likelihood of the first element <code>u0</code> comes from a prior, the <code>observables</code> start at the next element, and hence the observables and noise sequences should be 1 less than the tspan </p></div></div><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = copy(sol.W) # save for later
u0_prior_mean = [0.0, 0.0]
# use covariance of distribution we drew from
u0_prior_var = cov(u0)

prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
sol = solve(prob, KalmanFilter())
# plot(sol) The `u` is the sequence of posterior means.
sol.logpdf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-7.267470384145885</code></pre><p>Hence the <code>logpdf</code> provides the log likelihood marginalizing out the latent noise variables.</p><p>As before, we can differentiate the kalman filter itself.</p><pre><code class="language-julia hljs">function kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
# Find the gradient wrt the A, B, C and priors variance.
gradient((A, B, C, u0_prior_var) -&gt; kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables), A, B, C, u0_prior_var)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-80.06411683906794 0.05626977998797515; -621.8149957329778 -5.304267351521375], [15.302104616357; 124.138561342147;;], [-4.387777692199222 -0.07236691534868989; 0.7094339558152569 0.1183666705613522], [-0.01739503338834485 1.2530661161994963; -1.2485521725144484 -0.4707251025740842])</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some of the gradients, such as those for <code>observables</code>, have not been implemented so test carefully.  This is a general theme with gradients and <code>Zygote.jl</code> in general.  Your best friend in this process is the spectacular <a href="https://github.com/JuliaDiff/ChainRulesTestUtils.jl">ChainRulesTestUtils.jl</a> package. See <code>test_rrule</code> usage in the <a href="https://github.com/SciML/DifferenceEquations.jl/blob/main/test/linear_gradients.jl">linear unit tests</a>.</p></div></div><h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>A key application of these methods is to find the joint likelihood of the latent variables (i.e., the <code>noise</code>) and the model definition.</p><p>The actual calculation of the likelihood is trivial in that case, and just requires iteration of the linear system while accumulating the likelihood given the observation noise.</p><p>Crucially, the differentiability with respect to the high-dimensional noise vector enables gradient-based sampling and estimation methods which would otherwise be infeasible.</p><pre><code class="language-julia hljs">function joint_likelihood(A, B, C, D, u0, noise, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood(A, B, C, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-153.11795765903975</code></pre><p>And as always, this can be differentiated with respect to the state-space matrices and the noise.  Choosing a few parameters,</p><pre><code class="language-julia hljs">gradient((A, u0, noise) -&gt; joint_likelihood(A, B, C, D, u0, noise, observables), A, u0, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-47.14216896759356 -4.033068925467598; -210.5246243463676 -21.85355514027694], [-135.10171204144388, -1075.7139048934919], [-9.69987342062448 -8.48246148376716 … -0.6794292164000373 -0.007798349981003272])</code></pre><h2 id="Composition-of-State-Space-Models-and-AD"><a class="docs-heading-anchor" href="#Composition-of-State-Space-Models-and-AD">Composition of State Space Models and AD</a><a id="Composition-of-State-Space-Models-and-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-of-State-Space-Models-and-AD" title="Permalink"></a></h2><p>While the above gradients have been with respect to the full state space objects <code>A, B</code>, etc. those themselves could be generated through a separate procedure and the whole object differentiated.  For example, lets repeat the above examples where we generate the <code>A</code> matrix from some sort of deep parameters.</p><p>First we will generate some observations with a <code>generate_model</code> proxy–-which could be replaced with something more complicated but still differentiable</p><pre><code class="language-julia hljs">function generate_model(β)
    A = [β 6.2;
        0.0  0.2]
    B = Matrix([0.0  0.001]&#39;) # [0.0; 0.001;;] gives a zygote bug
    C = [0.09 0.67;
        1.00 0.00]
    D = [0.01, 0.01]
    return (;A,B,C,D)
end

function simulate_model(β, u0;T = 200)
    mod = generate_model(β)
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, T); mod.C, observables_noise = mod.D)
    sol = solve(prob) # simulates
    observables = hcat(sol.z...)
    observables = observables[:, 2:end] # see note above on likelihood and timing
    return observables, sol.W
end

# Fix a &quot;pseudo-true&quot; and generate noise and observables
β = 0.95
u0 = [0.0, 0.0]
observables, noise = simulate_model(β, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.0867968627276834 -0.015534771520352833 … -0.03346347247518665 0.02941077478500921; 0.09031852850200527 0.08919937634757465 … -0.019516410656928 0.030538978997886823], [-0.7456973073962512 -0.6111509959960206 … -0.4659879048918313 -0.5866739724787616])</code></pre><p>Next, we will evaluate the marginal likelihood using the kalman filter for a particular <code>β</code> value,</p><pre><code class="language-julia hljs">function kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
u0_prior_mean = [0.0, 0.0]
u0_prior_var = [1e-10 0.0;
                0.0 1e-10]  # starting with degenerate prior
kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">358.77505942878656</code></pre><p>Given the observation error we would not expect the pseudo-true to exactly maximimize the log likelihood.  To show this, we can optimize it using using the Optim package and using a gradient-based optimization routine</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimJL
# Create a function to minimize only of β and use Zygote based gradients
kalman_objective(β,p) = -kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
kalman_objective(0.95, nothing)
gradient(β -&gt;kalman_objective(β, nothing),β) # Verifying it can be differentiated


optf = OptimizationFunction(kalman_objective, Optimization.AutoZygote())
β0 = [0.91] # start off of the pseudotrue
optprob = OptimizationProblem(optf, β0)
optsol = solve(optprob,LBFGS())  # reverse-mode AD is overkill here</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 1-element Vector{Float64}:
 -0.10905840309488457</code></pre><p>In this way, this package composes with others such as <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">DifferentiableStateSpaceModels.jl</a> which take a set of structural parameters and an expectational difference equation and generate a state-space model.</p><p>Similarly, we can find the joint likelihood for a particular <code>β</code> value and noise.  Here we will add in prior.  Some form of a prior or regularization is generally necessary for these sorts of nonlinear models.</p><pre><code class="language-julia hljs">function joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, noise)
    return solve(prob).logpdf + sum(logpdf.(noise_prior, noise)) + logpdf(β_prior, β) # posterior
end
u0 = [0.0, 0.0]
noise_prior = Normal(0.0, 1.0)
β_prior = Normal(β, 0.03) # prior local to the true value
joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">66.81298103035749</code></pre><p>Which we can turn into a differntiable objective adding in a prior on the noise</p><pre><code class="language-julia hljs">joint_model_objective(x, p) = -joint_model_posterior(x[1], u0, Matrix(x[2:end]&#39;), observables, noise_prior, β_prior) # extract noise and parameeter from vector
x0 = vcat([0.95], noise[1,:])  # starting at the true noise
joint_model_objective(x0, nothing)
gradient(x -&gt;joint_model_objective(x, nothing),x0) # Verifying it can be differentiated

# optimize
optf = OptimizationFunction(joint_model_objective, Optimization.AutoZygote())
optprob = OptimizationProblem(optf, x0)
optsol = solve(optprob,LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 201-element Vector{Float64}:
  0.9600124382733101
 -0.021494425530262956
 -0.08363321752269276
 -0.07388857303117227
 -0.039227529137685305
  0.01057727140400967
  0.03235369166632269
 -0.00833247260214973
 -0.12323740618219534
 -0.19209326623980807
  ⋮
 -0.10361190384885896
 -0.002236202110535102
 -0.11977407119432303
 -0.13070495055889544
 -0.07946447747207983
 -0.10453569422647602
  0.025519930312777214
  0.024793479206079702
  0.002028044116096253</code></pre><p>This &quot;solves&quot; the problem relatively quickly, despite the high-dimensionality.  However, from a statistics perspective note that this last optimization process does not do especially well in recovering the pseudotrue if you increase the prior variance on the <code>β</code> parameter.  Maximizing the posterior is usually the wrong thing to do in high-dimensions because the mode is not a typical set.</p><h2 id="Caveats-on-Gradients-and-Performance"><a class="docs-heading-anchor" href="#Caveats-on-Gradients-and-Performance">Caveats on Gradients and Performance</a><a id="Caveats-on-Gradients-and-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Caveats-on-Gradients-and-Performance" title="Permalink"></a></h2><p>A few notes on performance and gradients:</p><ol><li>As this is using reverse-mode AD it will be efficient for fairly large systems as long as the ultimate value of your differentiable program.  With a little extra work and unit tests, it could support structured matrices/etc. as well.</li><li>Getting to much higher scales, where the <code>A,B,C,D</code> are so large that matrix-free operators is necessary, is feasible but will require generalizing those to LinearOperators.  This would be reasonably easy for the joint likelihood and feasible but possible for the Kalman filter</li><li>At this point, there is no support for forward-mode auto-differentiation.  For smaller systems with a kalman filter, this should dominate the alternatives, and efficient forward-mode AD rules for the kalman filter exist (see the supplementary materials in the the <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">Differentiable State Space Models</a> paper).  However, it would be a significant amount of work to add end-to-end support and fulfill standard SciML interfaces, and perhaps waiting for <a href="https://enzyme.mit.edu/julia/">Enzyme</a> or similar AD systems that provide both forward/reverse/mixed mode makes sense.</li><li>Forward-mode AD is likely inappropriate for the joint-likelihood based models since the dimensionality of the noise is always large.</li><li>The gradient rules are written using <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules.jl</a> so in theory they will work with any supporting AD.  In practice, though, Zygote is the most tested and other systems have inconsistent support on Julia at this time.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a><a class="docs-footer-nextpage" href="../quadratic_state_space_examples/">Quadratic State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 14 March 2023 00:40">Tuesday 14 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
