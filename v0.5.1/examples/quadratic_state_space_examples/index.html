<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.00355313797926341]
 [-0.022142538148937074, 0.011455871346632328]
 [0.05030627602718485, -0.0024457862748475025]
 [0.03255879505228328, -0.0018850753382210436]
 [0.01917192743228832, 0.007942034378389683]
 [0.06758322172709617, 0.00942862552802232]
 [0.12290338140136077, 0.0011767499083631507]
 [0.1239868599249243, -0.01192973835038314]
 [0.04408771307289922, -0.01504565495293219]
 ⋮
 [-0.18378336646403373, 0.007886293627645152]
 [-0.12568937103914757, 0.003924728289783287]
 [-0.09513909111885711, 0.0030447036330139786]
 [-0.07157630148152241, 0.016697431470654382]
 [0.03623584637413685, 0.0009723117436016742]
 [0.04037903111417424, 0.0038287988894932135]
 [0.06207557775283068, -0.002797238820386936]
 [0.04156331508703469, -0.0009641407428672872]
 [0.033429315087756706, -0.011676802977374405]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip760">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip760)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip761">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip760)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip762">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip760)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1462.34 2352.76,1462.34 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1038.3 2352.76,1038.3 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,614.262 2352.76,614.262 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,190.222 2352.76,190.222 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1462.34 105.89,1462.34 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1038.3 105.89,1038.3 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,614.262 105.89,614.262 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,190.222 105.89,190.222 "/>
<path clip-path="url(#clip760)" d="M-54.3545 1462.79 L-24.6788 1462.79 L-24.6788 1466.73 L-54.3545 1466.73 L-54.3545 1462.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-4.58628 1448.14 Q-8.19737 1448.14 -10.0261 1451.7 Q-11.8316 1455.24 -11.8316 1462.37 Q-11.8316 1469.48 -10.0261 1473.05 Q-8.19737 1476.59 -4.58628 1476.59 Q-0.95204 1476.59 0.853506 1473.05 Q2.6822 1469.48 2.6822 1462.37 Q2.6822 1455.24 0.853506 1451.7 Q-0.95204 1448.14 -4.58628 1448.14 M-4.58628 1444.43 Q1.22387 1444.43 4.27941 1449.04 Q7.3581 1453.62 7.3581 1462.37 Q7.3581 1471.1 4.27941 1475.71 Q1.22387 1480.29 -4.58628 1480.29 Q-10.3964 1480.29 -13.4751 1475.71 Q-16.5307 1471.1 -16.5307 1462.37 Q-16.5307 1453.62 -13.4751 1449.04 Q-10.3964 1444.43 -4.58628 1444.43 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M15.5756 1473.74 L20.4599 1473.74 L20.4599 1479.62 L15.5756 1479.62 L15.5756 1473.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M34.6728 1475.68 L50.9921 1475.68 L50.9921 1479.62 L29.0478 1479.62 L29.0478 1475.68 Q31.7098 1472.93 36.2931 1468.3 Q40.8996 1463.65 42.0801 1462.31 Q44.3255 1459.78 45.2051 1458.05 Q46.1079 1456.29 46.1079 1454.6 Q46.1079 1451.84 44.1635 1450.11 Q42.2422 1448.37 39.1403 1448.37 Q36.9413 1448.37 34.4876 1449.13 Q32.057 1449.9 29.2793 1451.45 L29.2793 1446.73 Q32.1033 1445.59 34.557 1445.01 Q37.0107 1444.43 39.0477 1444.43 Q44.4181 1444.43 47.6125 1447.12 Q50.8069 1449.81 50.8069 1454.3 Q50.8069 1456.43 49.9968 1458.35 Q49.2097 1460.24 47.1033 1462.84 Q46.5246 1463.51 43.4227 1466.73 Q40.3209 1469.92 34.6728 1475.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-54.7249 1038.75 L-25.0491 1038.75 L-25.0491 1042.69 L-54.7249 1042.69 L-54.7249 1038.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-4.95665 1024.1 Q-8.56774 1024.1 -10.3964 1027.66 Q-12.202 1031.21 -12.202 1038.34 Q-12.202 1045.44 -10.3964 1049.01 Q-8.56774 1052.55 -4.95665 1052.55 Q-1.32241 1052.55 0.483137 1049.01 Q2.31183 1045.44 2.31183 1038.34 Q2.31183 1031.21 0.483137 1027.66 Q-1.32241 1024.1 -4.95665 1024.1 M-4.95665 1020.4 Q0.853506 1020.4 3.90904 1025 Q6.98773 1029.59 6.98773 1038.34 Q6.98773 1047.06 3.90904 1051.67 Q0.853506 1056.25 -4.95665 1056.25 Q-10.7668 1056.25 -13.8455 1051.67 Q-16.901 1047.06 -16.901 1038.34 Q-16.901 1029.59 -13.8455 1025 Q-10.7668 1020.4 -4.95665 1020.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M15.2053 1049.7 L20.0895 1049.7 L20.0895 1055.58 L15.2053 1055.58 L15.2053 1049.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M31.0848 1051.65 L38.7237 1051.65 L38.7237 1025.28 L30.4135 1026.95 L30.4135 1022.69 L38.6774 1021.02 L43.3533 1021.02 L43.3533 1051.65 L50.9921 1051.65 L50.9921 1055.58 L31.0848 1055.58 L31.0848 1051.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-6.18349 600.06 Q-9.79459 600.06 -11.6233 603.625 Q-13.4288 607.167 -13.4288 614.296 Q-13.4288 621.403 -11.6233 624.967 Q-9.79459 628.509 -6.18349 628.509 Q-2.54925 628.509 -0.743708 624.967 Q1.08499 621.403 1.08499 614.296 Q1.08499 607.167 -0.743708 603.625 Q-2.54925 600.06 -6.18349 600.06 M-6.18349 596.357 Q-0.37334 596.357 2.6822 600.963 Q5.76089 605.546 5.76089 614.296 Q5.76089 623.023 2.6822 627.63 Q-0.37334 632.213 -6.18349 632.213 Q-11.9936 632.213 -15.0723 627.63 Q-18.1279 623.023 -18.1279 614.296 Q-18.1279 605.546 -15.0723 600.963 Q-11.9936 596.357 -6.18349 596.357 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M13.9784 625.662 L18.8627 625.662 L18.8627 631.542 L13.9784 631.542 L13.9784 625.662 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M39.0477 600.06 Q35.4367 600.06 33.608 603.625 Q31.8024 607.167 31.8024 614.296 Q31.8024 621.403 33.608 624.967 Q35.4367 628.509 39.0477 628.509 Q42.682 628.509 44.4875 624.967 Q46.3162 621.403 46.3162 614.296 Q46.3162 607.167 44.4875 603.625 Q42.682 600.06 39.0477 600.06 M39.0477 596.357 Q44.8579 596.357 47.9134 600.963 Q50.9921 605.546 50.9921 614.296 Q50.9921 623.023 47.9134 627.63 Q44.8579 632.213 39.0477 632.213 Q33.2376 632.213 30.1589 627.63 Q27.1034 623.023 27.1034 614.296 Q27.1034 605.546 30.1589 600.963 Q33.2376 596.357 39.0477 596.357 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-4.95665 176.021 Q-8.56774 176.021 -10.3964 179.586 Q-12.202 183.127 -12.202 190.257 Q-12.202 197.364 -10.3964 200.928 Q-8.56774 204.47 -4.95665 204.47 Q-1.32241 204.47 0.483137 200.928 Q2.31183 197.364 2.31183 190.257 Q2.31183 183.127 0.483137 179.586 Q-1.32241 176.021 -4.95665 176.021 M-4.95665 172.317 Q0.853506 172.317 3.90904 176.924 Q6.98773 181.507 6.98773 190.257 Q6.98773 198.984 3.90904 203.59 Q0.853506 208.174 -4.95665 208.174 Q-10.7668 208.174 -13.8455 203.59 Q-16.901 198.984 -16.901 190.257 Q-16.901 181.507 -13.8455 176.924 Q-10.7668 172.317 -4.95665 172.317 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M15.2053 201.623 L20.0895 201.623 L20.0895 207.502 L15.2053 207.502 L15.2053 201.623 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M31.0848 203.567 L38.7237 203.567 L38.7237 177.202 L30.4135 178.868 L30.4135 174.609 L38.6774 172.942 L43.3533 172.942 L43.3533 203.567 L50.9921 203.567 L50.9921 207.502 L31.0848 207.502 L31.0848 203.567 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip762)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,614.262 162.518,614.593 238.043,708.155 313.569,400.943 389.094,476.199 464.619,532.965 540.145,327.682 615.67,93.1031 691.196,88.5087 766.721,427.312 842.247,829.734 917.772,1175.55 993.298,436.834 1068.82,110.132 1144.35,90.134 1219.87,488.013 1295.4,795.387 1370.92,891.559 1446.45,1082.19 1521.98,967.986 1597.5,1295.75 1673.03,1464 1748.55,1393.57 1824.08,1147.23 1899.6,1017.69 1975.13,917.773 2050.65,460.607 2126.18,443.039 2201.7,351.037 2277.23,438.017 2352.76,472.508 "/>
<polyline clip-path="url(#clip762)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,614.262 162.518,629.328 238.043,565.684 313.569,624.633 389.094,622.255 464.619,580.584 540.145,574.28 615.67,609.272 691.196,664.848 766.721,678.061 842.247,672.153 917.772,500.948 993.298,560.45 1068.82,606.931 1144.35,674.507 1219.87,663.036 1295.4,631.223 1370.92,647.346 1446.45,599.567 1521.98,670.351 1597.5,647.023 1673.03,609.689 1748.55,580.821 1824.08,597.619 1899.6,601.351 1975.13,543.458 2050.65,610.139 2126.18,598.026 2201.7,626.123 2277.23,618.35 2352.76,663.776 "/>
<path clip-path="url(#clip760)" d="M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 "/>
<polyline clip-path="url(#clip760)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1352.98 338.744,1352.98 "/>
<path clip-path="url(#clip760)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip760)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1404.82 338.744,1404.82 "/>
<path clip-path="url(#clip760)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -0.355314  1.21665  -0.473696  -0.139592  …  -0.3563  -0.0404693  -1.1484</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip820">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip821">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip820)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip822">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip820)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1517.35 2352.76,1517.35 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1287.19 2352.76,1287.19 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1057.02 2352.76,1057.02 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,826.847 2352.76,826.847 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,596.678 2352.76,596.678 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,366.508 2352.76,366.508 "/>
<polyline clip-path="url(#clip822)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,136.339 2352.76,136.339 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1517.35 105.89,1517.35 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1287.19 105.89,1287.19 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1057.02 105.89,1057.02 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,826.847 105.89,826.847 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,596.678 105.89,596.678 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,366.508 105.89,366.508 "/>
<polyline clip-path="url(#clip820)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,136.339 105.89,136.339 "/>
<path clip-path="url(#clip820)" d="M-9.72514 1517.81 L19.9506 1517.81 L19.9506 1521.74 L-9.72514 1521.74 L-9.72514 1517.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M30.0895 1500.07 L48.4458 1500.07 L48.4458 1504.01 L34.3718 1504.01 L34.3718 1512.48 Q35.3904 1512.14 36.4089 1511.97 Q37.4274 1511.79 38.4459 1511.79 Q44.2329 1511.79 47.6125 1514.96 Q50.9921 1518.13 50.9921 1523.55 Q50.9921 1529.13 47.5199 1532.23 Q44.0477 1535.31 37.7283 1535.31 Q35.5524 1535.31 33.2839 1534.94 Q31.0385 1534.57 28.6311 1533.82 L28.6311 1529.13 Q30.7145 1530.26 32.9367 1530.82 Q35.1589 1531.37 37.6357 1531.37 Q41.6403 1531.37 43.9783 1529.26 Q46.3162 1527.16 46.3162 1523.55 Q46.3162 1519.94 43.9783 1517.83 Q41.6403 1515.72 37.6357 1515.72 Q35.7607 1515.72 33.8857 1516.14 Q32.0339 1516.56 30.0895 1517.44 L30.0895 1500.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M39.0477 1272.98 Q35.4367 1272.98 33.608 1276.55 Q31.8024 1280.09 31.8024 1287.22 Q31.8024 1294.33 33.608 1297.89 Q35.4367 1301.43 39.0477 1301.43 Q42.682 1301.43 44.4875 1297.89 Q46.3162 1294.33 46.3162 1287.22 Q46.3162 1280.09 44.4875 1276.55 Q42.682 1272.98 39.0477 1272.98 M39.0477 1269.28 Q44.8579 1269.28 47.9134 1273.89 Q50.9921 1278.47 50.9921 1287.22 Q50.9921 1295.95 47.9134 1300.55 Q44.8579 1305.14 39.0477 1305.14 Q33.2376 1305.14 30.1589 1300.55 Q27.1034 1295.95 27.1034 1287.22 Q27.1034 1278.47 30.1589 1273.89 Q33.2376 1269.28 39.0477 1269.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M30.0895 1039.74 L48.4458 1039.74 L48.4458 1043.67 L34.3718 1043.67 L34.3718 1052.14 Q35.3904 1051.8 36.4089 1051.63 Q37.4274 1051.45 38.4459 1051.45 Q44.2329 1051.45 47.6125 1054.62 Q50.9921 1057.79 50.9921 1063.21 Q50.9921 1068.79 47.5199 1071.89 Q44.0477 1074.97 37.7283 1074.97 Q35.5524 1074.97 33.2839 1074.6 Q31.0385 1074.23 28.6311 1073.49 L28.6311 1068.79 Q30.7145 1069.92 32.9367 1070.48 Q35.1589 1071.03 37.6357 1071.03 Q41.6403 1071.03 43.9783 1068.93 Q46.3162 1066.82 46.3162 1063.21 Q46.3162 1059.6 43.9783 1057.49 Q41.6403 1055.38 37.6357 1055.38 Q35.7607 1055.38 33.8857 1055.8 Q32.0339 1056.22 30.0895 1057.1 L30.0895 1039.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M-0.303895 840.192 L7.33495 840.192 L7.33495 813.826 L-0.975188 815.493 L-0.975188 811.234 L7.28866 809.567 L11.9646 809.567 L11.9646 840.192 L19.6034 840.192 L19.6034 844.127 L-0.303895 844.127 L-0.303895 840.192 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M39.0477 812.646 Q35.4367 812.646 33.608 816.21 Q31.8024 819.752 31.8024 826.882 Q31.8024 833.988 33.608 837.553 Q35.4367 841.095 39.0477 841.095 Q42.682 841.095 44.4875 837.553 Q46.3162 833.988 46.3162 826.882 Q46.3162 819.752 44.4875 816.21 Q42.682 812.646 39.0477 812.646 M39.0477 808.942 Q44.8579 808.942 47.9134 813.548 Q50.9921 818.132 50.9921 826.882 Q50.9921 835.608 47.9134 840.215 Q44.8579 844.798 39.0477 844.798 Q33.2376 844.798 30.1589 840.215 Q27.1034 835.608 27.1034 826.882 Q27.1034 818.132 30.1589 813.548 Q33.2376 808.942 39.0477 808.942 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M0.69147 610.022 L8.33032 610.022 L8.33032 583.657 L0.0201769 585.324 L0.0201769 581.064 L8.28402 579.398 L12.9599 579.398 L12.9599 610.022 L20.5988 610.022 L20.5988 613.958 L0.69147 613.958 L0.69147 610.022 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M30.0895 579.398 L48.4458 579.398 L48.4458 583.333 L34.3718 583.333 L34.3718 591.805 Q35.3904 591.458 36.4089 591.296 Q37.4274 591.111 38.4459 591.111 Q44.2329 591.111 47.6125 594.282 Q50.9921 597.453 50.9921 602.87 Q50.9921 608.448 47.5199 611.55 Q44.0477 614.629 37.7283 614.629 Q35.5524 614.629 33.2839 614.259 Q31.0385 613.888 28.6311 613.147 L28.6311 608.448 Q30.7145 609.583 32.9367 610.138 Q35.1589 610.694 37.6357 610.694 Q41.6403 610.694 43.9783 608.587 Q46.3162 606.481 46.3162 602.87 Q46.3162 599.259 43.9783 597.152 Q41.6403 595.046 37.6357 595.046 Q35.7607 595.046 33.8857 595.462 Q32.0339 595.879 30.0895 596.759 L30.0895 579.398 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M2.91368 379.853 L19.233 379.853 L19.233 383.788 L-2.71129 383.788 L-2.71129 379.853 Q-0.0492672 377.099 4.53404 372.469 Q9.1405 367.816 10.321 366.474 Q12.5664 363.95 13.446 362.214 Q14.3488 360.455 14.3488 358.765 Q14.3488 356.011 12.4044 354.275 Q10.4831 352.538 7.38125 352.538 Q5.18219 352.538 2.7285 353.302 Q0.297953 354.066 -2.47981 355.617 L-2.47981 350.895 Q0.344249 349.761 2.79794 349.182 Q5.25163 348.603 7.28866 348.603 Q12.659 348.603 15.8534 351.288 Q19.0479 353.974 19.0479 358.464 Q19.0479 360.594 18.2377 362.515 Q17.4506 364.413 15.3442 367.006 Q14.7655 367.677 11.6636 370.895 Q8.5618 374.089 2.91368 379.853 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M39.0477 352.307 Q35.4367 352.307 33.608 355.872 Q31.8024 359.413 31.8024 366.543 Q31.8024 373.649 33.608 377.214 Q35.4367 380.756 39.0477 380.756 Q42.682 380.756 44.4875 377.214 Q46.3162 373.649 46.3162 366.543 Q46.3162 359.413 44.4875 355.872 Q42.682 352.307 39.0477 352.307 M39.0477 348.603 Q44.8579 348.603 47.9134 353.21 Q50.9921 357.793 50.9921 366.543 Q50.9921 375.27 47.9134 379.876 Q44.8579 384.46 39.0477 384.46 Q33.2376 384.46 30.1589 379.876 Q27.1034 375.27 27.1034 366.543 Q27.1034 357.793 30.1589 353.21 Q33.2376 348.603 39.0477 348.603 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M3.90904 149.684 L20.2284 149.684 L20.2284 153.619 L-1.71592 153.619 L-1.71592 149.684 Q0.946098 146.929 5.52941 142.3 Q10.1359 137.647 11.3164 136.304 Q13.5618 133.781 14.4414 132.045 Q15.3442 130.286 15.3442 128.596 Q15.3442 125.841 13.3997 124.105 Q11.4784 122.369 8.37661 122.369 Q6.17755 122.369 3.72386 123.133 Q1.29332 123.897 -1.48444 125.448 L-1.48444 120.726 Q1.33961 119.591 3.7933 119.013 Q6.247 118.434 8.28402 118.434 Q13.6544 118.434 16.8488 121.119 Q20.0432 123.804 20.0432 128.295 Q20.0432 130.425 19.233 132.346 Q18.446 134.244 16.3395 136.837 Q15.7608 137.508 12.659 140.726 Q9.55716 143.92 3.90904 149.684 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip820)" d="M30.0895 119.059 L48.4458 119.059 L48.4458 122.994 L34.3718 122.994 L34.3718 131.466 Q35.3904 131.119 36.4089 130.957 Q37.4274 130.772 38.4459 130.772 Q44.2329 130.772 47.6125 133.943 Q50.9921 137.114 50.9921 142.531 Q50.9921 148.11 47.5199 151.212 Q44.0477 154.29 37.7283 154.29 Q35.5524 154.29 33.2839 153.92 Q31.0385 153.55 28.6311 152.809 L28.6311 148.11 Q30.7145 149.244 32.9367 149.8 Q35.1589 150.355 37.6357 150.355 Q41.6403 150.355 43.9783 148.249 Q46.3162 146.142 46.3162 142.531 Q46.3162 138.92 43.9783 136.814 Q41.6403 134.707 37.6357 134.707 Q35.7607 134.707 33.8857 135.124 Q32.0339 135.54 30.0895 136.42 L30.0895 119.059 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip822)" d="M151.118 1369.52 L222.368 1441.62 L293.618 1477.72 L364.869 1479.3 L436.119 1471.58 L507.37 1464.39 L578.62 1455.09 L649.871 1448.59 L721.121 1438.97 L792.371 1431.67 L863.622 1425.64 L934.872 1417.81 L1006.12 1411.16 L1077.37 1404.58 L1148.62 1400.59 L1219.87 1397.1 L1291.12 1393.7 L1362.37 1388.16 L1433.63 1385.27 L1504.88 1381.41 L1576.13 1377.54 L1647.38 1376.41 L1718.63 1371.66 L1789.88 1368 L1861.13 1366.69 L1932.38 1364.72 L2003.63 1364.12 L2074.88 1363.57 L2146.13 1363.07 L2217.38 1358.29 L2288.63 1353.7 L2288.63 1018.72 L2217.38 1001.76 L2146.13 983.473 L2074.88 967.346 L2003.63 950.467 L1932.38 929.924 L1861.13 909.62 L1789.88 884.955 L1718.63 864.317 L1647.38 839.288 L1576.13 814.206 L1504.88 786.6 L1433.63 760.046 L1362.37 731.879 L1291.12 701.987 L1219.87 670.26 L1148.62 634.308 L1077.37 597.221 L1006.12 561.565 L934.872 521.629 L863.622 480.424 L792.371 436.444 L721.121 390.831 L649.871 340.023 L578.62 290.164 L507.37 236.28 L436.119 179.173 L364.869 126.651 L293.618 88.9544 L222.368 173.746 L151.118 1204.76  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip822)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1280.39 222.368,1180.06 293.618,1169.04 364.869,1168.08 436.119,1175.17 507.37,1182.8 578.62,1187.19 649.871,1190.66 721.121,1196.38 792.371,1201.58 863.622,1209.9 934.872,1212.27 1006.12,1215.02 1077.37,1213.58 1148.62,1217.13 1219.87,1222.51 1291.12,1229.09 1362.37,1234.06 1433.63,1236.51 1504.88,1239.58 1576.13,1243.36 1647.38,1248.25 1718.63,1250.82 1789.88,1253.13 1861.13,1255.74 1932.38,1255.23 2003.63,1258.19 2074.88,1256.09 2146.13,1255.5 2217.38,1254.62 2288.63,1256.41 "/>
<path clip-path="url(#clip822)" d="M151.118 1354.56 L222.368 1300.96 L293.618 1289.99 L364.869 1288.09 L436.119 1288.12 L507.37 1288.01 L578.62 1287.94 L649.871 1287.98 L721.121 1287.77 L792.371 1287.88 L863.622 1287.88 L934.872 1287.57 L1006.12 1287.99 L1077.37 1288.02 L1148.62 1287.99 L1219.87 1287.9 L1291.12 1287.89 L1362.37 1287.96 L1433.63 1287.99 L1504.88 1287.92 L1576.13 1287.79 L1647.38 1288.02 L1718.63 1288.11 L1789.88 1288.03 L1861.13 1287.83 L1932.38 1287.85 L2003.63 1287.79 L2074.88 1288.09 L2146.13 1287.95 L2217.38 1287.95 L2288.63 1287.99 L2288.63 1286.26 L2217.38 1286.48 L2146.13 1286.71 L2074.88 1286.49 L2003.63 1286.23 L1932.38 1286.57 L1861.13 1286.6 L1789.88 1286.53 L1718.63 1286.55 L1647.38 1286.42 L1576.13 1286.65 L1504.88 1286.56 L1433.63 1286.44 L1362.37 1286.61 L1291.12 1286.47 L1219.87 1286.26 L1148.62 1286.72 L1077.37 1286.53 L1006.12 1286.31 L934.872 1286.47 L863.622 1286.46 L792.371 1286.41 L721.121 1286.31 L649.871 1286.36 L578.62 1286.58 L507.37 1286.63 L436.119 1286.5 L364.869 1286.19 L293.618 1283.84 L222.368 1269.44 L151.118 1199.04  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip822)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1275.77 222.368,1285.51 293.618,1286.82 364.869,1287.04 436.119,1287.23 507.37,1287.24 578.62,1287.14 649.871,1287.41 721.121,1287.04 792.371,1287.28 863.622,1287.24 934.872,1287.03 1006.12,1287.14 1077.37,1287.31 1148.62,1287.22 1219.87,1287.35 1291.12,1287.24 1362.37,1287.38 1433.63,1287.16 1504.88,1287.25 1576.13,1287.3 1647.38,1287.07 1718.63,1287.28 1789.88,1287.19 1861.13,1287.08 1932.38,1287.26 2003.63,1287.22 2074.88,1287.31 2146.13,1287.18 2217.38,1287.16 2288.63,1287.14 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">45.80279896408488</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-45.22573238147203, -568.9806437858828], [-2.3883827828380886 0.2523117489872047; -29.812311672960476 1.915113305491669], [-1.0369545975711252 0.08053696638095714; -8.391467481289775 0.2156499829305802;;; 0.08053696638095714 -0.025150729707716125; 0.2156499829305802 -0.09626570151794898], [41.44028962475631; 98.63433674333204;;], [-97.3339978268687, 21.412045328949983], [5.479896080438674 -0.6307880561648526; 0.9955783365964621 0.2836828737999196], [-0.9343047284967385 -0.03006338025886798; 0.11527418295240198 -0.02541499185034846;;; -0.03006338025886798 -0.005175837224823752; -0.02541499185034846 0.005393596357562912], [0.6127168540266734 0.7338999924459112 … -0.014722018259441659 0.018496882177573216])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 18 March 2023 09:28">Saturday 18 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
