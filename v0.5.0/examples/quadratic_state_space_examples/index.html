<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.005277890127828223]
 [-0.03278834262375716, -0.018554620647629437]
 [-0.14514788085790672, 0.0005985626408818749]
 [-0.13426669212360814, -0.0016044828550656103]
 [-0.13756038504030885, 0.0022750146958641134]
 [-0.11666436082202894, -0.005486904775123459]
 [-0.14479337800066763, 0.004538669436907389]
 [-0.10947647154226373, 0.015158757245327415]
 [-0.00949242788916024, 0.005825726783559339]
 ⋮
 [0.15857678397346966, 0.002790906954753327]
 [0.16792235556213952, 0.005887934723269916]
 [0.19612232855460252, -0.00638273897304408]
 [0.14670092151924338, -0.005721948331386053]
 [0.10385353308555761, -0.01588867437001187]
 [0.000750331240033248, -0.005639703505270775]
 [-0.03423181935892063, -0.00565987882161571]
 [-0.06757616263683289, 0.016403805540077105]
 [0.03819281418861474, -0.007226081546588962]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip840">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip840)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip841">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip840)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip842">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip840)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1282.03 2352.76,1282.03 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,878.978 2352.76,878.978 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,475.929 2352.76,475.929 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,72.8798 2352.76,72.8798 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1282.03 105.89,1282.03 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,878.978 105.89,878.978 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,475.929 105.89,475.929 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,72.8798 105.89,72.8798 
  "/>
<path clip-path="url(#clip840)" d="M-54.7249 1282.48 L-25.0491 1282.48 L-25.0491 1286.41 L-54.7249 1286.41 L-54.7249 1282.48 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-4.95665 1267.83 Q-8.56774 1267.83 -10.3964 1271.39 Q-12.202 1274.93 -12.202 1282.06 Q-12.202 1289.17 -10.3964 1292.73 Q-8.56774 1296.27 -4.95665 1296.27 Q-1.32241 1296.27 0.483137 1292.73 Q2.31183 1289.17 2.31183 1282.06 Q2.31183 1274.93 0.483137 1271.39 Q-1.32241 1267.83 -4.95665 1267.83 M-4.95665 1264.12 Q0.853506 1264.12 3.90904 1268.73 Q6.98773 1273.31 6.98773 1282.06 Q6.98773 1290.79 3.90904 1295.4 Q0.853506 1299.98 -4.95665 1299.98 Q-10.7668 1299.98 -13.8455 1295.4 Q-16.901 1290.79 -16.901 1282.06 Q-16.901 1273.31 -13.8455 1268.73 Q-10.7668 1264.12 -4.95665 1264.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M15.2053 1293.43 L20.0895 1293.43 L20.0895 1299.31 L15.2053 1299.31 L15.2053 1293.43 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M31.0848 1295.37 L38.7237 1295.37 L38.7237 1269.01 L30.4135 1270.67 L30.4135 1266.41 L38.6774 1264.75 L43.3533 1264.75 L43.3533 1295.37 L50.9921 1295.37 L50.9921 1299.31 L31.0848 1299.31 L31.0848 1295.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-6.18349 864.777 Q-9.79459 864.777 -11.6233 868.341 Q-13.4288 871.883 -13.4288 879.013 Q-13.4288 886.119 -11.6233 889.684 Q-9.79459 893.226 -6.18349 893.226 Q-2.54925 893.226 -0.743708 889.684 Q1.08499 886.119 1.08499 879.013 Q1.08499 871.883 -0.743708 868.341 Q-2.54925 864.777 -6.18349 864.777 M-6.18349 861.073 Q-0.37334 861.073 2.6822 865.679 Q5.76089 870.263 5.76089 879.013 Q5.76089 887.74 2.6822 892.346 Q-0.37334 896.929 -6.18349 896.929 Q-11.9936 896.929 -15.0723 892.346 Q-18.1279 887.74 -18.1279 879.013 Q-18.1279 870.263 -15.0723 865.679 Q-11.9936 861.073 -6.18349 861.073 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M13.9784 890.378 L18.8627 890.378 L18.8627 896.258 L13.9784 896.258 L13.9784 890.378 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M39.0477 864.777 Q35.4367 864.777 33.608 868.341 Q31.8024 871.883 31.8024 879.013 Q31.8024 886.119 33.608 889.684 Q35.4367 893.226 39.0477 893.226 Q42.682 893.226 44.4875 889.684 Q46.3162 886.119 46.3162 879.013 Q46.3162 871.883 44.4875 868.341 Q42.682 864.777 39.0477 864.777 M39.0477 861.073 Q44.8579 861.073 47.9134 865.679 Q50.9921 870.263 50.9921 879.013 Q50.9921 887.74 47.9134 892.346 Q44.8579 896.929 39.0477 896.929 Q33.2376 896.929 30.1589 892.346 Q27.1034 887.74 27.1034 879.013 Q27.1034 870.263 30.1589 865.679 Q33.2376 861.073 39.0477 861.073 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-4.95665 461.728 Q-8.56774 461.728 -10.3964 465.292 Q-12.202 468.834 -12.202 475.964 Q-12.202 483.07 -10.3964 486.635 Q-8.56774 490.176 -4.95665 490.176 Q-1.32241 490.176 0.483137 486.635 Q2.31183 483.07 2.31183 475.964 Q2.31183 468.834 0.483137 465.292 Q-1.32241 461.728 -4.95665 461.728 M-4.95665 458.024 Q0.853506 458.024 3.90904 462.63 Q6.98773 467.214 6.98773 475.964 Q6.98773 484.69 3.90904 489.297 Q0.853506 493.88 -4.95665 493.88 Q-10.7668 493.88 -13.8455 489.297 Q-16.901 484.69 -16.901 475.964 Q-16.901 467.214 -13.8455 462.63 Q-10.7668 458.024 -4.95665 458.024 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M15.2053 487.329 L20.0895 487.329 L20.0895 493.209 L15.2053 493.209 L15.2053 487.329 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M31.0848 489.274 L38.7237 489.274 L38.7237 462.908 L30.4135 464.575 L30.4135 460.316 L38.6774 458.649 L43.3533 458.649 L43.3533 489.274 L50.9921 489.274 L50.9921 493.209 L31.0848 493.209 L31.0848 489.274 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-4.58628 58.6785 Q-8.19737 58.6785 -10.0261 62.2433 Q-11.8316 65.7849 -11.8316 72.9145 Q-11.8316 80.0209 -10.0261 83.5857 Q-8.19737 87.1274 -4.58628 87.1274 Q-0.95204 87.1274 0.853506 83.5857 Q2.6822 80.0209 2.6822 72.9145 Q2.6822 65.7849 0.853506 62.2433 Q-0.95204 58.6785 -4.58628 58.6785 M-4.58628 54.9748 Q1.22387 54.9748 4.27941 59.5812 Q7.3581 64.1645 7.3581 72.9145 Q7.3581 81.6413 4.27941 86.2478 Q1.22387 90.8311 -4.58628 90.8311 Q-10.3964 90.8311 -13.4751 86.2478 Q-16.5307 81.6413 -16.5307 72.9145 Q-16.5307 64.1645 -13.4751 59.5812 Q-10.3964 54.9748 -4.58628 54.9748 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M15.5756 84.2802 L20.4599 84.2802 L20.4599 90.1598 L15.5756 90.1598 L15.5756 84.2802 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip840)" d="M34.6728 86.2246 L50.9921 86.2246 L50.9921 90.1598 L29.0478 90.1598 L29.0478 86.2246 Q31.7098 83.47 36.2931 78.8404 Q40.8996 74.1876 42.0801 72.845 Q44.3255 70.3219 45.2051 68.5858 Q46.1079 66.8266 46.1079 65.1368 Q46.1079 62.3821 44.1635 60.646 Q42.2422 58.9099 39.1403 58.9099 Q36.9413 58.9099 34.4876 59.6738 Q32.057 60.4377 29.2793 61.9886 L29.2793 57.2664 Q32.1033 56.1322 34.557 55.5535 Q37.0107 54.9748 39.0477 54.9748 Q44.4181 54.9748 47.6125 57.6599 Q50.8069 60.3451 50.8069 64.8358 Q50.8069 66.9655 49.9968 68.8867 Q49.2097 70.7849 47.1033 73.3775 Q46.5246 74.0487 43.4227 77.2663 Q40.3209 80.4607 34.6728 86.2246 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip842)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,878.978 162.518,879.293 238.043,1011.13 313.569,1464 389.094,1420.14 464.619,1433.41 540.145,1349.19 615.67,1462.57 691.196,1320.22 766.721,917.237 
  842.247,769.649 917.772,512.903 993.298,420.189 1068.82,681.863 1144.35,356.022 1219.87,431.794 1295.4,320.583 1370.92,388.121 1446.45,345.432 1521.98,454.148 
  1597.5,485.845 1673.03,450.922 1748.55,239.836 1824.08,202.168 1899.6,88.5087 1975.13,287.701 2050.65,460.397 2126.18,875.954 2201.7,1016.95 2277.23,1151.34 
  2352.76,725.042 
  "/>
<polyline clip-path="url(#clip842)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,878.978 162.518,900.25 238.043,953.762 313.569,876.565 389.094,885.445 464.619,869.809 540.145,901.093 615.67,860.685 691.196,817.881 766.721,855.497 
  842.247,836.869 917.772,861.078 993.298,917.57 1068.82,825.173 1144.35,886.926 1219.87,857.466 1295.4,885.31 1370.92,868.11 1446.45,892.16 1521.98,880.611 
  1597.5,870.142 1673.03,841.645 1748.55,867.729 1824.08,855.247 1899.6,904.704 1975.13,902.04 2050.65,943.017 2126.18,901.709 2201.7,901.79 2277.23,812.863 
  2352.76,908.103 
  "/>
<path clip-path="url(#clip840)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip840)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip840)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip840)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip840)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -0.527789  -1.7499  0.430949  -0.17242  …  -0.453194  1.75358  -1.05068</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip900">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip900)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip901">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip900)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip902">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip900)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1491.25 2352.76,1491.25 
  "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1151.74 2352.76,1151.74 
  "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,812.226 2352.76,812.226 
  "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,472.716 2352.76,472.716 
  "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,133.206 2352.76,133.206 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1491.25 105.89,1491.25 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1151.74 105.89,1151.74 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,812.226 105.89,812.226 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,472.716 105.89,472.716 
  "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,133.206 105.89,133.206 
  "/>
<path clip-path="url(#clip900)" d="M-9.72514 1491.7 L19.9506 1491.7 L19.9506 1495.63 L-9.72514 1495.63 L-9.72514 1491.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M30.0895 1473.97 L48.4458 1473.97 L48.4458 1477.9 L34.3718 1477.9 L34.3718 1486.37 Q35.3904 1486.03 36.4089 1485.86 Q37.4274 1485.68 38.4459 1485.68 Q44.2329 1485.68 47.6125 1488.85 Q50.9921 1492.02 50.9921 1497.44 Q50.9921 1503.02 47.5199 1506.12 Q44.0477 1509.2 37.7283 1509.2 Q35.5524 1509.2 33.2839 1508.83 Q31.0385 1508.46 28.6311 1507.72 L28.6311 1503.02 Q30.7145 1504.15 32.9367 1504.71 Q35.1589 1505.26 37.6357 1505.26 Q41.6403 1505.26 43.9783 1503.16 Q46.3162 1501.05 46.3162 1497.44 Q46.3162 1493.83 43.9783 1491.72 Q41.6403 1489.61 37.6357 1489.61 Q35.7607 1489.61 33.8857 1490.03 Q32.0339 1490.45 30.0895 1491.33 L30.0895 1473.97 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M39.0477 1137.54 Q35.4367 1137.54 33.608 1141.1 Q31.8024 1144.64 31.8024 1151.77 Q31.8024 1158.88 33.608 1162.44 Q35.4367 1165.98 39.0477 1165.98 Q42.682 1165.98 44.4875 1162.44 Q46.3162 1158.88 46.3162 1151.77 Q46.3162 1144.64 44.4875 1141.1 Q42.682 1137.54 39.0477 1137.54 M39.0477 1133.83 Q44.8579 1133.83 47.9134 1138.44 Q50.9921 1143.02 50.9921 1151.77 Q50.9921 1160.5 47.9134 1165.1 Q44.8579 1169.69 39.0477 1169.69 Q33.2376 1169.69 30.1589 1165.1 Q27.1034 1160.5 27.1034 1151.77 Q27.1034 1143.02 30.1589 1138.44 Q33.2376 1133.83 39.0477 1133.83 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M30.0895 794.946 L48.4458 794.946 L48.4458 798.882 L34.3718 798.882 L34.3718 807.354 Q35.3904 807.007 36.4089 806.845 Q37.4274 806.659 38.4459 806.659 Q44.2329 806.659 47.6125 809.831 Q50.9921 813.002 50.9921 818.419 Q50.9921 823.997 47.5199 827.099 Q44.0477 830.178 37.7283 830.178 Q35.5524 830.178 33.2839 829.807 Q31.0385 829.437 28.6311 828.696 L28.6311 823.997 Q30.7145 825.132 32.9367 825.687 Q35.1589 826.243 37.6357 826.243 Q41.6403 826.243 43.9783 824.136 Q46.3162 822.03 46.3162 818.419 Q46.3162 814.807 43.9783 812.701 Q41.6403 810.595 37.6357 810.595 Q35.7607 810.595 33.8857 811.011 Q32.0339 811.428 30.0895 812.307 L30.0895 794.946 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M-0.303895 486.061 L7.33495 486.061 L7.33495 459.696 L-0.975188 461.362 L-0.975188 457.103 L7.28866 455.436 L11.9646 455.436 L11.9646 486.061 L19.6034 486.061 L19.6034 489.996 L-0.303895 489.996 L-0.303895 486.061 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M39.0477 458.515 Q35.4367 458.515 33.608 462.08 Q31.8024 465.621 31.8024 472.751 Q31.8024 479.857 33.608 483.422 Q35.4367 486.964 39.0477 486.964 Q42.682 486.964 44.4875 483.422 Q46.3162 479.857 46.3162 472.751 Q46.3162 465.621 44.4875 462.08 Q42.682 458.515 39.0477 458.515 M39.0477 454.811 Q44.8579 454.811 47.9134 459.418 Q50.9921 464.001 50.9921 472.751 Q50.9921 481.478 47.9134 486.084 Q44.8579 490.668 39.0477 490.668 Q33.2376 490.668 30.1589 486.084 Q27.1034 481.478 27.1034 472.751 Q27.1034 464.001 30.1589 459.418 Q33.2376 454.811 39.0477 454.811 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M0.69147 146.551 L8.33032 146.551 L8.33032 120.185 L0.0201769 121.852 L0.0201769 117.593 L8.28402 115.926 L12.9599 115.926 L12.9599 146.551 L20.5988 146.551 L20.5988 150.486 L0.69147 150.486 L0.69147 146.551 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip900)" d="M30.0895 115.926 L48.4458 115.926 L48.4458 119.861 L34.3718 119.861 L34.3718 128.333 Q35.3904 127.986 36.4089 127.824 Q37.4274 127.639 38.4459 127.639 Q44.2329 127.639 47.6125 130.81 Q50.9921 133.982 50.9921 139.398 Q50.9921 144.977 47.5199 148.079 Q44.0477 151.157 37.7283 151.157 Q35.5524 151.157 33.2839 150.787 Q31.0385 150.417 28.6311 149.676 L28.6311 144.977 Q30.7145 146.111 32.9367 146.667 Q35.1589 147.222 37.6357 147.222 Q41.6403 147.222 43.9783 145.116 Q46.3162 143.009 46.3162 139.398 Q46.3162 135.787 43.9783 133.681 Q41.6403 131.574 37.6357 131.574 Q35.7607 131.574 33.8857 131.991 Q32.0339 132.407 30.0895 133.287 L30.0895 115.926 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip902)" d="
M151.118 1277.45 L222.368 1421.04 L293.618 1477.72 L364.869 1479.3 L436.119 1465.16 L507.37 1449.81 L578.62 1440.3 L649.871 1428.63 L721.121 1415.16 L792.371 1400.71 
  L863.622 1393.17 L934.872 1386.41 L1006.12 1376.43 L1077.37 1366.03 L1148.62 1354.97 L1219.87 1346.83 L1291.12 1336.67 L1362.37 1329.07 L1433.63 1321.99 L1504.88 1311.62 
  L1576.13 1302.4 L1647.38 1295.37 L1718.63 1288.03 L1789.88 1281.14 L1861.13 1270.23 L1932.38 1269.19 L2003.63 1261.74 L2074.88 1258.08 L2146.13 1255.37 L2217.38 1252.91 
  L2288.63 1250.19 L2288.63 905.291 L2217.38 885.964 L2146.13 866.641 L2074.88 843.623 L2003.63 825.812 L1932.38 807.019 L1861.13 791.303 L1789.88 772.489 L1718.63 753.421 
  L1647.38 729.745 L1576.13 705.591 L1504.88 685.856 L1433.63 662.22 L1362.37 638.816 L1291.12 621.777 L1219.87 595.463 L1148.62 570.21 L1077.37 544.618 L1006.12 508.321 
  L934.872 473.018 L863.622 443.612 L792.371 403.158 L721.121 362.405 L649.871 323.149 L578.62 273.846 L507.37 219.649 L436.119 165.396 L364.869 116.191 L293.618 88.9544 
  L222.368 186.822 L151.118 1023.15  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip902)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1150.98 222.368,1188.87 293.618,1212.32 364.869,1212.71 436.119,1208.37 507.37,1207.72 578.62,1205.62 649.871,1203.71 721.121,1203.84 792.371,1202.48 
  863.622,1198.84 934.872,1193.89 1006.12,1193.02 1077.37,1190.37 1148.62,1182.95 1219.87,1179.61 1291.12,1179.33 1362.37,1174.77 1433.63,1173.51 1504.88,1172.66 
  1576.13,1170.39 1647.38,1175.09 1718.63,1177.39 1789.88,1179.65 1861.13,1174.04 1932.38,1174.43 2003.63,1172.84 2074.88,1175.45 2146.13,1172.7 2217.38,1172.13 
  2288.63,1173.54 
  "/>
<path clip-path="url(#clip902)" d="
M151.118 1233.63 L222.368 1168.23 L293.618 1155.07 L364.869 1153.34 L436.119 1153.1 L507.37 1152.99 L578.62 1152.89 L649.871 1152.69 L721.121 1152.93 L792.371 1152.74 
  L863.622 1152.79 L934.872 1153.07 L1006.12 1152.7 L1077.37 1152.64 L1148.62 1152.74 L1219.87 1152.79 L1291.12 1152.93 L1362.37 1152.98 L1433.63 1152.76 L1504.88 1152.98 
  L1576.13 1152.87 L1647.38 1152.94 L1718.63 1152.9 L1789.88 1152.89 L1861.13 1153.09 L1932.38 1152.77 L2003.63 1152.65 L2074.88 1152.74 L2146.13 1152.68 L2217.38 1152.74 
  L2288.63 1153.04 L2288.63 1150.86 L2217.38 1150.93 L2146.13 1150.71 L2074.88 1150.67 L2003.63 1151.02 L1932.38 1150.9 L1861.13 1151.05 L1789.88 1150.66 L1718.63 1150.98 
  L1647.38 1150.91 L1576.13 1150.72 L1504.88 1150.55 L1433.63 1150.99 L1362.37 1151.17 L1291.12 1150.25 L1219.87 1150.46 L1148.62 1150.69 L1077.37 1150.76 L1006.12 1150.73 
  L934.872 1150.58 L863.622 1150.49 L792.371 1150.49 L721.121 1151.05 L649.871 1150.74 L578.62 1150.33 L507.37 1150.63 L436.119 1150.72 L364.869 1150.78 L293.618 1147.82 
  L222.368 1132.52 L151.118 1059.12  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip902)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1164.36 222.368,1154.71 293.618,1152.32 364.869,1151.94 436.119,1151.9 507.37,1151.75 578.62,1151.81 649.871,1151.75 721.121,1151.74 792.371,1151.85 
  863.622,1151.88 934.872,1151.74 1006.12,1151.72 1077.37,1151.71 1148.62,1151.82 1219.87,1151.69 1291.12,1151.66 1362.37,1151.91 1433.63,1151.82 1504.88,1151.6 
  1576.13,1151.77 1647.38,1151.8 1718.63,1151.79 1789.88,1151.72 1861.13,1151.84 1932.38,1151.68 2003.63,1151.78 2074.88,1151.8 2146.13,1151.68 2217.38,1151.7 
  2288.63,1151.69 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">65.2511223426848</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-423.4444603910993, -3328.120773220037], [-32.25765214950315 -0.05483070110773016; -245.99749036938695 -2.788756453699605], [-6.5748981732645095 0.06227993764270741; -51.53123600971054 0.007018213638929963;;; 0.06227993764270741 -0.02323082758805552; 0.007018213638929963 -0.14519676157721817], [-49.60833367226075; -102.48613734914495;;], [-67.62559259854471, -16.54074117762371], [-2.831871682542946 -0.8076402033197425; -0.12634880578972676 -0.3806711974860803], [-1.3955426581244021 -0.02567481859213841; 0.27857115540749966 0.03768700715429184;;; -0.02567481859213841 -0.003958035293424232; 0.03768700715429184 -0.006053284244139384], [0.06663588922556625 -0.5661287210229076 … -0.2659016037113768 0.05123059785668141])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 13 August 2022 17:33">Saturday 13 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
