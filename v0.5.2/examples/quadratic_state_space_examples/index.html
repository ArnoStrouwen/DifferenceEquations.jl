<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.003972765944418912]
 [0.02452794780942935, 0.00396948316034027]
 [0.04788986853820083, 0.005361700050543856]
 [0.07876650725476321, -0.015254551416713677]
 [-0.019182479627407878, -0.006912346982012415]
 [-0.06099956467149249, -0.01988371981689162]
 [-0.17998809143833788, -0.016201639793266703]
 [-0.2705039055366735, -0.004828729827560228]
 [-0.2868481596668841, 0.014709633962860246]
 ⋮
 [0.23709842739476192, -0.00316060598270767]
 [0.20554014628864273, 0.003351660293660949]
 [0.21603782256119908, -0.006049499284328197]
 [0.1676694768498427, -0.005532112820439497]
 [0.12493760220125412, 0.003787227567300637]
 [0.14216635230292066, -0.00854995236155642]
 [0.08211454045731403, 0.010363715533922515]
 [0.14257594842719643, -0.013152029499488503]
 [0.05423973911191299, 0.0170607815091335]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip870">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip870)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip871">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip870)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip872">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip870)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1498.52 2352.76,1498.52 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1236 2352.76,1236 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,973.474 2352.76,973.474 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,710.949 2352.76,710.949 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,448.425 2352.76,448.425 "/>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,185.901 2352.76,185.901 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1498.52 105.89,1498.52 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1236 105.89,1236 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,973.474 105.89,973.474 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,710.949 105.89,710.949 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,448.425 105.89,448.425 "/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,185.901 105.89,185.901 "/>
<path clip-path="url(#clip870)" d="M-55.3036 1498.97 L-25.6278 1498.97 L-25.6278 1502.91 L-55.3036 1502.91 L-55.3036 1498.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-5.53535 1484.32 Q-9.14644 1484.32 -10.9751 1487.89 Q-12.7807 1491.43 -12.7807 1498.56 Q-12.7807 1505.66 -10.9751 1509.23 Q-9.14644 1512.77 -5.53535 1512.77 Q-1.90111 1512.77 -0.0955632 1509.23 Q1.73313 1505.66 1.73313 1498.56 Q1.73313 1491.43 -0.0955632 1487.89 Q-1.90111 1484.32 -5.53535 1484.32 M-5.53535 1480.62 Q0.274805 1480.62 3.33034 1485.22 Q6.40903 1489.81 6.40903 1498.56 Q6.40903 1507.28 3.33034 1511.89 Q0.274805 1516.47 -5.53535 1516.47 Q-11.3455 1516.47 -14.4242 1511.89 Q-17.4797 1507.28 -17.4797 1498.56 Q-17.4797 1489.81 -14.4242 1485.22 Q-11.3455 1480.62 -5.53535 1480.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M14.6266 1509.92 L19.5108 1509.92 L19.5108 1515.8 L14.6266 1515.8 L14.6266 1509.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M43.8625 1497.17 Q47.219 1497.89 49.094 1500.15 Q50.9921 1502.42 50.9921 1505.76 Q50.9921 1510.87 47.4736 1513.67 Q43.9551 1516.47 37.4737 1516.47 Q35.2978 1516.47 32.983 1516.03 Q30.6913 1515.62 28.2376 1514.76 L28.2376 1510.25 Q30.1821 1511.38 32.4969 1511.96 Q34.8117 1512.54 37.3348 1512.54 Q41.7329 1512.54 44.0246 1510.8 Q46.3394 1509.07 46.3394 1505.76 Q46.3394 1502.7 44.1866 1500.99 Q42.057 1499.25 38.2376 1499.25 L34.2098 1499.25 L34.2098 1495.41 L38.4227 1495.41 Q41.8718 1495.41 43.7005 1494.04 Q45.5292 1492.65 45.5292 1490.06 Q45.5292 1487.4 43.6311 1485.99 Q41.7561 1484.55 38.2376 1484.55 Q36.3163 1484.55 34.1172 1484.97 Q31.9182 1485.39 29.2793 1486.27 L29.2793 1482.1 Q31.9413 1481.36 34.2561 1480.99 Q36.5941 1480.62 38.6542 1480.62 Q43.9783 1480.62 47.0801 1483.05 Q50.1819 1485.45 50.1819 1489.58 Q50.1819 1492.45 48.5384 1494.44 Q46.8949 1496.4 43.8625 1497.17 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-54.3545 1236.45 L-24.6788 1236.45 L-24.6788 1240.38 L-54.3545 1240.38 L-54.3545 1236.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-4.58628 1221.8 Q-8.19737 1221.8 -10.0261 1225.36 Q-11.8316 1228.9 -11.8316 1236.03 Q-11.8316 1243.14 -10.0261 1246.7 Q-8.19737 1250.25 -4.58628 1250.25 Q-0.95204 1250.25 0.853506 1246.7 Q2.6822 1243.14 2.6822 1236.03 Q2.6822 1228.9 0.853506 1225.36 Q-0.95204 1221.8 -4.58628 1221.8 M-4.58628 1218.09 Q1.22387 1218.09 4.27941 1222.7 Q7.3581 1227.28 7.3581 1236.03 Q7.3581 1244.76 4.27941 1249.37 Q1.22387 1253.95 -4.58628 1253.95 Q-10.3964 1253.95 -13.4751 1249.37 Q-16.5307 1244.76 -16.5307 1236.03 Q-16.5307 1227.28 -13.4751 1222.7 Q-10.3964 1218.09 -4.58628 1218.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M15.5756 1247.4 L20.4599 1247.4 L20.4599 1253.28 L15.5756 1253.28 L15.5756 1247.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M34.6728 1249.34 L50.9921 1249.34 L50.9921 1253.28 L29.0478 1253.28 L29.0478 1249.34 Q31.7098 1246.59 36.2931 1241.96 Q40.8996 1237.31 42.0801 1235.96 Q44.3255 1233.44 45.2051 1231.7 Q46.1079 1229.94 46.1079 1228.25 Q46.1079 1225.5 44.1635 1223.76 Q42.2422 1222.03 39.1403 1222.03 Q36.9413 1222.03 34.4876 1222.79 Q32.057 1223.56 29.2793 1225.11 L29.2793 1220.38 Q32.1033 1219.25 34.557 1218.67 Q37.0107 1218.09 39.0477 1218.09 Q44.4181 1218.09 47.6125 1220.78 Q50.8069 1223.46 50.8069 1227.95 Q50.8069 1230.08 49.9968 1232 Q49.2097 1233.9 47.1033 1236.5 Q46.5246 1237.17 43.4227 1240.38 Q40.3209 1243.58 34.6728 1249.34 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-54.7249 973.925 L-25.0491 973.925 L-25.0491 977.86 L-54.7249 977.86 L-54.7249 973.925 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-4.95665 959.272 Q-8.56774 959.272 -10.3964 962.837 Q-12.202 966.379 -12.202 973.508 Q-12.202 980.615 -10.3964 984.18 Q-8.56774 987.721 -4.95665 987.721 Q-1.32241 987.721 0.483137 984.18 Q2.31183 980.615 2.31183 973.508 Q2.31183 966.379 0.483137 962.837 Q-1.32241 959.272 -4.95665 959.272 M-4.95665 955.569 Q0.853506 955.569 3.90904 960.175 Q6.98773 964.758 6.98773 973.508 Q6.98773 982.235 3.90904 986.842 Q0.853506 991.425 -4.95665 991.425 Q-10.7668 991.425 -13.8455 986.842 Q-16.901 982.235 -16.901 973.508 Q-16.901 964.758 -13.8455 960.175 Q-10.7668 955.569 -4.95665 955.569 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M15.2053 984.874 L20.0895 984.874 L20.0895 990.754 L15.2053 990.754 L15.2053 984.874 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M31.0848 986.818 L38.7237 986.818 L38.7237 960.453 L30.4135 962.12 L30.4135 957.86 L38.6774 956.194 L43.3533 956.194 L43.3533 986.818 L50.9921 986.818 L50.9921 990.754 L31.0848 990.754 L31.0848 986.818 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-6.18349 696.748 Q-9.79459 696.748 -11.6233 700.313 Q-13.4288 703.855 -13.4288 710.984 Q-13.4288 718.091 -11.6233 721.655 Q-9.79459 725.197 -6.18349 725.197 Q-2.54925 725.197 -0.743708 721.655 Q1.08499 718.091 1.08499 710.984 Q1.08499 703.855 -0.743708 700.313 Q-2.54925 696.748 -6.18349 696.748 M-6.18349 693.044 Q-0.37334 693.044 2.6822 697.651 Q5.76089 702.234 5.76089 710.984 Q5.76089 719.711 2.6822 724.317 Q-0.37334 728.901 -6.18349 728.901 Q-11.9936 728.901 -15.0723 724.317 Q-18.1279 719.711 -18.1279 710.984 Q-18.1279 702.234 -15.0723 697.651 Q-11.9936 693.044 -6.18349 693.044 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M13.9784 722.35 L18.8627 722.35 L18.8627 728.229 L13.9784 728.229 L13.9784 722.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M39.0477 696.748 Q35.4367 696.748 33.608 700.313 Q31.8024 703.855 31.8024 710.984 Q31.8024 718.091 33.608 721.655 Q35.4367 725.197 39.0477 725.197 Q42.682 725.197 44.4875 721.655 Q46.3162 718.091 46.3162 710.984 Q46.3162 703.855 44.4875 700.313 Q42.682 696.748 39.0477 696.748 M39.0477 693.044 Q44.8579 693.044 47.9134 697.651 Q50.9921 702.234 50.9921 710.984 Q50.9921 719.711 47.9134 724.317 Q44.8579 728.901 39.0477 728.901 Q33.2376 728.901 30.1589 724.317 Q27.1034 719.711 27.1034 710.984 Q27.1034 702.234 30.1589 697.651 Q33.2376 693.044 39.0477 693.044 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-4.95665 434.224 Q-8.56774 434.224 -10.3964 437.789 Q-12.202 441.33 -12.202 448.46 Q-12.202 455.566 -10.3964 459.131 Q-8.56774 462.673 -4.95665 462.673 Q-1.32241 462.673 0.483137 459.131 Q2.31183 455.566 2.31183 448.46 Q2.31183 441.33 0.483137 437.789 Q-1.32241 434.224 -4.95665 434.224 M-4.95665 430.52 Q0.853506 430.52 3.90904 435.127 Q6.98773 439.71 6.98773 448.46 Q6.98773 457.187 3.90904 461.793 Q0.853506 466.377 -4.95665 466.377 Q-10.7668 466.377 -13.8455 461.793 Q-16.901 457.187 -16.901 448.46 Q-16.901 439.71 -13.8455 435.127 Q-10.7668 430.52 -4.95665 430.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M15.2053 459.826 L20.0895 459.826 L20.0895 465.705 L15.2053 465.705 L15.2053 459.826 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M31.0848 461.77 L38.7237 461.77 L38.7237 435.404 L30.4135 437.071 L30.4135 432.812 L38.6774 431.145 L43.3533 431.145 L43.3533 461.77 L50.9921 461.77 L50.9921 465.705 L31.0848 465.705 L31.0848 461.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M-4.58628 171.7 Q-8.19737 171.7 -10.0261 175.265 Q-11.8316 178.806 -11.8316 185.936 Q-11.8316 193.042 -10.0261 196.607 Q-8.19737 200.149 -4.58628 200.149 Q-0.95204 200.149 0.853506 196.607 Q2.6822 193.042 2.6822 185.936 Q2.6822 178.806 0.853506 175.265 Q-0.95204 171.7 -4.58628 171.7 M-4.58628 167.996 Q1.22387 167.996 4.27941 172.602 Q7.3581 177.186 7.3581 185.936 Q7.3581 194.663 4.27941 199.269 Q1.22387 203.852 -4.58628 203.852 Q-10.3964 203.852 -13.4751 199.269 Q-16.5307 194.663 -16.5307 185.936 Q-16.5307 177.186 -13.4751 172.602 Q-10.3964 167.996 -4.58628 167.996 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M15.5756 197.301 L20.4599 197.301 L20.4599 203.181 L15.5756 203.181 L15.5756 197.301 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip870)" d="M34.6728 199.246 L50.9921 199.246 L50.9921 203.181 L29.0478 203.181 L29.0478 199.246 Q31.7098 196.491 36.2931 191.862 Q40.8996 187.209 42.0801 185.866 Q44.3255 183.343 45.2051 181.607 Q46.1079 179.848 46.1079 178.158 Q46.1079 175.403 44.1635 173.667 Q42.2422 171.931 39.1403 171.931 Q36.9413 171.931 34.4876 172.695 Q32.057 173.459 29.2793 175.01 L29.2793 170.288 Q32.1033 169.153 34.557 168.575 Q37.0107 167.996 39.0477 167.996 Q44.4181 167.996 47.6125 170.681 Q50.8069 173.366 50.8069 177.857 Q50.8069 179.987 49.9968 181.908 Q49.2097 183.806 47.1033 186.399 Q46.5246 187.07 43.4227 190.288 Q40.3209 193.482 34.6728 199.246 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip872)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,710.949 162.518,711.155 238.043,646.558 313.569,585.227 389.094,504.168 464.619,761.308 540.145,871.088 615.67,1183.46 691.196,1421.09 766.721,1464 842.247,1186.15 917.772,1103.63 993.298,872.67 1068.82,819.452 1144.35,822.267 1219.87,810.429 1295.4,436.743 1370.92,363.206 1446.45,579.706 1521.98,492.911 1597.5,444.688 1673.03,267.354 1748.55,88.5087 1824.08,171.357 1899.6,143.798 1975.13,270.776 2050.65,382.958 2126.18,337.728 2201.7,495.379 2277.23,336.653 2352.76,568.557 "/>
<polyline clip-path="url(#clip872)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,710.949 162.518,700.52 238.043,700.529 313.569,696.874 389.094,750.996 464.619,729.096 540.145,763.149 615.67,753.483 691.196,723.626 766.721,672.333 842.247,701.435 917.772,676.995 993.298,703.642 1068.82,712.246 1144.35,709.904 1219.87,652.087 1295.4,696.897 1370.92,743.184 1446.45,695.91 1521.98,701.405 1597.5,680.378 1673.03,678.748 1748.55,719.247 1824.08,702.151 1899.6,726.831 1975.13,725.473 2050.65,701.007 2126.18,733.395 2201.7,683.742 2277.23,745.477 2352.76,666.161 "/>
<path clip-path="url(#clip870)" d="M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 "/>
<polyline clip-path="url(#clip870)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,147.685 338.744,147.685 "/>
<path clip-path="url(#clip870)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip870)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,199.525 338.744,199.525 "/>
<path clip-path="url(#clip870)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.397277  0.317493  0.45678  -1.63269  …  1.20737  -1.52248  1.96912</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip930">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip930)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip931">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip930)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip932">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip930)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1504.16 2352.76,1504.16 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1224.65 2352.76,1224.65 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,945.144 2352.76,945.144 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,665.636 2352.76,665.636 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,386.128 2352.76,386.128 "/>
<polyline clip-path="url(#clip932)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,106.62 2352.76,106.62 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1504.16 105.89,1504.16 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1224.65 105.89,1224.65 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,945.144 105.89,945.144 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,665.636 105.89,665.636 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,386.128 105.89,386.128 "/>
<polyline clip-path="url(#clip930)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,106.62 105.89,106.62 "/>
<path clip-path="url(#clip930)" d="M-9.72514 1504.61 L19.9506 1504.61 L19.9506 1508.55 L-9.72514 1508.55 L-9.72514 1504.61 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M30.0895 1486.88 L48.4458 1486.88 L48.4458 1490.81 L34.3718 1490.81 L34.3718 1499.29 Q35.3904 1498.94 36.4089 1498.78 Q37.4274 1498.59 38.4459 1498.59 Q44.2329 1498.59 47.6125 1501.76 Q50.9921 1504.93 50.9921 1510.35 Q50.9921 1515.93 47.5199 1519.03 Q44.0477 1522.11 37.7283 1522.11 Q35.5524 1522.11 33.2839 1521.74 Q31.0385 1521.37 28.6311 1520.63 L28.6311 1515.93 Q30.7145 1517.06 32.9367 1517.62 Q35.1589 1518.18 37.6357 1518.18 Q41.6403 1518.18 43.9783 1516.07 Q46.3162 1513.96 46.3162 1510.35 Q46.3162 1506.74 43.9783 1504.63 Q41.6403 1502.53 37.6357 1502.53 Q35.7607 1502.53 33.8857 1502.94 Q32.0339 1503.36 30.0895 1504.24 L30.0895 1486.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M39.0477 1210.45 Q35.4367 1210.45 33.608 1214.01 Q31.8024 1217.56 31.8024 1224.69 Q31.8024 1231.79 33.608 1235.36 Q35.4367 1238.9 39.0477 1238.9 Q42.682 1238.9 44.4875 1235.36 Q46.3162 1231.79 46.3162 1224.69 Q46.3162 1217.56 44.4875 1214.01 Q42.682 1210.45 39.0477 1210.45 M39.0477 1206.75 Q44.8579 1206.75 47.9134 1211.35 Q50.9921 1215.94 50.9921 1224.69 Q50.9921 1233.41 47.9134 1238.02 Q44.8579 1242.6 39.0477 1242.6 Q33.2376 1242.6 30.1589 1238.02 Q27.1034 1233.41 27.1034 1224.69 Q27.1034 1215.94 30.1589 1211.35 Q33.2376 1206.75 39.0477 1206.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M30.0895 927.864 L48.4458 927.864 L48.4458 931.799 L34.3718 931.799 L34.3718 940.271 Q35.3904 939.924 36.4089 939.762 Q37.4274 939.577 38.4459 939.577 Q44.2329 939.577 47.6125 942.748 Q50.9921 945.919 50.9921 951.336 Q50.9921 956.914 47.5199 960.016 Q44.0477 963.095 37.7283 963.095 Q35.5524 963.095 33.2839 962.725 Q31.0385 962.354 28.6311 961.613 L28.6311 956.914 Q30.7145 958.049 32.9367 958.604 Q35.1589 959.16 37.6357 959.16 Q41.6403 959.16 43.9783 957.053 Q46.3162 954.947 46.3162 951.336 Q46.3162 947.725 43.9783 945.618 Q41.6403 943.512 37.6357 943.512 Q35.7607 943.512 33.8857 943.928 Q32.0339 944.345 30.0895 945.225 L30.0895 927.864 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M-0.303895 678.981 L7.33495 678.981 L7.33495 652.615 L-0.975188 654.282 L-0.975188 650.022 L7.28866 648.356 L11.9646 648.356 L11.9646 678.981 L19.6034 678.981 L19.6034 682.916 L-0.303895 682.916 L-0.303895 678.981 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M39.0477 651.434 Q35.4367 651.434 33.608 654.999 Q31.8024 658.541 31.8024 665.671 Q31.8024 672.777 33.608 676.342 Q35.4367 679.883 39.0477 679.883 Q42.682 679.883 44.4875 676.342 Q46.3162 672.777 46.3162 665.671 Q46.3162 658.541 44.4875 654.999 Q42.682 651.434 39.0477 651.434 M39.0477 647.731 Q44.8579 647.731 47.9134 652.337 Q50.9921 656.921 50.9921 665.671 Q50.9921 674.397 47.9134 679.004 Q44.8579 683.587 39.0477 683.587 Q33.2376 683.587 30.1589 679.004 Q27.1034 674.397 27.1034 665.671 Q27.1034 656.921 30.1589 652.337 Q33.2376 647.731 39.0477 647.731 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M0.69147 399.473 L8.33032 399.473 L8.33032 373.107 L0.0201769 374.774 L0.0201769 370.515 L8.28402 368.848 L12.9599 368.848 L12.9599 399.473 L20.5988 399.473 L20.5988 403.408 L0.69147 403.408 L0.69147 399.473 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M30.0895 368.848 L48.4458 368.848 L48.4458 372.783 L34.3718 372.783 L34.3718 381.255 Q35.3904 380.908 36.4089 380.746 Q37.4274 380.561 38.4459 380.561 Q44.2329 380.561 47.6125 383.732 Q50.9921 386.903 50.9921 392.32 Q50.9921 397.899 47.5199 401.001 Q44.0477 404.079 37.7283 404.079 Q35.5524 404.079 33.2839 403.709 Q31.0385 403.339 28.6311 402.598 L28.6311 397.899 Q30.7145 399.033 32.9367 399.589 Q35.1589 400.144 37.6357 400.144 Q41.6403 400.144 43.9783 398.038 Q46.3162 395.931 46.3162 392.32 Q46.3162 388.709 43.9783 386.603 Q41.6403 384.496 37.6357 384.496 Q35.7607 384.496 33.8857 384.913 Q32.0339 385.329 30.0895 386.209 L30.0895 368.848 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M2.91368 119.965 L19.233 119.965 L19.233 123.9 L-2.71129 123.9 L-2.71129 119.965 Q-0.0492672 117.21 4.53404 112.581 Q9.1405 107.928 10.321 106.585 Q12.5664 104.062 13.446 102.326 Q14.3488 100.567 14.3488 98.8771 Q14.3488 96.1225 12.4044 94.3864 Q10.4831 92.6503 7.38125 92.6503 Q5.18219 92.6503 2.7285 93.4142 Q0.297953 94.1781 -2.47981 95.729 L-2.47981 91.0068 Q0.344249 89.8726 2.79794 89.2939 Q5.25163 88.7152 7.28866 88.7152 Q12.659 88.7152 15.8534 91.4003 Q19.0479 94.0855 19.0479 98.5762 Q19.0479 100.706 18.2377 102.627 Q17.4506 104.525 15.3442 107.118 Q14.7655 107.789 11.6636 111.007 Q8.5618 114.201 2.91368 119.965 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip930)" d="M39.0477 92.4188 Q35.4367 92.4188 33.608 95.9836 Q31.8024 99.5253 31.8024 106.655 Q31.8024 113.761 33.608 117.326 Q35.4367 120.868 39.0477 120.868 Q42.682 120.868 44.4875 117.326 Q46.3162 113.761 46.3162 106.655 Q46.3162 99.5253 44.4875 95.9836 Q42.682 92.4188 39.0477 92.4188 M39.0477 88.7152 Q44.8579 88.7152 47.9134 93.3216 Q50.9921 97.9049 50.9921 106.655 Q50.9921 115.382 47.9134 119.988 Q44.8579 124.571 39.0477 124.571 Q33.2376 124.571 30.1589 119.988 Q27.1034 115.382 27.1034 106.655 Q27.1034 97.9049 30.1589 93.3216 Q33.2376 88.7152 39.0477 88.7152 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip932)" d="M151.118 1324 L222.368 1435.93 L293.618 1479.3 L364.869 1476.73 L436.119 1465.21 L507.37 1451.85 L578.62 1440.31 L649.871 1430.69 L721.121 1419.94 L792.371 1416.78 L863.622 1407.58 L934.872 1398.77 L1006.12 1391.72 L1077.37 1382.5 L1148.62 1373 L1219.87 1364.71 L1291.12 1360.22 L1362.37 1355.14 L1433.63 1349.65 L1504.88 1349.29 L1576.13 1346.87 L1647.38 1342.21 L1718.63 1337.58 L1789.88 1334.02 L1861.13 1329.44 L1932.38 1326.75 L2003.63 1323.87 L2074.88 1320.19 L2146.13 1311.63 L2217.38 1304.33 L2288.63 1296.49 L2288.63 945.352 L2217.38 929.74 L2146.13 915.432 L2074.88 898.765 L2003.63 882.122 L1932.38 866.961 L1861.13 850.944 L1789.88 833.639 L1718.63 814.734 L1647.38 792.893 L1576.13 770.882 L1504.88 748.211 L1433.63 718.263 L1362.37 691.584 L1291.12 664.224 L1219.87 630.357 L1148.62 596.735 L1077.37 564.464 L1006.12 533.442 L934.872 496.523 L863.622 453.182 L792.371 411.554 L721.121 368.585 L649.871 328.823 L578.62 277.669 L507.37 225.651 L436.119 171.045 L364.869 117.596 L293.618 88.9544 L222.368 183.891 L151.118 1156.66  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip932)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1233.45 222.368,1160.31 293.618,1161.83 364.869,1168.37 436.119,1175.58 507.37,1178.06 578.62,1181.68 649.871,1179.7 721.121,1179.29 792.371,1180.79 863.622,1183.21 934.872,1190.13 1006.12,1193.91 1077.37,1197.92 1148.62,1197.44 1219.87,1201.94 1291.12,1203.19 1362.37,1203.42 1433.63,1207.76 1504.88,1210.4 1576.13,1212.88 1647.38,1213.57 1718.63,1211.57 1789.88,1208.79 1861.13,1207.74 1932.38,1207.83 2003.63,1210.18 2074.88,1213.23 2146.13,1216.93 2217.38,1219 2288.63,1215.52 "/>
<path clip-path="url(#clip932)" d="M151.118 1317.62 L222.368 1243.48 L293.618 1228.44 L364.869 1225.77 L436.119 1225.64 L507.37 1225.34 L578.62 1225.63 L649.871 1225.23 L721.121 1225.64 L792.371 1225.31 L863.622 1225.43 L934.872 1225.36 L1006.12 1225.62 L1077.37 1225.31 L1148.62 1225.64 L1219.87 1225.66 L1291.12 1225.68 L1362.37 1225.82 L1433.63 1225.73 L1504.88 1225.43 L1576.13 1225.81 L1647.38 1225.56 L1718.63 1225.39 L1789.88 1225.53 L1861.13 1225.52 L1932.38 1225.63 L2003.63 1225.82 L2074.88 1225.42 L2146.13 1225.21 L2217.38 1225.47 L2288.63 1225.5 L2288.63 1223.94 L2217.38 1223.52 L2146.13 1223.7 L2074.88 1223.84 L2003.63 1223.87 L1932.38 1223.78 L1861.13 1223.96 L1789.88 1224.01 L1718.63 1223.68 L1647.38 1223.7 L1576.13 1223.77 L1504.88 1223.79 L1433.63 1223.73 L1362.37 1224 L1291.12 1223.84 L1219.87 1223.89 L1148.62 1223.81 L1077.37 1223.77 L1006.12 1223.86 L934.872 1223.67 L863.622 1223.97 L792.371 1224.06 L721.121 1223.67 L649.871 1223.79 L578.62 1223.69 L507.37 1223.79 L436.119 1223.64 L364.869 1223.64 L293.618 1220.53 L222.368 1206.04 L151.118 1133.23  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip932)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1224.91 222.368,1224.75 293.618,1224.5 364.869,1224.61 436.119,1224.53 507.37,1224.68 578.62,1224.44 649.871,1224.66 721.121,1224.6 792.371,1224.51 863.622,1224.69 934.872,1224.52 1006.12,1224.7 1077.37,1224.62 1148.62,1224.84 1219.87,1224.87 1291.12,1224.76 1362.37,1224.9 1433.63,1224.73 1504.88,1224.6 1576.13,1224.77 1647.38,1224.53 1718.63,1224.71 1789.88,1224.71 1861.13,1224.72 1932.38,1224.72 2003.63,1224.61 2074.88,1224.64 2146.13,1224.54 2217.38,1224.4 2288.63,1224.73 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">49.474009524884934</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-314.0842691003424, -2369.9131994938894], [13.679711642789346 -0.4018373416180336; 118.87267357896388 -1.5861749801746385], [-5.588062736117175 0.04692312153731571; -38.60305167339995 0.32966449961809646;;; 0.04692312153731571 -0.04219376559098577; 0.32966449961809646 -0.30510934320182087], [-48.37879991905959; -301.5484833124368;;], [45.57769171077098, -21.749855165545796], [-9.225947358715144 -0.39397506000420357; -1.7700801492203109 -0.14407321066288079], [-0.4740450504683553 0.05358583868523787; -0.7610769431001955 -0.03395989841533953;;; 0.05358583868523787 0.0007624527569792648; -0.03395989841533953 0.0022331345731258674], [-0.4099902111743267 -0.8056470840956113 … 0.6860557870100703 -0.03310350199461415])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 20:23">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
