<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.004290505427822045]
 [-0.026696119297516037, -0.0007069960903328109]
 [-0.02982024806977942, 0.0008767144191879073]
 [-0.022971378453190163, -0.007206919475837534]
 [-0.06641049945167636, 0.0024138723487400573]
 [-0.04819564541891238, -0.012147449060819614]
 [-0.12067773922154716, -0.00827035396887225]
 [-0.16571979904583292, 0.0038845511344730668]
 [-0.13342964653426956, -0.016656831850182678]
 ⋮
 [-0.07317868039937027, -0.0012502815698442863]
 [-0.07733954469415169, -0.014435383654800458]
 [-0.16232073101361993, -0.0028385642458989137]
 [-0.17183053301829868, -0.02891378578765598]
 [-0.33963068194701634, -0.024028053664556334]
 [-0.4693581783101872, -0.006241338040846358]
 [-0.48438758551267036, -0.0007129496958545635]
 [-0.46469001712263125, 0.0022418017456111773]
 [-0.42773488540911164, -0.01208731361171005]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip960">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip960)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip961">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip960)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip962">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip960)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1232.72 2352.76,1232.72 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,958.656 2352.76,958.656 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,684.592 2352.76,684.592 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,410.529 2352.76,410.529 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,136.465 2352.76,136.465 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1232.72 105.89,1232.72 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,958.656 105.89,958.656 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,684.592 105.89,684.592 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,410.529 105.89,410.529 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,136.465 105.89,136.465 
  "/>
<path clip-path="url(#clip960)" d="M-56.4379 1233.17 L-26.7621 1233.17 L-26.7621 1237.11 L-56.4379 1237.11 L-56.4379 1233.17 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-6.6696 1218.52 Q-10.2807 1218.52 -12.1094 1222.08 Q-13.9149 1225.62 -13.9149 1232.75 Q-13.9149 1239.86 -12.1094 1243.43 Q-10.2807 1246.97 -6.6696 1246.97 Q-3.03536 1246.97 -1.22982 1243.43 Q0.598877 1239.86 0.598877 1232.75 Q0.598877 1225.62 -1.22982 1222.08 Q-3.03536 1218.52 -6.6696 1218.52 M-6.6696 1214.81 Q-0.859448 1214.81 2.19609 1219.42 Q5.27478 1224 5.27478 1232.75 Q5.27478 1241.48 2.19609 1246.09 Q-0.859448 1250.67 -6.6696 1250.67 Q-12.4798 1250.67 -15.5584 1246.09 Q-18.614 1241.48 -18.614 1232.75 Q-18.614 1224 -15.5584 1219.42 Q-12.4798 1214.81 -6.6696 1214.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M13.4923 1244.12 L18.3766 1244.12 L18.3766 1250 L13.4923 1250 L13.4923 1244.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M41.4088 1219.51 L29.6034 1237.96 L41.4088 1237.96 L41.4088 1219.51 M40.182 1215.44 L46.0616 1215.44 L46.0616 1237.96 L50.9921 1237.96 L50.9921 1241.85 L46.0616 1241.85 L46.0616 1250 L41.4088 1250 L41.4088 1241.85 L25.8071 1241.85 L25.8071 1237.34 L40.182 1215.44 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-55.3036 959.107 L-25.6278 959.107 L-25.6278 963.042 L-55.3036 963.042 L-55.3036 959.107 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-5.53535 944.455 Q-9.14644 944.455 -10.9751 948.019 Q-12.7807 951.561 -12.7807 958.691 Q-12.7807 965.797 -10.9751 969.362 Q-9.14644 972.903 -5.53535 972.903 Q-1.90111 972.903 -0.0955632 969.362 Q1.73313 965.797 1.73313 958.691 Q1.73313 951.561 -0.0955632 948.019 Q-1.90111 944.455 -5.53535 944.455 M-5.53535 940.751 Q0.274805 940.751 3.33034 945.357 Q6.40903 949.941 6.40903 958.691 Q6.40903 967.417 3.33034 972.024 Q0.274805 976.607 -5.53535 976.607 Q-11.3455 976.607 -14.4242 972.024 Q-17.4797 967.417 -17.4797 958.691 Q-17.4797 949.941 -14.4242 945.357 Q-11.3455 940.751 -5.53535 940.751 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M14.6266 970.056 L19.5108 970.056 L19.5108 975.936 L14.6266 975.936 L14.6266 970.056 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M43.8625 957.302 Q47.219 958.019 49.094 960.288 Q50.9921 962.556 50.9921 965.89 Q50.9921 971.005 47.4736 973.806 Q43.9551 976.607 37.4737 976.607 Q35.2978 976.607 32.983 976.167 Q30.6913 975.751 28.2376 974.894 L28.2376 970.38 Q30.1821 971.515 32.4969 972.093 Q34.8117 972.672 37.3348 972.672 Q41.7329 972.672 44.0246 970.936 Q46.3394 969.2 46.3394 965.89 Q46.3394 962.834 44.1866 961.121 Q42.057 959.385 38.2376 959.385 L34.2098 959.385 L34.2098 955.542 L38.4227 955.542 Q41.8718 955.542 43.7005 954.177 Q45.5292 952.788 45.5292 950.195 Q45.5292 947.533 43.6311 946.121 Q41.7561 944.686 38.2376 944.686 Q36.3163 944.686 34.1172 945.103 Q31.9182 945.519 29.2793 946.399 L29.2793 942.232 Q31.9413 941.492 34.2561 941.121 Q36.5941 940.751 38.6542 940.751 Q43.9783 940.751 47.0801 943.181 Q50.1819 945.589 50.1819 949.709 Q50.1819 952.58 48.5384 954.57 Q46.8949 956.538 43.8625 957.302 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-54.3545 685.044 L-24.6788 685.044 L-24.6788 688.979 L-54.3545 688.979 L-54.3545 685.044 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-4.58628 670.391 Q-8.19737 670.391 -10.0261 673.956 Q-11.8316 677.497 -11.8316 684.627 Q-11.8316 691.733 -10.0261 695.298 Q-8.19737 698.84 -4.58628 698.84 Q-0.95204 698.84 0.853506 695.298 Q2.6822 691.733 2.6822 684.627 Q2.6822 677.497 0.853506 673.956 Q-0.95204 670.391 -4.58628 670.391 M-4.58628 666.687 Q1.22387 666.687 4.27941 671.294 Q7.3581 675.877 7.3581 684.627 Q7.3581 693.354 4.27941 697.96 Q1.22387 702.544 -4.58628 702.544 Q-10.3964 702.544 -13.4751 697.96 Q-16.5307 693.354 -16.5307 684.627 Q-16.5307 675.877 -13.4751 671.294 Q-10.3964 666.687 -4.58628 666.687 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M15.5756 695.993 L20.4599 695.993 L20.4599 701.872 L15.5756 701.872 L15.5756 695.993 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M34.6728 697.937 L50.9921 697.937 L50.9921 701.872 L29.0478 701.872 L29.0478 697.937 Q31.7098 695.182 36.2931 690.553 Q40.8996 685.9 42.0801 684.558 Q44.3255 682.034 45.2051 680.298 Q46.1079 678.539 46.1079 676.849 Q46.1079 674.095 44.1635 672.358 Q42.2422 670.622 39.1403 670.622 Q36.9413 670.622 34.4876 671.386 Q32.057 672.15 29.2793 673.701 L29.2793 668.979 Q32.1033 667.845 34.557 667.266 Q37.0107 666.687 39.0477 666.687 Q44.4181 666.687 47.6125 669.372 Q50.8069 672.058 50.8069 676.548 Q50.8069 678.678 49.9968 680.599 Q49.2097 682.497 47.1033 685.09 Q46.5246 685.761 43.4227 688.979 Q40.3209 692.173 34.6728 697.937 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-54.7249 410.98 L-25.0491 410.98 L-25.0491 414.915 L-54.7249 414.915 L-54.7249 410.98 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-4.95665 396.327 Q-8.56774 396.327 -10.3964 399.892 Q-12.202 403.434 -12.202 410.563 Q-12.202 417.67 -10.3964 421.235 Q-8.56774 424.776 -4.95665 424.776 Q-1.32241 424.776 0.483137 421.235 Q2.31183 417.67 2.31183 410.563 Q2.31183 403.434 0.483137 399.892 Q-1.32241 396.327 -4.95665 396.327 M-4.95665 392.624 Q0.853506 392.624 3.90904 397.23 Q6.98773 401.813 6.98773 410.563 Q6.98773 419.29 3.90904 423.897 Q0.853506 428.48 -4.95665 428.48 Q-10.7668 428.48 -13.8455 423.897 Q-16.901 419.29 -16.901 410.563 Q-16.901 401.813 -13.8455 397.23 Q-10.7668 392.624 -4.95665 392.624 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M15.2053 421.929 L20.0895 421.929 L20.0895 427.809 L15.2053 427.809 L15.2053 421.929 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M31.0848 423.873 L38.7237 423.873 L38.7237 397.508 L30.4135 399.174 L30.4135 394.915 L38.6774 393.249 L43.3533 393.249 L43.3533 423.873 L50.9921 423.873 L50.9921 427.809 L31.0848 427.809 L31.0848 423.873 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-6.18349 122.264 Q-9.79459 122.264 -11.6233 125.828 Q-13.4288 129.37 -13.4288 136.5 Q-13.4288 143.606 -11.6233 147.171 Q-9.79459 150.713 -6.18349 150.713 Q-2.54925 150.713 -0.743708 147.171 Q1.08499 143.606 1.08499 136.5 Q1.08499 129.37 -0.743708 125.828 Q-2.54925 122.264 -6.18349 122.264 M-6.18349 118.56 Q-0.37334 118.56 2.6822 123.166 Q5.76089 127.75 5.76089 136.5 Q5.76089 145.226 2.6822 149.833 Q-0.37334 154.416 -6.18349 154.416 Q-11.9936 154.416 -15.0723 149.833 Q-18.1279 145.226 -18.1279 136.5 Q-18.1279 127.75 -15.0723 123.166 Q-11.9936 118.56 -6.18349 118.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M13.9784 147.865 L18.8627 147.865 L18.8627 153.745 L13.9784 153.745 L13.9784 147.865 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip960)" d="M39.0477 122.264 Q35.4367 122.264 33.608 125.828 Q31.8024 129.37 31.8024 136.5 Q31.8024 143.606 33.608 147.171 Q35.4367 150.713 39.0477 150.713 Q42.682 150.713 44.4875 147.171 Q46.3162 143.606 46.3162 136.5 Q46.3162 129.37 44.4875 125.828 Q42.682 122.264 39.0477 122.264 M39.0477 118.56 Q44.8579 118.56 47.9134 123.166 Q50.9921 127.75 50.9921 136.5 Q50.9921 145.226 47.9134 149.833 Q44.8579 154.416 39.0477 154.416 Q33.2376 154.416 30.1589 149.833 Q27.1034 145.226 27.1034 136.5 Q27.1034 127.75 30.1589 123.166 Q33.2376 118.56 39.0477 118.56 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip962)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,136.465 162.518,136.679 238.043,209.629 313.569,218.191 389.094,199.421 464.619,318.472 540.145,268.552 615.67,467.199 691.196,590.643 766.721,502.147 
  842.247,764.328 917.772,1117.77 993.298,1028.28 1068.82,1036.87 1144.35,871.816 1219.87,574.798 1295.4,284.58 1370.92,638.415 1446.45,314.203 1521.98,178.315 
  1597.5,215.284 1673.03,251.566 1748.55,337.021 1824.08,348.424 1899.6,581.327 1975.13,607.39 2050.65,1067.27 2126.18,1422.81 2201.7,1464 2277.23,1410.01 
  2352.76,1308.73 
  "/>
<polyline clip-path="url(#clip962)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,136.465 162.518,148.224 238.043,138.403 313.569,134.062 389.094,156.216 464.619,129.849 540.145,169.757 615.67,159.131 691.196,125.819 766.721,182.115 
  842.247,199.382 917.772,129.882 993.298,145.043 1068.82,117.059 1144.35,94.6469 1219.87,93.4187 1295.4,195.37 1370.92,88.5087 1446.45,116.007 1521.98,142.739 
  1597.5,142.928 1673.03,151.189 1748.55,139.891 1824.08,176.027 1899.6,144.244 1975.13,215.707 2050.65,202.317 2126.18,153.57 2201.7,138.419 2277.23,130.321 
  2352.76,169.592 
  "/>
<path clip-path="url(#clip960)" d="
M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 
  "/>
<polyline clip-path="url(#clip960)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  187.693,1352.98 338.744,1352.98 
  "/>
<path clip-path="url(#clip960)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip960)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  187.693,1404.82 338.744,1404.82 
  "/>
<path clip-path="url(#clip960)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -0.429051  0.0151105  0.101811  -0.738226  …  0.0535318  0.238439  -1.25357</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip020">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip020)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip021">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip020)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip022">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip020)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1335.78 2352.76,1335.78 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1132.13 2352.76,1132.13 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,928.49 2352.76,928.49 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,724.848 2352.76,724.848 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,521.205 2352.76,521.205 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,317.562 2352.76,317.562 
  "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,113.92 2352.76,113.92 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1335.78 105.89,1335.78 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1132.13 105.89,1132.13 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,928.49 105.89,928.49 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,724.848 105.89,724.848 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,521.205 105.89,521.205 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,317.562 105.89,317.562 
  "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,113.92 105.89,113.92 
  "/>
<path clip-path="url(#clip020)" d="M-54.9564 1336.23 L-25.2806 1336.23 L-25.2806 1340.16 L-54.9564 1340.16 L-54.9564 1336.23 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-11.1603 1349.12 L5.15904 1349.12 L5.15904 1353.06 L-16.7853 1353.06 L-16.7853 1349.12 Q-14.1233 1346.37 -9.53996 1341.74 Q-4.9335 1337.08 -3.75295 1335.74 Q-1.50759 1333.22 -0.627968 1331.48 Q0.274805 1329.72 0.274805 1328.03 Q0.274805 1325.28 -1.66963 1323.54 Q-3.59091 1321.81 -6.69275 1321.81 Q-8.89181 1321.81 -11.3455 1322.57 Q-13.776 1323.33 -16.5538 1324.88 L-16.5538 1320.16 Q-13.7297 1319.03 -11.2761 1318.45 Q-8.82237 1317.87 -6.78534 1317.87 Q-1.415 1317.87 1.77943 1320.56 Q4.97385 1323.24 4.97385 1327.73 Q4.97385 1329.86 4.16367 1331.78 Q3.37664 1333.68 1.27017 1336.27 Q0.69147 1336.94 -2.41037 1340.16 Q-5.5122 1343.36 -11.1603 1349.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M14.9738 1347.18 L19.858 1347.18 L19.858 1353.06 L14.9738 1353.06 L14.9738 1347.18 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M30.0895 1318.5 L48.4458 1318.5 L48.4458 1322.43 L34.3718 1322.43 L34.3718 1330.9 Q35.3904 1330.56 36.4089 1330.39 Q37.4274 1330.21 38.4459 1330.21 Q44.2329 1330.21 47.6125 1333.38 Q50.9921 1336.55 50.9921 1341.97 Q50.9921 1347.55 47.5199 1350.65 Q44.0477 1353.73 37.7283 1353.73 Q35.5524 1353.73 33.2839 1353.36 Q31.0385 1352.99 28.6311 1352.25 L28.6311 1347.55 Q30.7145 1348.68 32.9367 1349.24 Q35.1589 1349.79 37.6357 1349.79 Q41.6403 1349.79 43.9783 1347.69 Q46.3162 1345.58 46.3162 1341.97 Q46.3162 1338.36 43.9783 1336.25 Q41.6403 1334.14 37.6357 1334.14 Q35.7607 1334.14 33.8857 1334.56 Q32.0339 1334.98 30.0895 1335.86 L30.0895 1318.5 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-6.18349 1117.93 Q-9.79459 1117.93 -11.6233 1121.5 Q-13.4288 1125.04 -13.4288 1132.17 Q-13.4288 1139.27 -11.6233 1142.84 Q-9.79459 1146.38 -6.18349 1146.38 Q-2.54925 1146.38 -0.743708 1142.84 Q1.08499 1139.27 1.08499 1132.17 Q1.08499 1125.04 -0.743708 1121.5 Q-2.54925 1117.93 -6.18349 1117.93 M-6.18349 1114.23 Q-0.37334 1114.23 2.6822 1118.83 Q5.76089 1123.42 5.76089 1132.17 Q5.76089 1140.89 2.6822 1145.5 Q-0.37334 1150.08 -6.18349 1150.08 Q-11.9936 1150.08 -15.0723 1145.5 Q-18.1279 1140.89 -18.1279 1132.17 Q-18.1279 1123.42 -15.0723 1118.83 Q-11.9936 1114.23 -6.18349 1114.23 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M13.9784 1143.53 L18.8627 1143.53 L18.8627 1149.41 L13.9784 1149.41 L13.9784 1143.53 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M39.0477 1117.93 Q35.4367 1117.93 33.608 1121.5 Q31.8024 1125.04 31.8024 1132.17 Q31.8024 1139.27 33.608 1142.84 Q35.4367 1146.38 39.0477 1146.38 Q42.682 1146.38 44.4875 1142.84 Q46.3162 1139.27 46.3162 1132.17 Q46.3162 1125.04 44.4875 1121.5 Q42.682 1117.93 39.0477 1117.93 M39.0477 1114.23 Q44.8579 1114.23 47.9134 1118.83 Q50.9921 1123.42 50.9921 1132.17 Q50.9921 1140.89 47.9134 1145.5 Q44.8579 1150.08 39.0477 1150.08 Q33.2376 1150.08 30.1589 1145.5 Q27.1034 1140.89 27.1034 1132.17 Q27.1034 1123.42 30.1589 1118.83 Q33.2376 1114.23 39.0477 1114.23 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-11.1603 941.835 L5.15904 941.835 L5.15904 945.77 L-16.7853 945.77 L-16.7853 941.835 Q-14.1233 939.08 -9.53996 934.451 Q-4.9335 929.798 -3.75295 928.455 Q-1.50759 925.932 -0.627968 924.196 Q0.274805 922.437 0.274805 920.747 Q0.274805 917.993 -1.66963 916.256 Q-3.59091 914.52 -6.69275 914.52 Q-8.89181 914.52 -11.3455 915.284 Q-13.776 916.048 -16.5538 917.599 L-16.5538 912.877 Q-13.7297 911.743 -11.2761 911.164 Q-8.82237 910.585 -6.78534 910.585 Q-1.415 910.585 1.77943 913.27 Q4.97385 915.956 4.97385 920.446 Q4.97385 922.576 4.16367 924.497 Q3.37664 926.395 1.27017 928.988 Q0.69147 929.659 -2.41037 932.877 Q-5.5122 936.071 -11.1603 941.835 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M14.9738 939.891 L19.858 939.891 L19.858 945.77 L14.9738 945.77 L14.9738 939.891 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M30.0895 911.21 L48.4458 911.21 L48.4458 915.145 L34.3718 915.145 L34.3718 923.618 Q35.3904 923.27 36.4089 923.108 Q37.4274 922.923 38.4459 922.923 Q44.2329 922.923 47.6125 926.094 Q50.9921 929.266 50.9921 934.682 Q50.9921 940.261 47.5199 943.363 Q44.0477 946.442 37.7283 946.442 Q35.5524 946.442 33.2839 946.071 Q31.0385 945.701 28.6311 944.96 L28.6311 940.261 Q30.7145 941.395 32.9367 941.951 Q35.1589 942.506 37.6357 942.506 Q41.6403 942.506 43.9783 940.4 Q46.3162 938.293 46.3162 934.682 Q46.3162 931.071 43.9783 928.965 Q41.6403 926.858 37.6357 926.858 Q35.7607 926.858 33.8857 927.275 Q32.0339 927.692 30.0895 928.571 L30.0895 911.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-16.1371 707.568 L2.21924 707.568 L2.21924 711.503 L-11.8548 711.503 L-11.8548 719.975 Q-10.8362 719.628 -9.81773 719.466 Q-8.79922 719.28 -7.78071 719.28 Q-1.9937 719.28 1.38591 722.452 Q4.76552 725.623 4.76552 731.04 Q4.76552 736.618 1.29332 739.72 Q-2.17889 742.799 -8.4983 742.799 Q-10.6742 742.799 -12.9427 742.428 Q-15.1881 742.058 -17.5955 741.317 L-17.5955 736.618 Q-15.5121 737.753 -13.2899 738.308 Q-11.0677 738.864 -8.59089 738.864 Q-4.58628 738.864 -2.24833 736.757 Q0.089621 734.651 0.089621 731.04 Q0.089621 727.429 -2.24833 725.322 Q-4.58628 723.216 -8.59089 723.216 Q-10.4659 723.216 -12.3409 723.632 Q-14.1927 724.049 -16.1371 724.929 L-16.1371 707.568 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M13.9784 736.248 L18.8627 736.248 L18.8627 742.128 L13.9784 742.128 L13.9784 736.248 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M39.0477 710.646 Q35.4367 710.646 33.608 714.211 Q31.8024 717.753 31.8024 724.882 Q31.8024 731.989 33.608 735.554 Q35.4367 739.095 39.0477 739.095 Q42.682 739.095 44.4875 735.554 Q46.3162 731.989 46.3162 724.882 Q46.3162 717.753 44.4875 714.211 Q42.682 710.646 39.0477 710.646 M39.0477 706.943 Q44.8579 706.943 47.9134 711.549 Q50.9921 716.132 50.9921 724.882 Q50.9921 733.609 47.9134 738.216 Q44.8579 742.799 39.0477 742.799 Q33.2376 742.799 30.1589 738.216 Q27.1034 733.609 27.1034 724.882 Q27.1034 716.132 30.1589 711.549 Q33.2376 706.943 39.0477 706.943 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-16.3686 503.925 L5.85348 503.925 L5.85348 505.916 L-6.69275 538.485 L-11.577 538.485 L0.228509 507.86 L-16.3686 507.86 L-16.3686 503.925 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M14.9738 532.605 L19.858 532.605 L19.858 538.485 L14.9738 538.485 L14.9738 532.605 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M30.0895 503.925 L48.4458 503.925 L48.4458 507.86 L34.3718 507.86 L34.3718 516.332 Q35.3904 515.985 36.4089 515.823 Q37.4274 515.638 38.4459 515.638 Q44.2329 515.638 47.6125 518.809 Q50.9921 521.98 50.9921 527.397 Q50.9921 532.976 47.5199 536.077 Q44.0477 539.156 37.7283 539.156 Q35.5524 539.156 33.2839 538.786 Q31.0385 538.415 28.6311 537.675 L28.6311 532.976 Q30.7145 534.11 32.9367 534.665 Q35.1589 535.221 37.6357 535.221 Q41.6403 535.221 43.9783 533.115 Q46.3162 531.008 46.3162 527.397 Q46.3162 523.786 43.9783 521.679 Q41.6403 519.573 37.6357 519.573 Q35.7607 519.573 33.8857 519.99 Q32.0339 520.406 30.0895 521.286 L30.0895 503.925 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-45.5351 330.907 L-37.8963 330.907 L-37.8963 304.541 L-46.2064 306.208 L-46.2064 301.949 L-37.9426 300.282 L-33.2667 300.282 L-33.2667 330.907 L-25.6278 330.907 L-25.6278 334.842 L-45.5351 334.842 L-45.5351 330.907 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-6.18349 303.361 Q-9.79459 303.361 -11.6233 306.926 Q-13.4288 310.467 -13.4288 317.597 Q-13.4288 324.703 -11.6233 328.268 Q-9.79459 331.81 -6.18349 331.81 Q-2.54925 331.81 -0.743708 328.268 Q1.08499 324.703 1.08499 317.597 Q1.08499 310.467 -0.743708 306.926 Q-2.54925 303.361 -6.18349 303.361 M-6.18349 299.657 Q-0.37334 299.657 2.6822 304.264 Q5.76089 308.847 5.76089 317.597 Q5.76089 326.324 2.6822 330.93 Q-0.37334 335.513 -6.18349 335.513 Q-11.9936 335.513 -15.0723 330.93 Q-18.1279 326.324 -18.1279 317.597 Q-18.1279 308.847 -15.0723 304.264 Q-11.9936 299.657 -6.18349 299.657 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M13.9784 328.963 L18.8627 328.963 L18.8627 334.842 L13.9784 334.842 L13.9784 328.963 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M39.0477 303.361 Q35.4367 303.361 33.608 306.926 Q31.8024 310.467 31.8024 317.597 Q31.8024 324.703 33.608 328.268 Q35.4367 331.81 39.0477 331.81 Q42.682 331.81 44.4875 328.268 Q46.3162 324.703 46.3162 317.597 Q46.3162 310.467 44.4875 306.926 Q42.682 303.361 39.0477 303.361 M39.0477 299.657 Q44.8579 299.657 47.9134 304.264 Q50.9921 308.847 50.9921 317.597 Q50.9921 326.324 47.9134 330.93 Q44.8579 335.513 39.0477 335.513 Q33.2376 335.513 30.1589 330.93 Q27.1034 326.324 27.1034 317.597 Q27.1034 308.847 30.1589 304.264 Q33.2376 299.657 39.0477 299.657 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-44.5398 127.264 L-36.9009 127.264 L-36.9009 100.899 L-45.2111 102.565 L-45.2111 98.3062 L-36.9472 96.6395 L-32.2713 96.6395 L-32.2713 127.264 L-24.6325 127.264 L-24.6325 131.2 L-44.5398 131.2 L-44.5398 127.264 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-11.1603 127.264 L5.15904 127.264 L5.15904 131.2 L-16.7853 131.2 L-16.7853 127.264 Q-14.1233 124.51 -9.53996 119.88 Q-4.9335 115.227 -3.75295 113.885 Q-1.50759 111.362 -0.627968 109.626 Q0.274805 107.866 0.274805 106.176 Q0.274805 103.422 -1.66963 101.686 Q-3.59091 99.9497 -6.69275 99.9497 Q-8.89181 99.9497 -11.3455 100.714 Q-13.776 101.477 -16.5538 103.028 L-16.5538 98.3062 Q-13.7297 97.1719 -11.2761 96.5932 Q-8.82237 96.0145 -6.78534 96.0145 Q-1.415 96.0145 1.77943 98.6997 Q4.97385 101.385 4.97385 105.876 Q4.97385 108.005 4.16367 109.926 Q3.37664 111.825 1.27017 114.417 Q0.69147 115.088 -2.41037 118.306 Q-5.5122 121.5 -11.1603 127.264 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M14.9738 125.32 L19.858 125.32 L19.858 131.2 L14.9738 131.2 L14.9738 125.32 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip020)" d="M30.0895 96.6395 L48.4458 96.6395 L48.4458 100.575 L34.3718 100.575 L34.3718 109.047 Q35.3904 108.7 36.4089 108.538 Q37.4274 108.352 38.4459 108.352 Q44.2329 108.352 47.6125 111.524 Q50.9921 114.695 50.9921 120.112 Q50.9921 125.69 47.5199 128.792 Q44.0477 131.871 37.7283 131.871 Q35.5524 131.871 33.2839 131.5 Q31.0385 131.13 28.6311 130.389 L28.6311 125.69 Q30.7145 126.825 32.9367 127.38 Q35.1589 127.936 37.6357 127.936 Q41.6403 127.936 43.9783 125.829 Q46.3162 123.723 46.3162 120.112 Q46.3162 116.501 43.9783 114.394 Q41.6403 112.288 37.6357 112.288 Q35.7607 112.288 33.8857 112.704 Q32.0339 113.121 30.0895 114.001 L30.0895 96.6395 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip022)" d="
M151.118 1256.55 L222.368 1414.79 L293.618 1478.61 L364.869 1479.3 L436.119 1463.15 L507.37 1450.65 L578.62 1440.74 L649.871 1428.73 L721.121 1415.28 L792.371 1400.54 
  L863.622 1387.31 L934.872 1375.42 L1006.12 1367.67 L1077.37 1352.33 L1148.62 1344.08 L1219.87 1331.87 L1291.12 1321.76 L1362.37 1312.9 L1433.63 1298.77 L1504.88 1288.43 
  L1576.13 1282.74 L1647.38 1274.9 L1718.63 1267.16 L1789.88 1262.04 L1861.13 1254.12 L1932.38 1256.64 L2003.63 1249.25 L2074.88 1240.03 L2146.13 1240.78 L2217.38 1230.66 
  L2288.63 1227.67 L2288.63 869.658 L2217.38 858.14 L2146.13 848.842 L2074.88 830.102 L2003.63 815.417 L1932.38 795.742 L1861.13 773.323 L1789.88 754.904 L1718.63 741.208 
  L1647.38 721.704 L1576.13 702.75 L1504.88 676.203 L1433.63 652.092 L1362.37 625.211 L1291.12 599.196 L1219.87 566.689 L1148.62 537.982 L1077.37 503.538 L1006.12 476.675 
  L934.872 441.188 L863.622 406.99 L792.371 367.913 L721.121 329.763 L649.871 288.665 L578.62 247.205 L507.37 201.613 L436.119 159.41 L364.869 117.777 L293.618 88.9544 
  L222.368 186.979 L151.118 1016.09  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip022)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1113.03 222.368,1153.21 293.618,1187.83 364.869,1183.75 436.119,1172.99 507.37,1175.93 578.62,1177.21 649.871,1178.87 721.121,1177.43 792.371,1173.57 
  863.622,1166.97 934.872,1162.54 1006.12,1160.66 1077.37,1164.45 1148.62,1157.98 1219.87,1153.35 1291.12,1150.37 1362.37,1147.24 1433.63,1144.75 1504.88,1141.74 
  1576.13,1141.08 1647.38,1143.86 1718.63,1149.91 1789.88,1145.47 1861.13,1140.17 1932.38,1135.41 2003.63,1130.88 2074.88,1131.06 2146.13,1127.51 2217.38,1127.89 
  2288.63,1129.36 
  "/>
<path clip-path="url(#clip022)" d="
M151.118 1267.73 L222.368 1160.03 L293.618 1137.27 L364.869 1133.73 L436.119 1133.55 L507.37 1133.33 L578.62 1133.5 L649.871 1133.82 L721.121 1133.35 L792.371 1133.38 
  L863.622 1133.7 L934.872 1133.38 L1006.12 1133.3 L1077.37 1133.38 L1148.62 1133.99 L1219.87 1133.14 L1291.12 1133.59 L1362.37 1133.35 L1433.63 1133.55 L1504.88 1133.56 
  L1576.13 1133.4 L1647.38 1133.4 L1718.63 1133.35 L1789.88 1133.49 L1861.13 1133.71 L1932.38 1133.27 L2003.63 1133.3 L2074.88 1133.6 L2146.13 1133.69 L2217.38 1133.48 
  L2288.63 1133.48 L2288.63 1130.95 L2217.38 1131.11 L2146.13 1131 L2074.88 1130.85 L2003.63 1131.01 L1932.38 1130.94 L1861.13 1131.11 L1789.88 1130.72 L1718.63 1130.76 
  L1647.38 1130.8 L1576.13 1130.84 L1504.88 1130.94 L1433.63 1130.95 L1362.37 1131.09 L1291.12 1130.98 L1219.87 1130.6 L1148.62 1130.79 L1077.37 1130.53 L1006.12 1130.8 
  L934.872 1130.54 L863.622 1130.65 L792.371 1130.82 L721.121 1130.73 L649.871 1131.01 L578.62 1130.56 L507.37 1130.86 L436.119 1130.88 L364.869 1130.41 L293.618 1128.25 
  L222.368 1112.49 L151.118 1034.79  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip022)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1148.67 222.368,1134.95 293.618,1132.16 364.869,1132.16 436.119,1132.24 507.37,1131.85 578.62,1132.2 649.871,1132.04 721.121,1132.05 792.371,1131.94 
  863.622,1131.8 934.872,1131.95 1006.12,1131.91 1077.37,1132.35 1148.62,1132.14 1219.87,1132.12 1291.12,1132.22 1362.37,1132.23 1433.63,1132.13 1504.88,1132.15 
  1576.13,1132.06 1647.38,1131.99 1718.63,1132.22 1789.88,1131.95 1861.13,1132.17 1932.38,1131.98 2003.63,1132.08 2074.88,1132.12 2146.13,1132.44 2217.38,1132.15 
  2288.63,1132.15 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">60.70739340682705</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-105.53671238152918, -853.3969179234654], [21.319158631936734 0.43112536562685255; 133.14675434090285 6.117038106937294], [-5.943334151328186 -0.129486140567876; -33.141370484408974 -0.8040537222043789;;; -0.129486140567876 -0.01833965235453206; -0.8040537222043789 -0.15654643723954997], [108.50990396571132; 239.62011858080396;;], [-35.509280003382486, -2.7303023464928335], [9.439281704979631 -0.23778136937876995; 1.7717221938737158 0.7843150683429273], [-2.8694610777887335 0.060390883421944985; -1.6897631032087166 -0.10899700546953008;;; 0.060390883421944985 0.009137881981586481; -0.10899700546953008 -0.0060975126022250895], [0.4411896910635549 0.16331084996277886 … -0.19275742731164866 -0.08448981216795166])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 5 January 2023 03:50">Thursday 5 January 2023</span>. Using Julia version 1.8.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
