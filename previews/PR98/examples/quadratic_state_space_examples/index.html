<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.01268747899966672]
 [-0.07831127366776681, -0.013777525665985505]
 [-0.15922886197934155, -0.0017672642294435995]
 [-0.16227898715167272, -0.005331321016336398]
 [-0.18715525521803092, -0.013004999991203744]
 [-0.2578198145124741, -0.0014759230640440718]
 [-0.2541386323375244, -0.007658373780626637]
 [-0.28868955623981013, -0.008000881228231197]
 [-0.3235988707504159, 0.011087247131961329]
 ⋮
 [-0.1342419587751013, 0.0030216205779992397]
 [-0.10887682447372368, -0.0031704187329819945]
 [-0.12311525385034834, 0.005117530584961207]
 [-0.08527309560236557, -0.00293606192137165]
 [-0.09924869215952949, -0.006950543432255802]
 [-0.13726173696782049, -0.0005479212367971865]
 [-0.13387179093511625, 0.010770285119389161]
 [-0.060219256230938704, 0.02277886107921244]
 [0.08547103157665084, 0.0022779054479075593]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip140">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip140)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip141">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip140)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip142">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip140)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1384.64 2352.76,1384.64 "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1048.4 2352.76,1048.4 "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,712.15 2352.76,712.15 "/>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,375.903 2352.76,375.903 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1384.64 105.89,1384.64 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1048.4 105.89,1048.4 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,712.15 105.89,712.15 "/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,375.903 105.89,375.903 "/>
<path clip-path="url(#clip140)" d="M-55.3036 1385.1 L-25.6278 1385.1 L-25.6278 1389.03 L-55.3036 1389.03 L-55.3036 1385.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M-5.53535 1370.44 Q-9.14644 1370.44 -10.9751 1374.01 Q-12.7807 1377.55 -12.7807 1384.68 Q-12.7807 1391.79 -10.9751 1395.35 Q-9.14644 1398.89 -5.53535 1398.89 Q-1.90111 1398.89 -0.0955632 1395.35 Q1.73313 1391.79 1.73313 1384.68 Q1.73313 1377.55 -0.0955632 1374.01 Q-1.90111 1370.44 -5.53535 1370.44 M-5.53535 1366.74 Q0.274805 1366.74 3.33034 1371.35 Q6.40903 1375.93 6.40903 1384.68 Q6.40903 1393.41 3.33034 1398.01 Q0.274805 1402.6 -5.53535 1402.6 Q-11.3455 1402.6 -14.4242 1398.01 Q-17.4797 1393.41 -17.4797 1384.68 Q-17.4797 1375.93 -14.4242 1371.35 Q-11.3455 1366.74 -5.53535 1366.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M14.6266 1396.05 L19.5108 1396.05 L19.5108 1401.92 L14.6266 1401.92 L14.6266 1396.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M43.8625 1383.29 Q47.219 1384.01 49.094 1386.28 Q50.9921 1388.55 50.9921 1391.88 Q50.9921 1396.99 47.4736 1399.8 Q43.9551 1402.6 37.4737 1402.6 Q35.2978 1402.6 32.983 1402.16 Q30.6913 1401.74 28.2376 1400.88 L28.2376 1396.37 Q30.1821 1397.5 32.4969 1398.08 Q34.8117 1398.66 37.3348 1398.66 Q41.7329 1398.66 44.0246 1396.92 Q46.3394 1395.19 46.3394 1391.88 Q46.3394 1388.82 44.1866 1387.11 Q42.057 1385.37 38.2376 1385.37 L34.2098 1385.37 L34.2098 1381.53 L38.4227 1381.53 Q41.8718 1381.53 43.7005 1380.17 Q45.5292 1378.78 45.5292 1376.18 Q45.5292 1373.52 43.6311 1372.11 Q41.7561 1370.67 38.2376 1370.67 Q36.3163 1370.67 34.1172 1371.09 Q31.9182 1371.51 29.2793 1372.39 L29.2793 1368.22 Q31.9413 1367.48 34.2561 1367.11 Q36.5941 1366.74 38.6542 1366.74 Q43.9783 1366.74 47.0801 1369.17 Q50.1819 1371.58 50.1819 1375.7 Q50.1819 1378.57 48.5384 1380.56 Q46.8949 1382.53 43.8625 1383.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M-54.3545 1048.85 L-24.6788 1048.85 L-24.6788 1052.78 L-54.3545 1052.78 L-54.3545 1048.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M-4.58628 1034.2 Q-8.19737 1034.2 -10.0261 1037.76 Q-11.8316 1041.3 -11.8316 1048.43 Q-11.8316 1055.54 -10.0261 1059.1 Q-8.19737 1062.64 -4.58628 1062.64 Q-0.95204 1062.64 0.853506 1059.1 Q2.6822 1055.54 2.6822 1048.43 Q2.6822 1041.3 0.853506 1037.76 Q-0.95204 1034.2 -4.58628 1034.2 M-4.58628 1030.49 Q1.22387 1030.49 4.27941 1035.1 Q7.3581 1039.68 7.3581 1048.43 Q7.3581 1057.16 4.27941 1061.77 Q1.22387 1066.35 -4.58628 1066.35 Q-10.3964 1066.35 -13.4751 1061.77 Q-16.5307 1057.16 -16.5307 1048.43 Q-16.5307 1039.68 -13.4751 1035.1 Q-10.3964 1030.49 -4.58628 1030.49 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M15.5756 1059.8 L20.4599 1059.8 L20.4599 1065.68 L15.5756 1065.68 L15.5756 1059.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M34.6728 1061.74 L50.9921 1061.74 L50.9921 1065.68 L29.0478 1065.68 L29.0478 1061.74 Q31.7098 1058.99 36.2931 1054.36 Q40.8996 1049.71 42.0801 1048.36 Q44.3255 1045.84 45.2051 1044.1 Q46.1079 1042.34 46.1079 1040.65 Q46.1079 1037.9 44.1635 1036.16 Q42.2422 1034.43 39.1403 1034.43 Q36.9413 1034.43 34.4876 1035.19 Q32.057 1035.96 29.2793 1037.51 L29.2793 1032.78 Q32.1033 1031.65 34.557 1031.07 Q37.0107 1030.49 39.0477 1030.49 Q44.4181 1030.49 47.6125 1033.18 Q50.8069 1035.86 50.8069 1040.35 Q50.8069 1042.48 49.9968 1044.4 Q49.2097 1046.3 47.1033 1048.9 Q46.5246 1049.57 43.4227 1052.78 Q40.3209 1055.98 34.6728 1061.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M-54.7249 712.601 L-25.0491 712.601 L-25.0491 716.537 L-54.7249 716.537 L-54.7249 712.601 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M-4.95665 697.949 Q-8.56774 697.949 -10.3964 701.514 Q-12.202 705.055 -12.202 712.185 Q-12.202 719.291 -10.3964 722.856 Q-8.56774 726.398 -4.95665 726.398 Q-1.32241 726.398 0.483137 722.856 Q2.31183 719.291 2.31183 712.185 Q2.31183 705.055 0.483137 701.514 Q-1.32241 697.949 -4.95665 697.949 M-4.95665 694.245 Q0.853506 694.245 3.90904 698.852 Q6.98773 703.435 6.98773 712.185 Q6.98773 720.912 3.90904 725.518 Q0.853506 730.101 -4.95665 730.101 Q-10.7668 730.101 -13.8455 725.518 Q-16.901 720.912 -16.901 712.185 Q-16.901 703.435 -13.8455 698.852 Q-10.7668 694.245 -4.95665 694.245 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M15.2053 723.55 L20.0895 723.55 L20.0895 729.43 L15.2053 729.43 L15.2053 723.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M31.0848 725.495 L38.7237 725.495 L38.7237 699.129 L30.4135 700.796 L30.4135 696.537 L38.6774 694.87 L43.3533 694.87 L43.3533 725.495 L50.9921 725.495 L50.9921 729.43 L31.0848 729.43 L31.0848 725.495 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M-6.18349 361.701 Q-9.79459 361.701 -11.6233 365.266 Q-13.4288 368.808 -13.4288 375.937 Q-13.4288 383.044 -11.6233 386.609 Q-9.79459 390.15 -6.18349 390.15 Q-2.54925 390.15 -0.743708 386.609 Q1.08499 383.044 1.08499 375.937 Q1.08499 368.808 -0.743708 365.266 Q-2.54925 361.701 -6.18349 361.701 M-6.18349 357.998 Q-0.37334 357.998 2.6822 362.604 Q5.76089 367.188 5.76089 375.937 Q5.76089 384.664 2.6822 389.271 Q-0.37334 393.854 -6.18349 393.854 Q-11.9936 393.854 -15.0723 389.271 Q-18.1279 384.664 -18.1279 375.937 Q-18.1279 367.188 -15.0723 362.604 Q-11.9936 357.998 -6.18349 357.998 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M13.9784 387.303 L18.8627 387.303 L18.8627 393.183 L13.9784 393.183 L13.9784 387.303 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip140)" d="M39.0477 361.701 Q35.4367 361.701 33.608 365.266 Q31.8024 368.808 31.8024 375.937 Q31.8024 383.044 33.608 386.609 Q35.4367 390.15 39.0477 390.15 Q42.682 390.15 44.4875 386.609 Q46.3162 383.044 46.3162 375.937 Q46.3162 368.808 44.4875 365.266 Q42.682 361.701 39.0477 361.701 M39.0477 357.998 Q44.8579 357.998 47.9134 362.604 Q50.9921 367.188 50.9921 375.937 Q50.9921 384.664 47.9134 389.271 Q44.8579 393.854 39.0477 393.854 Q33.2376 393.854 30.1589 389.271 Q27.1034 384.664 27.1034 375.937 Q27.1034 367.188 30.1589 362.604 Q33.2376 357.998 39.0477 357.998 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip142)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,375.903 162.518,376.166 238.043,639.222 313.569,911.306 389.094,921.561 464.619,1005.21 540.145,1242.81 615.67,1230.44 691.196,1346.61 766.721,1464 842.247,1178.31 917.772,942.621 993.298,725.23 1068.82,841.138 1144.35,968.592 1219.87,1001.8 1295.4,947.977 1370.92,748.852 1446.45,885.629 1521.98,965.865 1597.5,1146.53 1673.03,889.556 1748.55,827.288 1824.08,741.998 1899.6,789.874 1975.13,662.631 2050.65,709.624 2126.18,837.442 2201.7,826.043 2277.23,578.388 2352.76,88.5087 "/>
<polyline clip-path="url(#clip142)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,375.903 162.518,418.564 238.043,422.229 313.569,381.845 389.094,393.829 464.619,419.632 540.145,380.865 615.67,401.654 691.196,402.805 766.721,338.622 842.247,344.378 917.772,345.447 993.298,397.466 1068.82,400.294 1144.35,386.029 1219.87,372.217 1295.4,348.416 1370.92,401.053 1446.45,392.982 1521.98,409.994 1597.5,340.72 1673.03,369.952 1748.55,365.743 1824.08,386.563 1899.6,358.695 1975.13,385.775 2050.65,399.274 2126.18,377.745 2201.7,339.688 2277.23,299.309 2352.76,368.243 "/>
<path clip-path="url(#clip140)" d="M2027.46 1456.66 L2277.23 1456.66 L2277.23 1301.14 L2027.46 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,1456.66 2277.23,1456.66 2277.23,1301.14 2027.46,1301.14 2027.46,1456.66 "/>
<polyline clip-path="url(#clip140)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,1352.98 2203.69,1352.98 "/>
<path clip-path="url(#clip140)" d="M2242.26 1357.23 Q2237.1 1357.23 2235.11 1358.41 Q2233.12 1359.59 2233.12 1362.44 Q2233.12 1364.7 2234.6 1366.05 Q2236.11 1367.37 2238.68 1367.37 Q2242.22 1367.37 2244.35 1364.87 Q2246.5 1362.34 2246.5 1358.18 L2246.5 1357.23 L2242.26 1357.23 M2250.76 1355.47 L2250.76 1370.26 L2246.5 1370.26 L2246.5 1366.32 Q2245.04 1368.69 2242.87 1369.82 Q2240.69 1370.93 2237.54 1370.93 Q2233.56 1370.93 2231.2 1368.71 Q2228.86 1366.46 2228.86 1362.71 Q2228.86 1358.34 2231.78 1356.12 Q2234.72 1353.89 2240.53 1353.89 L2246.5 1353.89 L2246.5 1353.48 Q2246.5 1350.54 2244.56 1348.94 Q2242.63 1347.32 2239.14 1347.32 Q2236.92 1347.32 2234.81 1347.85 Q2232.7 1348.38 2230.76 1349.45 L2230.76 1345.51 Q2233.1 1344.61 2235.3 1344.17 Q2237.5 1343.71 2239.58 1343.71 Q2245.2 1343.71 2247.98 1346.63 Q2250.76 1349.54 2250.76 1355.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip140)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,1404.82 2203.69,1404.82 "/>
<path clip-path="url(#clip140)" d="M2247.63 1409.16 Q2247.63 1404.46 2245.69 1401.8 Q2243.77 1399.11 2240.39 1399.11 Q2237.01 1399.11 2235.06 1401.8 Q2233.14 1404.46 2233.14 1409.16 Q2233.14 1413.86 2235.06 1416.54 Q2237.01 1419.21 2240.39 1419.21 Q2243.77 1419.21 2245.69 1416.54 Q2247.63 1413.86 2247.63 1409.16 M2233.14 1400.11 Q2234.49 1397.79 2236.52 1396.68 Q2238.58 1395.55 2241.43 1395.55 Q2246.15 1395.55 2249.09 1399.3 Q2252.06 1403.05 2252.06 1409.16 Q2252.06 1415.27 2249.09 1419.02 Q2246.15 1422.77 2241.43 1422.77 Q2238.58 1422.77 2236.52 1421.66 Q2234.49 1420.53 2233.14 1418.21 L2233.14 1422.1 L2228.86 1422.1 L2228.86 1386.08 L2233.14 1386.08 L2233.14 1400.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -1.26875  -1.124  0.0988241  -0.497787  …  1.08799  2.06248  -0.227787</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip200">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip200)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip201">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip200)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip202">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip200)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1339.87 2352.76,1339.87 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1047.69 2352.76,1047.69 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,755.516 2352.76,755.516 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,463.337 2352.76,463.337 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,171.159 2352.76,171.159 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1339.87 105.89,1339.87 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1047.69 105.89,1047.69 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,755.516 105.89,755.516 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,463.337 105.89,463.337 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,171.159 105.89,171.159 "/>
<path clip-path="url(#clip200)" d="M-10.0724 1340.32 L19.6034 1340.32 L19.6034 1344.26 L-10.0724 1344.26 L-10.0724 1340.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M43.8625 1338.52 Q47.219 1339.24 49.094 1341.51 Q50.9921 1343.77 50.9921 1347.11 Q50.9921 1352.22 47.4736 1355.02 Q43.9551 1357.82 37.4737 1357.82 Q35.2978 1357.82 32.983 1357.38 Q30.6913 1356.97 28.2376 1356.11 L28.2376 1351.6 Q30.1821 1352.73 32.4969 1353.31 Q34.8117 1353.89 37.3348 1353.89 Q41.7329 1353.89 44.0246 1352.15 Q46.3394 1350.42 46.3394 1347.11 Q46.3394 1344.05 44.1866 1342.34 Q42.057 1340.6 38.2376 1340.6 L34.2098 1340.6 L34.2098 1336.76 L38.4227 1336.76 Q41.8718 1336.76 43.7005 1335.39 Q45.5292 1334.01 45.5292 1331.41 Q45.5292 1328.75 43.6311 1327.34 Q41.7561 1325.9 38.2376 1325.9 Q36.3163 1325.9 34.1172 1326.32 Q31.9182 1326.74 29.2793 1327.62 L29.2793 1323.45 Q31.9413 1322.71 34.2561 1322.34 Q36.5941 1321.97 38.6542 1321.97 Q43.9783 1321.97 47.0801 1324.4 Q50.1819 1326.81 50.1819 1330.93 Q50.1819 1333.8 48.5384 1335.79 Q46.8949 1337.76 43.8625 1338.52 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M39.0477 1033.49 Q35.4367 1033.49 33.608 1037.06 Q31.8024 1040.6 31.8024 1047.73 Q31.8024 1054.84 33.608 1058.4 Q35.4367 1061.94 39.0477 1061.94 Q42.682 1061.94 44.4875 1058.4 Q46.3162 1054.84 46.3162 1047.73 Q46.3162 1040.6 44.4875 1037.06 Q42.682 1033.49 39.0477 1033.49 M39.0477 1029.79 Q44.8579 1029.79 47.9134 1034.4 Q50.9921 1038.98 50.9921 1047.73 Q50.9921 1056.46 47.9134 1061.06 Q44.8579 1065.65 39.0477 1065.65 Q33.2376 1065.65 30.1589 1061.06 Q27.1034 1056.46 27.1034 1047.73 Q27.1034 1038.98 30.1589 1034.4 Q33.2376 1029.79 39.0477 1029.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M43.8625 754.162 Q47.219 754.879 49.094 757.148 Q50.9921 759.416 50.9921 762.75 Q50.9921 767.865 47.4736 770.666 Q43.9551 773.467 37.4737 773.467 Q35.2978 773.467 32.983 773.027 Q30.6913 772.611 28.2376 771.754 L28.2376 767.24 Q30.1821 768.375 32.4969 768.953 Q34.8117 769.532 37.3348 769.532 Q41.7329 769.532 44.0246 767.796 Q46.3394 766.06 46.3394 762.75 Q46.3394 759.694 44.1866 757.981 Q42.057 756.245 38.2376 756.245 L34.2098 756.245 L34.2098 752.403 L38.4227 752.403 Q41.8718 752.403 43.7005 751.037 Q45.5292 749.648 45.5292 747.055 Q45.5292 744.393 43.6311 742.981 Q41.7561 741.546 38.2376 741.546 Q36.3163 741.546 34.1172 741.963 Q31.9182 742.379 29.2793 743.259 L29.2793 739.092 Q31.9413 738.352 34.2561 737.981 Q36.5941 737.611 38.6542 737.611 Q43.9783 737.611 47.0801 740.041 Q50.1819 742.449 50.1819 746.569 Q50.1819 749.44 48.5384 751.43 Q46.8949 753.398 43.8625 754.162 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M39.4644 461.474 Q36.3163 461.474 34.4644 463.627 Q32.6357 465.779 32.6357 469.529 Q32.6357 473.256 34.4644 475.432 Q36.3163 477.585 39.4644 477.585 Q42.6125 477.585 44.4412 475.432 Q46.2931 473.256 46.2931 469.529 Q46.2931 465.779 44.4412 463.627 Q42.6125 461.474 39.4644 461.474 M48.7468 446.821 L48.7468 451.08 Q46.9875 450.247 45.182 449.807 Q43.3996 449.367 41.6403 449.367 Q37.0107 449.367 34.557 452.492 Q32.1265 455.617 31.7793 461.937 Q33.145 459.923 35.2052 458.858 Q37.2653 457.77 39.7422 457.77 Q44.9505 457.77 47.9597 460.941 Q50.9921 464.09 50.9921 469.529 Q50.9921 474.853 47.844 478.071 Q44.6959 481.289 39.4644 481.289 Q33.4691 481.289 30.2978 476.705 Q27.1265 472.099 27.1265 463.372 Q27.1265 455.178 31.0154 450.317 Q34.9042 445.432 41.4551 445.432 Q43.2144 445.432 44.9968 445.78 Q46.8023 446.127 48.7468 446.821 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M29.3719 187.721 L29.3719 183.462 Q31.1311 184.295 32.9367 184.735 Q34.7422 185.175 36.4783 185.175 Q41.1079 185.175 43.5385 182.073 Q45.9922 178.948 46.3394 172.605 Q44.9968 174.596 42.9366 175.661 Q40.8764 176.726 38.3765 176.726 Q33.1913 176.726 30.1589 173.601 Q27.1497 170.453 27.1497 165.013 Q27.1497 159.689 30.2978 156.471 Q33.4459 153.254 38.6774 153.254 Q44.6727 153.254 47.8208 157.86 Q50.9921 162.443 50.9921 171.193 Q50.9921 179.365 47.1033 184.249 Q43.2375 189.11 36.6866 189.11 Q34.9274 189.11 33.1219 188.763 Q31.3163 188.416 29.3719 187.721 M38.6774 173.068 Q41.8255 173.068 43.6542 170.916 Q45.506 168.763 45.506 165.013 Q45.506 161.286 43.6542 159.133 Q41.8255 156.957 38.6774 156.957 Q35.5292 156.957 33.6774 159.133 Q31.8487 161.286 31.8487 165.013 Q31.8487 168.763 33.6774 170.916 Q35.5292 173.068 38.6774 173.068 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip202)" d="M151.118 1187.4 L222.368 1389.37 L293.618 1477.19 L364.869 1479.3 L436.119 1462.77 L507.37 1439.73 L578.62 1419.46 L649.871 1398.67 L721.121 1382.1 L792.371 1369.97 L863.622 1354.48 L934.872 1339.76 L1006.12 1328.35 L1077.37 1313.24 L1148.62 1305.01 L1219.87 1286.35 L1291.12 1277.44 L1362.37 1263.02 L1433.63 1252.5 L1504.88 1247.57 L1576.13 1238.35 L1647.38 1227.99 L1718.63 1221.1 L1789.88 1203.66 L1861.13 1193.22 L1932.38 1188.65 L2003.63 1187.13 L2074.88 1180.15 L2146.13 1175.56 L2217.38 1168.43 L2288.63 1165.06 L2288.63 799.132 L2217.38 794.487 L2146.13 778.034 L2074.88 762.119 L2003.63 744.712 L1932.38 724.737 L1861.13 709.056 L1789.88 692.149 L1718.63 682.49 L1647.38 662.63 L1576.13 640.291 L1504.88 617.219 L1433.63 593.395 L1362.37 570.473 L1291.12 545.024 L1219.87 519.61 L1148.62 494.764 L1077.37 466.331 L1006.12 439.923 L934.872 402.204 L863.622 369.4 L792.371 335.499 L721.121 306.184 L649.871 275.347 L578.62 237.172 L507.37 190.625 L436.119 152.375 L364.869 113.575 L293.618 88.9544 L222.368 160.23 L151.118 889.235  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip202)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1056.86 222.368,1006.44 293.618,1061.9 364.869,1057.51 436.119,1059.83 507.37,1067.73 578.62,1065.63 649.871,1063.09 721.121,1060.65 792.371,1058.43 863.622,1061.4 934.872,1059.28 1006.12,1057.09 1077.37,1057.22 1148.62,1055.63 1219.87,1053.74 1291.12,1056.41 1362.37,1055.71 1433.63,1053.96 1504.88,1052.53 1576.13,1047.42 1647.38,1048.39 1718.63,1053.18 1789.88,1055.48 1861.13,1056.7 1932.38,1058.75 2003.63,1054.83 2074.88,1055.61 2146.13,1058.83 2217.38,1062.66 2288.63,1056.1 "/>
<path clip-path="url(#clip202)" d="M151.118 1166.89 L222.368 1071.77 L293.618 1052.8 L364.869 1049.88 L436.119 1049.22 L507.37 1049.17 L578.62 1048.52 L649.871 1049.31 L721.121 1049.34 L792.371 1049.4 L863.622 1049.11 L934.872 1049.1 L1006.12 1048.82 L1077.37 1049.28 L1148.62 1049.24 L1219.87 1049.09 L1291.12 1049.01 L1362.37 1048.79 L1433.63 1049.27 L1504.88 1049.4 L1576.13 1049.25 L1647.38 1049.41 L1718.63 1048.98 L1789.88 1049.26 L1861.13 1049.03 L1932.38 1049.23 L2003.63 1048.98 L2074.88 1049.2 L2146.13 1049.33 L2217.38 1049.11 L2288.63 1048.85 L2288.63 1046.08 L2217.38 1045.96 L2146.13 1046.09 L2074.88 1046.14 L2003.63 1046.04 L1932.38 1046.01 L1861.13 1046 L1789.88 1046 L1718.63 1045.49 L1647.38 1046.25 L1576.13 1046.33 L1504.88 1046.13 L1433.63 1045.3 L1362.37 1045.79 L1291.12 1046.44 L1219.87 1046.56 L1148.62 1046.21 L1077.37 1046.11 L1006.12 1046.51 L934.872 1046.18 L863.622 1046.4 L792.371 1046.35 L721.121 1046.25 L649.871 1046.2 L578.62 1046.11 L507.37 1046.13 L436.119 1046.33 L364.869 1045.6 L293.618 1043.5 L222.368 1028.77 L151.118 953.637  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip202)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1050.99 222.368,1048.13 293.618,1047.26 364.869,1047.75 436.119,1047.81 507.37,1047.63 578.62,1047.36 649.871,1047.8 721.121,1047.93 792.371,1047.54 863.622,1047.71 934.872,1047.88 1006.12,1047.72 1077.37,1047.83 1148.62,1047.87 1219.87,1047.94 1291.12,1047.63 1362.37,1047.58 1433.63,1047.64 1504.88,1047.82 1576.13,1047.92 1647.38,1048.01 1718.63,1047.35 1789.88,1047.58 1861.13,1047.6 1932.38,1047.7 2003.63,1047.75 2074.88,1047.68 2146.13,1047.6 2217.38,1047.61 2288.63,1047.43 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">60.18116206621738</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([166.26724119700526, 1481.4085741720614], [-25.697075629992437 1.4330328010680022; -250.26126319833637 4.773601459526473], [2.8517199561848585 -0.10201917372509792; 34.52665509207249 -0.6467357551365573;;; -0.10201917372509792 0.009300853408259906; -0.6467357551365573 0.02447444085780877], [136.50403415794955; 921.9550419537602;;], [-26.311905619979107, -7.886228801720545], [2.270667320308645 0.41718575323725793; 8.696564459941726 0.2520581880083866], [-0.15438539567117124 0.09281583634698859; -0.965823073776518 -0.06809182837366963;;; 0.09281583634698859 0.005465347569011593; -0.06809182837366963 -0.0001359879052127014], [-2.500541256233476 -1.6094166038621263 … 1.5594529749892019 0.041963373233373805])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 19:28">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
