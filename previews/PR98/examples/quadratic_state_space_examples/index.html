<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.0013825867024695238]
 [0.008425433138864832, 0.001560688020225415]
 [0.017610686611715127, -0.007493330272988746]
 [-0.029640114470720513, 0.005209846631851697]
 [0.004139076559064887, 0.017000196052485553]
 [0.1101642544299313, 0.010387569127437914]
 [0.16939256894875343, 0.014685986088897261]
 [0.2527336489029235, 0.0017476935892509254]
 [0.25088094125487426, 0.001551535183689245]
 ⋮
 [0.003241124126462979, 0.011250592109007645]
 [0.0731518884521923, 0.014553102610131236]
 [0.16037703093519695, -0.006313537295308499]
 [0.11318845049907908, 0.0012998059997720022]
 [0.1155221246884851, -0.00640627691534635]
 [0.07002565926120284, 0.004800693310358115]
 [0.096303662567968, 0.0002613665175509036]
 [0.09303079497972674, -0.017083376914908893]
 [-0.016809676494579234, 0.0017881261229092762]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip700">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip700)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip701">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip700)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip702">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip700)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1470.49 2352.76,1470.49 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1242.24 2352.76,1242.24 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1013.99 2352.76,1013.99 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,785.737 2352.76,785.737 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,557.487 2352.76,557.487 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,329.237 2352.76,329.237 "/>
<polyline clip-path="url(#clip702)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,100.988 2352.76,100.988 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1470.49 105.89,1470.49 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1242.24 105.89,1242.24 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1013.99 105.89,1013.99 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,785.737 105.89,785.737 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,557.487 105.89,557.487 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,329.237 105.89,329.237 "/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,100.988 105.89,100.988 "/>
<path clip-path="url(#clip700)" d="M-85.1183 1470.94 L-55.4425 1470.94 L-55.4425 1474.87 L-85.1183 1474.87 L-85.1183 1470.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-35.35 1456.28 Q-38.9611 1456.28 -40.7898 1459.85 Q-42.5953 1463.39 -42.5953 1470.52 Q-42.5953 1477.63 -40.7898 1481.19 Q-38.9611 1484.73 -35.35 1484.73 Q-31.7158 1484.73 -29.9102 1481.19 Q-28.0815 1477.63 -28.0815 1470.52 Q-28.0815 1463.39 -29.9102 1459.85 Q-31.7158 1456.28 -35.35 1456.28 M-35.35 1452.58 Q-29.5398 1452.58 -26.4843 1457.19 Q-23.4056 1461.77 -23.4056 1470.52 Q-23.4056 1479.25 -26.4843 1483.85 Q-29.5398 1488.44 -35.35 1488.44 Q-41.1602 1488.44 -44.2388 1483.85 Q-47.2944 1479.25 -47.2944 1470.52 Q-47.2944 1461.77 -44.2388 1457.19 Q-41.1602 1452.58 -35.35 1452.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-15.1881 1481.89 L-10.3038 1481.89 L-10.3038 1487.77 L-15.1881 1487.77 L-15.1881 1481.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M9.88124 1456.28 Q6.27014 1456.28 4.44145 1459.85 Q2.6359 1463.39 2.6359 1470.52 Q2.6359 1477.63 4.44145 1481.19 Q6.27014 1484.73 9.88124 1484.73 Q13.5155 1484.73 15.321 1481.19 Q17.1497 1477.63 17.1497 1470.52 Q17.1497 1463.39 15.321 1459.85 Q13.5155 1456.28 9.88124 1456.28 M9.88124 1452.58 Q15.6914 1452.58 18.7469 1457.19 Q21.8256 1461.77 21.8256 1470.52 Q21.8256 1479.25 18.7469 1483.85 Q15.6914 1488.44 9.88124 1488.44 Q4.07108 1488.44 0.992394 1483.85 Q-2.06315 1479.25 -2.06315 1470.52 Q-2.06315 1461.77 0.992394 1457.19 Q4.07108 1452.58 9.88124 1452.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M30.0895 1453.21 L48.4458 1453.21 L48.4458 1457.14 L34.3718 1457.14 L34.3718 1465.61 Q35.3904 1465.27 36.4089 1465.1 Q37.4274 1464.92 38.4459 1464.92 Q44.2329 1464.92 47.6125 1468.09 Q50.9921 1471.26 50.9921 1476.68 Q50.9921 1482.26 47.5199 1485.36 Q44.0477 1488.44 37.7283 1488.44 Q35.5524 1488.44 33.2839 1488.07 Q31.0385 1487.7 28.6311 1486.96 L28.6311 1482.26 Q30.7145 1483.39 32.9367 1483.95 Q35.1589 1484.5 37.6357 1484.5 Q41.6403 1484.5 43.9783 1482.4 Q46.3162 1480.29 46.3162 1476.68 Q46.3162 1473.07 43.9783 1470.96 Q41.6403 1468.85 37.6357 1468.85 Q35.7607 1468.85 33.8857 1469.27 Q32.0339 1469.69 30.0895 1470.57 L30.0895 1453.21 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-36.3454 1228.03 Q-39.9565 1228.03 -41.7852 1231.6 Q-43.5907 1235.14 -43.5907 1242.27 Q-43.5907 1249.38 -41.7852 1252.94 Q-39.9565 1256.48 -36.3454 1256.48 Q-32.7111 1256.48 -30.9056 1252.94 Q-29.0769 1249.38 -29.0769 1242.27 Q-29.0769 1235.14 -30.9056 1231.6 Q-32.7111 1228.03 -36.3454 1228.03 M-36.3454 1224.33 Q-30.5352 1224.33 -27.4797 1228.94 Q-24.401 1233.52 -24.401 1242.27 Q-24.401 1251 -27.4797 1255.6 Q-30.5352 1260.19 -36.3454 1260.19 Q-42.1555 1260.19 -45.2342 1255.6 Q-48.2897 1251 -48.2897 1242.27 Q-48.2897 1233.52 -45.2342 1228.94 Q-42.1555 1224.33 -36.3454 1224.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.1834 1253.64 L-11.2992 1253.64 L-11.2992 1259.52 L-16.1834 1259.52 L-16.1834 1253.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M8.88587 1228.03 Q5.27478 1228.03 3.44608 1231.6 Q1.64054 1235.14 1.64054 1242.27 Q1.64054 1249.38 3.44608 1252.94 Q5.27478 1256.48 8.88587 1256.48 Q12.5201 1256.48 14.3257 1252.94 Q16.1543 1249.38 16.1543 1242.27 Q16.1543 1235.14 14.3257 1231.6 Q12.5201 1228.03 8.88587 1228.03 M8.88587 1224.33 Q14.696 1224.33 17.7516 1228.94 Q20.8303 1233.52 20.8303 1242.27 Q20.8303 1251 17.7516 1255.6 Q14.696 1260.19 8.88587 1260.19 Q3.07572 1260.19 -0.00297114 1255.6 Q-3.05851 1251 -3.05851 1242.27 Q-3.05851 1233.52 -0.00297114 1228.94 Q3.07572 1224.33 8.88587 1224.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M39.0477 1228.03 Q35.4367 1228.03 33.608 1231.6 Q31.8024 1235.14 31.8024 1242.27 Q31.8024 1249.38 33.608 1252.94 Q35.4367 1256.48 39.0477 1256.48 Q42.682 1256.48 44.4875 1252.94 Q46.3162 1249.38 46.3162 1242.27 Q46.3162 1235.14 44.4875 1231.6 Q42.682 1228.03 39.0477 1228.03 M39.0477 1224.33 Q44.8579 1224.33 47.9134 1228.94 Q50.9921 1233.52 50.9921 1242.27 Q50.9921 1251 47.9134 1255.6 Q44.8579 1260.19 39.0477 1260.19 Q33.2376 1260.19 30.1589 1255.6 Q27.1034 1251 27.1034 1242.27 Q27.1034 1233.52 30.1589 1228.94 Q33.2376 1224.33 39.0477 1224.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-35.35 999.785 Q-38.9611 999.785 -40.7898 1003.35 Q-42.5953 1006.89 -42.5953 1014.02 Q-42.5953 1021.13 -40.7898 1024.69 Q-38.9611 1028.23 -35.35 1028.23 Q-31.7158 1028.23 -29.9102 1024.69 Q-28.0815 1021.13 -28.0815 1014.02 Q-28.0815 1006.89 -29.9102 1003.35 Q-31.7158 999.785 -35.35 999.785 M-35.35 996.081 Q-29.5398 996.081 -26.4843 1000.69 Q-23.4056 1005.27 -23.4056 1014.02 Q-23.4056 1022.75 -26.4843 1027.35 Q-29.5398 1031.94 -35.35 1031.94 Q-41.1602 1031.94 -44.2388 1027.35 Q-47.2944 1022.75 -47.2944 1014.02 Q-47.2944 1005.27 -44.2388 1000.69 Q-41.1602 996.081 -35.35 996.081 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-15.1881 1025.39 L-10.3038 1025.39 L-10.3038 1031.27 L-15.1881 1031.27 L-15.1881 1025.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M9.88124 999.785 Q6.27014 999.785 4.44145 1003.35 Q2.6359 1006.89 2.6359 1014.02 Q2.6359 1021.13 4.44145 1024.69 Q6.27014 1028.23 9.88124 1028.23 Q13.5155 1028.23 15.321 1024.69 Q17.1497 1021.13 17.1497 1014.02 Q17.1497 1006.89 15.321 1003.35 Q13.5155 999.785 9.88124 999.785 M9.88124 996.081 Q15.6914 996.081 18.7469 1000.69 Q21.8256 1005.27 21.8256 1014.02 Q21.8256 1022.75 18.7469 1027.35 Q15.6914 1031.94 9.88124 1031.94 Q4.07108 1031.94 0.992394 1027.35 Q-2.06315 1022.75 -2.06315 1014.02 Q-2.06315 1005.27 0.992394 1000.69 Q4.07108 996.081 9.88124 996.081 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M30.0895 996.706 L48.4458 996.706 L48.4458 1000.64 L34.3718 1000.64 L34.3718 1009.11 Q35.3904 1008.77 36.4089 1008.6 Q37.4274 1008.42 38.4459 1008.42 Q44.2329 1008.42 47.6125 1011.59 Q50.9921 1014.76 50.9921 1020.18 Q50.9921 1025.76 47.5199 1028.86 Q44.0477 1031.94 37.7283 1031.94 Q35.5524 1031.94 33.2839 1031.57 Q31.0385 1031.2 28.6311 1030.46 L28.6311 1025.76 Q30.7145 1026.89 32.9367 1027.45 Q35.1589 1028 37.6357 1028 Q41.6403 1028 43.9783 1025.9 Q46.3162 1023.79 46.3162 1020.18 Q46.3162 1016.57 43.9783 1014.46 Q41.6403 1012.35 37.6357 1012.35 Q35.7607 1012.35 33.8857 1012.77 Q32.0339 1013.19 30.0895 1014.07 L30.0895 996.706 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-36.3454 771.535 Q-39.9565 771.535 -41.7852 775.1 Q-43.5907 778.642 -43.5907 785.772 Q-43.5907 792.878 -41.7852 796.443 Q-39.9565 799.984 -36.3454 799.984 Q-32.7111 799.984 -30.9056 796.443 Q-29.0769 792.878 -29.0769 785.772 Q-29.0769 778.642 -30.9056 775.1 Q-32.7111 771.535 -36.3454 771.535 M-36.3454 767.832 Q-30.5352 767.832 -27.4797 772.438 Q-24.401 777.022 -24.401 785.772 Q-24.401 794.498 -27.4797 799.105 Q-30.5352 803.688 -36.3454 803.688 Q-42.1555 803.688 -45.2342 799.105 Q-48.2897 794.498 -48.2897 785.772 Q-48.2897 777.022 -45.2342 772.438 Q-42.1555 767.832 -36.3454 767.832 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.1834 797.137 L-11.2992 797.137 L-11.2992 803.017 L-16.1834 803.017 L-16.1834 797.137 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-0.303895 799.082 L7.33495 799.082 L7.33495 772.716 L-0.975188 774.383 L-0.975188 770.123 L7.28866 768.457 L11.9646 768.457 L11.9646 799.082 L19.6034 799.082 L19.6034 803.017 L-0.303895 803.017 L-0.303895 799.082 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M39.0477 771.535 Q35.4367 771.535 33.608 775.1 Q31.8024 778.642 31.8024 785.772 Q31.8024 792.878 33.608 796.443 Q35.4367 799.984 39.0477 799.984 Q42.682 799.984 44.4875 796.443 Q46.3162 792.878 46.3162 785.772 Q46.3162 778.642 44.4875 775.1 Q42.682 771.535 39.0477 771.535 M39.0477 767.832 Q44.8579 767.832 47.9134 772.438 Q50.9921 777.022 50.9921 785.772 Q50.9921 794.498 47.9134 799.105 Q44.8579 803.688 39.0477 803.688 Q33.2376 803.688 30.1589 799.105 Q27.1034 794.498 27.1034 785.772 Q27.1034 777.022 30.1589 772.438 Q33.2376 767.832 39.0477 767.832 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-35.35 543.286 Q-38.9611 543.286 -40.7898 546.851 Q-42.5953 550.392 -42.5953 557.522 Q-42.5953 564.628 -40.7898 568.193 Q-38.9611 571.735 -35.35 571.735 Q-31.7158 571.735 -29.9102 568.193 Q-28.0815 564.628 -28.0815 557.522 Q-28.0815 550.392 -29.9102 546.851 Q-31.7158 543.286 -35.35 543.286 M-35.35 539.582 Q-29.5398 539.582 -26.4843 544.189 Q-23.4056 548.772 -23.4056 557.522 Q-23.4056 566.249 -26.4843 570.855 Q-29.5398 575.438 -35.35 575.438 Q-41.1602 575.438 -44.2388 570.855 Q-47.2944 566.249 -47.2944 557.522 Q-47.2944 548.772 -44.2388 544.189 Q-41.1602 539.582 -35.35 539.582 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-15.1881 568.888 L-10.3038 568.888 L-10.3038 574.767 L-15.1881 574.767 L-15.1881 568.888 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M0.69147 570.832 L8.33032 570.832 L8.33032 544.466 L0.0201769 546.133 L0.0201769 541.874 L8.28402 540.207 L12.9599 540.207 L12.9599 570.832 L20.5988 570.832 L20.5988 574.767 L0.69147 574.767 L0.69147 570.832 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M30.0895 540.207 L48.4458 540.207 L48.4458 544.142 L34.3718 544.142 L34.3718 552.614 Q35.3904 552.267 36.4089 552.105 Q37.4274 551.92 38.4459 551.92 Q44.2329 551.92 47.6125 555.091 Q50.9921 558.263 50.9921 563.679 Q50.9921 569.258 47.5199 572.36 Q44.0477 575.438 37.7283 575.438 Q35.5524 575.438 33.2839 575.068 Q31.0385 574.698 28.6311 573.957 L28.6311 569.258 Q30.7145 570.392 32.9367 570.948 Q35.1589 571.503 37.6357 571.503 Q41.6403 571.503 43.9783 569.397 Q46.3162 567.29 46.3162 563.679 Q46.3162 560.068 43.9783 557.962 Q41.6403 555.855 37.6357 555.855 Q35.7607 555.855 33.8857 556.272 Q32.0339 556.689 30.0895 557.568 L30.0895 540.207 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-36.3454 315.036 Q-39.9565 315.036 -41.7852 318.601 Q-43.5907 322.143 -43.5907 329.272 Q-43.5907 336.379 -41.7852 339.943 Q-39.9565 343.485 -36.3454 343.485 Q-32.7111 343.485 -30.9056 339.943 Q-29.0769 336.379 -29.0769 329.272 Q-29.0769 322.143 -30.9056 318.601 Q-32.7111 315.036 -36.3454 315.036 M-36.3454 311.332 Q-30.5352 311.332 -27.4797 315.939 Q-24.401 320.522 -24.401 329.272 Q-24.401 337.999 -27.4797 342.605 Q-30.5352 347.189 -36.3454 347.189 Q-42.1555 347.189 -45.2342 342.605 Q-48.2897 337.999 -48.2897 329.272 Q-48.2897 320.522 -45.2342 315.939 Q-42.1555 311.332 -36.3454 311.332 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-16.1834 340.638 L-11.2992 340.638 L-11.2992 346.517 L-16.1834 346.517 L-16.1834 340.638 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M2.91368 342.582 L19.233 342.582 L19.233 346.517 L-2.71129 346.517 L-2.71129 342.582 Q-0.0492672 339.828 4.53404 335.198 Q9.1405 330.545 10.321 329.203 Q12.5664 326.68 13.446 324.943 Q14.3488 323.184 14.3488 321.494 Q14.3488 318.74 12.4044 317.004 Q10.4831 315.268 7.38125 315.268 Q5.18219 315.268 2.7285 316.032 Q0.297953 316.795 -2.47981 318.346 L-2.47981 313.624 Q0.344249 312.49 2.79794 311.911 Q5.25163 311.332 7.28866 311.332 Q12.659 311.332 15.8534 314.018 Q19.0479 316.703 19.0479 321.194 Q19.0479 323.323 18.2377 325.244 Q17.4506 327.143 15.3442 329.735 Q14.7655 330.406 11.6636 333.624 Q8.5618 336.818 2.91368 342.582 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M39.0477 315.036 Q35.4367 315.036 33.608 318.601 Q31.8024 322.143 31.8024 329.272 Q31.8024 336.379 33.608 339.943 Q35.4367 343.485 39.0477 343.485 Q42.682 343.485 44.4875 339.943 Q46.3162 336.379 46.3162 329.272 Q46.3162 322.143 44.4875 318.601 Q42.682 315.036 39.0477 315.036 M39.0477 311.332 Q44.8579 311.332 47.9134 315.939 Q50.9921 320.522 50.9921 329.272 Q50.9921 337.999 47.9134 342.605 Q44.8579 347.189 39.0477 347.189 Q33.2376 347.189 30.1589 342.605 Q27.1034 337.999 27.1034 329.272 Q27.1034 320.522 30.1589 315.939 Q33.2376 311.332 39.0477 311.332 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-35.35 86.7865 Q-38.9611 86.7865 -40.7898 90.3513 Q-42.5953 93.8929 -42.5953 101.023 Q-42.5953 108.129 -40.7898 111.694 Q-38.9611 115.235 -35.35 115.235 Q-31.7158 115.235 -29.9102 111.694 Q-28.0815 108.129 -28.0815 101.023 Q-28.0815 93.8929 -29.9102 90.3513 Q-31.7158 86.7865 -35.35 86.7865 M-35.35 83.0828 Q-29.5398 83.0828 -26.4843 87.6892 Q-23.4056 92.2725 -23.4056 101.023 Q-23.4056 109.749 -26.4843 114.356 Q-29.5398 118.939 -35.35 118.939 Q-41.1602 118.939 -44.2388 114.356 Q-47.2944 109.749 -47.2944 101.023 Q-47.2944 92.2725 -44.2388 87.6892 Q-41.1602 83.0828 -35.35 83.0828 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M-15.1881 112.388 L-10.3038 112.388 L-10.3038 118.268 L-15.1881 118.268 L-15.1881 112.388 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M3.90904 114.333 L20.2284 114.333 L20.2284 118.268 L-1.71592 118.268 L-1.71592 114.333 Q0.946098 111.578 5.52941 106.948 Q10.1359 102.296 11.3164 100.953 Q13.5618 98.4299 14.4414 96.6938 Q15.3442 94.9346 15.3442 93.2448 Q15.3442 90.4902 13.3997 88.754 Q11.4784 87.0179 8.37661 87.0179 Q6.17755 87.0179 3.72386 87.7818 Q1.29332 88.5457 -1.48444 90.0966 L-1.48444 85.3744 Q1.33961 84.2402 3.7933 83.6615 Q6.247 83.0828 8.28402 83.0828 Q13.6544 83.0828 16.8488 85.768 Q20.0432 88.4531 20.0432 92.9438 Q20.0432 95.0735 19.233 96.9947 Q18.446 98.8929 16.3395 101.485 Q15.7608 102.157 12.659 105.374 Q9.55716 108.569 3.90904 114.333 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip700)" d="M30.0895 83.7078 L48.4458 83.7078 L48.4458 87.6429 L34.3718 87.6429 L34.3718 96.1151 Q35.3904 95.7679 36.4089 95.6059 Q37.4274 95.4207 38.4459 95.4207 Q44.2329 95.4207 47.6125 98.592 Q50.9921 101.763 50.9921 107.18 Q50.9921 112.759 47.5199 115.86 Q44.0477 118.939 37.7283 118.939 Q35.5524 118.939 33.2839 118.569 Q31.0385 118.198 28.6311 117.458 L28.6311 112.759 Q30.7145 113.893 32.9367 114.448 Q35.1589 115.004 37.6357 115.004 Q41.6403 115.004 43.9783 112.897 Q46.3162 110.791 46.3162 107.18 Q46.3162 103.569 43.9783 101.462 Q41.6403 99.3558 37.6357 99.3558 Q35.7607 99.3558 33.8857 99.7725 Q32.0339 100.189 30.0895 101.069 L30.0895 83.7078 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip702)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1242.24 162.518,1242.59 238.043,1203.77 313.569,1161.84 389.094,1377.54 464.619,1223.34 540.145,739.337 615.67,468.96 691.196,88.5087 766.721,96.9663 842.247,110.577 917.772,459.705 993.298,421.532 1068.82,689.221 1144.35,366.583 1219.87,613.523 1295.4,658.688 1370.92,686.755 1446.45,1130.01 1521.98,1353.57 1597.5,1464 1673.03,1451.76 1748.55,1227.44 1824.08,908.298 1899.6,510.116 1975.13,725.532 2050.65,714.878 2126.18,922.569 2201.7,802.611 2277.23,817.551 2352.76,1318.97 "/>
<polyline clip-path="url(#clip702)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1242.24 162.518,1235.92 238.043,1235.11 313.569,1276.44 389.094,1218.45 464.619,1164.63 540.145,1194.82 615.67,1175.19 691.196,1234.26 766.721,1235.15 842.247,1289.47 917.772,1229.75 993.298,1278.81 1068.82,1186.1 1144.35,1274.99 1219.87,1244.39 1295.4,1242 1370.92,1309.6 1446.45,1277.46 1521.98,1260.93 1597.5,1241.99 1673.03,1207.8 1748.55,1190.88 1824.08,1175.8 1899.6,1271.06 1975.13,1236.3 2050.65,1271.48 2126.18,1220.32 2201.7,1241.04 2277.23,1320.22 2352.76,1234.07 "/>
<path clip-path="url(#clip700)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip700)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip700)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip700)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip700)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip700)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.138259  0.128417  -0.780547  0.670851  …  -0.0698772  -1.71357  0.52048</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip760">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip760)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip761">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip760)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip762">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip760)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1190.21 2352.76,1190.21 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,854.172 2352.76,854.172 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,518.13 2352.76,518.13 "/>
<polyline clip-path="url(#clip762)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,182.088 2352.76,182.088 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1190.21 105.89,1190.21 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,854.172 105.89,854.172 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,518.13 105.89,518.13 "/>
<polyline clip-path="url(#clip760)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,182.088 105.89,182.088 "/>
<path clip-path="url(#clip760)" d="M39.0477 1176.01 Q35.4367 1176.01 33.608 1179.58 Q31.8024 1183.12 31.8024 1190.25 Q31.8024 1197.36 33.608 1200.92 Q35.4367 1204.46 39.0477 1204.46 Q42.682 1204.46 44.4875 1200.92 Q46.3162 1197.36 46.3162 1190.25 Q46.3162 1183.12 44.4875 1179.58 Q42.682 1176.01 39.0477 1176.01 M39.0477 1172.31 Q44.8579 1172.31 47.9134 1176.92 Q50.9921 1181.5 50.9921 1190.25 Q50.9921 1198.98 47.9134 1203.58 Q44.8579 1208.17 39.0477 1208.17 Q33.2376 1208.17 30.1589 1203.58 Q27.1034 1198.98 27.1034 1190.25 Q27.1034 1181.5 30.1589 1176.92 Q33.2376 1172.31 39.0477 1172.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M30.0895 836.892 L48.4458 836.892 L48.4458 840.828 L34.3718 840.828 L34.3718 849.3 Q35.3904 848.953 36.4089 848.791 Q37.4274 848.605 38.4459 848.605 Q44.2329 848.605 47.6125 851.777 Q50.9921 854.948 50.9921 860.365 Q50.9921 865.943 47.5199 869.045 Q44.0477 872.124 37.7283 872.124 Q35.5524 872.124 33.2839 871.753 Q31.0385 871.383 28.6311 870.642 L28.6311 865.943 Q30.7145 867.077 32.9367 867.633 Q35.1589 868.189 37.6357 868.189 Q41.6403 868.189 43.9783 866.082 Q46.3162 863.976 46.3162 860.365 Q46.3162 856.753 43.9783 854.647 Q41.6403 852.541 37.6357 852.541 Q35.7607 852.541 33.8857 852.957 Q32.0339 853.374 30.0895 854.253 L30.0895 836.892 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M-0.303895 531.475 L7.33495 531.475 L7.33495 505.11 L-0.975188 506.776 L-0.975188 502.517 L7.28866 500.85 L11.9646 500.85 L11.9646 531.475 L19.6034 531.475 L19.6034 535.41 L-0.303895 535.41 L-0.303895 531.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M39.0477 503.929 Q35.4367 503.929 33.608 507.494 Q31.8024 511.036 31.8024 518.165 Q31.8024 525.272 33.608 528.836 Q35.4367 532.378 39.0477 532.378 Q42.682 532.378 44.4875 528.836 Q46.3162 525.272 46.3162 518.165 Q46.3162 511.036 44.4875 507.494 Q42.682 503.929 39.0477 503.929 M39.0477 500.225 Q44.8579 500.225 47.9134 504.832 Q50.9921 509.415 50.9921 518.165 Q50.9921 526.892 47.9134 531.498 Q44.8579 536.082 39.0477 536.082 Q33.2376 536.082 30.1589 531.498 Q27.1034 526.892 27.1034 518.165 Q27.1034 509.415 30.1589 504.832 Q33.2376 500.225 39.0477 500.225 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M0.69147 195.433 L8.33032 195.433 L8.33032 169.068 L0.0201769 170.734 L0.0201769 166.475 L8.28402 164.808 L12.9599 164.808 L12.9599 195.433 L20.5988 195.433 L20.5988 199.368 L0.69147 199.368 L0.69147 195.433 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip760)" d="M30.0895 164.808 L48.4458 164.808 L48.4458 168.744 L34.3718 168.744 L34.3718 177.216 Q35.3904 176.869 36.4089 176.707 Q37.4274 176.521 38.4459 176.521 Q44.2329 176.521 47.6125 179.693 Q50.9921 182.864 50.9921 188.281 Q50.9921 193.859 47.5199 196.961 Q44.0477 200.04 37.7283 200.04 Q35.5524 200.04 33.2839 199.669 Q31.0385 199.299 28.6311 198.558 L28.6311 193.859 Q30.7145 194.994 32.9367 195.549 Q35.1589 196.105 37.6357 196.105 Q41.6403 196.105 43.9783 193.998 Q46.3162 191.892 46.3162 188.281 Q46.3162 184.669 43.9783 182.563 Q41.6403 180.457 37.6357 180.457 Q35.7607 180.457 33.8857 180.873 Q32.0339 181.29 30.0895 182.169 L30.0895 164.808 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip762)" d="M151.118 1315.44 L222.368 1439.68 L293.618 1478.42 L364.869 1479.3 L436.119 1472.07 L507.37 1460.45 L578.62 1445.64 L649.871 1433.19 L721.121 1418.94 L792.371 1411.25 L863.622 1402.94 L934.872 1395.77 L1006.12 1388.41 L1077.37 1382.66 L1148.62 1372.69 L1219.87 1365.03 L1291.12 1359.81 L1362.37 1351.74 L1433.63 1344.84 L1504.88 1336.55 L1576.13 1333.55 L1647.38 1328.33 L1718.63 1320.5 L1789.88 1317.44 L1861.13 1306.37 L1932.38 1300.49 L2003.63 1295 L2074.88 1295.69 L2146.13 1290.88 L2217.38 1288.61 L2288.63 1285.36 L2288.63 923.535 L2217.38 904.653 L2146.13 892.606 L2074.88 875.443 L2003.63 860.677 L1932.38 840.406 L1861.13 828.817 L1789.88 813.077 L1718.63 794.809 L1647.38 770.603 L1576.13 748.864 L1504.88 723.267 L1433.63 700.168 L1362.37 674.535 L1291.12 645.172 L1219.87 614.628 L1148.62 575.486 L1077.37 546.069 L1006.12 515.917 L934.872 480.511 L863.622 446.239 L792.371 402.966 L721.121 361.915 L649.871 315.841 L578.62 266.339 L507.37 219.002 L436.119 168.358 L364.869 121.358 L293.618 88.9544 L222.368 177.966 L151.118 1110.64  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip762)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1206.33 222.368,1240.75 293.618,1266.61 364.869,1266.46 436.119,1265.4 507.37,1262.54 578.62,1255.43 649.871,1255.13 721.121,1252.14 792.371,1250.91 863.622,1250.77 934.872,1243.82 1006.12,1238.2 1077.37,1233.75 1148.62,1232.45 1219.87,1234.18 1291.12,1231.16 1362.37,1227.95 1433.63,1226.32 1504.88,1222.08 1576.13,1219.52 1647.38,1222.55 1718.63,1219.13 1789.88,1216.83 1861.13,1217.65 1932.38,1214.14 2003.63,1215.28 2074.88,1215.56 2146.13,1214.65 2217.38,1212.42 2288.63,1210.48 "/>
<path clip-path="url(#clip762)" d="M151.118 1280.75 L222.368 1208.23 L293.618 1194.31 L364.869 1191.49 L436.119 1191.09 L507.37 1191.24 L578.62 1191.72 L649.871 1191.15 L721.121 1191.31 L792.371 1191.04 L863.622 1191.06 L934.872 1191.22 L1006.12 1191.36 L1077.37 1191.34 L1148.62 1191.28 L1219.87 1191.35 L1291.12 1191.22 L1362.37 1191.21 L1433.63 1191.05 L1504.88 1191.5 L1576.13 1191.38 L1647.38 1191.36 L1718.63 1191.06 L1789.88 1191.35 L1861.13 1191.21 L1932.38 1191.4 L2003.63 1191.45 L2074.88 1191.27 L2146.13 1191.32 L2217.38 1191.04 L2288.63 1191.25 L2288.63 1189.31 L2217.38 1189.37 L2146.13 1189.41 L2074.88 1189.18 L2003.63 1189.36 L1932.38 1189.26 L1861.13 1189.15 L1789.88 1189.18 L1718.63 1189.21 L1647.38 1189.07 L1576.13 1189.15 L1504.88 1188.95 L1433.63 1189.19 L1362.37 1189.12 L1291.12 1188.85 L1219.87 1188.93 L1148.62 1189.15 L1077.37 1188.73 L1006.12 1189.25 L934.872 1189.51 L863.622 1189.32 L792.371 1189.41 L721.121 1188.73 L649.871 1189.28 L578.62 1189.19 L507.37 1189.37 L436.119 1189.45 L364.869 1189.26 L293.618 1186.7 L222.368 1171.56 L151.118 1097.44  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip762)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1194.2 222.368,1190.89 293.618,1190.76 364.869,1190.21 436.119,1190.19 507.37,1190.15 578.62,1190.25 649.871,1190.22 721.121,1190.16 792.371,1190.4 863.622,1190.26 934.872,1190.35 1006.12,1190.33 1077.37,1190.3 1148.62,1190.28 1219.87,1190.14 1291.12,1190.33 1362.37,1190.26 1433.63,1190.15 1504.88,1190.09 1576.13,1190.21 1647.38,1190.18 1718.63,1190.19 1789.88,1190.08 1861.13,1190.13 1932.38,1190.31 2003.63,1190.2 2074.88,1190.36 2146.13,1190.26 2217.38,1190.37 2288.63,1190.27 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">52.592569781298245</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-850.1792669136855, -6256.351666066435], [-85.14230063822009 -1.0061150685400015; -613.4759952097565 -11.474368724614513], [-16.71855739916763 0.05419850683498338; -124.39553922428226 0.09282071843252315;;; 0.05419850683498338 -0.061820668432020984; 0.09282071843252315 -0.4659364732302733], [-122.52309730209186; -635.4955610444622;;], [-62.49844506855008, -75.93829123792226], [-5.260333747857969 0.393029305213691; -5.8951606909859 -0.5018435883098054], [-0.8208662657545449 0.021251833489421917; -0.8699186436324101 -0.020227932616230057;;; 0.021251833489421917 0.004374495468014183; -0.020227932616230057 -0.004817562027688434], [-2.6566437682023247 -3.0921211468384957 … -0.29892596094738777 0.02977730013203369])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 19:54">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
