<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.004319714375308832]
 [0.026688030411183734, 0.012067279785685843]
 [0.1005697965777675, 0.013264233450521287]
 [0.17833944418459788, 0.0027383045884970345]
 [0.1863716304030252, -0.005579709123052227]
 [0.14240133548983622, -0.01703987916568258]
 [0.030297522732513942, -0.004325662981586952]
 [0.001935217204058621, 0.015130357467897948]
 [0.09628546629746845, 0.006928057344225809]
 ⋮
 [-0.04880147796469139, -0.0018292921489038297]
 [-0.05776507851690563, 0.008495478025355581]
 [-0.0020919427432374185, 0.0006889721150469116]
 [0.0022073446188118338, -0.003404598133367761]
 [-0.019053691206806046, -0.00868020008329612]
 [-0.07174890877116714, -0.016162246090686363]
 [-0.1675496591437755, -0.005606777613429545]
 [-0.19385571086282766, -0.0012210755087236974]
 [-0.19179872946133322, 0.0031370077112508367]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip500">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip500)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip501">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip500)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip502">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip500)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1486.22 2352.76,1486.22 "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1124.47 2352.76,1124.47 "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,762.715 2352.76,762.715 "/>
<polyline clip-path="url(#clip502)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,400.961 2352.76,400.961 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1486.22 105.89,1486.22 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1124.47 105.89,1124.47 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,762.715 105.89,762.715 "/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,400.961 105.89,400.961 "/>
<path clip-path="url(#clip500)" d="M-54.3545 1486.67 L-24.6788 1486.67 L-24.6788 1490.61 L-54.3545 1490.61 L-54.3545 1486.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-4.58628 1472.02 Q-8.19737 1472.02 -10.0261 1475.59 Q-11.8316 1479.13 -11.8316 1486.26 Q-11.8316 1493.36 -10.0261 1496.93 Q-8.19737 1500.47 -4.58628 1500.47 Q-0.95204 1500.47 0.853506 1496.93 Q2.6822 1493.36 2.6822 1486.26 Q2.6822 1479.13 0.853506 1475.59 Q-0.95204 1472.02 -4.58628 1472.02 M-4.58628 1468.32 Q1.22387 1468.32 4.27941 1472.92 Q7.3581 1477.51 7.3581 1486.26 Q7.3581 1494.98 4.27941 1499.59 Q1.22387 1504.17 -4.58628 1504.17 Q-10.3964 1504.17 -13.4751 1499.59 Q-16.5307 1494.98 -16.5307 1486.26 Q-16.5307 1477.51 -13.4751 1472.92 Q-10.3964 1468.32 -4.58628 1468.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M15.5756 1497.62 L20.4599 1497.62 L20.4599 1503.5 L15.5756 1503.5 L15.5756 1497.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M34.6728 1499.57 L50.9921 1499.57 L50.9921 1503.5 L29.0478 1503.5 L29.0478 1499.57 Q31.7098 1496.81 36.2931 1492.18 Q40.8996 1487.53 42.0801 1486.19 Q44.3255 1483.66 45.2051 1481.93 Q46.1079 1480.17 46.1079 1478.48 Q46.1079 1475.72 44.1635 1473.99 Q42.2422 1472.25 39.1403 1472.25 Q36.9413 1472.25 34.4876 1473.02 Q32.057 1473.78 29.2793 1475.33 L29.2793 1470.61 Q32.1033 1469.47 34.557 1468.9 Q37.0107 1468.32 39.0477 1468.32 Q44.4181 1468.32 47.6125 1471 Q50.8069 1473.69 50.8069 1478.18 Q50.8069 1480.31 49.9968 1482.23 Q49.2097 1484.13 47.1033 1486.72 Q46.5246 1487.39 43.4227 1490.61 Q40.3209 1493.8 34.6728 1499.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-54.7249 1124.92 L-25.0491 1124.92 L-25.0491 1128.86 L-54.7249 1128.86 L-54.7249 1124.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-4.95665 1110.27 Q-8.56774 1110.27 -10.3964 1113.83 Q-12.202 1117.37 -12.202 1124.5 Q-12.202 1131.61 -10.3964 1135.17 Q-8.56774 1138.72 -4.95665 1138.72 Q-1.32241 1138.72 0.483137 1135.17 Q2.31183 1131.61 2.31183 1124.5 Q2.31183 1117.37 0.483137 1113.83 Q-1.32241 1110.27 -4.95665 1110.27 M-4.95665 1106.56 Q0.853506 1106.56 3.90904 1111.17 Q6.98773 1115.75 6.98773 1124.5 Q6.98773 1133.23 3.90904 1137.84 Q0.853506 1142.42 -4.95665 1142.42 Q-10.7668 1142.42 -13.8455 1137.84 Q-16.901 1133.23 -16.901 1124.5 Q-16.901 1115.75 -13.8455 1111.17 Q-10.7668 1106.56 -4.95665 1106.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M15.2053 1135.87 L20.0895 1135.87 L20.0895 1141.75 L15.2053 1141.75 L15.2053 1135.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M31.0848 1137.81 L38.7237 1137.81 L38.7237 1111.45 L30.4135 1113.11 L30.4135 1108.86 L38.6774 1107.19 L43.3533 1107.19 L43.3533 1137.81 L50.9921 1137.81 L50.9921 1141.75 L31.0848 1141.75 L31.0848 1137.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-6.18349 748.514 Q-9.79459 748.514 -11.6233 752.078 Q-13.4288 755.62 -13.4288 762.75 Q-13.4288 769.856 -11.6233 773.421 Q-9.79459 776.963 -6.18349 776.963 Q-2.54925 776.963 -0.743708 773.421 Q1.08499 769.856 1.08499 762.75 Q1.08499 755.62 -0.743708 752.078 Q-2.54925 748.514 -6.18349 748.514 M-6.18349 744.81 Q-0.37334 744.81 2.6822 749.416 Q5.76089 754 5.76089 762.75 Q5.76089 771.477 2.6822 776.083 Q-0.37334 780.666 -6.18349 780.666 Q-11.9936 780.666 -15.0723 776.083 Q-18.1279 771.477 -18.1279 762.75 Q-18.1279 754 -15.0723 749.416 Q-11.9936 744.81 -6.18349 744.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M13.9784 774.115 L18.8627 774.115 L18.8627 779.995 L13.9784 779.995 L13.9784 774.115 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M39.0477 748.514 Q35.4367 748.514 33.608 752.078 Q31.8024 755.62 31.8024 762.75 Q31.8024 769.856 33.608 773.421 Q35.4367 776.963 39.0477 776.963 Q42.682 776.963 44.4875 773.421 Q46.3162 769.856 46.3162 762.75 Q46.3162 755.62 44.4875 752.078 Q42.682 748.514 39.0477 748.514 M39.0477 744.81 Q44.8579 744.81 47.9134 749.416 Q50.9921 754 50.9921 762.75 Q50.9921 771.477 47.9134 776.083 Q44.8579 780.666 39.0477 780.666 Q33.2376 780.666 30.1589 776.083 Q27.1034 771.477 27.1034 762.75 Q27.1034 754 30.1589 749.416 Q33.2376 744.81 39.0477 744.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M-4.95665 386.76 Q-8.56774 386.76 -10.3964 390.325 Q-12.202 393.866 -12.202 400.996 Q-12.202 408.102 -10.3964 411.667 Q-8.56774 415.209 -4.95665 415.209 Q-1.32241 415.209 0.483137 411.667 Q2.31183 408.102 2.31183 400.996 Q2.31183 393.866 0.483137 390.325 Q-1.32241 386.76 -4.95665 386.76 M-4.95665 383.056 Q0.853506 383.056 3.90904 387.663 Q6.98773 392.246 6.98773 400.996 Q6.98773 409.723 3.90904 414.329 Q0.853506 418.913 -4.95665 418.913 Q-10.7668 418.913 -13.8455 414.329 Q-16.901 409.723 -16.901 400.996 Q-16.901 392.246 -13.8455 387.663 Q-10.7668 383.056 -4.95665 383.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M15.2053 412.362 L20.0895 412.362 L20.0895 418.241 L15.2053 418.241 L15.2053 412.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip500)" d="M31.0848 414.306 L38.7237 414.306 L38.7237 387.941 L30.4135 389.607 L30.4135 385.348 L38.6774 383.681 L43.3533 383.681 L43.3533 414.306 L50.9921 414.306 L50.9921 418.241 L31.0848 418.241 L31.0848 414.306 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip502)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,762.715 162.518,762.998 238.043,666.17 313.569,398.9 389.094,117.565 464.619,88.5087 540.145,247.573 615.67,653.113 691.196,755.714 766.721,414.399 842.247,276.014 917.772,552.052 993.298,721.994 1068.82,742.793 1144.35,984.668 1219.87,685.964 1295.4,769.808 1370.92,849.039 1446.45,878.33 1521.98,900.897 1597.5,1029.39 1673.03,781.586 1748.55,939.256 1824.08,971.682 1899.6,770.283 1975.13,754.73 2050.65,831.642 2126.18,1022.27 2201.7,1368.83 2277.23,1464 2352.76,1456.55 "/>
<polyline clip-path="url(#clip502)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,762.715 162.518,747.088 238.043,719.061 313.569,714.731 389.094,752.809 464.619,782.9 540.145,824.357 615.67,778.363 691.196,707.98 766.721,737.652 842.247,803.437 917.772,788.457 993.298,765.697 1068.82,801.732 1144.35,716.546 1219.87,775.594 1295.4,775.529 1370.92,768.095 1446.45,767.246 1521.98,784.585 1597.5,725.018 1673.03,788.346 1748.55,769.333 1824.08,731.982 1899.6,760.223 1975.13,775.031 2050.65,794.116 2126.18,821.183 2201.7,782.998 2277.23,767.132 2352.76,751.367 "/>
<path clip-path="url(#clip500)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip500)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip500)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip500)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip500)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip500)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.431971  1.12033  1.08508  0.00854579  …  -0.237433  -0.009972  0.338122</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip560">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip560)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip561">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip560)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip562">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip560)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1488.09 2352.76,1488.09 "/>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1137.4 2352.76,1137.4 "/>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,786.711 2352.76,786.711 "/>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,436.02 2352.76,436.02 "/>
<polyline clip-path="url(#clip562)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,85.3285 2352.76,85.3285 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1488.09 105.89,1488.09 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1137.4 105.89,1137.4 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,786.711 105.89,786.711 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,436.02 105.89,436.02 "/>
<polyline clip-path="url(#clip560)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,85.3285 105.89,85.3285 "/>
<path clip-path="url(#clip560)" d="M-9.72514 1488.54 L19.9506 1488.54 L19.9506 1492.48 L-9.72514 1492.48 L-9.72514 1488.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M30.0895 1470.81 L48.4458 1470.81 L48.4458 1474.75 L34.3718 1474.75 L34.3718 1483.22 Q35.3904 1482.87 36.4089 1482.71 Q37.4274 1482.53 38.4459 1482.53 Q44.2329 1482.53 47.6125 1485.7 Q50.9921 1488.87 50.9921 1494.29 Q50.9921 1499.86 47.5199 1502.97 Q44.0477 1506.04 37.7283 1506.04 Q35.5524 1506.04 33.2839 1505.67 Q31.0385 1505.3 28.6311 1504.56 L28.6311 1499.86 Q30.7145 1501 32.9367 1501.55 Q35.1589 1502.11 37.6357 1502.11 Q41.6403 1502.11 43.9783 1500 Q46.3162 1497.9 46.3162 1494.29 Q46.3162 1490.67 43.9783 1488.57 Q41.6403 1486.46 37.6357 1486.46 Q35.7607 1486.46 33.8857 1486.88 Q32.0339 1487.29 30.0895 1488.17 L30.0895 1470.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M39.0477 1123.2 Q35.4367 1123.2 33.608 1126.77 Q31.8024 1130.31 31.8024 1137.44 Q31.8024 1144.54 33.608 1148.11 Q35.4367 1151.65 39.0477 1151.65 Q42.682 1151.65 44.4875 1148.11 Q46.3162 1144.54 46.3162 1137.44 Q46.3162 1130.31 44.4875 1126.77 Q42.682 1123.2 39.0477 1123.2 M39.0477 1119.5 Q44.8579 1119.5 47.9134 1124.1 Q50.9921 1128.69 50.9921 1137.44 Q50.9921 1146.16 47.9134 1150.77 Q44.8579 1155.35 39.0477 1155.35 Q33.2376 1155.35 30.1589 1150.77 Q27.1034 1146.16 27.1034 1137.44 Q27.1034 1128.69 30.1589 1124.1 Q33.2376 1119.5 39.0477 1119.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M30.0895 769.431 L48.4458 769.431 L48.4458 773.366 L34.3718 773.366 L34.3718 781.838 Q35.3904 781.491 36.4089 781.329 Q37.4274 781.144 38.4459 781.144 Q44.2329 781.144 47.6125 784.315 Q50.9921 787.487 50.9921 792.903 Q50.9921 798.482 47.5199 801.584 Q44.0477 804.662 37.7283 804.662 Q35.5524 804.662 33.2839 804.292 Q31.0385 803.922 28.6311 803.181 L28.6311 798.482 Q30.7145 799.616 32.9367 800.172 Q35.1589 800.727 37.6357 800.727 Q41.6403 800.727 43.9783 798.621 Q46.3162 796.514 46.3162 792.903 Q46.3162 789.292 43.9783 787.186 Q41.6403 785.079 37.6357 785.079 Q35.7607 785.079 33.8857 785.496 Q32.0339 785.912 30.0895 786.792 L30.0895 769.431 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M-0.303895 449.365 L7.33495 449.365 L7.33495 422.999 L-0.975188 424.666 L-0.975188 420.406 L7.28866 418.74 L11.9646 418.74 L11.9646 449.365 L19.6034 449.365 L19.6034 453.3 L-0.303895 453.3 L-0.303895 449.365 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M39.0477 421.818 Q35.4367 421.818 33.608 425.383 Q31.8024 428.925 31.8024 436.055 Q31.8024 443.161 33.608 446.726 Q35.4367 450.267 39.0477 450.267 Q42.682 450.267 44.4875 446.726 Q46.3162 443.161 46.3162 436.055 Q46.3162 428.925 44.4875 425.383 Q42.682 421.818 39.0477 421.818 M39.0477 418.115 Q44.8579 418.115 47.9134 422.721 Q50.9921 427.305 50.9921 436.055 Q50.9921 444.781 47.9134 449.388 Q44.8579 453.971 39.0477 453.971 Q33.2376 453.971 30.1589 449.388 Q27.1034 444.781 27.1034 436.055 Q27.1034 427.305 30.1589 422.721 Q33.2376 418.115 39.0477 418.115 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M0.69147 98.6734 L8.33032 98.6734 L8.33032 72.3078 L0.0201769 73.9744 L0.0201769 69.7152 L8.28402 68.0485 L12.9599 68.0485 L12.9599 98.6734 L20.5988 98.6734 L20.5988 102.609 L0.69147 102.609 L0.69147 98.6734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip560)" d="M30.0895 68.0485 L48.4458 68.0485 L48.4458 71.9837 L34.3718 71.9837 L34.3718 80.4559 Q35.3904 80.1086 36.4089 79.9466 Q37.4274 79.7614 38.4459 79.7614 Q44.2329 79.7614 47.6125 82.9327 Q50.9921 86.104 50.9921 91.5206 Q50.9921 97.0993 47.5199 100.201 Q44.0477 103.28 37.7283 103.28 Q35.5524 103.28 33.2839 102.909 Q31.0385 102.539 28.6311 101.798 L28.6311 97.0993 Q30.7145 98.2335 32.9367 98.7891 Q35.1589 99.3446 37.6357 99.3446 Q41.6403 99.3446 43.9783 97.2382 Q46.3162 95.1317 46.3162 91.5206 Q46.3162 87.9095 43.9783 85.803 Q41.6403 83.6966 37.6357 83.6966 Q35.7607 83.6966 33.8857 84.1132 Q32.0339 84.5299 30.0895 85.4095 L30.0895 68.0485 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip562)" d="M151.118 1232.65 L222.368 1416.76 L293.618 1478.04 L364.869 1479.3 L436.119 1467.13 L507.37 1448.4 L578.62 1431.41 L649.871 1420.17 L721.121 1407.57 L792.371 1391.56 L863.622 1376.87 L934.872 1365.99 L1006.12 1356.8 L1077.37 1350.96 L1148.62 1344.84 L1219.87 1335.16 L1291.12 1326.33 L1362.37 1318.78 L1433.63 1311.63 L1504.88 1309.51 L1576.13 1298.97 L1647.38 1291.02 L1718.63 1285.33 L1789.88 1277.94 L1861.13 1272.05 L1932.38 1269.55 L2003.63 1259.91 L2074.88 1256.04 L2146.13 1253.67 L2217.38 1245.24 L2288.63 1240.37 L2288.63 882.794 L2217.38 874.61 L2146.13 861.838 L2074.88 841.582 L2003.63 822.841 L1932.38 808.783 L1861.13 790.843 L1789.88 775.226 L1718.63 758.92 L1647.38 740.196 L1576.13 720.747 L1504.88 701.374 L1433.63 678.028 L1362.37 651.782 L1291.12 624.875 L1219.87 593.656 L1148.62 559.443 L1077.37 524.525 L1006.12 493.545 L934.872 456.715 L863.622 420.828 L792.371 382.72 L721.121 343.807 L649.871 307.556 L578.62 262.454 L507.37 215.941 L436.119 167.495 L364.869 118.521 L293.618 88.9544 L222.368 179.027 L151.118 1024.83  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip562)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1130.61 222.368,1115 293.618,1111.98 364.869,1117.14 436.119,1118.65 507.37,1122.03 578.62,1121.53 649.871,1121.3 721.121,1122.96 792.371,1120.63 863.622,1122.08 934.872,1128.36 1006.12,1130.06 1077.37,1136.04 1148.62,1133.06 1219.87,1131.86 1291.12,1133.89 1362.37,1132.47 1433.63,1132.23 1504.88,1131.05 1576.13,1129.03 1647.38,1125.95 1718.63,1127.04 1789.88,1128.78 1861.13,1129.7 1932.38,1129.45 2003.63,1127.49 2074.88,1128.16 2146.13,1125.36 2217.38,1122.43 2288.63,1119.61 "/>
<path clip-path="url(#clip562)" d="M151.118 1226.88 L222.368 1155.43 L293.618 1140.92 L364.869 1138.64 L436.119 1138.45 L507.37 1138.46 L578.62 1138.49 L649.871 1138.74 L721.121 1138.7 L792.371 1138.56 L863.622 1138.77 L934.872 1138.65 L1006.12 1138.6 L1077.37 1138.8 L1148.62 1138.63 L1219.87 1138.45 L1291.12 1138.43 L1362.37 1138.55 L1433.63 1138.68 L1504.88 1138.33 L1576.13 1138.46 L1647.38 1138.48 L1718.63 1138.63 L1789.88 1138.54 L1861.13 1138.31 L1932.38 1138.67 L2003.63 1138.49 L2074.88 1138.56 L2146.13 1138.68 L2217.38 1138.7 L2288.63 1138.69 L2288.63 1136.24 L2217.38 1136.19 L2146.13 1136.39 L2074.88 1136.29 L2003.63 1136.37 L1932.38 1136.1 L1861.13 1136.45 L1789.88 1136.22 L1718.63 1136.28 L1647.38 1136.51 L1576.13 1136.13 L1504.88 1136.27 L1433.63 1136.59 L1362.37 1136.73 L1291.12 1136.46 L1219.87 1136.37 L1148.62 1136.45 L1077.37 1136.32 L1006.12 1136.44 L934.872 1135.87 L863.622 1136.13 L792.371 1136.29 L721.121 1136.19 L649.871 1136.35 L578.62 1136.29 L507.37 1136.13 L436.119 1136.47 L364.869 1136.02 L293.618 1133.77 L222.368 1120.22 L151.118 1045.51  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip562)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1131.76 222.368,1136.74 293.618,1137.09 364.869,1137.37 436.119,1137.63 507.37,1137.44 578.62,1137.32 649.871,1137.36 721.121,1137.46 792.371,1137.32 863.622,1137.63 934.872,1137.42 1006.12,1137.57 1077.37,1137.4 1148.62,1137.38 1219.87,1137.56 1291.12,1137.53 1362.37,1137.67 1433.63,1137.38 1504.88,1137.5 1576.13,1137.4 1647.38,1137.48 1718.63,1137.33 1789.88,1137.38 1861.13,1137.41 1932.38,1137.48 2003.63,1137.47 2074.88,1137.41 2146.13,1137.66 2217.38,1137.44 2288.63,1137.46 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">53.93692045695294</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-10.37088671513095, -341.3273690667981], [-12.640063168113475 0.7073307428861229; -131.44108822506277 2.4801903226856656], [-2.5666065284247184 0.04203689497274312; -15.228297971730425 -0.17848813334987032;;; 0.04203689497274312 -0.014271042610314647; -0.17848813334987032 -0.08902783449497861], [127.07470507835731; 440.21677393356117;;], [-74.85378626196892, 29.36403670693865], [-7.794114703517296 0.1646545677779046; 5.042071252038248 0.7264938519049613], [-0.4622970414265927 0.061173591704590836; 0.110136288666987 -0.023712332144623198;;; 0.061173591704590836 -0.01189238292687597; -0.023712332144623198 0.005335777330683978], [0.38169776204919653 -0.10913051747187483 … -0.5796791773940807 -0.004991809178182169])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 19:19">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
