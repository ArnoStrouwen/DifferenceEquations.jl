<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/linear_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Linear (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Simulating-Ensembles-and-Fixing-Noise"><span>Simulating Ensembles and Fixing Noise</span></a></li><li><a class="tocitem" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><span>Observables and Marginal Likelihood using a Kalman Filter</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li><li><a class="tocitem" href="#Composition-of-State-Space-Models-and-AD"><span>Composition of State Space Models and AD</span></a></li><li><a class="tocitem" href="#Caveats-on-Gradients-and-Performance"><span>Caveats on Gradients and Performance</span></a></li></ul></li><li><a class="tocitem" href="../quadratic_state_space_examples/">Quadratic State Space Examples</a></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/linear_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-State-Space-Examples"><a class="docs-heading-anchor" href="#Linear-State-Space-Examples">Linear State Space Examples</a><a id="Linear-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-State-Space-Examples" title="Permalink"></a></h1><p>This tutorial provides describes the support for linear and linear gaussian state space models.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form of the linear model is</p><p class="math-container">\[u_{n+1} = A u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.  More generally, support could be added for <span>$u_{n+1} = A(p,n) u_n + B(p,n) w_{n+1}$</span> where <span>$p$</span> is a vector of differentiable parameters, and the <span>$A$</span> and <span>$B$</span> are potentially matrix-free operators.</p><h2 id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model">Simulating a Linear (and Time-Invariant) State Space Model</a><a id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>LinearStateSpaceProblem</code> and simulating it for a simple, linear equation.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote
A = [0.95 6.2;
     0.0  0.2]
B = [0.0; 0.01;;] # matrix
C = [0.09 0.67;
     1.00 0.00]
D = [0.1, 0.1] # diagonal observation noise
u0 = zeros(2)
T = 10

prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:10
u: 11-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [0.0, 0.00806448267861053]
 [0.04999979260738529, 0.013297307353382753]
 [0.1299431085679891, 0.0022324603014048476]
 [0.1372872070082997, 0.010135480129053909]
 [0.19326282345801893, -0.004556832093496709]
 [0.15534732330543838, 0.0020014569827942175]
 [0.1599889904334906, 0.0006616772632675493]
 [0.1560919399440749, -0.0035100442632479793]
 [0.12652506851473366, 0.008671566500276956]
 [0.1739625273907141, 0.006277170395875007]</code></pre><p>The <code>u</code> vector of the simulated solution can be plotted using standard recipes, including use of the optional <code>syms</code>.  See <a href="https://diffeq.sciml.ai/latest/basics/plot/">SciML docs</a> for more options.</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip200">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip200)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip201">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip200)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip202">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip200)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1432.31 2352.76,1432.31 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1084.65 2352.76,1084.65 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,736.987 2352.76,736.987 "/>
<polyline clip-path="url(#clip202)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,389.325 2352.76,389.325 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1432.31 105.89,1432.31 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1084.65 105.89,1084.65 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,736.987 105.89,736.987 "/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,389.325 105.89,389.325 "/>
<path clip-path="url(#clip200)" d="M-36.3454 1418.11 Q-39.9565 1418.11 -41.7852 1421.67 Q-43.5907 1425.22 -43.5907 1432.35 Q-43.5907 1439.45 -41.7852 1443.02 Q-39.9565 1446.56 -36.3454 1446.56 Q-32.7111 1446.56 -30.9056 1443.02 Q-29.0769 1439.45 -29.0769 1432.35 Q-29.0769 1425.22 -30.9056 1421.67 Q-32.7111 1418.11 -36.3454 1418.11 M-36.3454 1414.41 Q-30.5352 1414.41 -27.4797 1419.01 Q-24.401 1423.6 -24.401 1432.35 Q-24.401 1441.07 -27.4797 1445.68 Q-30.5352 1450.26 -36.3454 1450.26 Q-42.1555 1450.26 -45.2342 1445.68 Q-48.2897 1441.07 -48.2897 1432.35 Q-48.2897 1423.6 -45.2342 1419.01 Q-42.1555 1414.41 -36.3454 1414.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-16.1834 1443.71 L-11.2992 1443.71 L-11.2992 1449.59 L-16.1834 1449.59 L-16.1834 1443.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M8.88587 1418.11 Q5.27478 1418.11 3.44608 1421.67 Q1.64054 1425.22 1.64054 1432.35 Q1.64054 1439.45 3.44608 1443.02 Q5.27478 1446.56 8.88587 1446.56 Q12.5201 1446.56 14.3257 1443.02 Q16.1543 1439.45 16.1543 1432.35 Q16.1543 1425.22 14.3257 1421.67 Q12.5201 1418.11 8.88587 1418.11 M8.88587 1414.41 Q14.696 1414.41 17.7516 1419.01 Q20.8303 1423.6 20.8303 1432.35 Q20.8303 1441.07 17.7516 1445.68 Q14.696 1450.26 8.88587 1450.26 Q3.07572 1450.26 -0.00297114 1445.68 Q-3.05851 1441.07 -3.05851 1432.35 Q-3.05851 1423.6 -0.00297114 1419.01 Q3.07572 1414.41 8.88587 1414.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M39.0477 1418.11 Q35.4367 1418.11 33.608 1421.67 Q31.8024 1425.22 31.8024 1432.35 Q31.8024 1439.45 33.608 1443.02 Q35.4367 1446.56 39.0477 1446.56 Q42.682 1446.56 44.4875 1443.02 Q46.3162 1439.45 46.3162 1432.35 Q46.3162 1425.22 44.4875 1421.67 Q42.682 1418.11 39.0477 1418.11 M39.0477 1414.41 Q44.8579 1414.41 47.9134 1419.01 Q50.9921 1423.6 50.9921 1432.35 Q50.9921 1441.07 47.9134 1445.68 Q44.8579 1450.26 39.0477 1450.26 Q33.2376 1450.26 30.1589 1445.68 Q27.1034 1441.07 27.1034 1432.35 Q27.1034 1423.6 30.1589 1419.01 Q33.2376 1414.41 39.0477 1414.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-35.35 1070.45 Q-38.9611 1070.45 -40.7898 1074.01 Q-42.5953 1077.55 -42.5953 1084.68 Q-42.5953 1091.79 -40.7898 1095.35 Q-38.9611 1098.9 -35.35 1098.9 Q-31.7158 1098.9 -29.9102 1095.35 Q-28.0815 1091.79 -28.0815 1084.68 Q-28.0815 1077.55 -29.9102 1074.01 Q-31.7158 1070.45 -35.35 1070.45 M-35.35 1066.74 Q-29.5398 1066.74 -26.4843 1071.35 Q-23.4056 1075.93 -23.4056 1084.68 Q-23.4056 1093.41 -26.4843 1098.02 Q-29.5398 1102.6 -35.35 1102.6 Q-41.1602 1102.6 -44.2388 1098.02 Q-47.2944 1093.41 -47.2944 1084.68 Q-47.2944 1075.93 -44.2388 1071.35 Q-41.1602 1066.74 -35.35 1066.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-15.1881 1096.05 L-10.3038 1096.05 L-10.3038 1101.93 L-15.1881 1101.93 L-15.1881 1096.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M9.88124 1070.45 Q6.27014 1070.45 4.44145 1074.01 Q2.6359 1077.55 2.6359 1084.68 Q2.6359 1091.79 4.44145 1095.35 Q6.27014 1098.9 9.88124 1098.9 Q13.5155 1098.9 15.321 1095.35 Q17.1497 1091.79 17.1497 1084.68 Q17.1497 1077.55 15.321 1074.01 Q13.5155 1070.45 9.88124 1070.45 M9.88124 1066.74 Q15.6914 1066.74 18.7469 1071.35 Q21.8256 1075.93 21.8256 1084.68 Q21.8256 1093.41 18.7469 1098.02 Q15.6914 1102.6 9.88124 1102.6 Q4.07108 1102.6 0.992394 1098.02 Q-2.06315 1093.41 -2.06315 1084.68 Q-2.06315 1075.93 0.992394 1071.35 Q4.07108 1066.74 9.88124 1066.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M30.0895 1067.37 L48.4458 1067.37 L48.4458 1071.3 L34.3718 1071.3 L34.3718 1079.78 Q35.3904 1079.43 36.4089 1079.27 Q37.4274 1079.08 38.4459 1079.08 Q44.2329 1079.08 47.6125 1082.25 Q50.9921 1085.42 50.9921 1090.84 Q50.9921 1096.42 47.5199 1099.52 Q44.0477 1102.6 37.7283 1102.6 Q35.5524 1102.6 33.2839 1102.23 Q31.0385 1101.86 28.6311 1101.12 L28.6311 1096.42 Q30.7145 1097.55 32.9367 1098.11 Q35.1589 1098.66 37.6357 1098.66 Q41.6403 1098.66 43.9783 1096.56 Q46.3162 1094.45 46.3162 1090.84 Q46.3162 1087.23 43.9783 1085.12 Q41.6403 1083.02 37.6357 1083.02 Q35.7607 1083.02 33.8857 1083.43 Q32.0339 1083.85 30.0895 1084.73 L30.0895 1067.37 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-36.3454 722.786 Q-39.9565 722.786 -41.7852 726.351 Q-43.5907 729.892 -43.5907 737.022 Q-43.5907 744.128 -41.7852 747.693 Q-39.9565 751.235 -36.3454 751.235 Q-32.7111 751.235 -30.9056 747.693 Q-29.0769 744.128 -29.0769 737.022 Q-29.0769 729.892 -30.9056 726.351 Q-32.7111 722.786 -36.3454 722.786 M-36.3454 719.082 Q-30.5352 719.082 -27.4797 723.688 Q-24.401 728.272 -24.401 737.022 Q-24.401 745.749 -27.4797 750.355 Q-30.5352 754.938 -36.3454 754.938 Q-42.1555 754.938 -45.2342 750.355 Q-48.2897 745.749 -48.2897 737.022 Q-48.2897 728.272 -45.2342 723.688 Q-42.1555 719.082 -36.3454 719.082 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-16.1834 748.387 L-11.2992 748.387 L-11.2992 754.267 L-16.1834 754.267 L-16.1834 748.387 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-0.303895 750.332 L7.33495 750.332 L7.33495 723.966 L-0.975188 725.633 L-0.975188 721.374 L7.28866 719.707 L11.9646 719.707 L11.9646 750.332 L19.6034 750.332 L19.6034 754.267 L-0.303895 754.267 L-0.303895 750.332 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M39.0477 722.786 Q35.4367 722.786 33.608 726.351 Q31.8024 729.892 31.8024 737.022 Q31.8024 744.128 33.608 747.693 Q35.4367 751.235 39.0477 751.235 Q42.682 751.235 44.4875 747.693 Q46.3162 744.128 46.3162 737.022 Q46.3162 729.892 44.4875 726.351 Q42.682 722.786 39.0477 722.786 M39.0477 719.082 Q44.8579 719.082 47.9134 723.688 Q50.9921 728.272 50.9921 737.022 Q50.9921 745.749 47.9134 750.355 Q44.8579 754.938 39.0477 754.938 Q33.2376 754.938 30.1589 750.355 Q27.1034 745.749 27.1034 737.022 Q27.1034 728.272 30.1589 723.688 Q33.2376 719.082 39.0477 719.082 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-35.35 375.124 Q-38.9611 375.124 -40.7898 378.689 Q-42.5953 382.23 -42.5953 389.36 Q-42.5953 396.466 -40.7898 400.031 Q-38.9611 403.573 -35.35 403.573 Q-31.7158 403.573 -29.9102 400.031 Q-28.0815 396.466 -28.0815 389.36 Q-28.0815 382.23 -29.9102 378.689 Q-31.7158 375.124 -35.35 375.124 M-35.35 371.42 Q-29.5398 371.42 -26.4843 376.027 Q-23.4056 380.61 -23.4056 389.36 Q-23.4056 398.087 -26.4843 402.693 Q-29.5398 407.277 -35.35 407.277 Q-41.1602 407.277 -44.2388 402.693 Q-47.2944 398.087 -47.2944 389.36 Q-47.2944 380.61 -44.2388 376.027 Q-41.1602 371.42 -35.35 371.42 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M-15.1881 400.726 L-10.3038 400.726 L-10.3038 406.605 L-15.1881 406.605 L-15.1881 400.726 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M0.69147 402.67 L8.33032 402.67 L8.33032 376.305 L0.0201769 377.971 L0.0201769 373.712 L8.28402 372.045 L12.9599 372.045 L12.9599 402.67 L20.5988 402.67 L20.5988 406.605 L0.69147 406.605 L0.69147 402.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip200)" d="M30.0895 372.045 L48.4458 372.045 L48.4458 375.98 L34.3718 375.98 L34.3718 384.453 Q35.3904 384.105 36.4089 383.943 Q37.4274 383.758 38.4459 383.758 Q44.2329 383.758 47.6125 386.929 Q50.9921 390.101 50.9921 395.517 Q50.9921 401.096 47.5199 404.198 Q44.0477 407.277 37.7283 407.277 Q35.5524 407.277 33.2839 406.906 Q31.0385 406.536 28.6311 405.795 L28.6311 401.096 Q30.7145 402.23 32.9367 402.786 Q35.1589 403.341 37.6357 403.341 Q41.6403 403.341 43.9783 401.235 Q46.3162 399.128 46.3162 395.517 Q46.3162 391.906 43.9783 389.8 Q41.6403 387.693 37.6357 387.693 Q35.7607 387.693 33.8857 388.11 Q32.0339 388.527 30.0895 389.406 L30.0895 372.045 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip202)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1432.31 313.569,1432.31 540.145,1084.65 766.721,528.786 993.298,477.72 1219.87,88.5087 1446.45,352.144 1673.03,319.869 1899.6,346.967 2126.18,552.552 2352.76,222.708 "/>
<polyline clip-path="url(#clip202)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1432.31 313.569,1376.24 540.145,1339.85 766.721,1416.79 993.298,1361.84 1219.87,1464 1446.45,1418.39 1673.03,1427.71 1899.6,1456.72 2126.18,1372.02 2352.76,1388.66 "/>
<path clip-path="url(#clip200)" d="M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip200)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 "/>
<polyline clip-path="url(#clip200)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,147.685 338.744,147.685 "/>
<path clip-path="url(#clip200)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip200)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,199.525 338.744,199.525 "/>
<path clip-path="url(#clip200)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>By default the solution provides an interface to access the simulated <code>u</code>.  That is, <code>sol.u[...] = sol[...]</code>,</p><pre><code class="language-julia hljs">sol[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.0
 0.00806448267861053</code></pre><p>Or to get the first element of the last step</p><pre><code class="language-julia hljs">sol[end][1] #first element of last step</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.1739625273907141</code></pre><p>Finally, to extract the full vector</p><pre><code class="language-julia hljs">@show sol[2,:];  # whole second vector</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
  0.00806448267861053
  0.013297307353382753
  0.0022324603014048476
  0.010135480129053909
 -0.004556832093496709
  0.0020014569827942175
  0.0006616772632675493
 -0.0035100442632479793
  0.008671566500276956
  0.006277170395875007</code></pre><p>The results for all of <code>sol.u</code> can be loaded in a dataframe, where the column names will be the (optionally) provided symbols.</p><pre><code class="language-julia hljs">df = DataFrame(sol)</code></pre><div><div style = "float: left;"><span>11×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">timestamp</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.00806448</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.0499998</td><td style = "text-align: right;">0.0132973</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.129943</td><td style = "text-align: right;">0.00223246</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.137287</td><td style = "text-align: right;">0.0101355</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.193263</td><td style = "text-align: right;">-0.00455683</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">6</td><td style = "text-align: right;">0.155347</td><td style = "text-align: right;">0.00200146</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">7</td><td style = "text-align: right;">0.159989</td><td style = "text-align: right;">0.000661677</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">8</td><td style = "text-align: right;">0.156092</td><td style = "text-align: right;">-0.00351004</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">9</td><td style = "text-align: right;">0.126525</td><td style = "text-align: right;">0.00867157</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">10</td><td style = "text-align: right;">0.173963</td><td style = "text-align: right;">0.00627717</td></tr></tbody></table></div><p>Other results, such as the simulated noise and observables can be extracted from the solution</p><pre><code class="language-julia hljs">sol.z # observables</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [0.7876288731192512, 0.6406985839280503]
 [0.5898536723849669, 0.5502118079612411]
 [0.3945398335212773, 0.32193272932705963]
 [-0.21866734363831453, -0.3278351404872917]
 [-0.1413179028513571, -0.10022089617703636]
 [0.2945167495521368, 0.5331259229889734]
 [-0.0185223934739487, -0.013010586915607497]
 [0.44880417509467035, -0.07884735751863084]
 [0.31012140518244624, 0.6408106438059303]
 [-0.20477862139729547, 0.5237465234308112]
 [-0.29615951099314364, 0.10101695047244513]</code></pre><pre><code class="language-julia hljs">sol.W # Simulated Noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10 Matrix{Float64}:
 0.806448  1.16844  -0.0427001  0.968899  …  -0.364238  0.937358  0.454286</code></pre><p>We can also solve the model passing in fixed noise, which will be useful for joint likelihoods.  First lets extract the noise from the previous solution, then rerun the simulation but with a different initial value</p><pre><code class="language-julia hljs">noise = sol.W
u0_2 = [0.1, 0.0]
prob2 = LinearStateSpaceProblem(A, B, u0_2, (0, T); C, observables_noise = D, syms = [:a, :b], noise)
sol2 = solve(prob2)
plot(sol2)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip260">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip260)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip261">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip260)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip262">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip260)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1441.22 2352.76,1441.22 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1191.31 2352.76,1191.31 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,941.402 2352.76,941.402 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,691.493 2352.76,691.493 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,441.584 2352.76,441.584 "/>
<polyline clip-path="url(#clip262)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,191.676 2352.76,191.676 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1441.22 105.89,1441.22 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1191.31 105.89,1191.31 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,941.402 105.89,941.402 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,691.493 105.89,691.493 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,441.584 105.89,441.584 "/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,191.676 105.89,191.676 "/>
<path clip-path="url(#clip260)" d="M-36.3454 1427.02 Q-39.9565 1427.02 -41.7852 1430.58 Q-43.5907 1434.12 -43.5907 1441.25 Q-43.5907 1448.36 -41.7852 1451.93 Q-39.9565 1455.47 -36.3454 1455.47 Q-32.7111 1455.47 -30.9056 1451.93 Q-29.0769 1448.36 -29.0769 1441.25 Q-29.0769 1434.12 -30.9056 1430.58 Q-32.7111 1427.02 -36.3454 1427.02 M-36.3454 1423.31 Q-30.5352 1423.31 -27.4797 1427.92 Q-24.401 1432.5 -24.401 1441.25 Q-24.401 1449.98 -27.4797 1454.59 Q-30.5352 1459.17 -36.3454 1459.17 Q-42.1555 1459.17 -45.2342 1454.59 Q-48.2897 1449.98 -48.2897 1441.25 Q-48.2897 1432.5 -45.2342 1427.92 Q-42.1555 1423.31 -36.3454 1423.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-16.1834 1452.62 L-11.2992 1452.62 L-11.2992 1458.5 L-16.1834 1458.5 L-16.1834 1452.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M8.88587 1427.02 Q5.27478 1427.02 3.44608 1430.58 Q1.64054 1434.12 1.64054 1441.25 Q1.64054 1448.36 3.44608 1451.93 Q5.27478 1455.47 8.88587 1455.47 Q12.5201 1455.47 14.3257 1451.93 Q16.1543 1448.36 16.1543 1441.25 Q16.1543 1434.12 14.3257 1430.58 Q12.5201 1427.02 8.88587 1427.02 M8.88587 1423.31 Q14.696 1423.31 17.7516 1427.92 Q20.8303 1432.5 20.8303 1441.25 Q20.8303 1449.98 17.7516 1454.59 Q14.696 1459.17 8.88587 1459.17 Q3.07572 1459.17 -0.00297114 1454.59 Q-3.05851 1449.98 -3.05851 1441.25 Q-3.05851 1432.5 -0.00297114 1427.92 Q3.07572 1423.31 8.88587 1423.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M39.0477 1427.02 Q35.4367 1427.02 33.608 1430.58 Q31.8024 1434.12 31.8024 1441.25 Q31.8024 1448.36 33.608 1451.93 Q35.4367 1455.47 39.0477 1455.47 Q42.682 1455.47 44.4875 1451.93 Q46.3162 1448.36 46.3162 1441.25 Q46.3162 1434.12 44.4875 1430.58 Q42.682 1427.02 39.0477 1427.02 M39.0477 1423.31 Q44.8579 1423.31 47.9134 1427.92 Q50.9921 1432.5 50.9921 1441.25 Q50.9921 1449.98 47.9134 1454.59 Q44.8579 1459.17 39.0477 1459.17 Q33.2376 1459.17 30.1589 1454.59 Q27.1034 1449.98 27.1034 1441.25 Q27.1034 1432.5 30.1589 1427.92 Q33.2376 1423.31 39.0477 1423.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-35.35 1177.11 Q-38.9611 1177.11 -40.7898 1180.67 Q-42.5953 1184.22 -42.5953 1191.35 Q-42.5953 1198.45 -40.7898 1202.02 Q-38.9611 1205.56 -35.35 1205.56 Q-31.7158 1205.56 -29.9102 1202.02 Q-28.0815 1198.45 -28.0815 1191.35 Q-28.0815 1184.22 -29.9102 1180.67 Q-31.7158 1177.11 -35.35 1177.11 M-35.35 1173.41 Q-29.5398 1173.41 -26.4843 1178.01 Q-23.4056 1182.6 -23.4056 1191.35 Q-23.4056 1200.07 -26.4843 1204.68 Q-29.5398 1209.26 -35.35 1209.26 Q-41.1602 1209.26 -44.2388 1204.68 Q-47.2944 1200.07 -47.2944 1191.35 Q-47.2944 1182.6 -44.2388 1178.01 Q-41.1602 1173.41 -35.35 1173.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-15.1881 1202.71 L-10.3038 1202.71 L-10.3038 1208.59 L-15.1881 1208.59 L-15.1881 1202.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M9.88124 1177.11 Q6.27014 1177.11 4.44145 1180.67 Q2.6359 1184.22 2.6359 1191.35 Q2.6359 1198.45 4.44145 1202.02 Q6.27014 1205.56 9.88124 1205.56 Q13.5155 1205.56 15.321 1202.02 Q17.1497 1198.45 17.1497 1191.35 Q17.1497 1184.22 15.321 1180.67 Q13.5155 1177.11 9.88124 1177.11 M9.88124 1173.41 Q15.6914 1173.41 18.7469 1178.01 Q21.8256 1182.6 21.8256 1191.35 Q21.8256 1200.07 18.7469 1204.68 Q15.6914 1209.26 9.88124 1209.26 Q4.07108 1209.26 0.992394 1204.68 Q-2.06315 1200.07 -2.06315 1191.35 Q-2.06315 1182.6 0.992394 1178.01 Q4.07108 1173.41 9.88124 1173.41 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M30.0895 1174.03 L48.4458 1174.03 L48.4458 1177.97 L34.3718 1177.97 L34.3718 1186.44 Q35.3904 1186.09 36.4089 1185.93 Q37.4274 1185.74 38.4459 1185.74 Q44.2329 1185.74 47.6125 1188.91 Q50.9921 1192.09 50.9921 1197.5 Q50.9921 1203.08 47.5199 1206.18 Q44.0477 1209.26 37.7283 1209.26 Q35.5524 1209.26 33.2839 1208.89 Q31.0385 1208.52 28.6311 1207.78 L28.6311 1203.08 Q30.7145 1204.22 32.9367 1204.77 Q35.1589 1205.33 37.6357 1205.33 Q41.6403 1205.33 43.9783 1203.22 Q46.3162 1201.11 46.3162 1197.5 Q46.3162 1193.89 43.9783 1191.79 Q41.6403 1189.68 37.6357 1189.68 Q35.7607 1189.68 33.8857 1190.1 Q32.0339 1190.51 30.0895 1191.39 L30.0895 1174.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-36.3454 927.201 Q-39.9565 927.201 -41.7852 930.765 Q-43.5907 934.307 -43.5907 941.437 Q-43.5907 948.543 -41.7852 952.108 Q-39.9565 955.649 -36.3454 955.649 Q-32.7111 955.649 -30.9056 952.108 Q-29.0769 948.543 -29.0769 941.437 Q-29.0769 934.307 -30.9056 930.765 Q-32.7111 927.201 -36.3454 927.201 M-36.3454 923.497 Q-30.5352 923.497 -27.4797 928.103 Q-24.401 932.687 -24.401 941.437 Q-24.401 950.163 -27.4797 954.77 Q-30.5352 959.353 -36.3454 959.353 Q-42.1555 959.353 -45.2342 954.77 Q-48.2897 950.163 -48.2897 941.437 Q-48.2897 932.687 -45.2342 928.103 Q-42.1555 923.497 -36.3454 923.497 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-16.1834 952.802 L-11.2992 952.802 L-11.2992 958.682 L-16.1834 958.682 L-16.1834 952.802 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-0.303895 954.747 L7.33495 954.747 L7.33495 928.381 L-0.975188 930.048 L-0.975188 925.789 L7.28866 924.122 L11.9646 924.122 L11.9646 954.747 L19.6034 954.747 L19.6034 958.682 L-0.303895 958.682 L-0.303895 954.747 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M39.0477 927.201 Q35.4367 927.201 33.608 930.765 Q31.8024 934.307 31.8024 941.437 Q31.8024 948.543 33.608 952.108 Q35.4367 955.649 39.0477 955.649 Q42.682 955.649 44.4875 952.108 Q46.3162 948.543 46.3162 941.437 Q46.3162 934.307 44.4875 930.765 Q42.682 927.201 39.0477 927.201 M39.0477 923.497 Q44.8579 923.497 47.9134 928.103 Q50.9921 932.687 50.9921 941.437 Q50.9921 950.163 47.9134 954.77 Q44.8579 959.353 39.0477 959.353 Q33.2376 959.353 30.1589 954.77 Q27.1034 950.163 27.1034 941.437 Q27.1034 932.687 30.1589 928.103 Q33.2376 923.497 39.0477 923.497 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-35.35 677.292 Q-38.9611 677.292 -40.7898 680.857 Q-42.5953 684.398 -42.5953 691.528 Q-42.5953 698.634 -40.7898 702.199 Q-38.9611 705.741 -35.35 705.741 Q-31.7158 705.741 -29.9102 702.199 Q-28.0815 698.634 -28.0815 691.528 Q-28.0815 684.398 -29.9102 680.857 Q-31.7158 677.292 -35.35 677.292 M-35.35 673.588 Q-29.5398 673.588 -26.4843 678.195 Q-23.4056 682.778 -23.4056 691.528 Q-23.4056 700.255 -26.4843 704.861 Q-29.5398 709.444 -35.35 709.444 Q-41.1602 709.444 -44.2388 704.861 Q-47.2944 700.255 -47.2944 691.528 Q-47.2944 682.778 -44.2388 678.195 Q-41.1602 673.588 -35.35 673.588 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-15.1881 702.894 L-10.3038 702.894 L-10.3038 708.773 L-15.1881 708.773 L-15.1881 702.894 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M0.69147 704.838 L8.33032 704.838 L8.33032 678.472 L0.0201769 680.139 L0.0201769 675.88 L8.28402 674.213 L12.9599 674.213 L12.9599 704.838 L20.5988 704.838 L20.5988 708.773 L0.69147 708.773 L0.69147 704.838 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M30.0895 674.213 L48.4458 674.213 L48.4458 678.148 L34.3718 678.148 L34.3718 686.62 Q35.3904 686.273 36.4089 686.111 Q37.4274 685.926 38.4459 685.926 Q44.2329 685.926 47.6125 689.097 Q50.9921 692.269 50.9921 697.685 Q50.9921 703.264 47.5199 706.366 Q44.0477 709.444 37.7283 709.444 Q35.5524 709.444 33.2839 709.074 Q31.0385 708.704 28.6311 707.963 L28.6311 703.264 Q30.7145 704.398 32.9367 704.954 Q35.1589 705.509 37.6357 705.509 Q41.6403 705.509 43.9783 703.403 Q46.3162 701.296 46.3162 697.685 Q46.3162 694.074 43.9783 691.968 Q41.6403 689.861 37.6357 689.861 Q35.7607 689.861 33.8857 690.278 Q32.0339 690.695 30.0895 691.574 L30.0895 674.213 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-36.3454 427.383 Q-39.9565 427.383 -41.7852 430.948 Q-43.5907 434.489 -43.5907 441.619 Q-43.5907 448.726 -41.7852 452.29 Q-39.9565 455.832 -36.3454 455.832 Q-32.7111 455.832 -30.9056 452.29 Q-29.0769 448.726 -29.0769 441.619 Q-29.0769 434.489 -30.9056 430.948 Q-32.7111 427.383 -36.3454 427.383 M-36.3454 423.679 Q-30.5352 423.679 -27.4797 428.286 Q-24.401 432.869 -24.401 441.619 Q-24.401 450.346 -27.4797 454.952 Q-30.5352 459.536 -36.3454 459.536 Q-42.1555 459.536 -45.2342 454.952 Q-48.2897 450.346 -48.2897 441.619 Q-48.2897 432.869 -45.2342 428.286 Q-42.1555 423.679 -36.3454 423.679 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-16.1834 452.985 L-11.2992 452.985 L-11.2992 458.864 L-16.1834 458.864 L-16.1834 452.985 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M2.91368 454.929 L19.233 454.929 L19.233 458.864 L-2.71129 458.864 L-2.71129 454.929 Q-0.0492672 452.175 4.53404 447.545 Q9.1405 442.892 10.321 441.55 Q12.5664 439.027 13.446 437.29 Q14.3488 435.531 14.3488 433.841 Q14.3488 431.087 12.4044 429.351 Q10.4831 427.615 7.38125 427.615 Q5.18219 427.615 2.7285 428.378 Q0.297953 429.142 -2.47981 430.693 L-2.47981 425.971 Q0.344249 424.837 2.79794 424.258 Q5.25163 423.679 7.28866 423.679 Q12.659 423.679 15.8534 426.365 Q19.0479 429.05 19.0479 433.54 Q19.0479 435.67 18.2377 437.591 Q17.4506 439.489 15.3442 442.082 Q14.7655 442.753 11.6636 445.971 Q8.5618 449.165 2.91368 454.929 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M39.0477 427.383 Q35.4367 427.383 33.608 430.948 Q31.8024 434.489 31.8024 441.619 Q31.8024 448.726 33.608 452.29 Q35.4367 455.832 39.0477 455.832 Q42.682 455.832 44.4875 452.29 Q46.3162 448.726 46.3162 441.619 Q46.3162 434.489 44.4875 430.948 Q42.682 427.383 39.0477 427.383 M39.0477 423.679 Q44.8579 423.679 47.9134 428.286 Q50.9921 432.869 50.9921 441.619 Q50.9921 450.346 47.9134 454.952 Q44.8579 459.536 39.0477 459.536 Q33.2376 459.536 30.1589 454.952 Q27.1034 450.346 27.1034 441.619 Q27.1034 432.869 30.1589 428.286 Q33.2376 423.679 39.0477 423.679 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-35.35 177.474 Q-38.9611 177.474 -40.7898 181.039 Q-42.5953 184.581 -42.5953 191.71 Q-42.5953 198.817 -40.7898 202.382 Q-38.9611 205.923 -35.35 205.923 Q-31.7158 205.923 -29.9102 202.382 Q-28.0815 198.817 -28.0815 191.71 Q-28.0815 184.581 -29.9102 181.039 Q-31.7158 177.474 -35.35 177.474 M-35.35 173.771 Q-29.5398 173.771 -26.4843 178.377 Q-23.4056 182.96 -23.4056 191.71 Q-23.4056 200.437 -26.4843 205.044 Q-29.5398 209.627 -35.35 209.627 Q-41.1602 209.627 -44.2388 205.044 Q-47.2944 200.437 -47.2944 191.71 Q-47.2944 182.96 -44.2388 178.377 Q-41.1602 173.771 -35.35 173.771 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M-15.1881 203.076 L-10.3038 203.076 L-10.3038 208.956 L-15.1881 208.956 L-15.1881 203.076 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M3.90904 205.02 L20.2284 205.02 L20.2284 208.956 L-1.71592 208.956 L-1.71592 205.02 Q0.946098 202.266 5.52941 197.636 Q10.1359 192.983 11.3164 191.641 Q13.5618 189.118 14.4414 187.382 Q15.3442 185.622 15.3442 183.933 Q15.3442 181.178 13.3997 179.442 Q11.4784 177.706 8.37661 177.706 Q6.17755 177.706 3.72386 178.47 Q1.29332 179.234 -1.48444 180.784 L-1.48444 176.062 Q1.33961 174.928 3.7933 174.349 Q6.247 173.771 8.28402 173.771 Q13.6544 173.771 16.8488 176.456 Q20.0432 179.141 20.0432 183.632 Q20.0432 185.761 19.233 187.683 Q18.446 189.581 16.3395 192.173 Q15.7608 192.845 12.659 196.062 Q9.55716 199.257 3.90904 205.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip260)" d="M30.0895 174.396 L48.4458 174.396 L48.4458 178.331 L34.3718 178.331 L34.3718 186.803 Q35.3904 186.456 36.4089 186.294 Q37.4274 186.109 38.4459 186.109 Q44.2329 186.109 47.6125 189.28 Q50.9921 192.451 50.9921 197.868 Q50.9921 203.446 47.5199 206.548 Q44.0477 209.627 37.7283 209.627 Q35.5524 209.627 33.2839 209.257 Q31.0385 208.886 28.6311 208.145 L28.6311 203.446 Q30.7145 204.581 32.9367 205.136 Q35.1589 205.692 37.6357 205.692 Q41.6403 205.692 43.9783 203.585 Q46.3162 201.479 46.3162 197.868 Q46.3162 194.257 43.9783 192.15 Q41.6403 190.044 37.6357 190.044 Q35.7607 190.044 33.8857 190.46 Q32.0339 190.877 30.0895 191.757 L30.0895 174.396 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip262)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,941.402 313.569,966.393 540.145,740.226 766.721,363.21 993.298,347.929 1219.87,88.5087 1446.45,297.354 1673.03,292.525 1899.6,329.455 2126.18,493.815 2352.76,272.465 "/>
<polyline clip-path="url(#clip262)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1441.22 313.569,1400.91 540.145,1374.76 766.721,1430.06 993.298,1390.56 1219.87,1464 1446.45,1431.22 1673.03,1437.91 1899.6,1458.76 2126.18,1397.88 2352.76,1409.85 "/>
<path clip-path="url(#clip260)" d="M162.518 251.365 L412.288 251.365 L412.288 95.8446 L162.518 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip260)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,251.365 412.288,251.365 412.288,95.8446 162.518,95.8446 162.518,251.365 "/>
<polyline clip-path="url(#clip260)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,147.685 338.744,147.685 "/>
<path clip-path="url(#clip260)" d="M377.322 151.932 Q372.16 151.932 370.169 153.113 Q368.178 154.293 368.178 157.141 Q368.178 159.409 369.66 160.752 Q371.164 162.071 373.734 162.071 Q377.275 162.071 379.405 159.571 Q381.558 157.048 381.558 152.881 L381.558 151.932 L377.322 151.932 M385.817 150.173 L385.817 164.965 L381.558 164.965 L381.558 161.029 Q380.099 163.391 377.923 164.525 Q375.747 165.636 372.599 165.636 Q368.618 165.636 366.257 163.414 Q363.919 161.168 363.919 157.418 Q363.919 153.043 366.835 150.821 Q369.775 148.599 375.585 148.599 L381.558 148.599 L381.558 148.182 Q381.558 145.243 379.613 143.645 Q377.692 142.025 374.197 142.025 Q371.974 142.025 369.868 142.557 Q367.761 143.09 365.817 144.155 L365.817 140.219 Q368.155 139.317 370.354 138.877 Q372.553 138.414 374.636 138.414 Q380.261 138.414 383.039 141.33 Q385.817 144.247 385.817 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip260)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,199.525 338.744,199.525 "/>
<path clip-path="url(#clip260)" d="M382.692 203.865 Q382.692 199.166 380.747 196.504 Q378.826 193.819 375.447 193.819 Q372.067 193.819 370.122 196.504 Q368.201 199.166 368.201 203.865 Q368.201 208.564 370.122 211.249 Q372.067 213.911 375.447 213.911 Q378.826 213.911 380.747 211.249 Q382.692 208.564 382.692 203.865 M368.201 194.814 Q369.544 192.499 371.581 191.388 Q373.641 190.254 376.488 190.254 Q381.21 190.254 384.15 194.004 Q387.113 197.754 387.113 203.865 Q387.113 209.976 384.15 213.726 Q381.21 217.476 376.488 217.476 Q373.641 217.476 371.581 216.365 Q369.544 215.231 368.201 212.916 L368.201 216.805 L363.919 216.805 L363.919 180.786 L368.201 180.786 L368.201 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>To construct an IRF we can take the model and perturb just the first element of the noise,</p><pre><code class="language-julia hljs">function irf(A, B, C, T = 20)
    noise = Matrix([1.0; zeros(T-1)]&#39;)
    problem = LinearStateSpaceProblem(A, B, zeros(2), (0, T); C, noise, syms = [:a, :b])
    return solve(problem)
end
plot(irf(A, B, C))</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip320">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip320)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip321">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip320)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip322">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="653.433,1505.26 653.433,47.2441 "/>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1505.26 1219.87,47.2441 "/>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1786.31,1505.26 1786.31,47.2441 "/>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="653.433,1505.26 653.433,1486.36 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1505.26 1219.87,1486.36 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1786.31,1505.26 1786.31,1486.36 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip320)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M643.711 1533.1 L662.067 1533.1 L662.067 1537.04 L647.993 1537.04 L647.993 1545.51 Q649.012 1545.16 650.03 1545 Q651.049 1544.81 652.067 1544.81 Q657.854 1544.81 661.234 1547.98 Q664.614 1551.16 664.614 1556.57 Q664.614 1562.15 661.141 1565.25 Q657.669 1568.33 651.35 1568.33 Q649.174 1568.33 646.905 1567.96 Q644.66 1567.59 642.253 1566.85 L642.253 1562.15 Q644.336 1563.28 646.558 1563.84 Q648.78 1564.4 651.257 1564.4 Q655.262 1564.4 657.6 1562.29 Q659.938 1560.18 659.938 1556.57 Q659.938 1552.96 657.6 1550.85 Q655.262 1548.75 651.257 1548.75 Q649.382 1548.75 647.507 1549.16 Q645.655 1549.58 643.711 1550.46 L643.711 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M1194.56 1563.72 L1202.2 1563.72 L1202.2 1537.36 L1193.89 1539.03 L1193.89 1534.77 L1202.15 1533.1 L1206.83 1533.1 L1206.83 1563.72 L1214.47 1563.72 L1214.47 1567.66 L1194.56 1567.66 L1194.56 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M1233.91 1536.18 Q1230.3 1536.18 1228.47 1539.74 Q1226.67 1543.28 1226.67 1550.41 Q1226.67 1557.52 1228.47 1561.09 Q1230.3 1564.63 1233.91 1564.63 Q1237.55 1564.63 1239.35 1561.09 Q1241.18 1557.52 1241.18 1550.41 Q1241.18 1543.28 1239.35 1539.74 Q1237.55 1536.18 1233.91 1536.18 M1233.91 1532.47 Q1239.72 1532.47 1242.78 1537.08 Q1245.86 1541.66 1245.86 1550.41 Q1245.86 1559.14 1242.78 1563.75 Q1239.72 1568.33 1233.91 1568.33 Q1228.1 1568.33 1225.02 1563.75 Q1221.97 1559.14 1221.97 1550.41 Q1221.97 1541.66 1225.02 1537.08 Q1228.1 1532.47 1233.91 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M1761.5 1563.72 L1769.14 1563.72 L1769.14 1537.36 L1760.83 1539.03 L1760.83 1534.77 L1769.09 1533.1 L1773.77 1533.1 L1773.77 1563.72 L1781.41 1563.72 L1781.41 1567.66 L1761.5 1567.66 L1761.5 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M1790.9 1533.1 L1809.25 1533.1 L1809.25 1537.04 L1795.18 1537.04 L1795.18 1545.51 Q1796.2 1545.16 1797.22 1545 Q1798.24 1544.81 1799.25 1544.81 Q1805.04 1544.81 1808.42 1547.98 Q1811.8 1551.16 1811.8 1556.57 Q1811.8 1562.15 1808.33 1565.25 Q1804.86 1568.33 1798.54 1568.33 Q1796.36 1568.33 1794.09 1567.96 Q1791.85 1567.59 1789.44 1566.85 L1789.44 1562.15 Q1791.52 1563.28 1793.75 1563.84 Q1795.97 1564.4 1798.44 1564.4 Q1802.45 1564.4 1804.79 1562.29 Q1807.13 1560.18 1807.13 1556.57 Q1807.13 1552.96 1804.79 1550.85 Q1802.45 1548.75 1798.44 1548.75 Q1796.57 1548.75 1794.69 1549.16 Q1792.84 1549.58 1790.9 1550.46 L1790.9 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M2331.53 1563.72 L2347.85 1563.72 L2347.85 1567.66 L2325.9 1567.66 L2325.9 1563.72 Q2328.57 1560.97 2333.15 1556.34 Q2337.76 1551.69 2338.94 1550.35 Q2341.18 1547.82 2342.06 1546.09 Q2342.96 1544.33 2342.96 1542.64 Q2342.96 1539.88 2341.02 1538.15 Q2339.1 1536.41 2336 1536.41 Q2333.8 1536.41 2331.34 1537.17 Q2328.91 1537.94 2326.14 1539.49 L2326.14 1534.77 Q2328.96 1533.63 2331.41 1533.05 Q2333.87 1532.47 2335.9 1532.47 Q2341.27 1532.47 2344.47 1535.16 Q2347.66 1537.85 2347.66 1542.34 Q2347.66 1544.47 2346.85 1546.39 Q2346.07 1548.28 2343.96 1550.88 Q2343.38 1551.55 2340.28 1554.77 Q2337.18 1557.96 2331.53 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M2367.66 1536.18 Q2364.05 1536.18 2362.22 1539.74 Q2360.42 1543.28 2360.42 1550.41 Q2360.42 1557.52 2362.22 1561.09 Q2364.05 1564.63 2367.66 1564.63 Q2371.3 1564.63 2373.1 1561.09 Q2374.93 1557.52 2374.93 1550.41 Q2374.93 1543.28 2373.1 1539.74 Q2371.3 1536.18 2367.66 1536.18 M2367.66 1532.47 Q2373.47 1532.47 2376.53 1537.08 Q2379.61 1541.66 2379.61 1550.41 Q2379.61 1559.14 2376.53 1563.75 Q2373.47 1568.33 2367.66 1568.33 Q2361.85 1568.33 2358.77 1563.75 Q2355.72 1559.14 2355.72 1550.41 Q2355.72 1541.66 2358.77 1537.08 Q2361.85 1532.47 2367.66 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1078.16 2352.76,1078.16 "/>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,692.334 2352.76,692.334 "/>
<polyline clip-path="url(#clip322)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,306.503 2352.76,306.503 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1078.16 105.89,1078.16 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,692.334 105.89,692.334 "/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,306.503 105.89,306.503 "/>
<path clip-path="url(#clip320)" d="M-36.3454 1449.79 Q-39.9565 1449.79 -41.7852 1453.36 Q-43.5907 1456.9 -43.5907 1464.03 Q-43.5907 1471.14 -41.7852 1474.7 Q-39.9565 1478.24 -36.3454 1478.24 Q-32.7111 1478.24 -30.9056 1474.7 Q-29.0769 1471.14 -29.0769 1464.03 Q-29.0769 1456.9 -30.9056 1453.36 Q-32.7111 1449.79 -36.3454 1449.79 M-36.3454 1446.09 Q-30.5352 1446.09 -27.4797 1450.7 Q-24.401 1455.28 -24.401 1464.03 Q-24.401 1472.76 -27.4797 1477.36 Q-30.5352 1481.95 -36.3454 1481.95 Q-42.1555 1481.95 -45.2342 1477.36 Q-48.2897 1472.76 -48.2897 1464.03 Q-48.2897 1455.28 -45.2342 1450.7 Q-42.1555 1446.09 -36.3454 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M-16.1834 1475.4 L-11.2992 1475.4 L-11.2992 1481.28 L-16.1834 1481.28 L-16.1834 1475.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M8.88587 1449.79 Q5.27478 1449.79 3.44608 1453.36 Q1.64054 1456.9 1.64054 1464.03 Q1.64054 1471.14 3.44608 1474.7 Q5.27478 1478.24 8.88587 1478.24 Q12.5201 1478.24 14.3257 1474.7 Q16.1543 1471.14 16.1543 1464.03 Q16.1543 1456.9 14.3257 1453.36 Q12.5201 1449.79 8.88587 1449.79 M8.88587 1446.09 Q14.696 1446.09 17.7516 1450.7 Q20.8303 1455.28 20.8303 1464.03 Q20.8303 1472.76 17.7516 1477.36 Q14.696 1481.95 8.88587 1481.95 Q3.07572 1481.95 -0.00297114 1477.36 Q-3.05851 1472.76 -3.05851 1464.03 Q-3.05851 1455.28 -0.00297114 1450.7 Q3.07572 1446.09 8.88587 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M-34.7482 1063.96 Q-38.3592 1063.96 -40.1879 1067.53 Q-41.9935 1071.07 -41.9935 1078.2 Q-41.9935 1085.31 -40.1879 1088.87 Q-38.3592 1092.41 -34.7482 1092.41 Q-31.1139 1092.41 -29.3084 1088.87 Q-27.4797 1085.31 -27.4797 1078.2 Q-27.4797 1071.07 -29.3084 1067.53 Q-31.1139 1063.96 -34.7482 1063.96 M-34.7482 1060.26 Q-28.938 1060.26 -25.8825 1064.87 Q-22.8038 1069.45 -22.8038 1078.2 Q-22.8038 1086.93 -25.8825 1091.53 Q-28.938 1096.12 -34.7482 1096.12 Q-40.5583 1096.12 -43.637 1091.53 Q-46.6925 1086.93 -46.6925 1078.2 Q-46.6925 1069.45 -43.637 1064.87 Q-40.5583 1060.26 -34.7482 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M-14.5862 1089.56 L-9.70199 1089.56 L-9.70199 1095.44 L-14.5862 1095.44 L-14.5862 1089.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M10.4831 1063.96 Q6.87199 1063.96 5.0433 1067.53 Q3.23775 1071.07 3.23775 1078.2 Q3.23775 1085.31 5.0433 1088.87 Q6.87199 1092.41 10.4831 1092.41 Q14.1173 1092.41 15.9229 1088.87 Q17.7516 1085.31 17.7516 1078.2 Q17.7516 1071.07 15.9229 1067.53 Q14.1173 1063.96 10.4831 1063.96 M10.4831 1060.26 Q16.2932 1060.26 19.3488 1064.87 Q22.4275 1069.45 22.4275 1078.2 Q22.4275 1086.93 19.3488 1091.53 Q16.2932 1096.12 10.4831 1096.12 Q4.67293 1096.12 1.59424 1091.53 Q-1.4613 1086.93 -1.4613 1078.2 Q-1.4613 1069.45 1.59424 1064.87 Q4.67293 1060.26 10.4831 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M34.6728 1091.51 L50.9921 1091.51 L50.9921 1095.44 L29.0478 1095.44 L29.0478 1091.51 Q31.7098 1088.75 36.2931 1084.13 Q40.8996 1079.47 42.0801 1078.13 Q44.3255 1075.61 45.2051 1073.87 Q46.1079 1072.11 46.1079 1070.42 Q46.1079 1067.67 44.1635 1065.93 Q42.2422 1064.19 39.1403 1064.19 Q36.9413 1064.19 34.4876 1064.96 Q32.057 1065.72 29.2793 1067.27 L29.2793 1062.55 Q32.1033 1061.42 34.557 1060.84 Q37.0107 1060.26 39.0477 1060.26 Q44.4181 1060.26 47.6125 1062.94 Q50.8069 1065.63 50.8069 1070.12 Q50.8069 1072.25 49.9968 1074.17 Q49.2097 1076.07 47.1033 1078.66 Q46.5246 1079.33 43.4227 1082.55 Q40.3209 1085.75 34.6728 1091.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M-36.8315 678.132 Q-40.4426 678.132 -42.2713 681.697 Q-44.0768 685.239 -44.0768 692.369 Q-44.0768 699.475 -42.2713 703.04 Q-40.4426 706.581 -36.8315 706.581 Q-33.1972 706.581 -31.3917 703.04 Q-29.563 699.475 -29.563 692.369 Q-29.563 685.239 -31.3917 681.697 Q-33.1972 678.132 -36.8315 678.132 M-36.8315 674.429 Q-31.0213 674.429 -27.9658 679.035 Q-24.8871 683.619 -24.8871 692.369 Q-24.8871 701.095 -27.9658 705.702 Q-31.0213 710.285 -36.8315 710.285 Q-42.6416 710.285 -45.7203 705.702 Q-48.7759 701.095 -48.7759 692.369 Q-48.7759 683.619 -45.7203 679.035 Q-42.6416 674.429 -36.8315 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M-16.6695 703.734 L-11.7853 703.734 L-11.7853 709.614 L-16.6695 709.614 L-16.6695 703.734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M8.39976 678.132 Q4.78867 678.132 2.95998 681.697 Q1.15443 685.239 1.15443 692.369 Q1.15443 699.475 2.95998 703.04 Q4.78867 706.581 8.39976 706.581 Q12.034 706.581 13.8395 703.04 Q15.6682 699.475 15.6682 692.369 Q15.6682 685.239 13.8395 681.697 Q12.034 678.132 8.39976 678.132 M8.39976 674.429 Q14.2099 674.429 17.2655 679.035 Q20.3441 683.619 20.3441 692.369 Q20.3441 701.095 17.2655 705.702 Q14.2099 710.285 8.39976 710.285 Q2.58961 710.285 -0.48908 705.702 Q-3.54462 701.095 -3.54462 692.369 Q-3.54462 683.619 -0.48908 679.035 Q2.58961 674.429 8.39976 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M41.4088 679.128 L29.6034 697.577 L41.4088 697.577 L41.4088 679.128 M40.182 675.054 L46.0616 675.054 L46.0616 697.577 L50.9921 697.577 L50.9921 701.466 L46.0616 701.466 L46.0616 709.614 L41.4088 709.614 L41.4088 701.466 L25.8071 701.466 L25.8071 696.952 L40.182 675.054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M-36.5074 292.302 Q-40.1185 292.302 -41.9472 295.867 Q-43.7527 299.408 -43.7527 306.538 Q-43.7527 313.644 -41.9472 317.209 Q-40.1185 320.751 -36.5074 320.751 Q-32.8732 320.751 -31.0676 317.209 Q-29.2389 313.644 -29.2389 306.538 Q-29.2389 299.408 -31.0676 295.867 Q-32.8732 292.302 -36.5074 292.302 M-36.5074 288.598 Q-30.6973 288.598 -27.6417 293.205 Q-24.563 297.788 -24.563 306.538 Q-24.563 315.265 -27.6417 319.871 Q-30.6973 324.454 -36.5074 324.454 Q-42.3176 324.454 -45.3962 319.871 Q-48.4518 315.265 -48.4518 306.538 Q-48.4518 297.788 -45.3962 293.205 Q-42.3176 288.598 -36.5074 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M-16.3455 317.903 L-11.4612 317.903 L-11.4612 323.783 L-16.3455 323.783 L-16.3455 317.903 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M8.72383 292.302 Q5.11274 292.302 3.28405 295.867 Q1.4785 299.408 1.4785 306.538 Q1.4785 313.644 3.28405 317.209 Q5.11274 320.751 8.72383 320.751 Q12.3581 320.751 14.1636 317.209 Q15.9923 313.644 15.9923 306.538 Q15.9923 299.408 14.1636 295.867 Q12.3581 292.302 8.72383 292.302 M8.72383 288.598 Q14.534 288.598 17.5895 293.205 Q20.6682 297.788 20.6682 306.538 Q20.6682 315.265 17.5895 319.871 Q14.534 324.454 8.72383 324.454 Q2.91368 324.454 -0.165007 319.871 Q-3.22055 315.265 -3.22055 306.538 Q-3.22055 297.788 -0.165007 293.205 Q2.91368 288.598 8.72383 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip320)" d="M39.4644 304.64 Q36.3163 304.64 34.4644 306.792 Q32.6357 308.945 32.6357 312.695 Q32.6357 316.422 34.4644 318.598 Q36.3163 320.751 39.4644 320.751 Q42.6125 320.751 44.4412 318.598 Q46.2931 316.422 46.2931 312.695 Q46.2931 308.945 44.4412 306.792 Q42.6125 304.64 39.4644 304.64 M48.7468 289.987 L48.7468 294.246 Q46.9875 293.413 45.182 292.973 Q43.3996 292.533 41.6403 292.533 Q37.0107 292.533 34.557 295.658 Q32.1265 298.783 31.7793 305.103 Q33.145 303.089 35.2052 302.024 Q37.2653 300.936 39.7422 300.936 Q44.9505 300.936 47.9597 304.107 Q50.9921 307.255 50.9921 312.695 Q50.9921 318.019 47.844 321.237 Q44.6959 324.454 39.4644 324.454 Q33.4691 324.454 30.2978 319.871 Q27.1265 315.265 27.1265 306.538 Q27.1265 298.343 31.0154 293.482 Q34.9042 288.598 41.4551 288.598 Q43.2144 288.598 44.9968 288.945 Q46.8023 289.292 48.7468 289.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip322)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1464 313.569,267.92 426.857,88.5087 540.145,109.44 653.433,167.599 766.721,230.505 880.009,291.797 993.298,350.33 1106.59,405.998 1219.87,458.895 1333.16,509.149 1446.45,556.892 1559.74,602.247 1673.03,645.334 1786.31,686.267 1899.6,725.154 2012.89,762.096 2126.18,797.191 2239.47,830.531 2352.76,862.204 "/>
<polyline clip-path="url(#clip322)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1271.08 313.569,1425.41 426.857,1456.28 540.145,1462.45 653.433,1463.69 766.721,1463.93 880.009,1463.98 993.298,1463.99 1106.59,1463.99 1219.87,1464 1333.16,1464 1446.45,1464 1559.74,1464 1673.03,1464 1786.31,1464 1899.6,1464 2012.89,1464 2126.18,1464 2239.47,1464 2352.76,1464 "/>
<path clip-path="url(#clip320)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip320)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip320)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip320)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip320)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip320)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>Lets find the 2nd observable at the end of the IRF.</p><pre><code class="language-julia hljs">function last_observable_irf(A, B, C)
    sol = irf(A, B, C)
    return sol.z[end][2]  # return 2nd argument of last observable
end
last_observable_irf(A, B, C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.03119456447624772</code></pre><p>But everything in this package is differentiable.  Lets differentiate the observable of the IRF with respect to all of the parameters using <code>Zygote.jl</code>,</p><pre><code class="language-julia hljs">gradient(last_observable_irf, A, B, C)  # calculates gradient wrt all arguments</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.5822985368900442 0.0050313813671367304; 4.469834483178462 0.041592752634585235], [0.37735360253530714; 3.119456447624773;;], [0.0 0.0; 0.03119456447624772 5.242880000000006e-16])</code></pre><p>Gradients of other model elements (e.g. <code>.u</code> are also possible.  With this in mind, lets find the gradient of the mean of the 1st element of the IRF of the solution with respect to a particular noise vector.</p><pre><code class="language-julia hljs">function mean_u_1(A, B, C, noise, u0, T)
    problem = LinearStateSpaceProblem(A, B, u0, (0, T); noise, syms = [:a, :b])
    sol = solve(problem)
    u = sol.u # see issue #75 workaround
    # can have nontrivial functions and even non-mutating loops
    return mean( u[i][1] for i in 1:T)
end
u0 = [0.0, 0.0]
noise = sol.W # from simulation above
mean_u_1(A, B, C, noise, u0, T)
# dropping a few arguments from derivative
gradient((noise, u0)-&gt; mean_u_1(A, B, C, noise, u0, T), noise, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.05079876954953124 0.045314515146875 … 0.0 0.0], [0.702526121523242, 5.600882710405467])</code></pre><h2 id="Simulating-Ensembles-and-Fixing-Noise"><a class="docs-heading-anchor" href="#Simulating-Ensembles-and-Fixing-Noise">Simulating Ensembles and Fixing Noise</a><a id="Simulating-Ensembles-and-Fixing-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Ensembles-and-Fixing-Noise" title="Permalink"></a></h2><p>If you pass in a distribution for the initial condition, it will draw an initial condition.  Below we will simulate from a deterministic evolution equation and without any observation noise.</p><pre><code class="language-julia hljs">using Distributions, DiffEqBase
u0 = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = LinearStateSpaceProblem(A, nothing, u0, (0, T); C)
sol = solve(prob)
plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip380">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip380)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip381">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip380)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip382">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip380)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1071.18 2352.76,1071.18 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,678.363 2352.76,678.363 "/>
<polyline clip-path="url(#clip382)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,285.547 2352.76,285.547 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1071.18 105.89,1071.18 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,678.363 105.89,678.363 "/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,285.547 105.89,285.547 "/>
<path clip-path="url(#clip380)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M30.0895 1053.9 L48.4458 1053.9 L48.4458 1057.83 L34.3718 1057.83 L34.3718 1066.31 Q35.3904 1065.96 36.4089 1065.8 Q37.4274 1065.61 38.4459 1065.61 Q44.2329 1065.61 47.6125 1068.78 Q50.9921 1071.95 50.9921 1077.37 Q50.9921 1082.95 47.5199 1086.05 Q44.0477 1089.13 37.7283 1089.13 Q35.5524 1089.13 33.2839 1088.76 Q31.0385 1088.39 28.6311 1087.65 L28.6311 1082.95 Q30.7145 1084.08 32.9367 1084.64 Q35.1589 1085.2 37.6357 1085.2 Q41.6403 1085.2 43.9783 1083.09 Q46.3162 1080.98 46.3162 1077.37 Q46.3162 1073.76 43.9783 1071.65 Q41.6403 1069.55 37.6357 1069.55 Q35.7607 1069.55 33.8857 1069.96 Q32.0339 1070.38 30.0895 1071.26 L30.0895 1053.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M-0.303895 691.708 L7.33495 691.708 L7.33495 665.343 L-0.975188 667.009 L-0.975188 662.75 L7.28866 661.083 L11.9646 661.083 L11.9646 691.708 L19.6034 691.708 L19.6034 695.643 L-0.303895 695.643 L-0.303895 691.708 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M39.0477 664.162 Q35.4367 664.162 33.608 667.727 Q31.8024 671.268 31.8024 678.398 Q31.8024 685.504 33.608 689.069 Q35.4367 692.611 39.0477 692.611 Q42.682 692.611 44.4875 689.069 Q46.3162 685.504 46.3162 678.398 Q46.3162 671.268 44.4875 667.727 Q42.682 664.162 39.0477 664.162 M39.0477 660.458 Q44.8579 660.458 47.9134 665.065 Q50.9921 669.648 50.9921 678.398 Q50.9921 687.125 47.9134 691.731 Q44.8579 696.315 39.0477 696.315 Q33.2376 696.315 30.1589 691.731 Q27.1034 687.125 27.1034 678.398 Q27.1034 669.648 30.1589 665.065 Q33.2376 660.458 39.0477 660.458 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M0.69147 298.892 L8.33032 298.892 L8.33032 272.527 L0.0201769 274.193 L0.0201769 269.934 L8.28402 268.267 L12.9599 268.267 L12.9599 298.892 L20.5988 298.892 L20.5988 302.827 L0.69147 302.827 L0.69147 298.892 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M30.0895 268.267 L48.4458 268.267 L48.4458 272.203 L34.3718 272.203 L34.3718 280.675 Q35.3904 280.327 36.4089 280.165 Q37.4274 279.98 38.4459 279.98 Q44.2329 279.98 47.6125 283.152 Q50.9921 286.323 50.9921 291.739 Q50.9921 297.318 47.5199 300.42 Q44.0477 303.499 37.7283 303.499 Q35.5524 303.499 33.2839 303.128 Q31.0385 302.758 28.6311 302.017 L28.6311 297.318 Q30.7145 298.452 32.9367 299.008 Q35.1589 299.563 37.6357 299.563 Q41.6403 299.563 43.9783 297.457 Q46.3162 295.351 46.3162 291.739 Q46.3162 288.128 43.9783 286.022 Q41.6403 283.915 37.6357 283.915 Q35.7607 283.915 33.8857 284.332 Q32.0339 284.749 30.0895 285.628 L30.0895 268.267 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip382)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1441.27 313.569,264.166 540.145,88.5087 766.721,110.153 993.298,168.419 1219.87,231.313 1446.45,292.57 1673.03,351.066 1899.6,406.697 2126.18,459.559 2352.76,509.78 "/>
<polyline clip-path="url(#clip382)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1273.96 313.569,1425.99 540.145,1456.39 766.721,1462.47 993.298,1463.69 1219.87,1463.93 1446.45,1463.98 1673.03,1463.99 1899.6,1463.99 2126.18,1464 2352.76,1464 "/>
<path clip-path="url(#clip380)" d="M1942.97 251.365 L2277.23 251.365 L2277.23 95.8446 L1942.97 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip380)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1942.97,251.365 2277.23,251.365 2277.23,95.8446 1942.97,95.8446 1942.97,251.365 "/>
<polyline clip-path="url(#clip380)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,147.685 2119.2,147.685 "/>
<path clip-path="url(#clip380)" d="M2144.37 154.733 L2144.37 139.039 L2148.63 139.039 L2148.63 154.571 Q2148.63 158.252 2150.07 160.104 Q2151.5 161.932 2154.37 161.932 Q2157.82 161.932 2159.81 159.733 Q2161.82 157.534 2161.82 153.738 L2161.82 139.039 L2166.08 139.039 L2166.08 164.965 L2161.82 164.965 L2161.82 160.983 Q2160.27 163.344 2158.21 164.502 Q2156.18 165.636 2153.47 165.636 Q2149 165.636 2146.69 162.858 Q2144.37 160.08 2144.37 154.733 M2155.09 138.414 L2155.09 138.414 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2176.27 161.029 L2183.91 161.029 L2183.91 134.664 L2175.6 136.331 L2175.6 132.071 L2183.86 130.405 L2188.54 130.405 L2188.54 161.029 L2196.18 161.029 L2196.18 164.965 L2176.27 164.965 L2176.27 161.029 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2215.25 128.993 Q2212.15 134.317 2210.64 139.525 Q2209.14 144.733 2209.14 150.08 Q2209.14 155.428 2210.64 160.682 Q2212.17 165.914 2215.25 171.215 L2211.55 171.215 Q2208.07 165.775 2206.34 160.52 Q2204.62 155.266 2204.62 150.08 Q2204.62 144.918 2206.34 139.687 Q2208.05 134.456 2211.55 128.993 L2215.25 128.993 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2227.73 131.678 L2227.73 139.039 L2236.5 139.039 L2236.5 142.349 L2227.73 142.349 L2227.73 156.423 Q2227.73 159.594 2228.58 160.497 Q2229.46 161.4 2232.12 161.4 L2236.5 161.4 L2236.5 164.965 L2232.12 164.965 Q2227.19 164.965 2225.32 163.136 Q2223.44 161.284 2223.44 156.423 L2223.44 142.349 L2220.32 142.349 L2220.32 139.039 L2223.44 139.039 L2223.44 131.678 L2227.73 131.678 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2241.43 128.993 L2245.13 128.993 Q2248.61 134.456 2250.32 139.687 Q2252.06 144.918 2252.06 150.08 Q2252.06 155.266 2250.32 160.52 Q2248.61 165.775 2245.13 171.215 L2241.43 171.215 Q2244.51 165.914 2246.01 160.682 Q2247.54 155.428 2247.54 150.08 Q2247.54 144.733 2246.01 139.525 Q2244.51 134.317 2241.43 128.993 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip380)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,199.525 2119.2,199.525 "/>
<path clip-path="url(#clip380)" d="M2144.37 206.573 L2144.37 190.879 L2148.63 190.879 L2148.63 206.411 Q2148.63 210.092 2150.07 211.944 Q2151.5 213.772 2154.37 213.772 Q2157.82 213.772 2159.81 211.573 Q2161.82 209.374 2161.82 205.578 L2161.82 190.879 L2166.08 190.879 L2166.08 216.805 L2161.82 216.805 L2161.82 212.823 Q2160.27 215.184 2158.21 216.342 Q2156.18 217.476 2153.47 217.476 Q2149 217.476 2146.69 214.698 Q2144.37 211.92 2144.37 206.573 M2155.09 190.254 L2155.09 190.254 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2179.49 212.869 L2195.81 212.869 L2195.81 216.805 L2173.86 216.805 L2173.86 212.869 Q2176.52 210.115 2181.11 205.485 Q2185.71 200.832 2186.89 199.49 Q2189.14 196.967 2190.02 195.231 Q2190.92 193.471 2190.92 191.782 Q2190.92 189.027 2188.98 187.291 Q2187.06 185.555 2183.95 185.555 Q2181.75 185.555 2179.3 186.319 Q2176.87 187.083 2174.09 188.633 L2174.09 183.911 Q2176.92 182.777 2179.37 182.198 Q2181.82 181.62 2183.86 181.62 Q2189.23 181.62 2192.43 184.305 Q2195.62 186.99 2195.62 191.481 Q2195.62 193.61 2194.81 195.532 Q2194.02 197.43 2191.92 200.022 Q2191.34 200.694 2188.24 203.911 Q2185.13 207.106 2179.49 212.869 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2215.25 180.833 Q2212.15 186.157 2210.64 191.365 Q2209.14 196.573 2209.14 201.92 Q2209.14 207.268 2210.64 212.522 Q2212.17 217.754 2215.25 223.055 L2211.55 223.055 Q2208.07 217.615 2206.34 212.36 Q2204.62 207.106 2204.62 201.92 Q2204.62 196.758 2206.34 191.527 Q2208.05 186.296 2211.55 180.833 L2215.25 180.833 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2227.73 183.518 L2227.73 190.879 L2236.5 190.879 L2236.5 194.189 L2227.73 194.189 L2227.73 208.263 Q2227.73 211.434 2228.58 212.337 Q2229.46 213.24 2232.12 213.24 L2236.5 213.24 L2236.5 216.805 L2232.12 216.805 Q2227.19 216.805 2225.32 214.976 Q2223.44 213.124 2223.44 208.263 L2223.44 194.189 L2220.32 194.189 L2220.32 190.879 L2223.44 190.879 L2223.44 183.518 L2227.73 183.518 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip380)" d="M2241.43 180.833 L2245.13 180.833 Q2248.61 186.296 2250.32 191.527 Q2252.06 196.758 2252.06 201.92 Q2252.06 207.106 2250.32 212.36 Q2248.61 217.615 2245.13 223.055 L2241.43 223.055 Q2244.51 217.754 2246.01 212.522 Q2247.54 207.268 2247.54 201.92 Q2247.54 196.573 2246.01 191.365 Q2244.51 186.157 2241.43 180.833 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>With this, we can simulate an ensemble of solutions from different initial conditions (and we will turn back on the noise).  The <code>EnsembleSummary</code> calculates a set of quantiles by default.</p><pre><code class="language-julia hljs">T = 10
trajectories = 50
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C)
sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(sol)  #calculate summarize statistics from the
plot(summ)  # shows quantiles by default</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip440">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip440)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip441">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip440)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip442">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="685.496,1521.01 685.496,47.2441 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1521.01 1219.87,47.2441 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1754.25,1521.01 1754.25,47.2441 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="685.496,1521.01 685.496,1502.11 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1521.01 1219.87,1502.11 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.25,1521.01 1754.25,1502.11 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip440)" d="M128.502 1551.93 Q124.891 1551.93 123.062 1555.49 Q121.257 1559.03 121.257 1566.16 Q121.257 1573.27 123.062 1576.83 Q124.891 1580.38 128.502 1580.38 Q132.136 1580.38 133.942 1576.83 Q135.77 1573.27 135.77 1566.16 Q135.77 1559.03 133.942 1555.49 Q132.136 1551.93 128.502 1551.93 M128.502 1548.22 Q134.312 1548.22 137.368 1552.83 Q140.446 1557.41 140.446 1566.16 Q140.446 1574.89 137.368 1579.5 Q134.312 1584.08 128.502 1584.08 Q122.692 1584.08 119.613 1579.5 Q116.558 1574.89 116.558 1566.16 Q116.558 1557.41 119.613 1552.83 Q122.692 1548.22 128.502 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M148.664 1577.53 L153.548 1577.53 L153.548 1583.41 L148.664 1583.41 L148.664 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M173.733 1551.93 Q170.122 1551.93 168.293 1555.49 Q166.488 1559.03 166.488 1566.16 Q166.488 1573.27 168.293 1576.83 Q170.122 1580.38 173.733 1580.38 Q177.367 1580.38 179.173 1576.83 Q181.002 1573.27 181.002 1566.16 Q181.002 1559.03 179.173 1555.49 Q177.367 1551.93 173.733 1551.93 M173.733 1548.22 Q179.543 1548.22 182.599 1552.83 Q185.678 1557.41 185.678 1566.16 Q185.678 1574.89 182.599 1579.5 Q179.543 1584.08 173.733 1584.08 Q167.923 1584.08 164.844 1579.5 Q161.789 1574.89 161.789 1566.16 Q161.789 1557.41 164.844 1552.83 Q167.923 1548.22 173.733 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M657.232 1579.47 L673.551 1579.47 L673.551 1583.41 L651.607 1583.41 L651.607 1579.47 Q654.269 1576.72 658.852 1572.09 Q663.459 1567.44 664.639 1566.09 Q666.885 1563.57 667.764 1561.83 Q668.667 1560.07 668.667 1558.38 Q668.667 1555.63 666.723 1553.89 Q664.801 1552.16 661.7 1552.16 Q659.501 1552.16 657.047 1552.92 Q654.616 1553.69 651.839 1555.24 L651.839 1550.51 Q654.663 1549.38 657.116 1548.8 Q659.57 1548.22 661.607 1548.22 Q666.977 1548.22 670.172 1550.91 Q673.366 1553.59 673.366 1558.08 Q673.366 1560.21 672.556 1562.13 Q671.769 1564.03 669.663 1566.63 Q669.084 1567.3 665.982 1570.51 Q662.88 1573.71 657.232 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M683.366 1577.53 L688.25 1577.53 L688.25 1583.41 L683.366 1583.41 L683.366 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M698.482 1548.85 L716.838 1548.85 L716.838 1552.78 L702.764 1552.78 L702.764 1561.26 Q703.783 1560.91 704.801 1560.75 Q705.82 1560.56 706.838 1560.56 Q712.625 1560.56 716.005 1563.73 Q719.384 1566.9 719.384 1572.32 Q719.384 1577.9 715.912 1581 Q712.44 1584.08 706.121 1584.08 Q703.945 1584.08 701.676 1583.71 Q699.431 1583.34 697.023 1582.6 L697.023 1577.9 Q699.107 1579.03 701.329 1579.59 Q703.551 1580.14 706.028 1580.14 Q710.033 1580.14 712.371 1578.04 Q714.709 1575.93 714.709 1572.32 Q714.709 1568.71 712.371 1566.6 Q710.033 1564.5 706.028 1564.5 Q704.153 1564.5 702.278 1564.91 Q700.426 1565.33 698.482 1566.21 L698.482 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1187.04 1548.85 L1205.39 1548.85 L1205.39 1552.78 L1191.32 1552.78 L1191.32 1561.26 Q1192.34 1560.91 1193.36 1560.75 Q1194.38 1560.56 1195.39 1560.56 Q1201.18 1560.56 1204.56 1563.73 Q1207.94 1566.9 1207.94 1572.32 Q1207.94 1577.9 1204.47 1581 Q1201 1584.08 1194.68 1584.08 Q1192.5 1584.08 1190.23 1583.71 Q1187.99 1583.34 1185.58 1582.6 L1185.58 1577.9 Q1187.66 1579.03 1189.89 1579.59 Q1192.11 1580.14 1194.58 1580.14 Q1198.59 1580.14 1200.93 1578.04 Q1203.27 1575.93 1203.27 1572.32 Q1203.27 1568.71 1200.93 1566.6 Q1198.59 1564.5 1194.58 1564.5 Q1192.71 1564.5 1190.83 1564.91 Q1188.98 1565.33 1187.04 1566.21 L1187.04 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1217.15 1577.53 L1222.04 1577.53 L1222.04 1583.41 L1217.15 1583.41 L1217.15 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1242.22 1551.93 Q1238.61 1551.93 1236.78 1555.49 Q1234.98 1559.03 1234.98 1566.16 Q1234.98 1573.27 1236.78 1576.83 Q1238.61 1580.38 1242.22 1580.38 Q1245.86 1580.38 1247.66 1576.83 Q1249.49 1573.27 1249.49 1566.16 Q1249.49 1559.03 1247.66 1555.49 Q1245.86 1551.93 1242.22 1551.93 M1242.22 1548.22 Q1248.03 1548.22 1251.09 1552.83 Q1254.17 1557.41 1254.17 1566.16 Q1254.17 1574.89 1251.09 1579.5 Q1248.03 1584.08 1242.22 1584.08 Q1236.41 1584.08 1233.33 1579.5 Q1230.28 1574.89 1230.28 1566.16 Q1230.28 1557.41 1233.33 1552.83 Q1236.41 1548.22 1242.22 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1720.57 1548.85 L1742.79 1548.85 L1742.79 1550.84 L1730.25 1583.41 L1725.36 1583.41 L1737.17 1552.78 L1720.57 1552.78 L1720.57 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1751.91 1577.53 L1756.8 1577.53 L1756.8 1583.41 L1751.91 1583.41 L1751.91 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M1767.03 1548.85 L1785.39 1548.85 L1785.39 1552.78 L1771.31 1552.78 L1771.31 1561.26 Q1772.33 1560.91 1773.35 1560.75 Q1774.37 1560.56 1775.39 1560.56 Q1781.17 1560.56 1784.55 1563.73 Q1787.93 1566.9 1787.93 1572.32 Q1787.93 1577.9 1784.46 1581 Q1780.99 1584.08 1774.67 1584.08 Q1772.49 1584.08 1770.22 1583.71 Q1767.98 1583.34 1765.57 1582.6 L1765.57 1577.9 Q1767.65 1579.03 1769.88 1579.59 Q1772.1 1580.14 1774.58 1580.14 Q1778.58 1580.14 1780.92 1578.04 Q1783.26 1575.93 1783.26 1572.32 Q1783.26 1568.71 1780.92 1566.6 Q1778.58 1564.5 1774.58 1564.5 Q1772.7 1564.5 1770.83 1564.91 Q1768.97 1565.33 1767.03 1566.21 L1767.03 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M2240.7 1579.47 L2248.34 1579.47 L2248.34 1553.11 L2240.03 1554.77 L2240.03 1550.51 L2248.3 1548.85 L2252.97 1548.85 L2252.97 1579.47 L2260.61 1579.47 L2260.61 1583.41 L2240.7 1583.41 L2240.7 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M2280.05 1551.93 Q2276.44 1551.93 2274.61 1555.49 Q2272.81 1559.03 2272.81 1566.16 Q2272.81 1573.27 2274.61 1576.83 Q2276.44 1580.38 2280.05 1580.38 Q2283.69 1580.38 2285.49 1576.83 Q2287.32 1573.27 2287.32 1566.16 Q2287.32 1559.03 2285.49 1555.49 Q2283.69 1551.93 2280.05 1551.93 M2280.05 1548.22 Q2285.86 1548.22 2288.92 1552.83 Q2292 1557.41 2292 1566.16 Q2292 1574.89 2288.92 1579.5 Q2285.86 1584.08 2280.05 1584.08 Q2274.24 1584.08 2271.17 1579.5 Q2268.11 1574.89 2268.11 1566.16 Q2268.11 1557.41 2271.17 1552.83 Q2274.24 1548.22 2280.05 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M2300.22 1577.53 L2305.1 1577.53 L2305.1 1583.41 L2300.22 1583.41 L2300.22 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M2325.29 1551.93 Q2321.67 1551.93 2319.85 1555.49 Q2318.04 1559.03 2318.04 1566.16 Q2318.04 1573.27 2319.85 1576.83 Q2321.67 1580.38 2325.29 1580.38 Q2328.92 1580.38 2330.73 1576.83 Q2332.55 1573.27 2332.55 1566.16 Q2332.55 1559.03 2330.73 1555.49 Q2328.92 1551.93 2325.29 1551.93 M2325.29 1548.22 Q2331.1 1548.22 2334.15 1552.83 Q2337.23 1557.41 2337.23 1566.16 Q2337.23 1574.89 2334.15 1579.5 Q2331.1 1584.08 2325.29 1584.08 Q2319.48 1584.08 2316.4 1579.5 Q2313.34 1574.89 2313.34 1566.16 Q2313.34 1557.41 2316.4 1552.83 Q2319.48 1548.22 2325.29 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1463.45 2352.76,1463.45 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1168.93 2352.76,1168.93 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,874.405 2352.76,874.405 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,579.883 2352.76,579.883 "/>
<polyline clip-path="url(#clip442)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,285.36 2352.76,285.36 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1463.45 105.89,1463.45 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1168.93 105.89,1168.93 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,874.405 105.89,874.405 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,579.883 105.89,579.883 "/>
<polyline clip-path="url(#clip440)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,285.36 105.89,285.36 "/>
<path clip-path="url(#clip440)" d="M-40.8824 1463.9 L-11.2066 1463.9 L-11.2066 1467.84 L-40.8824 1467.84 L-40.8824 1463.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-0.303895 1476.8 L7.33495 1476.8 L7.33495 1450.43 L-0.975188 1452.1 L-0.975188 1447.84 L7.28866 1446.17 L11.9646 1446.17 L11.9646 1476.8 L19.6034 1476.8 L19.6034 1480.73 L-0.303895 1480.73 L-0.303895 1476.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M39.0477 1449.25 Q35.4367 1449.25 33.608 1452.81 Q31.8024 1456.36 31.8024 1463.49 Q31.8024 1470.59 33.608 1474.16 Q35.4367 1477.7 39.0477 1477.7 Q42.682 1477.7 44.4875 1474.16 Q46.3162 1470.59 46.3162 1463.49 Q46.3162 1456.36 44.4875 1452.81 Q42.682 1449.25 39.0477 1449.25 M39.0477 1445.55 Q44.8579 1445.55 47.9134 1450.15 Q50.9921 1454.74 50.9921 1463.49 Q50.9921 1472.21 47.9134 1476.82 Q44.8579 1481.4 39.0477 1481.4 Q33.2376 1481.4 30.1589 1476.82 Q27.1034 1472.21 27.1034 1463.49 Q27.1034 1454.74 30.1589 1450.15 Q33.2376 1445.55 39.0477 1445.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-9.72514 1169.38 L19.9506 1169.38 L19.9506 1173.31 L-9.72514 1173.31 L-9.72514 1169.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M30.0895 1151.65 L48.4458 1151.65 L48.4458 1155.58 L34.3718 1155.58 L34.3718 1164.06 Q35.3904 1163.71 36.4089 1163.55 Q37.4274 1163.36 38.4459 1163.36 Q44.2329 1163.36 47.6125 1166.53 Q50.9921 1169.7 50.9921 1175.12 Q50.9921 1180.7 47.5199 1183.8 Q44.0477 1186.88 37.7283 1186.88 Q35.5524 1186.88 33.2839 1186.51 Q31.0385 1186.14 28.6311 1185.4 L28.6311 1180.7 Q30.7145 1181.83 32.9367 1182.39 Q35.1589 1182.94 37.6357 1182.94 Q41.6403 1182.94 43.9783 1180.84 Q46.3162 1178.73 46.3162 1175.12 Q46.3162 1171.51 43.9783 1169.4 Q41.6403 1167.3 37.6357 1167.3 Q35.7607 1167.3 33.8857 1167.71 Q32.0339 1168.13 30.0895 1169.01 L30.0895 1151.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M39.0477 860.204 Q35.4367 860.204 33.608 863.769 Q31.8024 867.31 31.8024 874.44 Q31.8024 881.547 33.608 885.111 Q35.4367 888.653 39.0477 888.653 Q42.682 888.653 44.4875 885.111 Q46.3162 881.547 46.3162 874.44 Q46.3162 867.31 44.4875 863.769 Q42.682 860.204 39.0477 860.204 M39.0477 856.5 Q44.8579 856.5 47.9134 861.107 Q50.9921 865.69 50.9921 874.44 Q50.9921 883.167 47.9134 887.773 Q44.8579 892.357 39.0477 892.357 Q33.2376 892.357 30.1589 887.773 Q27.1034 883.167 27.1034 874.44 Q27.1034 865.69 30.1589 861.107 Q33.2376 856.5 39.0477 856.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M30.0895 562.603 L48.4458 562.603 L48.4458 566.538 L34.3718 566.538 L34.3718 575.01 Q35.3904 574.663 36.4089 574.501 Q37.4274 574.316 38.4459 574.316 Q44.2329 574.316 47.6125 577.487 Q50.9921 580.658 50.9921 586.075 Q50.9921 591.654 47.5199 594.755 Q44.0477 597.834 37.7283 597.834 Q35.5524 597.834 33.2839 597.464 Q31.0385 597.093 28.6311 596.353 L28.6311 591.654 Q30.7145 592.788 32.9367 593.343 Q35.1589 593.899 37.6357 593.899 Q41.6403 593.899 43.9783 591.792 Q46.3162 589.686 46.3162 586.075 Q46.3162 582.464 43.9783 580.357 Q41.6403 578.251 37.6357 578.251 Q35.7607 578.251 33.8857 578.668 Q32.0339 579.084 30.0895 579.964 L30.0895 562.603 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M-0.303895 298.705 L7.33495 298.705 L7.33495 272.339 L-0.975188 274.006 L-0.975188 269.747 L7.28866 268.08 L11.9646 268.08 L11.9646 298.705 L19.6034 298.705 L19.6034 302.64 L-0.303895 302.64 L-0.303895 298.705 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip440)" d="M39.0477 271.159 Q35.4367 271.159 33.608 274.724 Q31.8024 278.265 31.8024 285.395 Q31.8024 292.501 33.608 296.066 Q35.4367 299.608 39.0477 299.608 Q42.682 299.608 44.4875 296.066 Q46.3162 292.501 46.3162 285.395 Q46.3162 278.265 44.4875 274.724 Q42.682 271.159 39.0477 271.159 M39.0477 267.455 Q44.8579 267.455 47.9134 272.062 Q50.9921 276.645 50.9921 285.395 Q50.9921 294.122 47.9134 298.728 Q44.8579 303.312 39.0477 303.312 Q33.2376 303.312 30.1589 298.728 Q27.1034 294.122 27.1034 285.395 Q27.1034 276.645 30.1589 272.062 Q33.2376 267.455 39.0477 267.455 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip442)" d="M151.118 951.775 L364.869 1408.18 L578.62 1479.3 L792.371 1467.23 L1006.12 1441.86 L1219.87 1415.93 L1433.63 1389.17 L1647.38 1359.11 L1861.13 1332.9 L2074.88 1310.33 L2288.63 1289.23 L2288.63 326.871 L2074.88 304.098 L1861.13 276.226 L1647.38 248.109 L1433.63 215.72 L1219.87 180.435 L1006.12 143.729 L792.371 111.045 L578.62 88.9544 L364.869 175.558 L151.118 782.538  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip442)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,874.7 364.869,819.833 578.62,816.903 792.371,817.547 1006.12,818.49 1219.87,821.088 1433.63,823.629 1647.38,825.126 1861.13,828.972 2074.88,832.377 2288.63,840.221 "/>
<path clip-path="url(#clip442)" d="M151.118 952.13 L364.869 890.181 L578.62 877.999 L792.371 875.909 L1006.12 875.314 L1219.87 875.525 L1433.63 875.296 L1647.38 875.632 L1861.13 875.286 L2074.88 875.251 L2288.63 875.527 L2288.63 873.771 L2074.88 873.449 L1861.13 873.369 L1647.38 873.497 L1433.63 873.653 L1219.87 873.6 L1006.12 873.698 L792.371 872.83 L578.62 870.744 L364.869 853.97 L151.118 770.059  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip442)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,862.657 364.869,872.193 578.62,874.051 792.371,874.138 1006.12,874.44 1219.87,874.522 1433.63,874.308 1647.38,874.495 1861.13,874.426 2074.88,874.527 2288.63,874.45 "/>
</svg>
<h2 id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><a class="docs-heading-anchor" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter">Observables and Marginal Likelihood using a Kalman Filter</a><a id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter" title="Permalink"></a></h2><p>If you provide <code>observables</code> and provide a distribution for the <code>observables_noise</code> then the model can provide a calculation of the likelihood.  </p><p>The simplest case is if you use a gaussian prior and have gaussian observation noise.  First, lets simulate some data with included observation noise.  If passing in a matrix or vector, the <code>observables_noise</code> argument is intended to be the cholesky of the covariance matrix.  At this point, only diagonal observation noise is allowed.</p><pre><code class="language-julia hljs">u0 = MvNormal([1.0 0.1; 0.1 1.0])  # draw from mean zero initial conditions
T = 10
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)
sol.z # simulated observables with observation noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [0.5424541245537482, 1.9688475373481338]
 [0.034503941105918506, 0.8565462806016431]
 [-0.12922102755207884, 0.869328591819818]
 [0.04660403152354072, 0.4019957771427478]
 [0.24148062886240051, -0.23297750751051519]
 [0.45592539547273964, -0.1280929553260417]
 [-0.12821428706389398, -0.12395510783946806]
 [-0.5943998087347266, 0.4366282785289433]
 [-0.14834899087479306, -0.028245227554260788]
 [0.19723191121594708, 0.21300147860117485]
 [-0.03428496717015998, 0.3115901406080907]</code></pre><p>Next we will find the log likelihood of these simulated observables using the <code>u0</code> as a prior and with the true parameters.</p><p>The new arguments we pass to the problem creation are <code>u0_prior_variance, u0_prior_mean,</code> and <code>observables</code>.  The <code>u0</code> is ignored for the filtering problem but must match the size.  The <code>KalmanFilter()</code> argument to the <code>solve</code> is unnecessary since it can select it manually given the priors and observables.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The timing convention is such that <code>observables</code> are expected to match the predictions starting at the second time period.  As the likelihood of the first element <code>u0</code> comes from a prior, the <code>observables</code> start at the next element, and hence the observables and noise sequences should be 1 less than the tspan </p></div></div><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = copy(sol.W) # save for later
u0_prior_mean = [0.0, 0.0]
# use covariance of distribution we drew from
u0_prior_var = cov(u0)

prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
sol = solve(prob, KalmanFilter())
# plot(sol) The `u` is the sequence of posterior means.
sol.logpdf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-9.161862463737306</code></pre><p>Hence the <code>logpdf</code> provides the log likelihood marginalizing out the latent noise variables.</p><p>As before, we can differentiate the kalman filter itself.</p><pre><code class="language-julia hljs">function kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
# Find the gradient wrt the A, B, C and priors variance.
gradient((A, B, C, u0_prior_var) -&gt; kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables), A, B, C, u0_prior_var)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-11.246547620588562 -0.09515139000079888; -97.9623766477159 0.5782131918400242], [3.946184575381589; 37.477113192483145;;], [-0.6721247854312082 -0.008498305114059912; -0.00823761841880355 -0.03130658346887216], [0.27045426808874107 -10.896676610267836; 10.699688937466535 -0.4753524235380411])</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some of the gradients, such as those for <code>observables</code>, have not been implemented so test carefully.  This is a general theme with gradients and <code>Zygote.jl</code> in general.  Your best friend in this process is the spectacular <a href="https://github.com/JuliaDiff/ChainRulesTestUtils.jl">ChainRulesTestUtils.jl</a> package. See <code>test_rrule</code> usage in the <a href="https://github.com/SciML/DifferenceEquations.jl/blob/main/test/linear_gradients.jl">linear unit tests</a>.</p></div></div><h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>A key application of these methods is to find the joint likelihood of the latent variables (i.e., the <code>noise</code>) and the model definition.</p><p>The actual calculation of the likelihood is trivial in that case, and just requires iteration of the linear system while accumulating the likelihood given the observation noise.</p><p>Crucially, the differentiability with respect to the high-dimensional noise vector enables gradient-based sampling and estimation methods which would otherwise be infeasible.</p><pre><code class="language-julia hljs">function joint_likelihood(A, B, C, D, u0, noise, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood(A, B, C, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-11.033205491947758</code></pre><p>And as always, this can be differentiated with respect to the state-space matrices and the noise.  Choosing a few parameters,</p><pre><code class="language-julia hljs">gradient((A, u0, noise) -&gt; joint_likelihood(A, B, C, D, u0, noise, observables), A, u0, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-6.355183453733578 -0.36305403094285643; -41.05471575518344 -1.4316761593221408], [28.015292501527714, 214.17779879228647], [1.567057649642121 1.005853910664753 … 0.3208126843473916 -0.0008507543751924872])</code></pre><h2 id="Composition-of-State-Space-Models-and-AD"><a class="docs-heading-anchor" href="#Composition-of-State-Space-Models-and-AD">Composition of State Space Models and AD</a><a id="Composition-of-State-Space-Models-and-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-of-State-Space-Models-and-AD" title="Permalink"></a></h2><p>While the above gradients have been with respect to the full state space objects <code>A, B</code>, etc. those themselves could be generated through a separate procedure and the whole object differentiated.  For example, lets repeat the above examples where we generate the <code>A</code> matrix from some sort of deep parameters.</p><p>First we will generate some observations with a <code>generate_model</code> proxy–-which could be replaced with something more complicated but still differentiable</p><pre><code class="language-julia hljs">function generate_model(β)
    A = [β 6.2;
        0.0  0.2]
    B = Matrix([0.0  0.001]&#39;) # [0.0; 0.001;;] gives a zygote bug
    C = [0.09 0.67;
        1.00 0.00]
    D = [0.01, 0.01]
    return (;A,B,C,D)
end

function simulate_model(β, u0;T = 200)
    mod = generate_model(β)
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, T); mod.C, observables_noise = mod.D)
    sol = solve(prob) # simulates
    observables = hcat(sol.z...)
    observables = observables[:, 2:end] # see note above on likelihood and timing
    return observables, sol.W
end

# Fix a &quot;pseudo-true&quot; and generate noise and observables
β = 0.95
u0 = [0.0, 0.0]
observables, noise = simulate_model(β, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.09551300963978497 0.04794531202618687 … 0.13316470203992362 0.06108088842829237; -0.012503879613751987 0.11106430003293724 … 0.026128790040127203 -0.002783919364158331], [-0.12059749177157239 -1.0899022100039233 … -0.9417630636922736 -0.9066135068220109])</code></pre><p>Next, we will evaluate the marginal likelihood using the kalman filter for a particular <code>β</code> value,</p><pre><code class="language-julia hljs">function kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
u0_prior_mean = [0.0, 0.0]
u0_prior_var = [1e-10 0.0;
                0.0 1e-10]  # starting with degenerate prior
kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">368.71968744229184</code></pre><p>Given the observation error we would not expect the pseudo-true to exactly maximimize the log likelihood.  To show this, we can optimize it using using the Optim package and using a gradient-based optimization routine</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimJL
# Create a function to minimize only of β and use Zygote based gradients
kalman_objective(β,p) = -kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
kalman_objective(0.95, nothing)
gradient(β -&gt;kalman_objective(β, nothing),β) # Verifying it can be differentiated


optf = OptimizationFunction(kalman_objective, Optimization.AutoZygote())
β0 = [0.91] # start off of the pseudotrue
optprob = OptimizationProblem(optf, β0)
optsol = solve(optprob,LBFGS())  # reverse-mode AD is overkill here</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 1-element Vector{Float64}:
 0.23613101508208326</code></pre><p>In this way, this package composes with others such as <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">DifferentiableStateSpaceModels.jl</a> which take a set of structural parameters and an expectational difference equation and generate a state-space model.</p><p>Similarly, we can find the joint likelihood for a particular <code>β</code> value and noise.  Here we will add in prior.  Some form of a prior or regularization is generally necessary for these sorts of nonlinear models.</p><pre><code class="language-julia hljs">function joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, noise)
    return solve(prob).logpdf + sum(logpdf.(noise_prior, noise)) + logpdf(β_prior, β) # posterior
end
u0 = [0.0, 0.0]
noise_prior = Normal(0.0, 1.0)
β_prior = Normal(β, 0.03) # prior local to the true value
joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">85.46999582147947</code></pre><p>Which we can turn into a differntiable objective adding in a prior on the noise</p><pre><code class="language-julia hljs">joint_model_objective(x, p) = -joint_model_posterior(x[1], u0, Matrix(x[2:end]&#39;), observables, noise_prior, β_prior) # extract noise and parameeter from vector
x0 = vcat([0.95], noise[1,:])  # starting at the true noise
joint_model_objective(x0, nothing)
gradient(x -&gt;joint_model_objective(x, nothing),x0) # Verifying it can be differentiated

# optimize
optf = OptimizationFunction(joint_model_objective, Optimization.AutoZygote())
optprob = OptimizationProblem(optf, x0)
optsol = solve(optprob,LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 201-element Vector{Float64}:
  0.9570410503903555
  0.06279463182271501
 -0.021365957999346114
 -0.0673933076114305
 -0.09800733810758179
 -0.049000359942853074
 -0.011987282798767
  0.047325664946205846
  0.0707539064747933
  0.1954921756332912
  ⋮
 -0.025977055030077148
 -0.0003999389843698554
 -0.03194999413007
 -0.008941286998039774
  0.02106726183240816
  0.008688944148020713
  0.030965129812754445
  0.008480369891561711
  0.004064054130949096</code></pre><p>This &quot;solves&quot; the problem relatively quickly, despite the high-dimensionality.  However, from a statistics perspective note that this last optimization process does not do especially well in recovering the pseudotrue if you increase the prior variance on the <code>β</code> parameter.  Maximizing the posterior is usually the wrong thing to do in high-dimensions because the mode is not a typical set.</p><h2 id="Caveats-on-Gradients-and-Performance"><a class="docs-heading-anchor" href="#Caveats-on-Gradients-and-Performance">Caveats on Gradients and Performance</a><a id="Caveats-on-Gradients-and-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Caveats-on-Gradients-and-Performance" title="Permalink"></a></h2><p>A few notes on performance and gradients:</p><ol><li>As this is using reverse-mode AD it will be efficient for fairly large systems as long as the ultimate value of your differentiable program.  With a little extra work and unit tests, it could support structured matrices/etc. as well.</li><li>Getting to much higher scales, where the <code>A,B,C,D</code> are so large that matrix-free operators is necessary, is feasible but will require generalizing those to LinearOperators.  This would be reasonably easy for the joint likelihood and feasible but possible for the Kalman filter</li><li>At this point, there is no support for forward-mode auto-differentiation.  For smaller systems with a kalman filter, this should dominate the alternatives, and efficient forward-mode AD rules for the kalman filter exist (see the supplementary materials in the the <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">Differentiable State Space Models</a> paper).  However, it would be a significant amount of work to add end-to-end support and fulfill standard SciML interfaces, and perhaps waiting for <a href="https://enzyme.mit.edu/julia/">Enzyme</a> or similar AD systems that provide both forward/reverse/mixed mode makes sense.</li><li>Forward-mode AD is likely inappropriate for the joint-likelihood based models since the dimensionality of the noise is always large.</li><li>The gradient rules are written using <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules.jl</a> so in theory they will work with any supporting AD.  In practice, though, Zygote is the most tested and other systems have inconsistent support on Julia at this time.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a><a class="docs-footer-nextpage" href="../quadratic_state_space_examples/">Quadratic State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 19:19">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
