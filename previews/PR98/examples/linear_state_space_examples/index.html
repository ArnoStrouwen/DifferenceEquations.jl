<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/linear_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Linear State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Linear (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Simulating-Ensembles-and-Fixing-Noise"><span>Simulating Ensembles and Fixing Noise</span></a></li><li><a class="tocitem" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><span>Observables and Marginal Likelihood using a Kalman Filter</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li><li><a class="tocitem" href="#Composition-of-State-Space-Models-and-AD"><span>Composition of State Space Models and AD</span></a></li><li><a class="tocitem" href="#Caveats-on-Gradients-and-Performance"><span>Caveats on Gradients and Performance</span></a></li></ul></li><li><a class="tocitem" href="../quadratic_state_space_examples/">Quadratic State Space Examples</a></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Linear State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/linear_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-State-Space-Examples"><a class="docs-heading-anchor" href="#Linear-State-Space-Examples">Linear State Space Examples</a><a id="Linear-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-State-Space-Examples" title="Permalink"></a></h1><p>This tutorial provides describes the support for linear and linear gaussian state space models.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form of the linear model is</p><p class="math-container">\[u_{n+1} = A u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.  More generally, support could be added for <span>$u_{n+1} = A(p,n) u_n + B(p,n) w_{n+1}$</span> where <span>$p$</span> is a vector of differentiable parameters, and the <span>$A$</span> and <span>$B$</span> are potentially matrix-free operators.</p><h2 id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model">Simulating a Linear (and Time-Invariant) State Space Model</a><a id="Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Linear-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>LinearStateSpaceProblem</code> and simulating it for a simple, linear equation.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote
A = [0.95 6.2;
     0.0  0.2]
B = [0.0; 0.01;;] # matrix
C = [0.09 0.67;
     1.00 0.00]
D = [0.1, 0.1] # diagonal observation noise
u0 = zeros(2)
T = 10

prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:10
u: 11-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [0.0, -0.015038358336405485]
 [-0.09323782168571401, -0.02277311430716039]
 [-0.22976923930582274, -0.0031291731034932936]
 [-0.23768165058219, -0.0019047108149866793]
 [-0.2376067751059979, -0.003954069609440034]
 [-0.2502416679292262, -0.015199289704528864]
 [-0.33196518070084385, 0.010146088863136457]
 [-0.25246117071435564, -0.004691881672840332]
 [-0.2689277785502479, 0.008933682923073328]
 [-0.20009255549968083, -0.0054079502098192895]</code></pre><p>The <code>u</code> vector of the simulated solution can be plotted using standard recipes, including use of the optional <code>syms</code>.  See <a href="https://diffeq.sciml.ai/latest/basics/plot/">SciML docs</a> for more options.</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip840">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip840)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip841">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip840)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip842">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip840)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1335.48 2352.76,1335.48 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,933.418 2352.76,933.418 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,531.36 2352.76,531.36 "/>
<polyline clip-path="url(#clip842)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,129.302 2352.76,129.302 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1335.48 105.89,1335.48 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,933.418 105.89,933.418 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,531.36 105.89,531.36 "/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,129.302 105.89,129.302 "/>
<path clip-path="url(#clip840)" d="M-55.3036 1335.93 L-25.6278 1335.93 L-25.6278 1339.86 L-55.3036 1339.86 L-55.3036 1335.93 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-5.53535 1321.28 Q-9.14644 1321.28 -10.9751 1324.84 Q-12.7807 1328.38 -12.7807 1335.51 Q-12.7807 1342.62 -10.9751 1346.18 Q-9.14644 1349.72 -5.53535 1349.72 Q-1.90111 1349.72 -0.0955632 1346.18 Q1.73313 1342.62 1.73313 1335.51 Q1.73313 1328.38 -0.0955632 1324.84 Q-1.90111 1321.28 -5.53535 1321.28 M-5.53535 1317.57 Q0.274805 1317.57 3.33034 1322.18 Q6.40903 1326.76 6.40903 1335.51 Q6.40903 1344.24 3.33034 1348.84 Q0.274805 1353.43 -5.53535 1353.43 Q-11.3455 1353.43 -14.4242 1348.84 Q-17.4797 1344.24 -17.4797 1335.51 Q-17.4797 1326.76 -14.4242 1322.18 Q-11.3455 1317.57 -5.53535 1317.57 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M14.6266 1346.88 L19.5108 1346.88 L19.5108 1352.76 L14.6266 1352.76 L14.6266 1346.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M43.8625 1334.12 Q47.219 1334.84 49.094 1337.11 Q50.9921 1339.38 50.9921 1342.71 Q50.9921 1347.83 47.4736 1350.63 Q43.9551 1353.43 37.4737 1353.43 Q35.2978 1353.43 32.983 1352.99 Q30.6913 1352.57 28.2376 1351.71 L28.2376 1347.2 Q30.1821 1348.34 32.4969 1348.91 Q34.8117 1349.49 37.3348 1349.49 Q41.7329 1349.49 44.0246 1347.76 Q46.3394 1346.02 46.3394 1342.71 Q46.3394 1339.65 44.1866 1337.94 Q42.057 1336.21 38.2376 1336.21 L34.2098 1336.21 L34.2098 1332.36 L38.4227 1332.36 Q41.8718 1332.36 43.7005 1331 Q45.5292 1329.61 45.5292 1327.02 Q45.5292 1324.35 43.6311 1322.94 Q41.7561 1321.51 38.2376 1321.51 Q36.3163 1321.51 34.1172 1321.92 Q31.9182 1322.34 29.2793 1323.22 L29.2793 1319.05 Q31.9413 1318.31 34.2561 1317.94 Q36.5941 1317.57 38.6542 1317.57 Q43.9783 1317.57 47.0801 1320 Q50.1819 1322.41 50.1819 1326.53 Q50.1819 1329.4 48.5384 1331.39 Q46.8949 1333.36 43.8625 1334.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-54.3545 933.87 L-24.6788 933.87 L-24.6788 937.805 L-54.3545 937.805 L-54.3545 933.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-4.58628 919.217 Q-8.19737 919.217 -10.0261 922.782 Q-11.8316 926.323 -11.8316 933.453 Q-11.8316 940.56 -10.0261 944.124 Q-8.19737 947.666 -4.58628 947.666 Q-0.95204 947.666 0.853506 944.124 Q2.6822 940.56 2.6822 933.453 Q2.6822 926.323 0.853506 922.782 Q-0.95204 919.217 -4.58628 919.217 M-4.58628 915.513 Q1.22387 915.513 4.27941 920.12 Q7.3581 924.703 7.3581 933.453 Q7.3581 942.18 4.27941 946.786 Q1.22387 951.37 -4.58628 951.37 Q-10.3964 951.37 -13.4751 946.786 Q-16.5307 942.18 -16.5307 933.453 Q-16.5307 924.703 -13.4751 920.12 Q-10.3964 915.513 -4.58628 915.513 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M15.5756 944.819 L20.4599 944.819 L20.4599 950.698 L15.5756 950.698 L15.5756 944.819 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M34.6728 946.763 L50.9921 946.763 L50.9921 950.698 L29.0478 950.698 L29.0478 946.763 Q31.7098 944.009 36.2931 939.379 Q40.8996 934.726 42.0801 933.384 Q44.3255 930.861 45.2051 929.124 Q46.1079 927.365 46.1079 925.675 Q46.1079 922.921 44.1635 921.185 Q42.2422 919.449 39.1403 919.449 Q36.9413 919.449 34.4876 920.212 Q32.057 920.976 29.2793 922.527 L29.2793 917.805 Q32.1033 916.671 34.557 916.092 Q37.0107 915.513 39.0477 915.513 Q44.4181 915.513 47.6125 918.199 Q50.8069 920.884 50.8069 925.374 Q50.8069 927.504 49.9968 929.425 Q49.2097 931.323 47.1033 933.916 Q46.5246 934.587 43.4227 937.805 Q40.3209 940.999 34.6728 946.763 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-54.7249 531.812 L-25.0491 531.812 L-25.0491 535.747 L-54.7249 535.747 L-54.7249 531.812 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-4.95665 517.159 Q-8.56774 517.159 -10.3964 520.724 Q-12.202 524.265 -12.202 531.395 Q-12.202 538.501 -10.3964 542.066 Q-8.56774 545.608 -4.95665 545.608 Q-1.32241 545.608 0.483137 542.066 Q2.31183 538.501 2.31183 531.395 Q2.31183 524.265 0.483137 520.724 Q-1.32241 517.159 -4.95665 517.159 M-4.95665 513.455 Q0.853506 513.455 3.90904 518.062 Q6.98773 522.645 6.98773 531.395 Q6.98773 540.122 3.90904 544.728 Q0.853506 549.311 -4.95665 549.311 Q-10.7668 549.311 -13.8455 544.728 Q-16.901 540.122 -16.901 531.395 Q-16.901 522.645 -13.8455 518.062 Q-10.7668 513.455 -4.95665 513.455 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M15.2053 542.761 L20.0895 542.761 L20.0895 548.64 L15.2053 548.64 L15.2053 542.761 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M31.0848 544.705 L38.7237 544.705 L38.7237 518.339 L30.4135 520.006 L30.4135 515.747 L38.6774 514.08 L43.3533 514.08 L43.3533 544.705 L50.9921 544.705 L50.9921 548.64 L31.0848 548.64 L31.0848 544.705 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M-6.18349 115.101 Q-9.79459 115.101 -11.6233 118.665 Q-13.4288 122.207 -13.4288 129.337 Q-13.4288 136.443 -11.6233 140.008 Q-9.79459 143.549 -6.18349 143.549 Q-2.54925 143.549 -0.743708 140.008 Q1.08499 136.443 1.08499 129.337 Q1.08499 122.207 -0.743708 118.665 Q-2.54925 115.101 -6.18349 115.101 M-6.18349 111.397 Q-0.37334 111.397 2.6822 116.003 Q5.76089 120.587 5.76089 129.337 Q5.76089 138.063 2.6822 142.67 Q-0.37334 147.253 -6.18349 147.253 Q-11.9936 147.253 -15.0723 142.67 Q-18.1279 138.063 -18.1279 129.337 Q-18.1279 120.587 -15.0723 116.003 Q-11.9936 111.397 -6.18349 111.397 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M13.9784 140.702 L18.8627 140.702 L18.8627 146.582 L13.9784 146.582 L13.9784 140.702 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip840)" d="M39.0477 115.101 Q35.4367 115.101 33.608 118.665 Q31.8024 122.207 31.8024 129.337 Q31.8024 136.443 33.608 140.008 Q35.4367 143.549 39.0477 143.549 Q42.682 143.549 44.4875 140.008 Q46.3162 136.443 46.3162 129.337 Q46.3162 122.207 44.4875 118.665 Q42.682 115.101 39.0477 115.101 M39.0477 111.397 Q44.8579 111.397 47.9134 116.003 Q50.9921 120.587 50.9921 129.337 Q50.9921 138.063 47.9134 142.67 Q44.8579 147.253 39.0477 147.253 Q33.2376 147.253 30.1589 142.67 Q27.1034 138.063 27.1034 129.337 Q27.1034 120.587 30.1589 116.003 Q33.2376 111.397 39.0477 111.397 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip842)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,129.302 313.569,129.302 540.145,504.172 766.721,1053.11 993.298,1084.92 1219.87,1084.62 1446.45,1135.42 1673.03,1464 1899.6,1144.34 2126.18,1210.55 2352.76,933.79 "/>
<polyline clip-path="url(#clip842)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,129.302 313.569,189.765 540.145,220.863 766.721,141.883 993.298,136.96 1219.87,145.2 1446.45,190.412 1673.03,88.5087 1899.6,148.166 2126.18,93.3833 2352.76,151.045 "/>
<path clip-path="url(#clip840)" d="M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip840)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 "/>
<polyline clip-path="url(#clip840)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1352.98 338.744,1352.98 "/>
<path clip-path="url(#clip840)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip840)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1404.82 338.744,1404.82 "/>
<path clip-path="url(#clip840)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>By default the solution provides an interface to access the simulated <code>u</code>.  That is, <code>sol.u[...] = sol[...]</code>,</p><pre><code class="language-julia hljs">sol[2]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
  0.0
 -0.015038358336405485</code></pre><p>Or to get the first element of the last step</p><pre><code class="language-julia hljs">sol[end][1] #first element of last step</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-0.20009255549968083</code></pre><p>Finally, to extract the full vector</p><pre><code class="language-julia hljs">@show sol[2,:];  # whole second vector</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Float64}:
  0.0
 -0.015038358336405485
 -0.02277311430716039
 -0.0031291731034932936
 -0.0019047108149866793
 -0.003954069609440034
 -0.015199289704528864
  0.010146088863136457
 -0.004691881672840332
  0.008933682923073328
 -0.0054079502098192895</code></pre><p>The results for all of <code>sol.u</code> can be loaded in a dataframe, where the column names will be the (optionally) provided symbols.</p><pre><code class="language-julia hljs">df = DataFrame(sol)</code></pre><div><div style = "float: left;"><span>11×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">timestamp</th><th style = "text-align: left;">a</th><th style = "text-align: left;">b</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">-0.0150384</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">2</td><td style = "text-align: right;">-0.0932378</td><td style = "text-align: right;">-0.0227731</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">3</td><td style = "text-align: right;">-0.229769</td><td style = "text-align: right;">-0.00312917</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">4</td><td style = "text-align: right;">-0.237682</td><td style = "text-align: right;">-0.00190471</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">5</td><td style = "text-align: right;">-0.237607</td><td style = "text-align: right;">-0.00395407</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">6</td><td style = "text-align: right;">-0.250242</td><td style = "text-align: right;">-0.0151993</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: right;">7</td><td style = "text-align: right;">-0.331965</td><td style = "text-align: right;">0.0101461</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: right;">8</td><td style = "text-align: right;">-0.252461</td><td style = "text-align: right;">-0.00469188</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: right;">9</td><td style = "text-align: right;">-0.268928</td><td style = "text-align: right;">0.00893368</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: right;">10</td><td style = "text-align: right;">-0.200093</td><td style = "text-align: right;">-0.00540795</td></tr></tbody></table></div><p>Other results, such as the simulated noise and observables can be extracted from the solution</p><pre><code class="language-julia hljs">sol.z # observables</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [0.16621078036901377, -0.014107017952047728]
 [0.2702155470617682, -0.6422581269013716]
 [-0.5472291361367557, -0.7350734555030275]
 [0.040819156100178444, -0.061403394425210533]
 [-0.2955474226727922, -0.10653292217654825]
 [-0.2295997216573076, -0.2417905365041561]
 [-0.016605473445128735, -0.27655420304843237]
 [-0.5401735197680014, -0.3719860687660448]
 [0.7749897497532784, -0.04031900423734627]
 [0.22831831503216332, -0.7342629293929644]
 [0.3834752430487342, -0.6288235255943541]</code></pre><pre><code class="language-julia hljs">sol.W # Simulated Noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10 Matrix{Float64}:
 -1.50384  -1.97654  0.142545  -0.127888  …  -0.67211  0.987206  -0.719469</code></pre><p>We can also solve the model passing in fixed noise, which will be useful for joint likelihoods.  First lets extract the noise from the previous solution, then rerun the simulation but with a different initial value</p><pre><code class="language-julia hljs">noise = sol.W
u0_2 = [0.1, 0.0]
prob2 = LinearStateSpaceProblem(A, B, u0_2, (0, T); C, observables_noise = D, syms = [:a, :b], noise)
sol2 = solve(prob2)
plot(sol2)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip900">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip900)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip901">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip900)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip902">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip900)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1228 2352.76,1228 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,848.17 2352.76,848.17 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,468.339 2352.76,468.339 "/>
<polyline clip-path="url(#clip902)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,88.5087 2352.76,88.5087 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1228 105.89,1228 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,848.17 105.89,848.17 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,468.339 105.89,468.339 "/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,88.5087 105.89,88.5087 "/>
<path clip-path="url(#clip900)" d="M-54.3545 1228.45 L-24.6788 1228.45 L-24.6788 1232.39 L-54.3545 1232.39 L-54.3545 1228.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M-4.58628 1213.8 Q-8.19737 1213.8 -10.0261 1217.36 Q-11.8316 1220.91 -11.8316 1228.04 Q-11.8316 1235.14 -10.0261 1238.71 Q-8.19737 1242.25 -4.58628 1242.25 Q-0.95204 1242.25 0.853506 1238.71 Q2.6822 1235.14 2.6822 1228.04 Q2.6822 1220.91 0.853506 1217.36 Q-0.95204 1213.8 -4.58628 1213.8 M-4.58628 1210.1 Q1.22387 1210.1 4.27941 1214.7 Q7.3581 1219.29 7.3581 1228.04 Q7.3581 1236.76 4.27941 1241.37 Q1.22387 1245.95 -4.58628 1245.95 Q-10.3964 1245.95 -13.4751 1241.37 Q-16.5307 1236.76 -16.5307 1228.04 Q-16.5307 1219.29 -13.4751 1214.7 Q-10.3964 1210.1 -4.58628 1210.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M15.5756 1239.4 L20.4599 1239.4 L20.4599 1245.28 L15.5756 1245.28 L15.5756 1239.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M34.6728 1241.35 L50.9921 1241.35 L50.9921 1245.28 L29.0478 1245.28 L29.0478 1241.35 Q31.7098 1238.59 36.2931 1233.96 Q40.8996 1229.31 42.0801 1227.97 Q44.3255 1225.44 45.2051 1223.71 Q46.1079 1221.95 46.1079 1220.26 Q46.1079 1217.5 44.1635 1215.77 Q42.2422 1214.03 39.1403 1214.03 Q36.9413 1214.03 34.4876 1214.79 Q32.057 1215.56 29.2793 1217.11 L29.2793 1212.39 Q32.1033 1211.25 34.557 1210.67 Q37.0107 1210.1 39.0477 1210.1 Q44.4181 1210.1 47.6125 1212.78 Q50.8069 1215.47 50.8069 1219.96 Q50.8069 1222.09 49.9968 1224.01 Q49.2097 1225.91 47.1033 1228.5 Q46.5246 1229.17 43.4227 1232.39 Q40.3209 1235.58 34.6728 1241.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M-54.7249 848.622 L-25.0491 848.622 L-25.0491 852.557 L-54.7249 852.557 L-54.7249 848.622 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M-4.95665 833.969 Q-8.56774 833.969 -10.3964 837.534 Q-12.202 841.075 -12.202 848.205 Q-12.202 855.311 -10.3964 858.876 Q-8.56774 862.418 -4.95665 862.418 Q-1.32241 862.418 0.483137 858.876 Q2.31183 855.311 2.31183 848.205 Q2.31183 841.075 0.483137 837.534 Q-1.32241 833.969 -4.95665 833.969 M-4.95665 830.265 Q0.853506 830.265 3.90904 834.872 Q6.98773 839.455 6.98773 848.205 Q6.98773 856.932 3.90904 861.538 Q0.853506 866.121 -4.95665 866.121 Q-10.7668 866.121 -13.8455 861.538 Q-16.901 856.932 -16.901 848.205 Q-16.901 839.455 -13.8455 834.872 Q-10.7668 830.265 -4.95665 830.265 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M15.2053 859.571 L20.0895 859.571 L20.0895 865.45 L15.2053 865.45 L15.2053 859.571 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M31.0848 861.515 L38.7237 861.515 L38.7237 835.149 L30.4135 836.816 L30.4135 832.557 L38.6774 830.89 L43.3533 830.89 L43.3533 861.515 L50.9921 861.515 L50.9921 865.45 L31.0848 865.45 L31.0848 861.515 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M-6.18349 454.138 Q-9.79459 454.138 -11.6233 457.703 Q-13.4288 461.245 -13.4288 468.374 Q-13.4288 475.481 -11.6233 479.045 Q-9.79459 482.587 -6.18349 482.587 Q-2.54925 482.587 -0.743708 479.045 Q1.08499 475.481 1.08499 468.374 Q1.08499 461.245 -0.743708 457.703 Q-2.54925 454.138 -6.18349 454.138 M-6.18349 450.434 Q-0.37334 450.434 2.6822 455.041 Q5.76089 459.624 5.76089 468.374 Q5.76089 477.101 2.6822 481.707 Q-0.37334 486.291 -6.18349 486.291 Q-11.9936 486.291 -15.0723 481.707 Q-18.1279 477.101 -18.1279 468.374 Q-18.1279 459.624 -15.0723 455.041 Q-11.9936 450.434 -6.18349 450.434 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M13.9784 479.74 L18.8627 479.74 L18.8627 485.619 L13.9784 485.619 L13.9784 479.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M39.0477 454.138 Q35.4367 454.138 33.608 457.703 Q31.8024 461.245 31.8024 468.374 Q31.8024 475.481 33.608 479.045 Q35.4367 482.587 39.0477 482.587 Q42.682 482.587 44.4875 479.045 Q46.3162 475.481 46.3162 468.374 Q46.3162 461.245 44.4875 457.703 Q42.682 454.138 39.0477 454.138 M39.0477 450.434 Q44.8579 450.434 47.9134 455.041 Q50.9921 459.624 50.9921 468.374 Q50.9921 477.101 47.9134 481.707 Q44.8579 486.291 39.0477 486.291 Q33.2376 486.291 30.1589 481.707 Q27.1034 477.101 27.1034 468.374 Q27.1034 459.624 30.1589 455.041 Q33.2376 450.434 39.0477 450.434 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M-4.95665 74.3074 Q-8.56774 74.3074 -10.3964 77.8722 Q-12.202 81.4138 -12.202 88.5434 Q-12.202 95.6499 -10.3964 99.2147 Q-8.56774 102.756 -4.95665 102.756 Q-1.32241 102.756 0.483137 99.2147 Q2.31183 95.6499 2.31183 88.5434 Q2.31183 81.4138 0.483137 77.8722 Q-1.32241 74.3074 -4.95665 74.3074 M-4.95665 70.6037 Q0.853506 70.6037 3.90904 75.2102 Q6.98773 79.7935 6.98773 88.5434 Q6.98773 97.2702 3.90904 101.877 Q0.853506 106.46 -4.95665 106.46 Q-10.7668 106.46 -13.8455 101.877 Q-16.901 97.2702 -16.901 88.5434 Q-16.901 79.7935 -13.8455 75.2102 Q-10.7668 70.6037 -4.95665 70.6037 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M15.2053 99.9091 L20.0895 99.9091 L20.0895 105.789 L15.2053 105.789 L15.2053 99.9091 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip900)" d="M31.0848 101.854 L38.7237 101.854 L38.7237 75.4879 L30.4135 77.1546 L30.4135 72.8953 L38.6774 71.2287 L43.3533 71.2287 L43.3533 101.854 L50.9921 101.854 L50.9921 105.789 L31.0848 105.789 L31.0848 101.854 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip902)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,88.5087 313.569,107.5 540.145,479.688 766.721,1015.42 993.298,1061.75 1219.87,1076.94 1446.45,1139.62 1673.03,1464 1899.6,1175.28 2126.18,1250.42 2352.76,1000.93 "/>
<polyline clip-path="url(#clip902)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,468.339 313.569,525.46 540.145,554.839 766.721,480.225 993.298,475.574 1219.87,483.358 1446.45,526.071 1673.03,429.801 1899.6,486.161 2126.18,434.407 2352.76,488.88 "/>
<path clip-path="url(#clip900)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip900)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip900)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip900)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip900)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip900)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>To construct an IRF we can take the model and perturb just the first element of the noise,</p><pre><code class="language-julia hljs">function irf(A, B, C, T = 20)
    noise = Matrix([1.0; zeros(T-1)]&#39;)
    problem = LinearStateSpaceProblem(A, B, zeros(2), (0, T); C, noise, syms = [:a, :b])
    return solve(problem)
end
plot(irf(A, B, C))</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip960">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip960)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip961">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip960)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip962">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="653.433,1505.26 653.433,47.2441 "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1505.26 1219.87,47.2441 "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1786.31,1505.26 1786.31,47.2441 "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="653.433,1505.26 653.433,1486.36 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1505.26 1219.87,1486.36 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1786.31,1505.26 1786.31,1486.36 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip960)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M643.711 1533.1 L662.067 1533.1 L662.067 1537.04 L647.993 1537.04 L647.993 1545.51 Q649.012 1545.16 650.03 1545 Q651.049 1544.81 652.067 1544.81 Q657.854 1544.81 661.234 1547.98 Q664.614 1551.16 664.614 1556.57 Q664.614 1562.15 661.141 1565.25 Q657.669 1568.33 651.35 1568.33 Q649.174 1568.33 646.905 1567.96 Q644.66 1567.59 642.253 1566.85 L642.253 1562.15 Q644.336 1563.28 646.558 1563.84 Q648.78 1564.4 651.257 1564.4 Q655.262 1564.4 657.6 1562.29 Q659.938 1560.18 659.938 1556.57 Q659.938 1552.96 657.6 1550.85 Q655.262 1548.75 651.257 1548.75 Q649.382 1548.75 647.507 1549.16 Q645.655 1549.58 643.711 1550.46 L643.711 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1194.56 1563.72 L1202.2 1563.72 L1202.2 1537.36 L1193.89 1539.03 L1193.89 1534.77 L1202.15 1533.1 L1206.83 1533.1 L1206.83 1563.72 L1214.47 1563.72 L1214.47 1567.66 L1194.56 1567.66 L1194.56 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1233.91 1536.18 Q1230.3 1536.18 1228.47 1539.74 Q1226.67 1543.28 1226.67 1550.41 Q1226.67 1557.52 1228.47 1561.09 Q1230.3 1564.63 1233.91 1564.63 Q1237.55 1564.63 1239.35 1561.09 Q1241.18 1557.52 1241.18 1550.41 Q1241.18 1543.28 1239.35 1539.74 Q1237.55 1536.18 1233.91 1536.18 M1233.91 1532.47 Q1239.72 1532.47 1242.78 1537.08 Q1245.86 1541.66 1245.86 1550.41 Q1245.86 1559.14 1242.78 1563.75 Q1239.72 1568.33 1233.91 1568.33 Q1228.1 1568.33 1225.02 1563.75 Q1221.97 1559.14 1221.97 1550.41 Q1221.97 1541.66 1225.02 1537.08 Q1228.1 1532.47 1233.91 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1761.5 1563.72 L1769.14 1563.72 L1769.14 1537.36 L1760.83 1539.03 L1760.83 1534.77 L1769.09 1533.1 L1773.77 1533.1 L1773.77 1563.72 L1781.41 1563.72 L1781.41 1567.66 L1761.5 1567.66 L1761.5 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1790.9 1533.1 L1809.25 1533.1 L1809.25 1537.04 L1795.18 1537.04 L1795.18 1545.51 Q1796.2 1545.16 1797.22 1545 Q1798.24 1544.81 1799.25 1544.81 Q1805.04 1544.81 1808.42 1547.98 Q1811.8 1551.16 1811.8 1556.57 Q1811.8 1562.15 1808.33 1565.25 Q1804.86 1568.33 1798.54 1568.33 Q1796.36 1568.33 1794.09 1567.96 Q1791.85 1567.59 1789.44 1566.85 L1789.44 1562.15 Q1791.52 1563.28 1793.75 1563.84 Q1795.97 1564.4 1798.44 1564.4 Q1802.45 1564.4 1804.79 1562.29 Q1807.13 1560.18 1807.13 1556.57 Q1807.13 1552.96 1804.79 1550.85 Q1802.45 1548.75 1798.44 1548.75 Q1796.57 1548.75 1794.69 1549.16 Q1792.84 1549.58 1790.9 1550.46 L1790.9 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M2331.53 1563.72 L2347.85 1563.72 L2347.85 1567.66 L2325.9 1567.66 L2325.9 1563.72 Q2328.57 1560.97 2333.15 1556.34 Q2337.76 1551.69 2338.94 1550.35 Q2341.18 1547.82 2342.06 1546.09 Q2342.96 1544.33 2342.96 1542.64 Q2342.96 1539.88 2341.02 1538.15 Q2339.1 1536.41 2336 1536.41 Q2333.8 1536.41 2331.34 1537.17 Q2328.91 1537.94 2326.14 1539.49 L2326.14 1534.77 Q2328.96 1533.63 2331.41 1533.05 Q2333.87 1532.47 2335.9 1532.47 Q2341.27 1532.47 2344.47 1535.16 Q2347.66 1537.85 2347.66 1542.34 Q2347.66 1544.47 2346.85 1546.39 Q2346.07 1548.28 2343.96 1550.88 Q2343.38 1551.55 2340.28 1554.77 Q2337.18 1557.96 2331.53 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M2367.66 1536.18 Q2364.05 1536.18 2362.22 1539.74 Q2360.42 1543.28 2360.42 1550.41 Q2360.42 1557.52 2362.22 1561.09 Q2364.05 1564.63 2367.66 1564.63 Q2371.3 1564.63 2373.1 1561.09 Q2374.93 1557.52 2374.93 1550.41 Q2374.93 1543.28 2373.1 1539.74 Q2371.3 1536.18 2367.66 1536.18 M2367.66 1532.47 Q2373.47 1532.47 2376.53 1537.08 Q2379.61 1541.66 2379.61 1550.41 Q2379.61 1559.14 2376.53 1563.75 Q2373.47 1568.33 2367.66 1568.33 Q2361.85 1568.33 2358.77 1563.75 Q2355.72 1559.14 2355.72 1550.41 Q2355.72 1541.66 2358.77 1537.08 Q2361.85 1532.47 2367.66 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464 2352.76,1464 "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1078.16 2352.76,1078.16 "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,692.334 2352.76,692.334 "/>
<polyline clip-path="url(#clip962)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,306.503 2352.76,306.503 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 105.89,1464 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1078.16 105.89,1078.16 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,692.334 105.89,692.334 "/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,306.503 105.89,306.503 "/>
<path clip-path="url(#clip960)" d="M-36.3454 1449.79 Q-39.9565 1449.79 -41.7852 1453.36 Q-43.5907 1456.9 -43.5907 1464.03 Q-43.5907 1471.14 -41.7852 1474.7 Q-39.9565 1478.24 -36.3454 1478.24 Q-32.7111 1478.24 -30.9056 1474.7 Q-29.0769 1471.14 -29.0769 1464.03 Q-29.0769 1456.9 -30.9056 1453.36 Q-32.7111 1449.79 -36.3454 1449.79 M-36.3454 1446.09 Q-30.5352 1446.09 -27.4797 1450.7 Q-24.401 1455.28 -24.401 1464.03 Q-24.401 1472.76 -27.4797 1477.36 Q-30.5352 1481.95 -36.3454 1481.95 Q-42.1555 1481.95 -45.2342 1477.36 Q-48.2897 1472.76 -48.2897 1464.03 Q-48.2897 1455.28 -45.2342 1450.7 Q-42.1555 1446.09 -36.3454 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-16.1834 1475.4 L-11.2992 1475.4 L-11.2992 1481.28 L-16.1834 1481.28 L-16.1834 1475.4 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M8.88587 1449.79 Q5.27478 1449.79 3.44608 1453.36 Q1.64054 1456.9 1.64054 1464.03 Q1.64054 1471.14 3.44608 1474.7 Q5.27478 1478.24 8.88587 1478.24 Q12.5201 1478.24 14.3257 1474.7 Q16.1543 1471.14 16.1543 1464.03 Q16.1543 1456.9 14.3257 1453.36 Q12.5201 1449.79 8.88587 1449.79 M8.88587 1446.09 Q14.696 1446.09 17.7516 1450.7 Q20.8303 1455.28 20.8303 1464.03 Q20.8303 1472.76 17.7516 1477.36 Q14.696 1481.95 8.88587 1481.95 Q3.07572 1481.95 -0.00297114 1477.36 Q-3.05851 1472.76 -3.05851 1464.03 Q-3.05851 1455.28 -0.00297114 1450.7 Q3.07572 1446.09 8.88587 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M39.0477 1449.79 Q35.4367 1449.79 33.608 1453.36 Q31.8024 1456.9 31.8024 1464.03 Q31.8024 1471.14 33.608 1474.7 Q35.4367 1478.24 39.0477 1478.24 Q42.682 1478.24 44.4875 1474.7 Q46.3162 1471.14 46.3162 1464.03 Q46.3162 1456.9 44.4875 1453.36 Q42.682 1449.79 39.0477 1449.79 M39.0477 1446.09 Q44.8579 1446.09 47.9134 1450.7 Q50.9921 1455.28 50.9921 1464.03 Q50.9921 1472.76 47.9134 1477.36 Q44.8579 1481.95 39.0477 1481.95 Q33.2376 1481.95 30.1589 1477.36 Q27.1034 1472.76 27.1034 1464.03 Q27.1034 1455.28 30.1589 1450.7 Q33.2376 1446.09 39.0477 1446.09 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-34.7482 1063.96 Q-38.3592 1063.96 -40.1879 1067.53 Q-41.9935 1071.07 -41.9935 1078.2 Q-41.9935 1085.31 -40.1879 1088.87 Q-38.3592 1092.41 -34.7482 1092.41 Q-31.1139 1092.41 -29.3084 1088.87 Q-27.4797 1085.31 -27.4797 1078.2 Q-27.4797 1071.07 -29.3084 1067.53 Q-31.1139 1063.96 -34.7482 1063.96 M-34.7482 1060.26 Q-28.938 1060.26 -25.8825 1064.87 Q-22.8038 1069.45 -22.8038 1078.2 Q-22.8038 1086.93 -25.8825 1091.53 Q-28.938 1096.12 -34.7482 1096.12 Q-40.5583 1096.12 -43.637 1091.53 Q-46.6925 1086.93 -46.6925 1078.2 Q-46.6925 1069.45 -43.637 1064.87 Q-40.5583 1060.26 -34.7482 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-14.5862 1089.56 L-9.70199 1089.56 L-9.70199 1095.44 L-14.5862 1095.44 L-14.5862 1089.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M10.4831 1063.96 Q6.87199 1063.96 5.0433 1067.53 Q3.23775 1071.07 3.23775 1078.2 Q3.23775 1085.31 5.0433 1088.87 Q6.87199 1092.41 10.4831 1092.41 Q14.1173 1092.41 15.9229 1088.87 Q17.7516 1085.31 17.7516 1078.2 Q17.7516 1071.07 15.9229 1067.53 Q14.1173 1063.96 10.4831 1063.96 M10.4831 1060.26 Q16.2932 1060.26 19.3488 1064.87 Q22.4275 1069.45 22.4275 1078.2 Q22.4275 1086.93 19.3488 1091.53 Q16.2932 1096.12 10.4831 1096.12 Q4.67293 1096.12 1.59424 1091.53 Q-1.4613 1086.93 -1.4613 1078.2 Q-1.4613 1069.45 1.59424 1064.87 Q4.67293 1060.26 10.4831 1060.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M34.6728 1091.51 L50.9921 1091.51 L50.9921 1095.44 L29.0478 1095.44 L29.0478 1091.51 Q31.7098 1088.75 36.2931 1084.13 Q40.8996 1079.47 42.0801 1078.13 Q44.3255 1075.61 45.2051 1073.87 Q46.1079 1072.11 46.1079 1070.42 Q46.1079 1067.67 44.1635 1065.93 Q42.2422 1064.19 39.1403 1064.19 Q36.9413 1064.19 34.4876 1064.96 Q32.057 1065.72 29.2793 1067.27 L29.2793 1062.55 Q32.1033 1061.42 34.557 1060.84 Q37.0107 1060.26 39.0477 1060.26 Q44.4181 1060.26 47.6125 1062.94 Q50.8069 1065.63 50.8069 1070.12 Q50.8069 1072.25 49.9968 1074.17 Q49.2097 1076.07 47.1033 1078.66 Q46.5246 1079.33 43.4227 1082.55 Q40.3209 1085.75 34.6728 1091.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-36.8315 678.132 Q-40.4426 678.132 -42.2713 681.697 Q-44.0768 685.239 -44.0768 692.369 Q-44.0768 699.475 -42.2713 703.04 Q-40.4426 706.581 -36.8315 706.581 Q-33.1972 706.581 -31.3917 703.04 Q-29.563 699.475 -29.563 692.369 Q-29.563 685.239 -31.3917 681.697 Q-33.1972 678.132 -36.8315 678.132 M-36.8315 674.429 Q-31.0213 674.429 -27.9658 679.035 Q-24.8871 683.619 -24.8871 692.369 Q-24.8871 701.095 -27.9658 705.702 Q-31.0213 710.285 -36.8315 710.285 Q-42.6416 710.285 -45.7203 705.702 Q-48.7759 701.095 -48.7759 692.369 Q-48.7759 683.619 -45.7203 679.035 Q-42.6416 674.429 -36.8315 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-16.6695 703.734 L-11.7853 703.734 L-11.7853 709.614 L-16.6695 709.614 L-16.6695 703.734 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M8.39976 678.132 Q4.78867 678.132 2.95998 681.697 Q1.15443 685.239 1.15443 692.369 Q1.15443 699.475 2.95998 703.04 Q4.78867 706.581 8.39976 706.581 Q12.034 706.581 13.8395 703.04 Q15.6682 699.475 15.6682 692.369 Q15.6682 685.239 13.8395 681.697 Q12.034 678.132 8.39976 678.132 M8.39976 674.429 Q14.2099 674.429 17.2655 679.035 Q20.3441 683.619 20.3441 692.369 Q20.3441 701.095 17.2655 705.702 Q14.2099 710.285 8.39976 710.285 Q2.58961 710.285 -0.48908 705.702 Q-3.54462 701.095 -3.54462 692.369 Q-3.54462 683.619 -0.48908 679.035 Q2.58961 674.429 8.39976 674.429 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M41.4088 679.128 L29.6034 697.577 L41.4088 697.577 L41.4088 679.128 M40.182 675.054 L46.0616 675.054 L46.0616 697.577 L50.9921 697.577 L50.9921 701.466 L46.0616 701.466 L46.0616 709.614 L41.4088 709.614 L41.4088 701.466 L25.8071 701.466 L25.8071 696.952 L40.182 675.054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-36.5074 292.302 Q-40.1185 292.302 -41.9472 295.867 Q-43.7527 299.408 -43.7527 306.538 Q-43.7527 313.644 -41.9472 317.209 Q-40.1185 320.751 -36.5074 320.751 Q-32.8732 320.751 -31.0676 317.209 Q-29.2389 313.644 -29.2389 306.538 Q-29.2389 299.408 -31.0676 295.867 Q-32.8732 292.302 -36.5074 292.302 M-36.5074 288.598 Q-30.6973 288.598 -27.6417 293.205 Q-24.563 297.788 -24.563 306.538 Q-24.563 315.265 -27.6417 319.871 Q-30.6973 324.454 -36.5074 324.454 Q-42.3176 324.454 -45.3962 319.871 Q-48.4518 315.265 -48.4518 306.538 Q-48.4518 297.788 -45.3962 293.205 Q-42.3176 288.598 -36.5074 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M-16.3455 317.903 L-11.4612 317.903 L-11.4612 323.783 L-16.3455 323.783 L-16.3455 317.903 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M8.72383 292.302 Q5.11274 292.302 3.28405 295.867 Q1.4785 299.408 1.4785 306.538 Q1.4785 313.644 3.28405 317.209 Q5.11274 320.751 8.72383 320.751 Q12.3581 320.751 14.1636 317.209 Q15.9923 313.644 15.9923 306.538 Q15.9923 299.408 14.1636 295.867 Q12.3581 292.302 8.72383 292.302 M8.72383 288.598 Q14.534 288.598 17.5895 293.205 Q20.6682 297.788 20.6682 306.538 Q20.6682 315.265 17.5895 319.871 Q14.534 324.454 8.72383 324.454 Q2.91368 324.454 -0.165007 319.871 Q-3.22055 315.265 -3.22055 306.538 Q-3.22055 297.788 -0.165007 293.205 Q2.91368 288.598 8.72383 288.598 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip960)" d="M39.4644 304.64 Q36.3163 304.64 34.4644 306.792 Q32.6357 308.945 32.6357 312.695 Q32.6357 316.422 34.4644 318.598 Q36.3163 320.751 39.4644 320.751 Q42.6125 320.751 44.4412 318.598 Q46.2931 316.422 46.2931 312.695 Q46.2931 308.945 44.4412 306.792 Q42.6125 304.64 39.4644 304.64 M48.7468 289.987 L48.7468 294.246 Q46.9875 293.413 45.182 292.973 Q43.3996 292.533 41.6403 292.533 Q37.0107 292.533 34.557 295.658 Q32.1265 298.783 31.7793 305.103 Q33.145 303.089 35.2052 302.024 Q37.2653 300.936 39.7422 300.936 Q44.9505 300.936 47.9597 304.107 Q50.9921 307.255 50.9921 312.695 Q50.9921 318.019 47.844 321.237 Q44.6959 324.454 39.4644 324.454 Q33.4691 324.454 30.2978 319.871 Q27.1265 315.265 27.1265 306.538 Q27.1265 298.343 31.0154 293.482 Q34.9042 288.598 41.4551 288.598 Q43.2144 288.598 44.9968 288.945 Q46.8023 289.292 48.7468 289.987 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip962)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1464 313.569,267.92 426.857,88.5087 540.145,109.44 653.433,167.599 766.721,230.505 880.009,291.797 993.298,350.33 1106.59,405.998 1219.87,458.895 1333.16,509.149 1446.45,556.892 1559.74,602.247 1673.03,645.334 1786.31,686.267 1899.6,725.154 2012.89,762.096 2126.18,797.191 2239.47,830.531 2352.76,862.204 "/>
<polyline clip-path="url(#clip962)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464 200.28,1271.08 313.569,1425.41 426.857,1456.28 540.145,1462.45 653.433,1463.69 766.721,1463.93 880.009,1463.98 993.298,1463.99 1106.59,1463.99 1219.87,1464 1333.16,1464 1446.45,1464 1559.74,1464 1673.03,1464 1786.31,1464 1899.6,1464 2012.89,1464 2126.18,1464 2239.47,1464 2352.76,1464 "/>
<path clip-path="url(#clip960)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip960)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip960)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip960)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip960)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip960)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>Lets find the 2nd observable at the end of the IRF.</p><pre><code class="language-julia hljs">function last_observable_irf(A, B, C)
    sol = irf(A, B, C)
    return sol.z[end][2]  # return 2nd argument of last observable
end
last_observable_irf(A, B, C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.03119456447624772</code></pre><p>But everything in this package is differentiable.  Lets differentiate the observable of the IRF with respect to all of the parameters using <code>Zygote.jl</code>,</p><pre><code class="language-julia hljs">gradient(last_observable_irf, A, B, C)  # calculates gradient wrt all arguments</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.5822985368900442 0.0050313813671367304; 4.469834483178462 0.041592752634585235], [0.37735360253530714; 3.119456447624773;;], [0.0 0.0; 0.03119456447624772 5.242880000000006e-16])</code></pre><p>Gradients of other model elements (e.g. <code>.u</code> are also possible.  With this in mind, lets find the gradient of the mean of the 1st element of the IRF of the solution with respect to a particular noise vector.</p><pre><code class="language-julia hljs">function mean_u_1(A, B, C, noise, u0, T)
    problem = LinearStateSpaceProblem(A, B, u0, (0, T); noise, syms = [:a, :b])
    sol = solve(problem)
    u = sol.u # see issue #75 workaround
    # can have nontrivial functions and even non-mutating loops
    return mean( u[i][1] for i in 1:T)
end
u0 = [0.0, 0.0]
noise = sol.W # from simulation above
mean_u_1(A, B, C, noise, u0, T)
# dropping a few arguments from derivative
gradient((noise, u0)-&gt; mean_u_1(A, B, C, noise, u0, T), noise, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0.05079876954953124 0.045314515146875 … 0.0 0.0], [0.702526121523242, 5.600882710405467])</code></pre><h2 id="Simulating-Ensembles-and-Fixing-Noise"><a class="docs-heading-anchor" href="#Simulating-Ensembles-and-Fixing-Noise">Simulating Ensembles and Fixing Noise</a><a id="Simulating-Ensembles-and-Fixing-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-Ensembles-and-Fixing-Noise" title="Permalink"></a></h2><p>If you pass in a distribution for the initial condition, it will draw an initial condition.  Below we will simulate from a deterministic evolution equation and without any observation noise.</p><pre><code class="language-julia hljs">using Distributions, DiffEqBase
u0 = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = LinearStateSpaceProblem(A, nothing, u0, (0, T); C)
sol = solve(prob)
plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip020">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip020)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip021">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip020)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip022">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="540.145,1505.26 540.145,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="993.298,1505.26 993.298,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1446.45,1505.26 1446.45,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1899.6,1505.26 1899.6,47.2441 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="540.145,1505.26 540.145,1486.36 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="993.298,1505.26 993.298,1486.36 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1446.45,1505.26 1446.45,1486.36 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1899.6,1505.26 1899.6,1486.36 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip020)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M534.798 1563.72 L551.117 1563.72 L551.117 1567.66 L529.173 1567.66 L529.173 1563.72 Q531.835 1560.97 536.418 1556.34 Q541.025 1551.69 542.205 1550.35 Q544.45 1547.82 545.33 1546.09 Q546.233 1544.33 546.233 1542.64 Q546.233 1539.88 544.288 1538.15 Q542.367 1536.41 539.265 1536.41 Q537.066 1536.41 534.613 1537.17 Q532.182 1537.94 529.404 1539.49 L529.404 1534.77 Q532.228 1533.63 534.682 1533.05 Q537.136 1532.47 539.173 1532.47 Q544.543 1532.47 547.737 1535.16 Q550.932 1537.85 550.932 1542.34 Q550.932 1544.47 550.122 1546.39 Q549.335 1548.28 547.228 1550.88 Q546.649 1551.55 543.548 1554.77 Q540.446 1557.96 534.798 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M996.307 1537.17 L984.501 1555.62 L996.307 1555.62 L996.307 1537.17 M995.08 1533.1 L1000.96 1533.1 L1000.96 1555.62 L1005.89 1555.62 L1005.89 1559.51 L1000.96 1559.51 L1000.96 1567.66 L996.307 1567.66 L996.307 1559.51 L980.705 1559.51 L980.705 1555 L995.08 1533.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1446.86 1548.52 Q1443.71 1548.52 1441.86 1550.67 Q1440.03 1552.82 1440.03 1556.57 Q1440.03 1560.3 1441.86 1562.47 Q1443.71 1564.63 1446.86 1564.63 Q1450 1564.63 1451.83 1562.47 Q1453.68 1560.3 1453.68 1556.57 Q1453.68 1552.82 1451.83 1550.67 Q1450 1548.52 1446.86 1548.52 M1456.14 1533.86 L1456.14 1538.12 Q1454.38 1537.29 1452.57 1536.85 Q1450.79 1536.41 1449.03 1536.41 Q1444.4 1536.41 1441.95 1539.53 Q1439.52 1542.66 1439.17 1548.98 Q1440.54 1546.97 1442.6 1545.9 Q1444.66 1544.81 1447.13 1544.81 Q1452.34 1544.81 1455.35 1547.98 Q1458.38 1551.13 1458.38 1556.57 Q1458.38 1561.9 1455.24 1565.11 Q1452.09 1568.33 1446.86 1568.33 Q1440.86 1568.33 1437.69 1563.75 Q1434.52 1559.14 1434.52 1550.41 Q1434.52 1542.22 1438.41 1537.36 Q1442.3 1532.47 1448.85 1532.47 Q1450.61 1532.47 1452.39 1532.82 Q1454.19 1533.17 1456.14 1533.86 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1899.6 1551.25 Q1896.27 1551.25 1894.35 1553.03 Q1892.45 1554.81 1892.45 1557.94 Q1892.45 1561.06 1894.35 1562.85 Q1896.27 1564.63 1899.6 1564.63 Q1902.94 1564.63 1904.86 1562.85 Q1906.78 1561.04 1906.78 1557.94 Q1906.78 1554.81 1904.86 1553.03 Q1902.96 1551.25 1899.6 1551.25 M1894.93 1549.26 Q1891.92 1548.52 1890.23 1546.46 Q1888.56 1544.4 1888.56 1541.43 Q1888.56 1537.29 1891.5 1534.88 Q1894.46 1532.47 1899.6 1532.47 Q1904.77 1532.47 1907.7 1534.88 Q1910.64 1537.29 1910.64 1541.43 Q1910.64 1544.4 1908.95 1546.46 Q1907.29 1548.52 1904.3 1549.26 Q1907.68 1550.04 1909.56 1552.34 Q1911.45 1554.63 1911.45 1557.94 Q1911.45 1562.96 1908.38 1565.65 Q1905.32 1568.33 1899.6 1568.33 Q1893.89 1568.33 1890.81 1565.65 Q1887.75 1562.96 1887.75 1557.94 Q1887.75 1554.63 1889.65 1552.34 Q1891.55 1550.04 1894.93 1549.26 M1893.21 1541.87 Q1893.21 1544.56 1894.88 1546.06 Q1896.57 1547.57 1899.6 1547.57 Q1902.61 1547.57 1904.3 1546.06 Q1906.02 1544.56 1906.02 1541.87 Q1906.02 1539.19 1904.3 1537.68 Q1902.61 1536.18 1899.6 1536.18 Q1896.57 1536.18 1894.88 1537.68 Q1893.21 1539.19 1893.21 1541.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2327.44 1563.72 L2335.08 1563.72 L2335.08 1537.36 L2326.77 1539.03 L2326.77 1534.77 L2335.04 1533.1 L2339.71 1533.1 L2339.71 1563.72 L2347.35 1563.72 L2347.35 1567.66 L2327.44 1567.66 L2327.44 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2366.8 1536.18 Q2363.18 1536.18 2361.36 1539.74 Q2359.55 1543.28 2359.55 1550.41 Q2359.55 1557.52 2361.36 1561.09 Q2363.18 1564.63 2366.8 1564.63 Q2370.43 1564.63 2372.23 1561.09 Q2374.06 1557.52 2374.06 1550.41 Q2374.06 1543.28 2372.23 1539.74 Q2370.43 1536.18 2366.8 1536.18 M2366.8 1532.47 Q2372.61 1532.47 2375.66 1537.08 Q2378.74 1541.66 2378.74 1550.41 Q2378.74 1559.14 2375.66 1563.75 Q2372.61 1568.33 2366.8 1568.33 Q2360.99 1568.33 2357.91 1563.75 Q2354.85 1559.14 2354.85 1550.41 Q2354.85 1541.66 2357.91 1537.08 Q2360.99 1532.47 2366.8 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1341.83 2352.76,1341.83 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1137.05 2352.76,1137.05 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,932.269 2352.76,932.269 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,727.491 2352.76,727.491 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,522.713 2352.76,522.713 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,317.934 2352.76,317.934 "/>
<polyline clip-path="url(#clip022)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,113.156 2352.76,113.156 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1341.83 105.89,1341.83 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1137.05 105.89,1137.05 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,932.269 105.89,932.269 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,727.491 105.89,727.491 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,522.713 105.89,522.713 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,317.934 105.89,317.934 "/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,113.156 105.89,113.156 "/>
<path clip-path="url(#clip020)" d="M-10.8825 1342.28 L18.7932 1342.28 L18.7932 1346.21 L-10.8825 1346.21 L-10.8825 1342.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M39.4644 1339.96 Q36.3163 1339.96 34.4644 1342.11 Q32.6357 1344.27 32.6357 1348.02 Q32.6357 1351.74 34.4644 1353.92 Q36.3163 1356.07 39.4644 1356.07 Q42.6125 1356.07 44.4412 1353.92 Q46.2931 1351.74 46.2931 1348.02 Q46.2931 1344.27 44.4412 1342.11 Q42.6125 1339.96 39.4644 1339.96 M48.7468 1325.31 L48.7468 1329.57 Q46.9875 1328.74 45.182 1328.3 Q43.3996 1327.86 41.6403 1327.86 Q37.0107 1327.86 34.557 1330.98 Q32.1265 1334.11 31.7793 1340.43 Q33.145 1338.41 35.2052 1337.35 Q37.2653 1336.26 39.7422 1336.26 Q44.9505 1336.26 47.9597 1339.43 Q50.9921 1342.58 50.9921 1348.02 Q50.9921 1353.34 47.844 1356.56 Q44.6959 1359.78 39.4644 1359.78 Q33.4691 1359.78 30.2978 1355.19 Q27.1265 1350.59 27.1265 1341.86 Q27.1265 1333.67 31.0154 1328.8 Q34.9042 1323.92 41.4551 1323.92 Q43.2144 1323.92 44.9968 1324.27 Q46.8023 1324.62 48.7468 1325.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-9.72514 1137.5 L19.9506 1137.5 L19.9506 1141.43 L-9.72514 1141.43 L-9.72514 1137.5 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M30.0895 1119.77 L48.4458 1119.77 L48.4458 1123.7 L34.3718 1123.7 L34.3718 1132.17 Q35.3904 1131.83 36.4089 1131.67 Q37.4274 1131.48 38.4459 1131.48 Q44.2329 1131.48 47.6125 1134.65 Q50.9921 1137.82 50.9921 1143.24 Q50.9921 1148.82 47.5199 1151.92 Q44.0477 1155 37.7283 1155 Q35.5524 1155 33.2839 1154.63 Q31.0385 1154.26 28.6311 1153.52 L28.6311 1148.82 Q30.7145 1149.95 32.9367 1150.51 Q35.1589 1151.06 37.6357 1151.06 Q41.6403 1151.06 43.9783 1148.96 Q46.3162 1146.85 46.3162 1143.24 Q46.3162 1139.63 43.9783 1137.52 Q41.6403 1135.42 37.6357 1135.42 Q35.7607 1135.42 33.8857 1135.83 Q32.0339 1136.25 30.0895 1137.13 L30.0895 1119.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-11.2066 932.721 L18.4692 932.721 L18.4692 936.656 L-11.2066 936.656 L-11.2066 932.721 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M41.4088 919.063 L29.6034 937.512 L41.4088 937.512 L41.4088 919.063 M40.182 914.989 L46.0616 914.989 L46.0616 937.512 L50.9921 937.512 L50.9921 941.401 L46.0616 941.401 L46.0616 949.549 L41.4088 949.549 L41.4088 941.401 L25.8071 941.401 L25.8071 936.887 L40.182 914.989 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-10.0724 727.942 L19.6034 727.942 L19.6034 731.877 L-10.0724 731.877 L-10.0724 727.942 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M43.8625 726.137 Q47.219 726.854 49.094 729.123 Q50.9921 731.391 50.9921 734.725 Q50.9921 739.84 47.4736 742.641 Q43.9551 745.442 37.4737 745.442 Q35.2978 745.442 32.983 745.002 Q30.6913 744.586 28.2376 743.729 L28.2376 739.215 Q30.1821 740.35 32.4969 740.928 Q34.8117 741.507 37.3348 741.507 Q41.7329 741.507 44.0246 739.771 Q46.3394 738.035 46.3394 734.725 Q46.3394 731.669 44.1866 729.956 Q42.057 728.22 38.2376 728.22 L34.2098 728.22 L34.2098 724.377 L38.4227 724.377 Q41.8718 724.377 43.7005 723.012 Q45.5292 721.623 45.5292 719.03 Q45.5292 716.368 43.6311 714.956 Q41.7561 713.521 38.2376 713.521 Q36.3163 713.521 34.1172 713.938 Q31.9182 714.354 29.2793 715.234 L29.2793 711.067 Q31.9413 710.327 34.2561 709.956 Q36.5941 709.586 38.6542 709.586 Q43.9783 709.586 47.0801 712.016 Q50.1819 714.424 50.1819 718.544 Q50.1819 721.415 48.5384 723.405 Q46.8949 725.373 43.8625 726.137 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-9.12329 523.164 L20.5525 523.164 L20.5525 527.099 L-9.12329 527.099 L-9.12329 523.164 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M34.6728 536.058 L50.9921 536.058 L50.9921 539.993 L29.0478 539.993 L29.0478 536.058 Q31.7098 533.303 36.2931 528.673 Q40.8996 524.021 42.0801 522.678 Q44.3255 520.155 45.2051 518.419 Q46.1079 516.659 46.1079 514.97 Q46.1079 512.215 44.1635 510.479 Q42.2422 508.743 39.1403 508.743 Q36.9413 508.743 34.4876 509.507 Q32.057 510.271 29.2793 511.822 L29.2793 507.099 Q32.1033 505.965 34.557 505.386 Q37.0107 504.808 39.0477 504.808 Q44.4181 504.808 47.6125 507.493 Q50.8069 510.178 50.8069 514.669 Q50.8069 516.798 49.9968 518.72 Q49.2097 520.618 47.1033 523.21 Q46.5246 523.882 43.4227 527.099 Q40.3209 530.294 34.6728 536.058 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M-9.49366 318.386 L20.1821 318.386 L20.1821 322.321 L-9.49366 322.321 L-9.49366 318.386 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M31.0848 331.279 L38.7237 331.279 L38.7237 304.914 L30.4135 306.58 L30.4135 302.321 L38.6774 300.654 L43.3533 300.654 L43.3533 331.279 L50.9921 331.279 L50.9921 335.214 L31.0848 335.214 L31.0848 331.279 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M39.0477 98.9549 Q35.4367 98.9549 33.608 102.52 Q31.8024 106.061 31.8024 113.191 Q31.8024 120.297 33.608 123.862 Q35.4367 127.404 39.0477 127.404 Q42.682 127.404 44.4875 123.862 Q46.3162 120.297 46.3162 113.191 Q46.3162 106.061 44.4875 102.52 Q42.682 98.9549 39.0477 98.9549 M39.0477 95.2512 Q44.8579 95.2512 47.9134 99.8577 Q50.9921 104.441 50.9921 113.191 Q50.9921 121.918 47.9134 126.524 Q44.8579 131.108 39.0477 131.108 Q33.2376 131.108 30.1589 126.524 Q27.1034 121.918 27.1034 113.191 Q27.1034 104.441 30.1589 99.8577 Q33.2376 95.2512 39.0477 95.2512 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip022)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,88.5087 313.569,1283.73 540.145,1464 766.721,1444.21 993.298,1387.21 1219.87,1325.42 1446.45,1265.19 1673.03,1207.66 1899.6,1152.95 2126.18,1100.97 2352.76,1051.58 "/>
<polyline clip-path="url(#clip022)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,305.735 313.569,151.672 540.145,120.859 766.721,114.697 993.298,113.464 1219.87,113.218 1446.45,113.169 1673.03,113.159 1899.6,113.157 2126.18,113.156 2352.76,113.156 "/>
<path clip-path="url(#clip020)" d="M1942.97 1456.66 L2277.23 1456.66 L2277.23 1301.14 L1942.97 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip020)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1942.97,1456.66 2277.23,1456.66 2277.23,1301.14 1942.97,1301.14 1942.97,1456.66 "/>
<polyline clip-path="url(#clip020)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,1352.98 2119.2,1352.98 "/>
<path clip-path="url(#clip020)" d="M2144.37 1360.03 L2144.37 1344.33 L2148.63 1344.33 L2148.63 1359.87 Q2148.63 1363.55 2150.07 1365.4 Q2151.5 1367.23 2154.37 1367.23 Q2157.82 1367.23 2159.81 1365.03 Q2161.82 1362.83 2161.82 1359.03 L2161.82 1344.33 L2166.08 1344.33 L2166.08 1370.26 L2161.82 1370.26 L2161.82 1366.28 Q2160.27 1368.64 2158.21 1369.8 Q2156.18 1370.93 2153.47 1370.93 Q2149 1370.93 2146.69 1368.15 Q2144.37 1365.38 2144.37 1360.03 M2155.09 1343.71 L2155.09 1343.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2176.27 1366.32 L2183.91 1366.32 L2183.91 1339.96 L2175.6 1341.63 L2175.6 1337.37 L2183.86 1335.7 L2188.54 1335.7 L2188.54 1366.32 L2196.18 1366.32 L2196.18 1370.26 L2176.27 1370.26 L2176.27 1366.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2215.25 1334.29 Q2212.15 1339.61 2210.64 1344.82 Q2209.14 1350.03 2209.14 1355.38 Q2209.14 1360.72 2210.64 1365.98 Q2212.17 1371.21 2215.25 1376.51 L2211.55 1376.51 Q2208.07 1371.07 2206.34 1365.81 Q2204.62 1360.56 2204.62 1355.38 Q2204.62 1350.21 2206.34 1344.98 Q2208.05 1339.75 2211.55 1334.29 L2215.25 1334.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2227.73 1336.97 L2227.73 1344.33 L2236.5 1344.33 L2236.5 1347.64 L2227.73 1347.64 L2227.73 1361.72 Q2227.73 1364.89 2228.58 1365.79 Q2229.46 1366.69 2232.12 1366.69 L2236.5 1366.69 L2236.5 1370.26 L2232.12 1370.26 Q2227.19 1370.26 2225.32 1368.43 Q2223.44 1366.58 2223.44 1361.72 L2223.44 1347.64 L2220.32 1347.64 L2220.32 1344.33 L2223.44 1344.33 L2223.44 1336.97 L2227.73 1336.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2241.43 1334.29 L2245.13 1334.29 Q2248.61 1339.75 2250.32 1344.98 Q2252.06 1350.21 2252.06 1355.38 Q2252.06 1360.56 2250.32 1365.81 Q2248.61 1371.07 2245.13 1376.51 L2241.43 1376.51 Q2244.51 1371.21 2246.01 1365.98 Q2247.54 1360.72 2247.54 1355.38 Q2247.54 1350.03 2246.01 1344.82 Q2244.51 1339.61 2241.43 1334.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip020)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1968.14,1404.82 2119.2,1404.82 "/>
<path clip-path="url(#clip020)" d="M2144.37 1411.87 L2144.37 1396.17 L2148.63 1396.17 L2148.63 1411.71 Q2148.63 1415.39 2150.07 1417.24 Q2151.5 1419.07 2154.37 1419.07 Q2157.82 1419.07 2159.81 1416.87 Q2161.82 1414.67 2161.82 1410.87 L2161.82 1396.17 L2166.08 1396.17 L2166.08 1422.1 L2161.82 1422.1 L2161.82 1418.12 Q2160.27 1420.48 2158.21 1421.64 Q2156.18 1422.77 2153.47 1422.77 Q2149 1422.77 2146.69 1419.99 Q2144.37 1417.22 2144.37 1411.87 M2155.09 1395.55 L2155.09 1395.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2179.49 1418.16 L2195.81 1418.16 L2195.81 1422.1 L2173.86 1422.1 L2173.86 1418.16 Q2176.52 1415.41 2181.11 1410.78 Q2185.71 1406.13 2186.89 1404.78 Q2189.14 1402.26 2190.02 1400.53 Q2190.92 1398.77 2190.92 1397.08 Q2190.92 1394.32 2188.98 1392.59 Q2187.06 1390.85 2183.95 1390.85 Q2181.75 1390.85 2179.3 1391.61 Q2176.87 1392.38 2174.09 1393.93 L2174.09 1389.21 Q2176.92 1388.07 2179.37 1387.49 Q2181.82 1386.91 2183.86 1386.91 Q2189.23 1386.91 2192.43 1389.6 Q2195.62 1392.28 2195.62 1396.78 Q2195.62 1398.9 2194.81 1400.83 Q2194.02 1402.72 2191.92 1405.32 Q2191.34 1405.99 2188.24 1409.21 Q2185.13 1412.4 2179.49 1418.16 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2215.25 1386.13 Q2212.15 1391.45 2210.64 1396.66 Q2209.14 1401.87 2209.14 1407.22 Q2209.14 1412.56 2210.64 1417.82 Q2212.17 1423.05 2215.25 1428.35 L2211.55 1428.35 Q2208.07 1422.91 2206.34 1417.65 Q2204.62 1412.4 2204.62 1407.22 Q2204.62 1402.05 2206.34 1396.82 Q2208.05 1391.59 2211.55 1386.13 L2215.25 1386.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2227.73 1388.81 L2227.73 1396.17 L2236.5 1396.17 L2236.5 1399.48 L2227.73 1399.48 L2227.73 1413.56 Q2227.73 1416.73 2228.58 1417.63 Q2229.46 1418.53 2232.12 1418.53 L2236.5 1418.53 L2236.5 1422.1 L2232.12 1422.1 Q2227.19 1422.1 2225.32 1420.27 Q2223.44 1418.42 2223.44 1413.56 L2223.44 1399.48 L2220.32 1399.48 L2220.32 1396.17 L2223.44 1396.17 L2223.44 1388.81 L2227.73 1388.81 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip020)" d="M2241.43 1386.13 L2245.13 1386.13 Q2248.61 1391.59 2250.32 1396.82 Q2252.06 1402.05 2252.06 1407.22 Q2252.06 1412.4 2250.32 1417.65 Q2248.61 1422.91 2245.13 1428.35 L2241.43 1428.35 Q2244.51 1423.05 2246.01 1417.82 Q2247.54 1412.56 2247.54 1407.22 Q2247.54 1401.87 2246.01 1396.66 Q2244.51 1391.45 2241.43 1386.13 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>With this, we can simulate an ensemble of solutions from different initial conditions (and we will turn back on the noise).  The <code>EnsembleSummary</code> calculates a set of quantiles by default.</p><pre><code class="language-julia hljs">T = 10
trajectories = 50
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C)
sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(sol)  #calculate summarize statistics from the
plot(summ)  # shows quantiles by default</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip080">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip080)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip081">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip080)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip082">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="685.496,1521.01 685.496,47.2441 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1219.87,1521.01 1219.87,47.2441 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1754.25,1521.01 1754.25,47.2441 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="685.496,1521.01 685.496,1502.11 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1219.87,1521.01 1219.87,1502.11 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1754.25,1521.01 1754.25,1502.11 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip080)" d="M128.502 1551.93 Q124.891 1551.93 123.062 1555.49 Q121.257 1559.03 121.257 1566.16 Q121.257 1573.27 123.062 1576.83 Q124.891 1580.38 128.502 1580.38 Q132.136 1580.38 133.942 1576.83 Q135.77 1573.27 135.77 1566.16 Q135.77 1559.03 133.942 1555.49 Q132.136 1551.93 128.502 1551.93 M128.502 1548.22 Q134.312 1548.22 137.368 1552.83 Q140.446 1557.41 140.446 1566.16 Q140.446 1574.89 137.368 1579.5 Q134.312 1584.08 128.502 1584.08 Q122.692 1584.08 119.613 1579.5 Q116.558 1574.89 116.558 1566.16 Q116.558 1557.41 119.613 1552.83 Q122.692 1548.22 128.502 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M148.664 1577.53 L153.548 1577.53 L153.548 1583.41 L148.664 1583.41 L148.664 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M173.733 1551.93 Q170.122 1551.93 168.293 1555.49 Q166.488 1559.03 166.488 1566.16 Q166.488 1573.27 168.293 1576.83 Q170.122 1580.38 173.733 1580.38 Q177.367 1580.38 179.173 1576.83 Q181.002 1573.27 181.002 1566.16 Q181.002 1559.03 179.173 1555.49 Q177.367 1551.93 173.733 1551.93 M173.733 1548.22 Q179.543 1548.22 182.599 1552.83 Q185.678 1557.41 185.678 1566.16 Q185.678 1574.89 182.599 1579.5 Q179.543 1584.08 173.733 1584.08 Q167.923 1584.08 164.844 1579.5 Q161.789 1574.89 161.789 1566.16 Q161.789 1557.41 164.844 1552.83 Q167.923 1548.22 173.733 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M657.232 1579.47 L673.551 1579.47 L673.551 1583.41 L651.607 1583.41 L651.607 1579.47 Q654.269 1576.72 658.852 1572.09 Q663.459 1567.44 664.639 1566.09 Q666.885 1563.57 667.764 1561.83 Q668.667 1560.07 668.667 1558.38 Q668.667 1555.63 666.723 1553.89 Q664.801 1552.16 661.7 1552.16 Q659.501 1552.16 657.047 1552.92 Q654.616 1553.69 651.839 1555.24 L651.839 1550.51 Q654.663 1549.38 657.116 1548.8 Q659.57 1548.22 661.607 1548.22 Q666.977 1548.22 670.172 1550.91 Q673.366 1553.59 673.366 1558.08 Q673.366 1560.21 672.556 1562.13 Q671.769 1564.03 669.663 1566.63 Q669.084 1567.3 665.982 1570.51 Q662.88 1573.71 657.232 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M683.366 1577.53 L688.25 1577.53 L688.25 1583.41 L683.366 1583.41 L683.366 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M698.482 1548.85 L716.838 1548.85 L716.838 1552.78 L702.764 1552.78 L702.764 1561.26 Q703.783 1560.91 704.801 1560.75 Q705.82 1560.56 706.838 1560.56 Q712.625 1560.56 716.005 1563.73 Q719.384 1566.9 719.384 1572.32 Q719.384 1577.9 715.912 1581 Q712.44 1584.08 706.121 1584.08 Q703.945 1584.08 701.676 1583.71 Q699.431 1583.34 697.023 1582.6 L697.023 1577.9 Q699.107 1579.03 701.329 1579.59 Q703.551 1580.14 706.028 1580.14 Q710.033 1580.14 712.371 1578.04 Q714.709 1575.93 714.709 1572.32 Q714.709 1568.71 712.371 1566.6 Q710.033 1564.5 706.028 1564.5 Q704.153 1564.5 702.278 1564.91 Q700.426 1565.33 698.482 1566.21 L698.482 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M1187.04 1548.85 L1205.39 1548.85 L1205.39 1552.78 L1191.32 1552.78 L1191.32 1561.26 Q1192.34 1560.91 1193.36 1560.75 Q1194.38 1560.56 1195.39 1560.56 Q1201.18 1560.56 1204.56 1563.73 Q1207.94 1566.9 1207.94 1572.32 Q1207.94 1577.9 1204.47 1581 Q1201 1584.08 1194.68 1584.08 Q1192.5 1584.08 1190.23 1583.71 Q1187.99 1583.34 1185.58 1582.6 L1185.58 1577.9 Q1187.66 1579.03 1189.89 1579.59 Q1192.11 1580.14 1194.58 1580.14 Q1198.59 1580.14 1200.93 1578.04 Q1203.27 1575.93 1203.27 1572.32 Q1203.27 1568.71 1200.93 1566.6 Q1198.59 1564.5 1194.58 1564.5 Q1192.71 1564.5 1190.83 1564.91 Q1188.98 1565.33 1187.04 1566.21 L1187.04 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M1217.15 1577.53 L1222.04 1577.53 L1222.04 1583.41 L1217.15 1583.41 L1217.15 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M1242.22 1551.93 Q1238.61 1551.93 1236.78 1555.49 Q1234.98 1559.03 1234.98 1566.16 Q1234.98 1573.27 1236.78 1576.83 Q1238.61 1580.38 1242.22 1580.38 Q1245.86 1580.38 1247.66 1576.83 Q1249.49 1573.27 1249.49 1566.16 Q1249.49 1559.03 1247.66 1555.49 Q1245.86 1551.93 1242.22 1551.93 M1242.22 1548.22 Q1248.03 1548.22 1251.09 1552.83 Q1254.17 1557.41 1254.17 1566.16 Q1254.17 1574.89 1251.09 1579.5 Q1248.03 1584.08 1242.22 1584.08 Q1236.41 1584.08 1233.33 1579.5 Q1230.28 1574.89 1230.28 1566.16 Q1230.28 1557.41 1233.33 1552.83 Q1236.41 1548.22 1242.22 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M1720.57 1548.85 L1742.79 1548.85 L1742.79 1550.84 L1730.25 1583.41 L1725.36 1583.41 L1737.17 1552.78 L1720.57 1552.78 L1720.57 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M1751.91 1577.53 L1756.8 1577.53 L1756.8 1583.41 L1751.91 1583.41 L1751.91 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M1767.03 1548.85 L1785.39 1548.85 L1785.39 1552.78 L1771.31 1552.78 L1771.31 1561.26 Q1772.33 1560.91 1773.35 1560.75 Q1774.37 1560.56 1775.39 1560.56 Q1781.17 1560.56 1784.55 1563.73 Q1787.93 1566.9 1787.93 1572.32 Q1787.93 1577.9 1784.46 1581 Q1780.99 1584.08 1774.67 1584.08 Q1772.49 1584.08 1770.22 1583.71 Q1767.98 1583.34 1765.57 1582.6 L1765.57 1577.9 Q1767.65 1579.03 1769.88 1579.59 Q1772.1 1580.14 1774.58 1580.14 Q1778.58 1580.14 1780.92 1578.04 Q1783.26 1575.93 1783.26 1572.32 Q1783.26 1568.71 1780.92 1566.6 Q1778.58 1564.5 1774.58 1564.5 Q1772.7 1564.5 1770.83 1564.91 Q1768.97 1565.33 1767.03 1566.21 L1767.03 1548.85 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M2240.7 1579.47 L2248.34 1579.47 L2248.34 1553.11 L2240.03 1554.77 L2240.03 1550.51 L2248.3 1548.85 L2252.97 1548.85 L2252.97 1579.47 L2260.61 1579.47 L2260.61 1583.41 L2240.7 1583.41 L2240.7 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M2280.05 1551.93 Q2276.44 1551.93 2274.61 1555.49 Q2272.81 1559.03 2272.81 1566.16 Q2272.81 1573.27 2274.61 1576.83 Q2276.44 1580.38 2280.05 1580.38 Q2283.69 1580.38 2285.49 1576.83 Q2287.32 1573.27 2287.32 1566.16 Q2287.32 1559.03 2285.49 1555.49 Q2283.69 1551.93 2280.05 1551.93 M2280.05 1548.22 Q2285.86 1548.22 2288.92 1552.83 Q2292 1557.41 2292 1566.16 Q2292 1574.89 2288.92 1579.5 Q2285.86 1584.08 2280.05 1584.08 Q2274.24 1584.08 2271.17 1579.5 Q2268.11 1574.89 2268.11 1566.16 Q2268.11 1557.41 2271.17 1552.83 Q2274.24 1548.22 2280.05 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M2300.22 1577.53 L2305.1 1577.53 L2305.1 1583.41 L2300.22 1583.41 L2300.22 1577.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M2325.29 1551.93 Q2321.67 1551.93 2319.85 1555.49 Q2318.04 1559.03 2318.04 1566.16 Q2318.04 1573.27 2319.85 1576.83 Q2321.67 1580.38 2325.29 1580.38 Q2328.92 1580.38 2330.73 1576.83 Q2332.55 1573.27 2332.55 1566.16 Q2332.55 1559.03 2330.73 1555.49 Q2328.92 1551.93 2325.29 1551.93 M2325.29 1548.22 Q2331.1 1548.22 2334.15 1552.83 Q2337.23 1557.41 2337.23 1566.16 Q2337.23 1574.89 2334.15 1579.5 Q2331.1 1584.08 2325.29 1584.08 Q2319.48 1584.08 2316.4 1579.5 Q2313.34 1574.89 2313.34 1566.16 Q2313.34 1557.41 2316.4 1552.83 Q2319.48 1548.22 2325.29 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1464.9 2352.76,1464.9 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1193 2352.76,1193 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,921.104 2352.76,921.104 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,649.208 2352.76,649.208 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,377.312 2352.76,377.312 "/>
<polyline clip-path="url(#clip082)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,105.416 2352.76,105.416 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1464.9 105.89,1464.9 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1193 105.89,1193 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,921.104 105.89,921.104 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,649.208 105.89,649.208 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,377.312 105.89,377.312 "/>
<polyline clip-path="url(#clip080)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,105.416 105.89,105.416 "/>
<path clip-path="url(#clip080)" d="M-39.887 1465.35 L-10.2112 1465.35 L-10.2112 1469.28 L-39.887 1469.28 L-39.887 1465.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M0.69147 1478.24 L8.33032 1478.24 L8.33032 1451.88 L0.0201769 1453.54 L0.0201769 1449.28 L8.28402 1447.62 L12.9599 1447.62 L12.9599 1478.24 L20.5988 1478.24 L20.5988 1482.18 L0.69147 1482.18 L0.69147 1478.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M30.0895 1447.62 L48.4458 1447.62 L48.4458 1451.55 L34.3718 1451.55 L34.3718 1460.02 Q35.3904 1459.68 36.4089 1459.51 Q37.4274 1459.33 38.4459 1459.33 Q44.2329 1459.33 47.6125 1462.5 Q50.9921 1465.67 50.9921 1471.09 Q50.9921 1476.67 47.5199 1479.77 Q44.0477 1482.85 37.7283 1482.85 Q35.5524 1482.85 33.2839 1482.48 Q31.0385 1482.11 28.6311 1481.37 L28.6311 1476.67 Q30.7145 1477.8 32.9367 1478.36 Q35.1589 1478.91 37.6357 1478.91 Q41.6403 1478.91 43.9783 1476.81 Q46.3162 1474.7 46.3162 1471.09 Q46.3162 1467.48 43.9783 1465.37 Q41.6403 1463.26 37.6357 1463.26 Q35.7607 1463.26 33.8857 1463.68 Q32.0339 1464.1 30.0895 1464.98 L30.0895 1447.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M-40.8824 1193.45 L-11.2066 1193.45 L-11.2066 1197.39 L-40.8824 1197.39 L-40.8824 1193.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M-0.303895 1206.35 L7.33495 1206.35 L7.33495 1179.98 L-0.975188 1181.65 L-0.975188 1177.39 L7.28866 1175.72 L11.9646 1175.72 L11.9646 1206.35 L19.6034 1206.35 L19.6034 1210.28 L-0.303895 1210.28 L-0.303895 1206.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M39.0477 1178.8 Q35.4367 1178.8 33.608 1182.36 Q31.8024 1185.91 31.8024 1193.04 Q31.8024 1200.14 33.608 1203.71 Q35.4367 1207.25 39.0477 1207.25 Q42.682 1207.25 44.4875 1203.71 Q46.3162 1200.14 46.3162 1193.04 Q46.3162 1185.91 44.4875 1182.36 Q42.682 1178.8 39.0477 1178.8 M39.0477 1175.1 Q44.8579 1175.1 47.9134 1179.7 Q50.9921 1184.29 50.9921 1193.04 Q50.9921 1201.76 47.9134 1206.37 Q44.8579 1210.95 39.0477 1210.95 Q33.2376 1210.95 30.1589 1206.37 Q27.1034 1201.76 27.1034 1193.04 Q27.1034 1184.29 30.1589 1179.7 Q33.2376 1175.1 39.0477 1175.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M-9.72514 921.556 L19.9506 921.556 L19.9506 925.491 L-9.72514 925.491 L-9.72514 921.556 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M30.0895 903.824 L48.4458 903.824 L48.4458 907.76 L34.3718 907.76 L34.3718 916.232 Q35.3904 915.884 36.4089 915.722 Q37.4274 915.537 38.4459 915.537 Q44.2329 915.537 47.6125 918.709 Q50.9921 921.88 50.9921 927.296 Q50.9921 932.875 47.5199 935.977 Q44.0477 939.056 37.7283 939.056 Q35.5524 939.056 33.2839 938.685 Q31.0385 938.315 28.6311 937.574 L28.6311 932.875 Q30.7145 934.009 32.9367 934.565 Q35.1589 935.12 37.6357 935.12 Q41.6403 935.12 43.9783 933.014 Q46.3162 930.908 46.3162 927.296 Q46.3162 923.685 43.9783 921.579 Q41.6403 919.472 37.6357 919.472 Q35.7607 919.472 33.8857 919.889 Q32.0339 920.306 30.0895 921.185 L30.0895 903.824 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M39.0477 635.007 Q35.4367 635.007 33.608 638.572 Q31.8024 642.113 31.8024 649.243 Q31.8024 656.349 33.608 659.914 Q35.4367 663.456 39.0477 663.456 Q42.682 663.456 44.4875 659.914 Q46.3162 656.349 46.3162 649.243 Q46.3162 642.113 44.4875 638.572 Q42.682 635.007 39.0477 635.007 M39.0477 631.303 Q44.8579 631.303 47.9134 635.91 Q50.9921 640.493 50.9921 649.243 Q50.9921 657.97 47.9134 662.576 Q44.8579 667.16 39.0477 667.16 Q33.2376 667.16 30.1589 662.576 Q27.1034 657.97 27.1034 649.243 Q27.1034 640.493 30.1589 635.91 Q33.2376 631.303 39.0477 631.303 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M30.0895 360.032 L48.4458 360.032 L48.4458 363.967 L34.3718 363.967 L34.3718 372.44 Q35.3904 372.092 36.4089 371.93 Q37.4274 371.745 38.4459 371.745 Q44.2329 371.745 47.6125 374.916 Q50.9921 378.088 50.9921 383.504 Q50.9921 389.083 47.5199 392.185 Q44.0477 395.263 37.7283 395.263 Q35.5524 395.263 33.2839 394.893 Q31.0385 394.523 28.6311 393.782 L28.6311 389.083 Q30.7145 390.217 32.9367 390.773 Q35.1589 391.328 37.6357 391.328 Q41.6403 391.328 43.9783 389.222 Q46.3162 387.115 46.3162 383.504 Q46.3162 379.893 43.9783 377.787 Q41.6403 375.68 37.6357 375.68 Q35.7607 375.68 33.8857 376.097 Q32.0339 376.514 30.0895 377.393 L30.0895 360.032 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M-0.303895 118.761 L7.33495 118.761 L7.33495 92.3954 L-0.975188 94.062 L-0.975188 89.8028 L7.28866 88.1361 L11.9646 88.1361 L11.9646 118.761 L19.6034 118.761 L19.6034 122.696 L-0.303895 122.696 L-0.303895 118.761 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip080)" d="M39.0477 91.2148 Q35.4367 91.2148 33.608 94.7796 Q31.8024 98.3213 31.8024 105.451 Q31.8024 112.557 33.608 116.122 Q35.4367 119.664 39.0477 119.664 Q42.682 119.664 44.4875 116.122 Q46.3162 112.557 46.3162 105.451 Q46.3162 98.3213 44.4875 94.7796 Q42.682 91.2148 39.0477 91.2148 M39.0477 87.5111 Q44.8579 87.5111 47.9134 92.1176 Q50.9921 96.7009 50.9921 105.451 Q50.9921 114.178 47.9134 118.784 Q44.8579 123.367 39.0477 123.367 Q33.2376 123.367 30.1589 118.784 Q27.1034 114.178 27.1034 105.451 Q27.1034 96.7009 30.1589 92.1176 Q33.2376 87.5111 39.0477 87.5111 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip082)" d="M151.118 719.516 L364.869 1374.14 L578.62 1479.3 L792.371 1464.31 L1006.12 1424.67 L1219.87 1386.17 L1433.63 1354.54 L1647.38 1319.32 L1861.13 1285.9 L2074.88 1253.33 L2288.63 1226.55 L2288.63 262.273 L2074.88 245.406 L1861.13 221.857 L1647.38 202.255 L1433.63 177.736 L1219.87 152.807 L1006.12 125.258 L792.371 101.381 L578.62 88.9544 L364.869 154.304 L151.118 537.415  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip082)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,634.857 364.869,737.48 578.62,752.09 792.371,750.651 1006.12,745.917 1219.87,742.929 1433.63,735.796 1647.38,729.701 1861.13,725.399 2074.88,726.994 2288.63,723.182 "/>
<path clip-path="url(#clip082)" d="M151.118 765.702 L364.869 672.53 L578.62 653.725 L792.371 650.656 L1006.12 650.135 L1219.87 650.109 L1433.63 649.971 L1647.38 650.003 L1861.13 650.061 L2074.88 650.01 L2288.63 650.095 L2288.63 648.345 L2074.88 648.384 L1861.13 648.48 L1647.38 648.228 L1433.63 648.107 L1219.87 648.333 L1006.12 648.392 L792.371 648.344 L578.62 646.214 L364.869 633.794 L151.118 569.107  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip082)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,666.483 364.869,653.166 578.62,650.019 792.371,649.313 1006.12,649.226 1219.87,649.185 1433.63,649.309 1647.38,649.256 1861.13,649.215 2074.88,649.245 2288.63,649.178 "/>
</svg>
<h2 id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter"><a class="docs-heading-anchor" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter">Observables and Marginal Likelihood using a Kalman Filter</a><a id="Observables-and-Marginal-Likelihood-using-a-Kalman-Filter-1"></a><a class="docs-heading-anchor-permalink" href="#Observables-and-Marginal-Likelihood-using-a-Kalman-Filter" title="Permalink"></a></h2><p>If you provide <code>observables</code> and provide a distribution for the <code>observables_noise</code> then the model can provide a calculation of the likelihood.  </p><p>The simplest case is if you use a gaussian prior and have gaussian observation noise.  First, lets simulate some data with included observation noise.  If passing in a matrix or vector, the <code>observables_noise</code> argument is intended to be the cholesky of the covariance matrix.  At this point, only diagonal observation noise is allowed.</p><pre><code class="language-julia hljs">u0 = MvNormal([1.0 0.1; 0.1 1.0])  # draw from mean zero initial conditions
T = 10
prob = LinearStateSpaceProblem(A, B, u0, (0, T); C, observables_noise = D, syms = [:a, :b])
sol = solve(prob)
sol.z # simulated observables with observation noise</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11-element Vector{Vector{Float64}}:
 [-1.1214533199874694, -0.07942415748987719]
 [-0.9692816426832547, -9.167625949329011]
 [-1.2207578890313318, -10.71570869955395]
 [-1.3195703369488347, -10.415254603478871]
 [-0.8027569471486109, -9.378085585881314]
 [-1.072576857532435, -9.26397252390557]
 [-0.8316277656452901, -8.908988363115006]
 [-0.4979716746088165, -7.673521277621251]
 [-0.4933163834970611, -8.630609806187529]
 [-0.6786903314584506, -7.573747734133731]
 [-0.8826761470654202, -7.102961192788389]</code></pre><p>Next we will find the log likelihood of these simulated observables using the <code>u0</code> as a prior and with the true parameters.</p><p>The new arguments we pass to the problem creation are <code>u0_prior_variance, u0_prior_mean,</code> and <code>observables</code>.  The <code>u0</code> is ignored for the filtering problem but must match the size.  The <code>KalmanFilter()</code> argument to the <code>solve</code> is unnecessary since it can select it manually given the priors and observables.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The timing convention is such that <code>observables</code> are expected to match the predictions starting at the second time period.  As the likelihood of the first element <code>u0</code> comes from a prior, the <code>observables</code> start at the next element, and hence the observables and noise sequences should be 1 less than the tspan </p></div></div><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = copy(sol.W) # save for later
u0_prior_mean = [0.0, 0.0]
# use covariance of distribution we drew from
u0_prior_var = cov(u0)

prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
sol = solve(prob, KalmanFilter())
# plot(sol) The `u` is the sequence of posterior means.
sol.logpdf</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-9.473159968249735</code></pre><p>Hence the <code>logpdf</code> provides the log likelihood marginalizing out the latent noise variables.</p><p>As before, we can differentiate the kalman filter itself.</p><pre><code class="language-julia hljs">function kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, syms = [:a, :b], u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables)
# Find the gradient wrt the A, B, C and priors variance.
gradient((A, B, C, u0_prior_var) -&gt; kalman_likelihood(A, B, C, D, u0_prior_mean, u0_prior_var, observables), A, B, C, u0_prior_var)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-92.6243410330675 0.09872993022824378; -584.9857650789105 -15.833572052932485], [-4.695650427106574; -32.39902147421255;;], [56.44789104907027 0.0279333718543171; -4.569744612839884 0.22748606709924957], [-0.0690203980250775 3.543633402824983; -3.1788253007115865 0.4591751655441385])</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Some of the gradients, such as those for <code>observables</code>, have not been implemented so test carefully.  This is a general theme with gradients and <code>Zygote.jl</code> in general.  Your best friend in this process is the spectacular <a href="https://github.com/JuliaDiff/ChainRulesTestUtils.jl">ChainRulesTestUtils.jl</a> package. See <code>test_rrule</code> usage in the <a href="https://github.com/SciML/DifferenceEquations.jl/blob/main/test/linear_gradients.jl">linear unit tests</a>.</p></div></div><h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>A key application of these methods is to find the joint likelihood of the latent variables (i.e., the <code>noise</code>) and the model definition.</p><p>The actual calculation of the likelihood is trivial in that case, and just requires iteration of the linear system while accumulating the likelihood given the observation noise.</p><p>Crucially, the differentiability with respect to the high-dimensional noise vector enables gradient-based sampling and estimation methods which would otherwise be infeasible.</p><pre><code class="language-julia hljs">function joint_likelihood(A, B, C, D, u0, noise, observables)
    prob = LinearStateSpaceProblem(A, B, u0, (0, size(observables,2)); C, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood(A, B, C, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-4155.449027965711</code></pre><p>And as always, this can be differentiated with respect to the state-space matrices and the noise.  Choosing a few parameters,</p><pre><code class="language-julia hljs">gradient((A, u0, noise) -&gt; joint_likelihood(A, B, C, D, u0, noise, observables), A, u0, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-348.2045582467367 -17.83421752203789; -1885.5092944638543 -121.1959732399359], [-703.0647995364868, -5616.179898613342], [-51.38784981876087 -45.318522631687536 … -4.556893903346055 -0.0595280209337125])</code></pre><h2 id="Composition-of-State-Space-Models-and-AD"><a class="docs-heading-anchor" href="#Composition-of-State-Space-Models-and-AD">Composition of State Space Models and AD</a><a id="Composition-of-State-Space-Models-and-AD-1"></a><a class="docs-heading-anchor-permalink" href="#Composition-of-State-Space-Models-and-AD" title="Permalink"></a></h2><p>While the above gradients have been with respect to the full state space objects <code>A, B</code>, etc. those themselves could be generated through a separate procedure and the whole object differentiated.  For example, lets repeat the above examples where we generate the <code>A</code> matrix from some sort of deep parameters.</p><p>First we will generate some observations with a <code>generate_model</code> proxy–-which could be replaced with something more complicated but still differentiable</p><pre><code class="language-julia hljs">function generate_model(β)
    A = [β 6.2;
        0.0  0.2]
    B = Matrix([0.0  0.001]&#39;) # [0.0; 0.001;;] gives a zygote bug
    C = [0.09 0.67;
        1.00 0.00]
    D = [0.01, 0.01]
    return (;A,B,C,D)
end

function simulate_model(β, u0;T = 200)
    mod = generate_model(β)
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, T); mod.C, observables_noise = mod.D)
    sol = solve(prob) # simulates
    observables = hcat(sol.z...)
    observables = observables[:, 2:end] # see note above on likelihood and timing
    return observables, sol.W
end

# Fix a &quot;pseudo-true&quot; and generate noise and observables
β = 0.95
u0 = [0.0, 0.0]
observables, noise = simulate_model(β, u0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-0.1581858202498188 0.000506242464740485 … -0.05636902740413806 0.08658979203501363; -0.02162984182284967 0.02095581296295617 … -0.06518010885515804 -0.15281262802620207], [1.281920673928122 -1.064070716761896 … -0.32341695665050685 -1.3780651574303857])</code></pre><p>Next, we will evaluate the marginal likelihood using the kalman filter for a particular <code>β</code> value,</p><pre><code class="language-julia hljs">function kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, u0_prior_var, u0_prior_mean)
    return solve(prob).logpdf
end
u0_prior_mean = [0.0, 0.0]
u0_prior_var = [1e-10 0.0;
                0.0 1e-10]  # starting with degenerate prior
kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">358.04738227131054</code></pre><p>Given the observation error we would not expect the pseudo-true to exactly maximimize the log likelihood.  To show this, we can optimize it using using the Optim package and using a gradient-based optimization routine</p><pre><code class="language-julia hljs">using Optimization, OptimizationOptimJL
# Create a function to minimize only of β and use Zygote based gradients
kalman_objective(β,p) = -kalman_model_likelihood(β, u0_prior_mean, u0_prior_var, observables)
kalman_objective(0.95, nothing)
gradient(β -&gt;kalman_objective(β, nothing),β) # Verifying it can be differentiated


optf = OptimizationFunction(kalman_objective, Optimization.AutoZygote())
β0 = [0.91] # start off of the pseudotrue
optprob = OptimizationProblem(optf, β0)
optsol = solve(optprob,LBFGS())  # reverse-mode AD is overkill here</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 1-element Vector{Float64}:
 0.959135209265863</code></pre><p>In this way, this package composes with others such as <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">DifferentiableStateSpaceModels.jl</a> which take a set of structural parameters and an expectational difference equation and generate a state-space model.</p><p>Similarly, we can find the joint likelihood for a particular <code>β</code> value and noise.  Here we will add in prior.  Some form of a prior or regularization is generally necessary for these sorts of nonlinear models.</p><pre><code class="language-julia hljs">function joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)
    mod = generate_model(β) # generate model from structural parameters
    prob = LinearStateSpaceProblem(mod.A, mod.B, u0, (0, size(observables,2)); mod.C, observables,      observables_noise = mod.D, noise)
    return solve(prob).logpdf + sum(logpdf.(noise_prior, noise)) + logpdf(β_prior, β) # posterior
end
u0 = [0.0, 0.0]
noise_prior = Normal(0.0, 1.0)
β_prior = Normal(β, 0.03) # prior local to the true value
joint_model_posterior(β, u0, noise, observables, noise_prior, β_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">75.00051946117605</code></pre><p>Which we can turn into a differntiable objective adding in a prior on the noise</p><pre><code class="language-julia hljs">joint_model_objective(x, p) = -joint_model_posterior(x[1], u0, Matrix(x[2:end]&#39;), observables, noise_prior, β_prior) # extract noise and parameeter from vector
x0 = vcat([0.95], noise[1,:])  # starting at the true noise
joint_model_objective(x0, nothing)
gradient(x -&gt;joint_model_objective(x, nothing),x0) # Verifying it can be differentiated

# optimize
optf = OptimizationFunction(joint_model_objective, Optimization.AutoZygote())
optprob = OptimizationProblem(optf, x0)
optsol = solve(optprob,LBFGS())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">u: 201-element Vector{Float64}:
  0.9800677932549342
  0.05755688418502317
  0.05531764064470746
  0.050444301683182105
  0.030141564707146046
 -0.01635691676860105
 -0.04279991795710058
 -0.13895994231805756
 -0.146873891866985
 -0.2529376708716508
  ⋮
 -0.07905668735032209
 -0.15690025443651673
 -0.20894722713979352
 -0.22669178293414205
 -0.3310845692372593
 -0.23002139511726247
 -0.1840635144452459
 -0.10497576336966598
  0.005683934717213289</code></pre><p>This &quot;solves&quot; the problem relatively quickly, despite the high-dimensionality.  However, from a statistics perspective note that this last optimization process does not do especially well in recovering the pseudotrue if you increase the prior variance on the <code>β</code> parameter.  Maximizing the posterior is usually the wrong thing to do in high-dimensions because the mode is not a typical set.</p><h2 id="Caveats-on-Gradients-and-Performance"><a class="docs-heading-anchor" href="#Caveats-on-Gradients-and-Performance">Caveats on Gradients and Performance</a><a id="Caveats-on-Gradients-and-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Caveats-on-Gradients-and-Performance" title="Permalink"></a></h2><p>A few notes on performance and gradients:</p><ol><li>As this is using reverse-mode AD it will be efficient for fairly large systems as long as the ultimate value of your differentiable program.  With a little extra work and unit tests, it could support structured matrices/etc. as well.</li><li>Getting to much higher scales, where the <code>A,B,C,D</code> are so large that matrix-free operators is necessary, is feasible but will require generalizing those to LinearOperators.  This would be reasonably easy for the joint likelihood and feasible but possible for the Kalman filter</li><li>At this point, there is no support for forward-mode auto-differentiation.  For smaller systems with a kalman filter, this should dominate the alternatives, and efficient forward-mode AD rules for the kalman filter exist (see the supplementary materials in the the <a href="https://github.com/HighDimensionalEconLab/DifferentiableStateSpaceModels.jl">Differentiable State Space Models</a> paper).  However, it would be a significant amount of work to add end-to-end support and fulfill standard SciML interfaces, and perhaps waiting for <a href="https://enzyme.mit.edu/julia/">Enzyme</a> or similar AD systems that provide both forward/reverse/mixed mode makes sense.</li><li>Forward-mode AD is likely inappropriate for the joint-likelihood based models since the dimensionality of the noise is always large.</li><li>The gradient rules are written using <a href="https://github.com/JuliaDiff/ChainRules.jl">ChainRules.jl</a> so in theory they will work with any supporting AD.  In practice, though, Zygote is the most tested and other systems have inconsistent support on Julia at this time.</li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a><a class="docs-footer-nextpage" href="../quadratic_state_space_examples/">Quadratic State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 18 April 2023 19:28">Tuesday 18 April 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
