<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.022380839440705944]
 [-0.1373464678993582, -0.0056339011398814955]
 [-0.16533942336974752, 0.00487706065844036]
 [-0.1268988751177536, 0.0060080096283402565]
 [-0.08332476601714979, 0.011376370398196684]
 [-0.008364554843691559, -0.009746867752873669]
 [-0.06815150415185006, -0.010427115490363351]
 [-0.12908207999370286, -0.0017206193626691456]
 [-0.13335305030948563, -0.012170568675517987]
 ⋮
 [0.05730316925553396, -0.0013000609704795871]
 [0.046299211739949456, -0.0048264346220708125]
 [0.014040122890866556, 0.0014892643651743987]
 [0.022501456106752613, -0.01303967227967192]
 [-0.05903431801192387, -0.012896205686493318]
 [-0.13554472199618606, 0.012361024633245938]
 [-0.05184792156944474, -0.026619208917441076]
 [-0.21205887518881192, 0.003853721464464897]
 [-0.17766029105564762, 0.007687445940040502]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip240">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip240)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip241">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip240)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip242">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip240)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1377.72 2352.76,1377.72 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1167.96 2352.76,1167.96 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,958.195 2352.76,958.195 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,748.433 2352.76,748.433 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,538.671 2352.76,538.671 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,328.909 2352.76,328.909 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,119.147 2352.76,119.147 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1377.72 105.89,1377.72 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1167.96 105.89,1167.96 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,958.195 105.89,958.195 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,748.433 105.89,748.433 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,538.671 105.89,538.671 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,328.909 105.89,328.909 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,119.147 105.89,119.147 
  "/>
<path clip-path="url(#clip240)" d="M-85.1183 1378.17 L-55.4425 1378.17 L-55.4425 1382.11 L-85.1183 1382.11 L-85.1183 1378.17 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-35.35 1363.52 Q-38.9611 1363.52 -40.7898 1367.08 Q-42.5953 1370.62 -42.5953 1377.75 Q-42.5953 1384.86 -40.7898 1388.42 Q-38.9611 1391.97 -35.35 1391.97 Q-31.7158 1391.97 -29.9102 1388.42 Q-28.0815 1384.86 -28.0815 1377.75 Q-28.0815 1370.62 -29.9102 1367.08 Q-31.7158 1363.52 -35.35 1363.52 M-35.35 1359.81 Q-29.5398 1359.81 -26.4843 1364.42 Q-23.4056 1369 -23.4056 1377.75 Q-23.4056 1386.48 -26.4843 1391.09 Q-29.5398 1395.67 -35.35 1395.67 Q-41.1602 1395.67 -44.2388 1391.09 Q-47.2944 1386.48 -47.2944 1377.75 Q-47.2944 1369 -44.2388 1364.42 Q-41.1602 1359.81 -35.35 1359.81 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-15.1881 1389.12 L-10.3038 1389.12 L-10.3038 1395 L-15.1881 1395 L-15.1881 1389.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M3.90904 1391.06 L20.2284 1391.06 L20.2284 1395 L-1.71592 1395 L-1.71592 1391.06 Q0.946098 1388.31 5.52941 1383.68 Q10.1359 1379.03 11.3164 1377.68 Q13.5618 1375.16 14.4414 1373.42 Q15.3442 1371.67 15.3442 1369.98 Q15.3442 1367.22 13.3997 1365.48 Q11.4784 1363.75 8.37661 1363.75 Q6.17755 1363.75 3.72386 1364.51 Q1.29332 1365.28 -1.48444 1366.83 L-1.48444 1362.11 Q1.33961 1360.97 3.7933 1360.39 Q6.247 1359.81 8.28402 1359.81 Q13.6544 1359.81 16.8488 1362.5 Q20.0432 1365.18 20.0432 1369.67 Q20.0432 1371.8 19.233 1373.73 Q18.446 1375.62 16.3395 1378.22 Q15.7608 1378.89 12.659 1382.11 Q9.55716 1385.3 3.90904 1391.06 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M30.0895 1360.44 L48.4458 1360.44 L48.4458 1364.37 L34.3718 1364.37 L34.3718 1372.85 Q35.3904 1372.5 36.4089 1372.34 Q37.4274 1372.15 38.4459 1372.15 Q44.2329 1372.15 47.6125 1375.32 Q50.9921 1378.49 50.9921 1383.91 Q50.9921 1389.49 47.5199 1392.59 Q44.0477 1395.67 37.7283 1395.67 Q35.5524 1395.67 33.2839 1395.3 Q31.0385 1394.93 28.6311 1394.19 L28.6311 1389.49 Q30.7145 1390.62 32.9367 1391.18 Q35.1589 1391.73 37.6357 1391.73 Q41.6403 1391.73 43.9783 1389.63 Q46.3162 1387.52 46.3162 1383.91 Q46.3162 1380.3 43.9783 1378.19 Q41.6403 1376.09 37.6357 1376.09 Q35.7607 1376.09 33.8857 1376.5 Q32.0339 1376.92 30.0895 1377.8 L30.0895 1360.44 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-86.1136 1168.41 L-56.4379 1168.41 L-56.4379 1172.34 L-86.1136 1172.34 L-86.1136 1168.41 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-36.3454 1153.76 Q-39.9565 1153.76 -41.7852 1157.32 Q-43.5907 1160.86 -43.5907 1167.99 Q-43.5907 1175.1 -41.7852 1178.66 Q-39.9565 1182.2 -36.3454 1182.2 Q-32.7111 1182.2 -30.9056 1178.66 Q-29.0769 1175.1 -29.0769 1167.99 Q-29.0769 1160.86 -30.9056 1157.32 Q-32.7111 1153.76 -36.3454 1153.76 M-36.3454 1150.05 Q-30.5352 1150.05 -27.4797 1154.66 Q-24.401 1159.24 -24.401 1167.99 Q-24.401 1176.72 -27.4797 1181.32 Q-30.5352 1185.91 -36.3454 1185.91 Q-42.1555 1185.91 -45.2342 1181.32 Q-48.2897 1176.72 -48.2897 1167.99 Q-48.2897 1159.24 -45.2342 1154.66 Q-42.1555 1150.05 -36.3454 1150.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-16.1834 1179.36 L-11.2992 1179.36 L-11.2992 1185.24 L-16.1834 1185.24 L-16.1834 1179.36 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M2.91368 1181.3 L19.233 1181.3 L19.233 1185.24 L-2.71129 1185.24 L-2.71129 1181.3 Q-0.0492672 1178.55 4.53404 1173.92 Q9.1405 1169.26 10.321 1167.92 Q12.5664 1165.4 13.446 1163.66 Q14.3488 1161.9 14.3488 1160.21 Q14.3488 1157.46 12.4044 1155.72 Q10.4831 1153.99 7.38125 1153.99 Q5.18219 1153.99 2.7285 1154.75 Q0.297953 1155.51 -2.47981 1157.07 L-2.47981 1152.34 Q0.344249 1151.21 2.79794 1150.63 Q5.25163 1150.05 7.28866 1150.05 Q12.659 1150.05 15.8534 1152.74 Q19.0479 1155.42 19.0479 1159.91 Q19.0479 1162.04 18.2377 1163.96 Q17.4506 1165.86 15.3442 1168.45 Q14.7655 1169.13 11.6636 1172.34 Q8.5618 1175.54 2.91368 1181.3 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M39.0477 1153.76 Q35.4367 1153.76 33.608 1157.32 Q31.8024 1160.86 31.8024 1167.99 Q31.8024 1175.1 33.608 1178.66 Q35.4367 1182.2 39.0477 1182.2 Q42.682 1182.2 44.4875 1178.66 Q46.3162 1175.1 46.3162 1167.99 Q46.3162 1160.86 44.4875 1157.32 Q42.682 1153.76 39.0477 1153.76 M39.0477 1150.05 Q44.8579 1150.05 47.9134 1154.66 Q50.9921 1159.24 50.9921 1167.99 Q50.9921 1176.72 47.9134 1181.32 Q44.8579 1185.91 39.0477 1185.91 Q33.2376 1185.91 30.1589 1181.32 Q27.1034 1176.72 27.1034 1167.99 Q27.1034 1159.24 30.1589 1154.66 Q33.2376 1150.05 39.0477 1150.05 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-85.1183 958.646 L-55.4425 958.646 L-55.4425 962.581 L-85.1183 962.581 L-85.1183 958.646 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-35.35 943.994 Q-38.9611 943.994 -40.7898 947.558 Q-42.5953 951.1 -42.5953 958.23 Q-42.5953 965.336 -40.7898 968.901 Q-38.9611 972.442 -35.35 972.442 Q-31.7158 972.442 -29.9102 968.901 Q-28.0815 965.336 -28.0815 958.23 Q-28.0815 951.1 -29.9102 947.558 Q-31.7158 943.994 -35.35 943.994 M-35.35 940.29 Q-29.5398 940.29 -26.4843 944.896 Q-23.4056 949.48 -23.4056 958.23 Q-23.4056 966.956 -26.4843 971.563 Q-29.5398 976.146 -35.35 976.146 Q-41.1602 976.146 -44.2388 971.563 Q-47.2944 966.956 -47.2944 958.23 Q-47.2944 949.48 -44.2388 944.896 Q-41.1602 940.29 -35.35 940.29 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-15.1881 969.595 L-10.3038 969.595 L-10.3038 975.475 L-15.1881 975.475 L-15.1881 969.595 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M0.69147 971.54 L8.33032 971.54 L8.33032 945.174 L0.0201769 946.841 L0.0201769 942.581 L8.28402 940.915 L12.9599 940.915 L12.9599 971.54 L20.5988 971.54 L20.5988 975.475 L0.69147 975.475 L0.69147 971.54 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M30.0895 940.915 L48.4458 940.915 L48.4458 944.85 L34.3718 944.85 L34.3718 953.322 Q35.3904 952.975 36.4089 952.813 Q37.4274 952.628 38.4459 952.628 Q44.2329 952.628 47.6125 955.799 Q50.9921 958.97 50.9921 964.387 Q50.9921 969.966 47.5199 973.067 Q44.0477 976.146 37.7283 976.146 Q35.5524 976.146 33.2839 975.776 Q31.0385 975.405 28.6311 974.665 L28.6311 969.966 Q30.7145 971.1 32.9367 971.655 Q35.1589 972.211 37.6357 972.211 Q41.6403 972.211 43.9783 970.104 Q46.3162 967.998 46.3162 964.387 Q46.3162 960.776 43.9783 958.669 Q41.6403 956.563 37.6357 956.563 Q35.7607 956.563 33.8857 956.98 Q32.0339 957.396 30.0895 958.276 L30.0895 940.915 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-86.1136 748.884 L-56.4379 748.884 L-56.4379 752.819 L-86.1136 752.819 L-86.1136 748.884 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-36.3454 734.232 Q-39.9565 734.232 -41.7852 737.796 Q-43.5907 741.338 -43.5907 748.468 Q-43.5907 755.574 -41.7852 759.139 Q-39.9565 762.681 -36.3454 762.681 Q-32.7111 762.681 -30.9056 759.139 Q-29.0769 755.574 -29.0769 748.468 Q-29.0769 741.338 -30.9056 737.796 Q-32.7111 734.232 -36.3454 734.232 M-36.3454 730.528 Q-30.5352 730.528 -27.4797 735.134 Q-24.401 739.718 -24.401 748.468 Q-24.401 757.194 -27.4797 761.801 Q-30.5352 766.384 -36.3454 766.384 Q-42.1555 766.384 -45.2342 761.801 Q-48.2897 757.194 -48.2897 748.468 Q-48.2897 739.718 -45.2342 735.134 Q-42.1555 730.528 -36.3454 730.528 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-16.1834 759.833 L-11.2992 759.833 L-11.2992 765.713 L-16.1834 765.713 L-16.1834 759.833 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-0.303895 761.778 L7.33495 761.778 L7.33495 735.412 L-0.975188 737.079 L-0.975188 732.82 L7.28866 731.153 L11.9646 731.153 L11.9646 761.778 L19.6034 761.778 L19.6034 765.713 L-0.303895 765.713 L-0.303895 761.778 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M39.0477 734.232 Q35.4367 734.232 33.608 737.796 Q31.8024 741.338 31.8024 748.468 Q31.8024 755.574 33.608 759.139 Q35.4367 762.681 39.0477 762.681 Q42.682 762.681 44.4875 759.139 Q46.3162 755.574 46.3162 748.468 Q46.3162 741.338 44.4875 737.796 Q42.682 734.232 39.0477 734.232 M39.0477 730.528 Q44.8579 730.528 47.9134 735.134 Q50.9921 739.718 50.9921 748.468 Q50.9921 757.194 47.9134 761.801 Q44.8579 766.384 39.0477 766.384 Q33.2376 766.384 30.1589 761.801 Q27.1034 757.194 27.1034 748.468 Q27.1034 739.718 30.1589 735.134 Q33.2376 730.528 39.0477 730.528 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-85.1183 539.122 L-55.4425 539.122 L-55.4425 543.058 L-85.1183 543.058 L-85.1183 539.122 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-35.35 524.47 Q-38.9611 524.47 -40.7898 528.035 Q-42.5953 531.576 -42.5953 538.706 Q-42.5953 545.812 -40.7898 549.377 Q-38.9611 552.919 -35.35 552.919 Q-31.7158 552.919 -29.9102 549.377 Q-28.0815 545.812 -28.0815 538.706 Q-28.0815 531.576 -29.9102 528.035 Q-31.7158 524.47 -35.35 524.47 M-35.35 520.766 Q-29.5398 520.766 -26.4843 525.372 Q-23.4056 529.956 -23.4056 538.706 Q-23.4056 547.433 -26.4843 552.039 Q-29.5398 556.622 -35.35 556.622 Q-41.1602 556.622 -44.2388 552.039 Q-47.2944 547.433 -47.2944 538.706 Q-47.2944 529.956 -44.2388 525.372 Q-41.1602 520.766 -35.35 520.766 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-15.1881 550.071 L-10.3038 550.071 L-10.3038 555.951 L-15.1881 555.951 L-15.1881 550.071 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M9.88124 524.47 Q6.27014 524.47 4.44145 528.035 Q2.6359 531.576 2.6359 538.706 Q2.6359 545.812 4.44145 549.377 Q6.27014 552.919 9.88124 552.919 Q13.5155 552.919 15.321 549.377 Q17.1497 545.812 17.1497 538.706 Q17.1497 531.576 15.321 528.035 Q13.5155 524.47 9.88124 524.47 M9.88124 520.766 Q15.6914 520.766 18.7469 525.372 Q21.8256 529.956 21.8256 538.706 Q21.8256 547.433 18.7469 552.039 Q15.6914 556.622 9.88124 556.622 Q4.07108 556.622 0.992394 552.039 Q-2.06315 547.433 -2.06315 538.706 Q-2.06315 529.956 0.992394 525.372 Q4.07108 520.766 9.88124 520.766 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M30.0895 521.391 L48.4458 521.391 L48.4458 525.326 L34.3718 525.326 L34.3718 533.798 Q35.3904 533.451 36.4089 533.289 Q37.4274 533.104 38.4459 533.104 Q44.2329 533.104 47.6125 536.275 Q50.9921 539.446 50.9921 544.863 Q50.9921 550.442 47.5199 553.544 Q44.0477 556.622 37.7283 556.622 Q35.5524 556.622 33.2839 556.252 Q31.0385 555.882 28.6311 555.141 L28.6311 550.442 Q30.7145 551.576 32.9367 552.132 Q35.1589 552.687 37.6357 552.687 Q41.6403 552.687 43.9783 550.581 Q46.3162 548.474 46.3162 544.863 Q46.3162 541.252 43.9783 539.146 Q41.6403 537.039 37.6357 537.039 Q35.7607 537.039 33.8857 537.456 Q32.0339 537.872 30.0895 538.752 L30.0895 521.391 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-36.3454 314.708 Q-39.9565 314.708 -41.7852 318.273 Q-43.5907 321.814 -43.5907 328.944 Q-43.5907 336.05 -41.7852 339.615 Q-39.9565 343.157 -36.3454 343.157 Q-32.7111 343.157 -30.9056 339.615 Q-29.0769 336.05 -29.0769 328.944 Q-29.0769 321.814 -30.9056 318.273 Q-32.7111 314.708 -36.3454 314.708 M-36.3454 311.004 Q-30.5352 311.004 -27.4797 315.611 Q-24.401 320.194 -24.401 328.944 Q-24.401 337.671 -27.4797 342.277 Q-30.5352 346.86 -36.3454 346.86 Q-42.1555 346.86 -45.2342 342.277 Q-48.2897 337.671 -48.2897 328.944 Q-48.2897 320.194 -45.2342 315.611 Q-42.1555 311.004 -36.3454 311.004 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-16.1834 340.31 L-11.2992 340.31 L-11.2992 346.189 L-16.1834 346.189 L-16.1834 340.31 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M8.88587 314.708 Q5.27478 314.708 3.44608 318.273 Q1.64054 321.814 1.64054 328.944 Q1.64054 336.05 3.44608 339.615 Q5.27478 343.157 8.88587 343.157 Q12.5201 343.157 14.3257 339.615 Q16.1543 336.05 16.1543 328.944 Q16.1543 321.814 14.3257 318.273 Q12.5201 314.708 8.88587 314.708 M8.88587 311.004 Q14.696 311.004 17.7516 315.611 Q20.8303 320.194 20.8303 328.944 Q20.8303 337.671 17.7516 342.277 Q14.696 346.86 8.88587 346.86 Q3.07572 346.86 -0.00297114 342.277 Q-3.05851 337.671 -3.05851 328.944 Q-3.05851 320.194 -0.00297114 315.611 Q3.07572 311.004 8.88587 311.004 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M39.0477 314.708 Q35.4367 314.708 33.608 318.273 Q31.8024 321.814 31.8024 328.944 Q31.8024 336.05 33.608 339.615 Q35.4367 343.157 39.0477 343.157 Q42.682 343.157 44.4875 339.615 Q46.3162 336.05 46.3162 328.944 Q46.3162 321.814 44.4875 318.273 Q42.682 314.708 39.0477 314.708 M39.0477 311.004 Q44.8579 311.004 47.9134 315.611 Q50.9921 320.194 50.9921 328.944 Q50.9921 337.671 47.9134 342.277 Q44.8579 346.86 39.0477 346.86 Q33.2376 346.86 30.1589 342.277 Q27.1034 337.671 27.1034 328.944 Q27.1034 320.194 30.1589 315.611 Q33.2376 311.004 39.0477 311.004 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-35.35 104.946 Q-38.9611 104.946 -40.7898 108.511 Q-42.5953 112.052 -42.5953 119.182 Q-42.5953 126.288 -40.7898 129.853 Q-38.9611 133.395 -35.35 133.395 Q-31.7158 133.395 -29.9102 129.853 Q-28.0815 126.288 -28.0815 119.182 Q-28.0815 112.052 -29.9102 108.511 Q-31.7158 104.946 -35.35 104.946 M-35.35 101.242 Q-29.5398 101.242 -26.4843 105.849 Q-23.4056 110.432 -23.4056 119.182 Q-23.4056 127.909 -26.4843 132.515 Q-29.5398 137.099 -35.35 137.099 Q-41.1602 137.099 -44.2388 132.515 Q-47.2944 127.909 -47.2944 119.182 Q-47.2944 110.432 -44.2388 105.849 Q-41.1602 101.242 -35.35 101.242 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M-15.1881 130.548 L-10.3038 130.548 L-10.3038 136.427 L-15.1881 136.427 L-15.1881 130.548 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M9.88124 104.946 Q6.27014 104.946 4.44145 108.511 Q2.6359 112.052 2.6359 119.182 Q2.6359 126.288 4.44145 129.853 Q6.27014 133.395 9.88124 133.395 Q13.5155 133.395 15.321 129.853 Q17.1497 126.288 17.1497 119.182 Q17.1497 112.052 15.321 108.511 Q13.5155 104.946 9.88124 104.946 M9.88124 101.242 Q15.6914 101.242 18.7469 105.849 Q21.8256 110.432 21.8256 119.182 Q21.8256 127.909 18.7469 132.515 Q15.6914 137.099 9.88124 137.099 Q4.07108 137.099 0.992394 132.515 Q-2.06315 127.909 -2.06315 119.182 Q-2.06315 110.432 0.992394 105.849 Q4.07108 101.242 9.88124 101.242 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip240)" d="M30.0895 101.867 L48.4458 101.867 L48.4458 105.802 L34.3718 105.802 L34.3718 114.275 Q35.3904 113.927 36.4089 113.765 Q37.4274 113.58 38.4459 113.58 Q44.2329 113.58 47.6125 116.751 Q50.9921 119.923 50.9921 125.339 Q50.9921 130.918 47.5199 134.02 Q44.0477 137.099 37.7283 137.099 Q35.5524 137.099 33.2839 136.728 Q31.0385 136.358 28.6311 135.617 L28.6311 130.918 Q30.7145 132.052 32.9367 132.608 Q35.1589 133.163 37.6357 133.163 Q41.6403 133.163 43.9783 131.057 Q46.3162 128.95 46.3162 125.339 Q46.3162 121.728 43.9783 119.622 Q41.6403 117.515 37.6357 117.515 Q35.7607 117.515 33.8857 117.932 Q32.0339 118.349 30.0895 119.228 L30.0895 101.867 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip242)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,328.909 162.518,329.237 238.043,905.11 313.569,1022.55 389.094,861.28 464.619,678.476 540.145,364 615.67,614.821 691.196,870.439 766.721,888.357 
  842.247,1174.88 917.772,1307.6 993.298,1426.47 1068.82,1446.21 1144.35,1464 1219.87,1346.09 1295.4,1050.6 1370.92,988.47 1446.45,903.397 1521.98,333.343 
  1597.5,159.821 1673.03,228.544 1748.55,88.5087 1824.08,134.673 1899.6,270.007 1975.13,234.51 2050.65,576.572 2126.18,897.552 2201.7,546.424 2277.23,1218.55 
  2352.76,1074.24 
  "/>
<polyline clip-path="url(#clip242)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,328.909 162.518,422.802 238.043,352.545 313.569,308.449 389.094,303.704 464.619,281.183 540.145,369.8 615.67,372.653 691.196,336.128 766.721,379.968 
  842.247,357.239 917.772,356.072 993.298,340.934 1068.82,340.777 1144.35,318.966 1219.87,289.475 1295.4,324.645 1370.92,320.444 1446.45,242.314 1521.98,300.997 
  1597.5,338.584 1673.03,305.532 1748.55,334.363 1824.08,349.157 1899.6,322.661 1975.13,383.614 2050.65,383.012 2126.18,277.052 2201.7,440.583 2277.23,312.742 
  2352.76,296.658 
  "/>
<path clip-path="url(#clip240)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip240)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip240)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip240)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip240)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip240)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -2.23808  -0.115773  0.600384  0.50326  …  -2.90914  0.917756  0.69167</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip300">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip300)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip301">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip300)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip302">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip300)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1227.62 2352.76,1227.62 
  "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,920.119 2352.76,920.119 
  "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,612.622 2352.76,612.622 
  "/>
<polyline clip-path="url(#clip302)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,305.125 2352.76,305.125 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1227.62 105.89,1227.62 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,920.119 105.89,920.119 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,612.622 105.89,612.622 
  "/>
<polyline clip-path="url(#clip300)" style="stroke:#000000; stroke-linecap:butt; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,305.125 105.89,305.125 
  "/>
<path clip-path="url(#clip300)" d="M39.0477 1213.41 Q35.4367 1213.41 33.608 1216.98 Q31.8024 1220.52 31.8024 1227.65 Q31.8024 1234.76 33.608 1238.32 Q35.4367 1241.86 39.0477 1241.86 Q42.682 1241.86 44.4875 1238.32 Q46.3162 1234.76 46.3162 1227.65 Q46.3162 1220.52 44.4875 1216.98 Q42.682 1213.41 39.0477 1213.41 M39.0477 1209.71 Q44.8579 1209.71 47.9134 1214.32 Q50.9921 1218.9 50.9921 1227.65 Q50.9921 1236.38 47.9134 1240.98 Q44.8579 1245.57 39.0477 1245.57 Q33.2376 1245.57 30.1589 1240.98 Q27.1034 1236.38 27.1034 1227.65 Q27.1034 1218.9 30.1589 1214.32 Q33.2376 1209.71 39.0477 1209.71 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M30.0895 902.839 L48.4458 902.839 L48.4458 906.774 L34.3718 906.774 L34.3718 915.246 Q35.3904 914.899 36.4089 914.737 Q37.4274 914.552 38.4459 914.552 Q44.2329 914.552 47.6125 917.723 Q50.9921 920.894 50.9921 926.311 Q50.9921 931.89 47.5199 934.992 Q44.0477 938.07 37.7283 938.07 Q35.5524 938.07 33.2839 937.7 Q31.0385 937.33 28.6311 936.589 L28.6311 931.89 Q30.7145 933.024 32.9367 933.58 Q35.1589 934.135 37.6357 934.135 Q41.6403 934.135 43.9783 932.029 Q46.3162 929.922 46.3162 926.311 Q46.3162 922.7 43.9783 920.594 Q41.6403 918.487 37.6357 918.487 Q35.7607 918.487 33.8857 918.904 Q32.0339 919.32 30.0895 920.2 L30.0895 902.839 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M-0.303895 625.967 L7.33495 625.967 L7.33495 599.601 L-0.975188 601.268 L-0.975188 597.009 L7.28866 595.342 L11.9646 595.342 L11.9646 625.967 L19.6034 625.967 L19.6034 629.902 L-0.303895 629.902 L-0.303895 625.967 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M39.0477 598.421 Q35.4367 598.421 33.608 601.986 Q31.8024 605.527 31.8024 612.657 Q31.8024 619.763 33.608 623.328 Q35.4367 626.87 39.0477 626.87 Q42.682 626.87 44.4875 623.328 Q46.3162 619.763 46.3162 612.657 Q46.3162 605.527 44.4875 601.986 Q42.682 598.421 39.0477 598.421 M39.0477 594.717 Q44.8579 594.717 47.9134 599.324 Q50.9921 603.907 50.9921 612.657 Q50.9921 621.384 47.9134 625.99 Q44.8579 630.573 39.0477 630.573 Q33.2376 630.573 30.1589 625.99 Q27.1034 621.384 27.1034 612.657 Q27.1034 603.907 30.1589 599.324 Q33.2376 594.717 39.0477 594.717 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M0.69147 318.47 L8.33032 318.47 L8.33032 292.105 L0.0201769 293.771 L0.0201769 289.512 L8.28402 287.845 L12.9599 287.845 L12.9599 318.47 L20.5988 318.47 L20.5988 322.405 L0.69147 322.405 L0.69147 318.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip300)" d="M30.0895 287.845 L48.4458 287.845 L48.4458 291.78 L34.3718 291.78 L34.3718 300.253 Q35.3904 299.905 36.4089 299.743 Q37.4274 299.558 38.4459 299.558 Q44.2329 299.558 47.6125 302.729 Q50.9921 305.901 50.9921 311.317 Q50.9921 316.896 47.5199 319.998 Q44.0477 323.077 37.7283 323.077 Q35.5524 323.077 33.2839 322.706 Q31.0385 322.336 28.6311 321.595 L28.6311 316.896 Q30.7145 318.03 32.9367 318.586 Q35.1589 319.141 37.6357 319.141 Q41.6403 319.141 43.9783 317.035 Q46.3162 314.928 46.3162 311.317 Q46.3162 307.706 43.9783 305.6 Q41.6403 303.493 37.6357 303.493 Q35.7607 303.493 33.8857 303.91 Q32.0339 304.327 30.0895 305.206 L30.0895 287.845 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip302)" d="
M151.118 1313.73 L222.368 1428.06 L293.618 1479.3 L364.869 1476.82 L436.119 1464.29 L507.37 1451.66 L578.62 1444.13 L649.871 1431.78 L721.121 1421.64 L792.371 1410.66 
  L863.622 1402.4 L934.872 1393.46 L1006.12 1388.17 L1077.37 1383.13 L1148.62 1374.73 L1219.87 1370.35 L1291.12 1366.02 L1362.37 1355.72 L1433.63 1350.02 L1504.88 1346.01 
  L1576.13 1342.45 L1647.38 1335.23 L1718.63 1331.58 L1789.88 1327.65 L1861.13 1321.46 L1932.38 1314.43 L2003.63 1307.18 L2074.88 1304.43 L2146.13 1303.13 L2217.38 1301.52 
  L2288.63 1301.25 L2288.63 966.774 L2217.38 955.13 L2146.13 944.823 L2074.88 924.251 L2003.63 908.27 L1932.38 889.186 L1861.13 867.111 L1789.88 845.89 L1718.63 827.934 
  L1647.38 805.021 L1576.13 782.173 L1504.88 753.912 L1433.63 723.896 L1362.37 699.368 L1291.12 669.484 L1219.87 639.139 L1148.62 613.288 L1077.37 576.187 L1006.12 537.585 
  L934.872 505.138 L863.622 465.577 L792.371 427.596 L721.121 384.975 L649.871 335.853 L578.62 286.804 L507.37 233.657 L436.119 175.038 L364.869 120.482 L293.618 88.9544 
  L222.368 178.608 L151.118 1141.34  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip302)" style="stroke:#009af9; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1238.58 222.368,1260.29 293.618,1315.03 364.869,1312.72 436.119,1305.01 507.37,1303.43 578.62,1301.13 649.871,1300.21 721.121,1297.99 792.371,1298.33 
  863.622,1294.67 934.872,1290.28 1006.12,1291.37 1077.37,1290.53 1148.62,1290.96 1219.87,1286.72 1291.12,1283.24 1362.37,1278.53 1433.63,1276.01 1504.88,1271.36 
  1576.13,1273.34 1647.38,1267.99 1718.63,1263.62 1789.88,1257.49 1861.13,1254.27 1932.38,1246.06 2003.63,1241.05 2074.88,1240.17 2146.13,1240.18 2217.38,1236.08 
  2288.63,1234.37 
  "/>
<path clip-path="url(#clip302)" d="
M151.118 1330.01 L222.368 1248.13 L293.618 1231.6 L364.869 1229.28 L436.119 1228.65 L507.37 1228.46 L578.62 1228.49 L649.871 1228.6 L721.121 1228.49 L792.371 1228.66 
  L863.622 1228.42 L934.872 1228.53 L1006.12 1228.57 L1077.37 1228.72 L1148.62 1228.34 L1219.87 1228.5 L1291.12 1228.69 L1362.37 1228.46 L1433.63 1228.71 L1504.88 1228.99 
  L1576.13 1228.48 L1647.38 1228.24 L1718.63 1228.68 L1789.88 1228.44 L1861.13 1228.16 L1932.38 1228.22 L2003.63 1228.41 L2074.88 1228.58 L2146.13 1228.63 L2217.38 1228.42 
  L2288.63 1228.61 L2288.63 1226.54 L2217.38 1226.67 L2146.13 1226.83 L2074.88 1226.98 L2003.63 1226.66 L1932.38 1226.6 L1861.13 1226.6 L1789.88 1226.55 L1718.63 1226.56 
  L1647.38 1226.41 L1576.13 1226.54 L1504.88 1226.68 L1433.63 1226.59 L1362.37 1226.73 L1291.12 1226.84 L1219.87 1226.72 L1148.62 1226.64 L1077.37 1226.91 L1006.12 1227.04 
  L934.872 1226.78 L863.622 1226.59 L792.371 1226.64 L721.121 1226.72 L649.871 1226.75 L578.62 1226.69 L507.37 1226.79 L436.119 1226.72 L364.869 1226.55 L293.618 1223.29 
  L222.368 1209.27 L151.118 1135.98  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip302)" style="stroke:#e26f46; stroke-linecap:butt; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1244.24 222.368,1230.49 293.618,1227.89 364.869,1227.54 436.119,1227.84 507.37,1227.58 578.62,1227.69 649.871,1227.59 721.121,1227.57 792.371,1227.51 
  863.622,1227.53 934.872,1227.72 1006.12,1227.81 1077.37,1227.73 1148.62,1227.66 1219.87,1227.7 1291.12,1227.59 1362.37,1227.53 1433.63,1227.73 1504.88,1227.71 
  1576.13,1227.61 1647.38,1227.55 1718.63,1227.65 1789.88,1227.6 1861.13,1227.32 1932.38,1227.48 2003.63,1227.56 2074.88,1227.86 2146.13,1227.67 2217.38,1227.57 
  2288.63,1227.57 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">43.59166762409627</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([425.00659919411464, 2698.362512135158], [-70.67630419215617 0.42124188275813634; -563.8279746789933 -1.43203060590544], [13.148908873785281 -0.13751218017754968; 110.10579443021128 -0.5085351307497035;;; -0.13751218017754968 0.030588054408715853; -0.5085351307497035 0.22024625123984268], [22.37807577505248; 300.46864006262285;;], [-8.15279296872604, 80.39068264141518], [10.249821143139185 0.31789242757191327; 1.7534578380263603 -0.1228696396961477], [-2.5346154818168545 -0.02341913590509813; -0.8405464491617818 0.03284889204373167;;; -0.02341913590509813 -0.0032446373585815727; 0.03284889204373167 0.005672600682614715], [4.402964860692105 4.531418273764618 … -1.0615758991810942 0.08984833956934367])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 13 August 2022 15:18">Saturday 13 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
