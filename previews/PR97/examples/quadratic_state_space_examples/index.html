<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.003910211306458499]
 [0.024138566091645206, 0.01812953959682082]
 [0.13631448070755692, -0.003826182764461647]
 [0.10570538710290774, 0.010743393632412094]
 [0.16738584522129782, 0.010502557642337722]
 [0.22451149112124288, -0.006919320736193219]
 [0.1703436842762146, -0.015383666998023902]
 [0.06692902154250091, -0.0010468468850374272]
 [0.05701184757239061, -0.006286767507455233]
 ⋮
 [-0.12597441476159268, 0.0016798011371847651]
 [-0.10934824393555599, 0.014452680522022388]
 [-0.013810409938384833, 0.009955663562630881]
 [0.04882582984002178, 0.0122476540198507]
 [0.12274852876007467, 0.009080891724257844]
 [0.17316268127670625, 0.022038889338974865]
 [0.30283367799935734, 0.002523762939015958]
 [0.30331393249836286, -0.015149970832599717]
 [0.19453548106028934, 0.00795911155389672]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip390">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip390)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip391">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip390)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip392">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip390)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1294.18 2352.76,1294.18 "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,995.24 2352.76,995.24 "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,696.299 2352.76,696.299 "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,397.357 2352.76,397.357 "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,98.4154 2352.76,98.4154 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1294.18 105.89,1294.18 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,995.24 105.89,995.24 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,696.299 105.89,696.299 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,397.357 105.89,397.357 "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,98.4154 105.89,98.4154 "/>
<path clip-path="url(#clip390)" d="M-54.7249 1294.63 L-25.0491 1294.63 L-25.0491 1298.57 L-54.7249 1298.57 L-54.7249 1294.63 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-4.95665 1279.98 Q-8.56774 1279.98 -10.3964 1283.55 Q-12.202 1287.09 -12.202 1294.22 Q-12.202 1301.32 -10.3964 1304.89 Q-8.56774 1308.43 -4.95665 1308.43 Q-1.32241 1308.43 0.483137 1304.89 Q2.31183 1301.32 2.31183 1294.22 Q2.31183 1287.09 0.483137 1283.55 Q-1.32241 1279.98 -4.95665 1279.98 M-4.95665 1276.28 Q0.853506 1276.28 3.90904 1280.88 Q6.98773 1285.47 6.98773 1294.22 Q6.98773 1302.94 3.90904 1307.55 Q0.853506 1312.13 -4.95665 1312.13 Q-10.7668 1312.13 -13.8455 1307.55 Q-16.901 1302.94 -16.901 1294.22 Q-16.901 1285.47 -13.8455 1280.88 Q-10.7668 1276.28 -4.95665 1276.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M15.2053 1305.58 L20.0895 1305.58 L20.0895 1311.46 L15.2053 1311.46 L15.2053 1305.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M31.0848 1307.53 L38.7237 1307.53 L38.7237 1281.16 L30.4135 1282.83 L30.4135 1278.57 L38.6774 1276.9 L43.3533 1276.9 L43.3533 1307.53 L50.9921 1307.53 L50.9921 1311.46 L31.0848 1311.46 L31.0848 1307.53 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-6.18349 981.039 Q-9.79459 981.039 -11.6233 984.604 Q-13.4288 988.145 -13.4288 995.275 Q-13.4288 1002.38 -11.6233 1005.95 Q-9.79459 1009.49 -6.18349 1009.49 Q-2.54925 1009.49 -0.743708 1005.95 Q1.08499 1002.38 1.08499 995.275 Q1.08499 988.145 -0.743708 984.604 Q-2.54925 981.039 -6.18349 981.039 M-6.18349 977.335 Q-0.37334 977.335 2.6822 981.942 Q5.76089 986.525 5.76089 995.275 Q5.76089 1004 2.6822 1008.61 Q-0.37334 1013.19 -6.18349 1013.19 Q-11.9936 1013.19 -15.0723 1008.61 Q-18.1279 1004 -18.1279 995.275 Q-18.1279 986.525 -15.0723 981.942 Q-11.9936 977.335 -6.18349 977.335 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M13.9784 1006.64 L18.8627 1006.64 L18.8627 1012.52 L13.9784 1012.52 L13.9784 1006.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M39.0477 981.039 Q35.4367 981.039 33.608 984.604 Q31.8024 988.145 31.8024 995.275 Q31.8024 1002.38 33.608 1005.95 Q35.4367 1009.49 39.0477 1009.49 Q42.682 1009.49 44.4875 1005.95 Q46.3162 1002.38 46.3162 995.275 Q46.3162 988.145 44.4875 984.604 Q42.682 981.039 39.0477 981.039 M39.0477 977.335 Q44.8579 977.335 47.9134 981.942 Q50.9921 986.525 50.9921 995.275 Q50.9921 1004 47.9134 1008.61 Q44.8579 1013.19 39.0477 1013.19 Q33.2376 1013.19 30.1589 1008.61 Q27.1034 1004 27.1034 995.275 Q27.1034 986.525 30.1589 981.942 Q33.2376 977.335 39.0477 977.335 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-4.95665 682.097 Q-8.56774 682.097 -10.3964 685.662 Q-12.202 689.204 -12.202 696.333 Q-12.202 703.44 -10.3964 707.005 Q-8.56774 710.546 -4.95665 710.546 Q-1.32241 710.546 0.483137 707.005 Q2.31183 703.44 2.31183 696.333 Q2.31183 689.204 0.483137 685.662 Q-1.32241 682.097 -4.95665 682.097 M-4.95665 678.394 Q0.853506 678.394 3.90904 683 Q6.98773 687.583 6.98773 696.333 Q6.98773 705.06 3.90904 709.667 Q0.853506 714.25 -4.95665 714.25 Q-10.7668 714.25 -13.8455 709.667 Q-16.901 705.06 -16.901 696.333 Q-16.901 687.583 -13.8455 683 Q-10.7668 678.394 -4.95665 678.394 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M15.2053 707.699 L20.0895 707.699 L20.0895 713.579 L15.2053 713.579 L15.2053 707.699 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M31.0848 709.643 L38.7237 709.643 L38.7237 683.278 L30.4135 684.944 L30.4135 680.685 L38.6774 679.019 L43.3533 679.019 L43.3533 709.643 L50.9921 709.643 L50.9921 713.579 L31.0848 713.579 L31.0848 709.643 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-4.58628 383.156 Q-8.19737 383.156 -10.0261 386.72 Q-11.8316 390.262 -11.8316 397.392 Q-11.8316 404.498 -10.0261 408.063 Q-8.19737 411.605 -4.58628 411.605 Q-0.95204 411.605 0.853506 408.063 Q2.6822 404.498 2.6822 397.392 Q2.6822 390.262 0.853506 386.72 Q-0.95204 383.156 -4.58628 383.156 M-4.58628 379.452 Q1.22387 379.452 4.27941 384.058 Q7.3581 388.642 7.3581 397.392 Q7.3581 406.119 4.27941 410.725 Q1.22387 415.308 -4.58628 415.308 Q-10.3964 415.308 -13.4751 410.725 Q-16.5307 406.119 -16.5307 397.392 Q-16.5307 388.642 -13.4751 384.058 Q-10.3964 379.452 -4.58628 379.452 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M15.5756 408.757 L20.4599 408.757 L20.4599 414.637 L15.5756 414.637 L15.5756 408.757 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M34.6728 410.702 L50.9921 410.702 L50.9921 414.637 L29.0478 414.637 L29.0478 410.702 Q31.7098 407.947 36.2931 403.318 Q40.8996 398.665 42.0801 397.322 Q44.3255 394.799 45.2051 393.063 Q46.1079 391.304 46.1079 389.614 Q46.1079 386.859 44.1635 385.123 Q42.2422 383.387 39.1403 383.387 Q36.9413 383.387 34.4876 384.151 Q32.057 384.915 29.2793 386.466 L29.2793 381.744 Q32.1033 380.609 34.557 380.031 Q37.0107 379.452 39.0477 379.452 Q44.4181 379.452 47.6125 382.137 Q50.8069 384.822 50.8069 389.313 Q50.8069 391.443 49.9968 393.364 Q49.2097 395.262 47.1033 397.855 Q46.5246 398.526 43.4227 401.744 Q40.3209 404.938 34.6728 410.702 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-5.53535 84.2141 Q-9.14644 84.2141 -10.9751 87.7789 Q-12.7807 91.3205 -12.7807 98.4501 Q-12.7807 105.557 -10.9751 109.121 Q-9.14644 112.663 -5.53535 112.663 Q-1.90111 112.663 -0.0955632 109.121 Q1.73313 105.557 1.73313 98.4501 Q1.73313 91.3205 -0.0955632 87.7789 Q-1.90111 84.2141 -5.53535 84.2141 M-5.53535 80.5104 Q0.274805 80.5104 3.33034 85.1169 Q6.40903 89.7002 6.40903 98.4501 Q6.40903 107.177 3.33034 111.783 Q0.274805 116.367 -5.53535 116.367 Q-11.3455 116.367 -14.4242 111.783 Q-17.4797 107.177 -17.4797 98.4501 Q-17.4797 89.7002 -14.4242 85.1169 Q-11.3455 80.5104 -5.53535 80.5104 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M14.6266 109.816 L19.5108 109.816 L19.5108 115.695 L14.6266 115.695 L14.6266 109.816 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip390)" d="M43.8625 97.0613 Q47.219 97.7788 49.094 100.047 Q50.9921 102.316 50.9921 105.649 Q50.9921 110.765 47.4736 113.566 Q43.9551 116.367 37.4737 116.367 Q35.2978 116.367 32.983 115.927 Q30.6913 115.51 28.2376 114.654 L28.2376 110.14 Q30.1821 111.274 32.4969 111.853 Q34.8117 112.432 37.3348 112.432 Q41.7329 112.432 44.0246 110.695 Q46.3394 108.959 46.3394 105.649 Q46.3394 102.594 44.1866 100.881 Q42.057 99.1446 38.2376 99.1446 L34.2098 99.1446 L34.2098 95.302 L38.4227 95.302 Q41.8718 95.302 43.7005 93.9363 Q45.5292 92.5474 45.5292 89.9548 Q45.5292 87.2928 43.6311 85.8808 Q41.7561 84.4456 38.2376 84.4456 Q36.3163 84.4456 34.1172 84.8622 Q31.9182 85.2789 29.2793 86.1585 L29.2793 81.9919 Q31.9413 81.2512 34.2561 80.8808 Q36.5941 80.5104 38.6542 80.5104 Q43.9783 80.5104 47.0801 82.941 Q50.1819 85.3484 50.1819 89.4687 Q50.1819 92.3391 48.5384 94.3298 Q46.8949 96.2974 43.8625 97.0613 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip392)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,995.24 162.518,995.474 238.043,923.08 313.569,587.739 389.094,679.243 464.619,494.854 540.145,324.082 615.67,486.012 691.196,795.161 766.721,824.808 842.247,949.787 917.772,1217.57 993.298,1160.63 1068.82,1087.03 1144.35,1021 1219.87,989.464 1295.4,622.952 1370.92,720.36 1446.45,1029.97 1521.98,1152.98 1597.5,1409.65 1673.03,1464 1748.55,1371.83 1824.08,1322.13 1899.6,1036.53 1975.13,849.279 2050.65,628.294 2126.18,477.585 2201.7,89.9444 2277.23,88.5087 2352.76,413.693 "/>
<polyline clip-path="url(#clip392)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,995.24 162.518,983.551 238.043,941.043 313.569,1006.68 389.094,963.124 464.619,963.844 540.145,1015.92 615.67,1041.23 691.196,998.37 766.721,1014.03 842.247,1038.33 917.772,987.815 993.298,984.677 1068.82,985.307 1144.35,990.326 1219.87,936.621 1295.4,1007.92 1370.92,1043.26 1446.45,1015.39 1521.98,1038.21 1597.5,1007.35 1673.03,984.116 1748.55,990.219 1824.08,952.035 1899.6,965.479 1975.13,958.627 2050.65,968.094 2126.18,929.357 2201.7,987.696 2277.23,1040.53 2352.76,971.447 "/>
<path clip-path="url(#clip390)" d="M162.518 1456.66 L412.288 1456.66 L412.288 1301.14 L162.518 1301.14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="162.518,1456.66 412.288,1456.66 412.288,1301.14 162.518,1301.14 162.518,1456.66 "/>
<polyline clip-path="url(#clip390)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1352.98 338.744,1352.98 "/>
<path clip-path="url(#clip390)" d="M377.322 1357.23 Q372.16 1357.23 370.169 1358.41 Q368.178 1359.59 368.178 1362.44 Q368.178 1364.7 369.66 1366.05 Q371.164 1367.37 373.734 1367.37 Q377.275 1367.37 379.405 1364.87 Q381.558 1362.34 381.558 1358.18 L381.558 1357.23 L377.322 1357.23 M385.817 1355.47 L385.817 1370.26 L381.558 1370.26 L381.558 1366.32 Q380.099 1368.69 377.923 1369.82 Q375.747 1370.93 372.599 1370.93 Q368.618 1370.93 366.257 1368.71 Q363.919 1366.46 363.919 1362.71 Q363.919 1358.34 366.835 1356.12 Q369.775 1353.89 375.585 1353.89 L381.558 1353.89 L381.558 1353.48 Q381.558 1350.54 379.613 1348.94 Q377.692 1347.32 374.197 1347.32 Q371.974 1347.32 369.868 1347.85 Q367.761 1348.38 365.817 1349.45 L365.817 1345.51 Q368.155 1344.61 370.354 1344.17 Q372.553 1343.71 374.636 1343.71 Q380.261 1343.71 383.039 1346.63 Q385.817 1349.54 385.817 1355.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip390)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="187.693,1404.82 338.744,1404.82 "/>
<path clip-path="url(#clip390)" d="M382.692 1409.16 Q382.692 1404.46 380.747 1401.8 Q378.826 1399.11 375.447 1399.11 Q372.067 1399.11 370.122 1401.8 Q368.201 1404.46 368.201 1409.16 Q368.201 1413.86 370.122 1416.54 Q372.067 1419.21 375.447 1419.21 Q378.826 1419.21 380.747 1416.54 Q382.692 1413.86 382.692 1409.16 M368.201 1400.11 Q369.544 1397.79 371.581 1396.68 Q373.641 1395.55 376.488 1395.55 Q381.21 1395.55 384.15 1399.3 Q387.113 1403.05 387.113 1409.16 Q387.113 1415.27 384.15 1419.02 Q381.21 1422.77 376.488 1422.77 Q373.641 1422.77 371.581 1421.66 Q369.544 1420.53 368.201 1418.21 L368.201 1422.1 L363.919 1422.1 L363.919 1386.08 L368.201 1386.08 L368.201 1400.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.391021  1.73475  -0.745209  1.15086  …  -0.188401  -1.56547  1.09891</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip450">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip450)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip451">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip450)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip452">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip450)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1234.23 2352.76,1234.23 "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,881.95 2352.76,881.95 "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,529.674 2352.76,529.674 "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,177.399 2352.76,177.399 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1234.23 105.89,1234.23 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,881.95 105.89,881.95 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,529.674 105.89,529.674 "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,177.399 105.89,177.399 "/>
<path clip-path="url(#clip450)" d="M39.0477 1220.02 Q35.4367 1220.02 33.608 1223.59 Q31.8024 1227.13 31.8024 1234.26 Q31.8024 1241.37 33.608 1244.93 Q35.4367 1248.47 39.0477 1248.47 Q42.682 1248.47 44.4875 1244.93 Q46.3162 1241.37 46.3162 1234.26 Q46.3162 1227.13 44.4875 1223.59 Q42.682 1220.02 39.0477 1220.02 M39.0477 1216.32 Q44.8579 1216.32 47.9134 1220.93 Q50.9921 1225.51 50.9921 1234.26 Q50.9921 1242.99 47.9134 1247.59 Q44.8579 1252.18 39.0477 1252.18 Q33.2376 1252.18 30.1589 1247.59 Q27.1034 1242.99 27.1034 1234.26 Q27.1034 1225.51 30.1589 1220.93 Q33.2376 1216.32 39.0477 1216.32 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M30.0895 864.67 L48.4458 864.67 L48.4458 868.605 L34.3718 868.605 L34.3718 877.078 Q35.3904 876.73 36.4089 876.568 Q37.4274 876.383 38.4459 876.383 Q44.2329 876.383 47.6125 879.554 Q50.9921 882.726 50.9921 888.142 Q50.9921 893.721 47.5199 896.823 Q44.0477 899.901 37.7283 899.901 Q35.5524 899.901 33.2839 899.531 Q31.0385 899.161 28.6311 898.42 L28.6311 893.721 Q30.7145 894.855 32.9367 895.411 Q35.1589 895.966 37.6357 895.966 Q41.6403 895.966 43.9783 893.86 Q46.3162 891.753 46.3162 888.142 Q46.3162 884.531 43.9783 882.425 Q41.6403 880.318 37.6357 880.318 Q35.7607 880.318 33.8857 880.735 Q32.0339 881.152 30.0895 882.031 L30.0895 864.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M-0.303895 543.019 L7.33495 543.019 L7.33495 516.654 L-0.975188 518.32 L-0.975188 514.061 L7.28866 512.394 L11.9646 512.394 L11.9646 543.019 L19.6034 543.019 L19.6034 546.954 L-0.303895 546.954 L-0.303895 543.019 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M39.0477 515.473 Q35.4367 515.473 33.608 519.038 Q31.8024 522.58 31.8024 529.709 Q31.8024 536.816 33.608 540.38 Q35.4367 543.922 39.0477 543.922 Q42.682 543.922 44.4875 540.38 Q46.3162 536.816 46.3162 529.709 Q46.3162 522.58 44.4875 519.038 Q42.682 515.473 39.0477 515.473 M39.0477 511.769 Q44.8579 511.769 47.9134 516.376 Q50.9921 520.959 50.9921 529.709 Q50.9921 538.436 47.9134 543.042 Q44.8579 547.626 39.0477 547.626 Q33.2376 547.626 30.1589 543.042 Q27.1034 538.436 27.1034 529.709 Q27.1034 520.959 30.1589 516.376 Q33.2376 511.769 39.0477 511.769 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M0.69147 190.744 L8.33032 190.744 L8.33032 164.378 L0.0201769 166.045 L0.0201769 161.785 L8.28402 160.119 L12.9599 160.119 L12.9599 190.744 L20.5988 190.744 L20.5988 194.679 L0.69147 194.679 L0.69147 190.744 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip450)" d="M30.0895 160.119 L48.4458 160.119 L48.4458 164.054 L34.3718 164.054 L34.3718 172.526 Q35.3904 172.179 36.4089 172.017 Q37.4274 171.832 38.4459 171.832 Q44.2329 171.832 47.6125 175.003 Q50.9921 178.174 50.9921 183.591 Q50.9921 189.169 47.5199 192.271 Q44.0477 195.35 37.7283 195.35 Q35.5524 195.35 33.2839 194.98 Q31.0385 194.609 28.6311 193.869 L28.6311 189.169 Q30.7145 190.304 32.9367 190.859 Q35.1589 191.415 37.6357 191.415 Q41.6403 191.415 43.9783 189.308 Q46.3162 187.202 46.3162 183.591 Q46.3162 179.98 43.9783 177.873 Q41.6403 175.767 37.6357 175.767 Q35.7607 175.767 33.8857 176.183 Q32.0339 176.6 30.0895 177.48 L30.0895 160.119 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip452)" d="M151.118 1364.83 L222.368 1431.5 L293.618 1479.27 L364.869 1479.3 L436.119 1475.8 L507.37 1469.19 L578.62 1460.1 L649.871 1451.37 L721.121 1441.93 L792.371 1434.25 L863.622 1420.93 L934.872 1413.02 L1006.12 1401.96 L1077.37 1392.29 L1148.62 1383.18 L1219.87 1376.82 L1291.12 1374.74 L1362.37 1366.8 L1433.63 1361.94 L1504.88 1360.09 L1576.13 1350.6 L1647.38 1343.53 L1718.63 1335.92 L1789.88 1329.26 L1861.13 1330.4 L1932.38 1327.42 L2003.63 1319.99 L2074.88 1319.64 L2146.13 1317.82 L2217.38 1311.25 L2288.63 1309.51 L2288.63 973.271 L2217.38 949.067 L2146.13 935.733 L2074.88 920.93 L2003.63 909.741 L1932.38 896.109 L1861.13 877.949 L1789.88 859.046 L1718.63 837.478 L1647.38 818.193 L1576.13 796.649 L1504.88 773.182 L1433.63 744.624 L1362.37 715.37 L1291.12 681.996 L1219.87 651.998 L1148.62 616.101 L1077.37 582.424 L1006.12 546.224 L934.872 506.658 L863.622 462.771 L792.371 416.056 L721.121 374.08 L649.871 331.434 L578.62 285.33 L507.37 239.649 L436.119 180.507 L364.869 124.31 L293.618 88.9544 L222.368 178.311 L151.118 1145.53  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip452)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1221.9 222.368,1198.23 293.618,1188.45 364.869,1185.4 436.119,1194.25 507.37,1198.43 578.62,1202.43 649.871,1204.61 721.121,1204.92 792.371,1203.22 863.622,1205.8 934.872,1211.6 1006.12,1210.17 1077.37,1209.95 1148.62,1214.09 1219.87,1216.85 1291.12,1217.12 1362.37,1220.52 1433.63,1225.01 1504.88,1226.7 1576.13,1230.57 1647.38,1233.1 1718.63,1234.81 1789.88,1235.58 1861.13,1234.57 1932.38,1232.13 2003.63,1232.82 2074.88,1240.12 2146.13,1243.89 2217.38,1241.51 2288.63,1240.75 "/>
<path clip-path="url(#clip452)" d="M151.118 1308.67 L222.368 1249.26 L293.618 1237 L364.869 1235.8 L436.119 1235.08 L507.37 1235.14 L578.62 1235.12 L649.871 1235.36 L721.121 1235.49 L792.371 1235.55 L863.622 1234.92 L934.872 1235.35 L1006.12 1235.27 L1077.37 1235.42 L1148.62 1235.38 L1219.87 1235.54 L1291.12 1235.2 L1362.37 1235.4 L1433.63 1235 L1504.88 1235.13 L1576.13 1235.18 L1647.38 1235.17 L1718.63 1235.4 L1789.88 1235.47 L1861.13 1235.15 L1932.38 1235.49 L2003.63 1235.16 L2074.88 1235.58 L2146.13 1235.04 L2217.38 1235.79 L2288.63 1235.48 L2288.63 1233.14 L2217.38 1232.8 L2146.13 1233.26 L2074.88 1233.05 L2003.63 1233.32 L1932.38 1232.81 L1861.13 1233.24 L1789.88 1233.24 L1718.63 1233.16 L1647.38 1233.01 L1576.13 1232.96 L1504.88 1233.05 L1433.63 1233.06 L1362.37 1233.31 L1291.12 1233.1 L1219.87 1233.33 L1148.62 1233.27 L1077.37 1233.28 L1006.12 1232.77 L934.872 1233.24 L863.622 1233.38 L792.371 1233.14 L721.121 1233.25 L649.871 1233.18 L578.62 1232.91 L507.37 1232.98 L436.119 1233.06 L364.869 1233.07 L293.618 1230.44 L222.368 1215.31 L151.118 1137.63  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip452)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1230.8 222.368,1233.34 293.618,1234.16 364.869,1234.14 436.119,1234.2 507.37,1234.12 578.62,1234.17 649.871,1234.17 721.121,1234.15 792.371,1234.29 863.622,1234.27 934.872,1234.19 1006.12,1234.4 1077.37,1234.22 1148.62,1234.33 1219.87,1234.18 1291.12,1234.29 1362.37,1234.44 1433.63,1234.24 1504.88,1233.97 1576.13,1234.15 1647.38,1234.05 1718.63,1234.28 1789.88,1234.46 1861.13,1234.12 1932.38,1234.2 2003.63,1234.23 2074.88,1234.13 2146.13,1234.21 2217.38,1234.3 2288.63,1234.43 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">39.613394038480166</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([236.3847079135772, 1458.3919338909354], [26.077136897302076 -0.3252808878628165; 233.27963147212603 -1.6866711935960739], [2.323639389181112 -0.08549642871626129; 22.045753874067668 -0.3823654847582117;;; -0.08549642871626129 0.027118444052620715; -0.3823654847582117 0.10612543700199518], [-73.9552979661492; -279.95049529416883;;], [42.03311422447602, 48.060560224387295], [5.1280570309234905 -1.4106146269115702; -2.4106530676610602 -0.37051991366658965], [0.9787675694247718 -0.08080331976060615; -0.16317689312915049 -0.020377399550984474;;; -0.08080331976060615 -0.0018789688251446873; -0.020377399550984474 -0.011651144192075748], [3.311403203039906 3.327901298500566 … -0.3185702012936643 -0.024918666650251668])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 18 March 2023 08:34">Saturday 18 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
