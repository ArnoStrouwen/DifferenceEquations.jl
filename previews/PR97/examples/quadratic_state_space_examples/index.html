<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.012949921413028607]
 [0.08066166187067364, -0.009436517660545658]
 [0.018270195884282577, -0.009415159203820155]
 [-0.040829517910789634, 0.006427881985701382]
 [0.0010975391418813483, 0.01872382524781268]
 [0.11814964696956358, 0.0043543684635049505]
 [0.13925180396458003, 0.0012265903080751076]
 [0.13982812320955018, -0.02164879697383303]
 [-0.00020336751046877064, 0.008192060286281517]
 ⋮
 [0.17843239771145786, 0.00011633360697406274]
 [0.1701489934495623, -0.004742059129504252]
 [0.13217339984715495, -0.008137389733932902]
 [0.07516683653034048, -0.0025892389294866025]
 [0.05528401631370508, 0.008739229259734185]
 [0.10689490467375291, -0.011662736360748218]
 [0.029503520952131376, 0.019289394947544718]
 [0.14874453463398205, -0.0016889380530652528]
 [0.13074568962004013, 0.004445787169465908]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip230">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip230)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip231">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip230)" d="M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip232">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="842.247,1505.26 842.247,47.2441 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1597.5,1505.26 1597.5,47.2441 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2352.76,1505.26 2352.76,47.2441 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 2352.76,1505.26 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,1486.36 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="842.247,1505.26 842.247,1486.36 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1597.5,1505.26 1597.5,1486.36 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2352.76,1505.26 2352.76,1486.36 "/>
<path clip-path="url(#clip230)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1295.19 2352.76,1295.19 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,881.76 2352.76,881.76 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,468.328 2352.76,468.328 "/>
<polyline clip-path="url(#clip232)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,54.8956 2352.76,54.8956 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1505.26 86.9921,47.2441 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1295.19 105.89,1295.19 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,881.76 105.89,881.76 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,468.328 105.89,468.328 "/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,54.8956 105.89,54.8956 "/>
<path clip-path="url(#clip230)" d="M-6.18349 1280.99 Q-9.79459 1280.99 -11.6233 1284.56 Q-13.4288 1288.1 -13.4288 1295.23 Q-13.4288 1302.33 -11.6233 1305.9 Q-9.79459 1309.44 -6.18349 1309.44 Q-2.54925 1309.44 -0.743708 1305.9 Q1.08499 1302.33 1.08499 1295.23 Q1.08499 1288.1 -0.743708 1284.56 Q-2.54925 1280.99 -6.18349 1280.99 M-6.18349 1277.29 Q-0.37334 1277.29 2.6822 1281.89 Q5.76089 1286.48 5.76089 1295.23 Q5.76089 1303.95 2.6822 1308.56 Q-0.37334 1313.14 -6.18349 1313.14 Q-11.9936 1313.14 -15.0723 1308.56 Q-18.1279 1303.95 -18.1279 1295.23 Q-18.1279 1286.48 -15.0723 1281.89 Q-11.9936 1277.29 -6.18349 1277.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M13.9784 1306.59 L18.8627 1306.59 L18.8627 1312.47 L13.9784 1312.47 L13.9784 1306.59 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M39.0477 1280.99 Q35.4367 1280.99 33.608 1284.56 Q31.8024 1288.1 31.8024 1295.23 Q31.8024 1302.33 33.608 1305.9 Q35.4367 1309.44 39.0477 1309.44 Q42.682 1309.44 44.4875 1305.9 Q46.3162 1302.33 46.3162 1295.23 Q46.3162 1288.1 44.4875 1284.56 Q42.682 1280.99 39.0477 1280.99 M39.0477 1277.29 Q44.8579 1277.29 47.9134 1281.89 Q50.9921 1286.48 50.9921 1295.23 Q50.9921 1303.95 47.9134 1308.56 Q44.8579 1313.14 39.0477 1313.14 Q33.2376 1313.14 30.1589 1308.56 Q27.1034 1303.95 27.1034 1295.23 Q27.1034 1286.48 30.1589 1281.89 Q33.2376 1277.29 39.0477 1277.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M-4.95665 867.559 Q-8.56774 867.559 -10.3964 871.124 Q-12.202 874.666 -12.202 881.795 Q-12.202 888.902 -10.3964 892.466 Q-8.56774 896.008 -4.95665 896.008 Q-1.32241 896.008 0.483137 892.466 Q2.31183 888.902 2.31183 881.795 Q2.31183 874.666 0.483137 871.124 Q-1.32241 867.559 -4.95665 867.559 M-4.95665 863.855 Q0.853506 863.855 3.90904 868.462 Q6.98773 873.045 6.98773 881.795 Q6.98773 890.522 3.90904 895.128 Q0.853506 899.712 -4.95665 899.712 Q-10.7668 899.712 -13.8455 895.128 Q-16.901 890.522 -16.901 881.795 Q-16.901 873.045 -13.8455 868.462 Q-10.7668 863.855 -4.95665 863.855 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M15.2053 893.161 L20.0895 893.161 L20.0895 899.04 L15.2053 899.04 L15.2053 893.161 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M31.0848 895.105 L38.7237 895.105 L38.7237 868.74 L30.4135 870.406 L30.4135 866.147 L38.6774 864.48 L43.3533 864.48 L43.3533 895.105 L50.9921 895.105 L50.9921 899.04 L31.0848 899.04 L31.0848 895.105 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M-4.58628 454.127 Q-8.19737 454.127 -10.0261 457.691 Q-11.8316 461.233 -11.8316 468.363 Q-11.8316 475.469 -10.0261 479.034 Q-8.19737 482.576 -4.58628 482.576 Q-0.95204 482.576 0.853506 479.034 Q2.6822 475.469 2.6822 468.363 Q2.6822 461.233 0.853506 457.691 Q-0.95204 454.127 -4.58628 454.127 M-4.58628 450.423 Q1.22387 450.423 4.27941 455.029 Q7.3581 459.613 7.3581 468.363 Q7.3581 477.09 4.27941 481.696 Q1.22387 486.279 -4.58628 486.279 Q-10.3964 486.279 -13.4751 481.696 Q-16.5307 477.09 -16.5307 468.363 Q-16.5307 459.613 -13.4751 455.029 Q-10.3964 450.423 -4.58628 450.423 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M15.5756 479.728 L20.4599 479.728 L20.4599 485.608 L15.5756 485.608 L15.5756 479.728 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M34.6728 481.673 L50.9921 481.673 L50.9921 485.608 L29.0478 485.608 L29.0478 481.673 Q31.7098 478.918 36.2931 474.289 Q40.8996 469.636 42.0801 468.293 Q44.3255 465.77 45.2051 464.034 Q46.1079 462.275 46.1079 460.585 Q46.1079 457.83 44.1635 456.094 Q42.2422 454.358 39.1403 454.358 Q36.9413 454.358 34.4876 455.122 Q32.057 455.886 29.2793 457.437 L29.2793 452.715 Q32.1033 451.58 34.557 451.002 Q37.0107 450.423 39.0477 450.423 Q44.4181 450.423 47.6125 453.108 Q50.8069 455.793 50.8069 460.284 Q50.8069 462.414 49.9968 464.335 Q49.2097 466.233 47.1033 468.826 Q46.5246 469.497 43.4227 472.715 Q40.3209 475.909 34.6728 481.673 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M-5.53535 40.6943 Q-9.14644 40.6943 -10.9751 44.2591 Q-12.7807 47.8007 -12.7807 54.9303 Q-12.7807 62.0368 -10.9751 65.6016 Q-9.14644 69.1432 -5.53535 69.1432 Q-1.90111 69.1432 -0.0955632 65.6016 Q1.73313 62.0368 1.73313 54.9303 Q1.73313 47.8007 -0.0955632 44.2591 Q-1.90111 40.6943 -5.53535 40.6943 M-5.53535 36.9906 Q0.274805 36.9906 3.33034 41.5971 Q6.40903 46.1804 6.40903 54.9303 Q6.40903 63.6571 3.33034 68.2636 Q0.274805 72.8469 -5.53535 72.8469 Q-11.3455 72.8469 -14.4242 68.2636 Q-17.4797 63.6571 -17.4797 54.9303 Q-17.4797 46.1804 -14.4242 41.5971 Q-11.3455 36.9906 -5.53535 36.9906 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M14.6266 66.296 L19.5108 66.296 L19.5108 72.1756 L14.6266 72.1756 L14.6266 66.296 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip230)" d="M43.8625 53.5414 Q47.219 54.259 49.094 56.5275 Q50.9921 58.796 50.9921 62.1294 Q50.9921 67.2451 47.4736 70.046 Q43.9551 72.8469 37.4737 72.8469 Q35.2978 72.8469 32.983 72.4071 Q30.6913 71.9904 28.2376 71.1339 L28.2376 66.6201 Q30.1821 67.7543 32.4969 68.333 Q34.8117 68.9117 37.3348 68.9117 Q41.7329 68.9117 44.0246 67.1756 Q46.3394 65.4395 46.3394 62.1294 Q46.3394 59.0738 44.1866 57.3609 Q42.057 55.6248 38.2376 55.6248 L34.2098 55.6248 L34.2098 51.7822 L38.4227 51.7822 Q41.8718 51.7822 43.7005 50.4165 Q45.5292 49.0276 45.5292 46.435 Q45.5292 43.773 43.6311 42.3609 Q41.7561 40.9258 38.2376 40.9258 Q36.3163 40.9258 34.1172 41.3424 Q31.9182 41.7591 29.2793 42.6387 L29.2793 38.4721 Q31.9413 37.7313 34.2561 37.361 Q36.5941 36.9906 38.6542 36.9906 Q43.9783 36.9906 47.0801 39.4211 Q50.1819 41.8285 50.1819 45.9489 Q50.1819 48.8192 48.5384 50.81 Q46.8949 52.7776 43.8625 53.5414 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip232)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1295.19 162.518,1295.52 238.043,961.711 313.569,1219.66 389.094,1464 464.619,1290.66 540.145,806.724 615.67,719.481 691.196,717.098 766.721,1296.03 842.247,1085.47 917.772,756.743 993.298,663.161 1068.82,506.63 1144.35,455.18 1219.87,304.639 1295.4,285.475 1370.92,270.299 1446.45,111.974 1521.98,88.5087 1597.5,98.826 1673.03,392.468 1748.55,557.495 1824.08,591.742 1899.6,748.745 1975.13,984.429 2050.65,1066.63 2126.18,853.255 2201.7,1173.22 2277.23,680.235 2352.76,754.648 "/>
<polyline clip-path="url(#clip232)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1295.19 162.518,1241.65 238.043,1334.21 313.569,1334.12 389.094,1268.62 464.619,1217.78 540.145,1277.19 615.67,1290.12 691.196,1384.7 766.721,1261.32 842.247,1240.82 917.772,1275.78 993.298,1264.95 1068.82,1280.53 1144.35,1264.26 1219.87,1284.1 1295.4,1284.58 1370.92,1261.56 1446.45,1281.87 1521.98,1287.1 1597.5,1332.9 1673.03,1314.47 1748.55,1294.71 1824.08,1314.8 1899.6,1328.84 1975.13,1305.9 2050.65,1259.06 2126.18,1343.41 2201.7,1215.44 2277.23,1302.18 2352.76,1276.81 "/>
<path clip-path="url(#clip230)" d="M2027.46 251.365 L2277.23 251.365 L2277.23 95.8446 L2027.46 95.8446  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip230)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2027.46,251.365 2277.23,251.365 2277.23,95.8446 2027.46,95.8446 2027.46,251.365 "/>
<polyline clip-path="url(#clip230)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,147.685 2203.69,147.685 "/>
<path clip-path="url(#clip230)" d="M2242.26 151.932 Q2237.1 151.932 2235.11 153.113 Q2233.12 154.293 2233.12 157.141 Q2233.12 159.409 2234.6 160.752 Q2236.11 162.071 2238.68 162.071 Q2242.22 162.071 2244.35 159.571 Q2246.5 157.048 2246.5 152.881 L2246.5 151.932 L2242.26 151.932 M2250.76 150.173 L2250.76 164.965 L2246.5 164.965 L2246.5 161.029 Q2245.04 163.391 2242.87 164.525 Q2240.69 165.636 2237.54 165.636 Q2233.56 165.636 2231.2 163.414 Q2228.86 161.168 2228.86 157.418 Q2228.86 153.043 2231.78 150.821 Q2234.72 148.599 2240.53 148.599 L2246.5 148.599 L2246.5 148.182 Q2246.5 145.243 2244.56 143.645 Q2242.63 142.025 2239.14 142.025 Q2236.92 142.025 2234.81 142.557 Q2232.7 143.09 2230.76 144.155 L2230.76 140.219 Q2233.1 139.317 2235.3 138.877 Q2237.5 138.414 2239.58 138.414 Q2245.2 138.414 2247.98 141.33 Q2250.76 144.247 2250.76 150.173 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip230)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2052.63,199.525 2203.69,199.525 "/>
<path clip-path="url(#clip230)" d="M2247.63 203.865 Q2247.63 199.166 2245.69 196.504 Q2243.77 193.819 2240.39 193.819 Q2237.01 193.819 2235.06 196.504 Q2233.14 199.166 2233.14 203.865 Q2233.14 208.564 2235.06 211.249 Q2237.01 213.911 2240.39 213.911 Q2243.77 213.911 2245.69 211.249 Q2247.63 208.564 2247.63 203.865 M2233.14 194.814 Q2234.49 192.499 2236.52 191.388 Q2238.58 190.254 2241.43 190.254 Q2246.15 190.254 2249.09 194.004 Q2252.06 197.754 2252.06 203.865 Q2252.06 209.976 2249.09 213.726 Q2246.15 217.476 2241.43 217.476 Q2238.58 217.476 2236.52 216.365 Q2234.49 215.231 2233.14 212.916 L2233.14 216.805 L2228.86 216.805 L2228.86 180.786 L2233.14 180.786 L2233.14 194.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 1.29499  -1.20265  -0.752786  0.831091  …  2.16219  -0.554682  0.478357</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip290">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip290)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip291">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip290)" d="M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip292">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="151.118,1521.01 151.118,47.2441 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="863.622,1521.01 863.622,47.2441 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1576.13,1521.01 1576.13,47.2441 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2288.63,1521.01 2288.63,47.2441 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 2352.76,1521.01 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="151.118,1521.01 151.118,1502.11 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="863.622,1521.01 863.622,1502.11 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1576.13,1521.01 1576.13,1502.11 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2288.63,1521.01 2288.63,1502.11 "/>
<path clip-path="url(#clip290)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1517.08 2352.76,1517.08 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,1234.55 2352.76,1234.55 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,952.008 2352.76,952.008 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,669.469 2352.76,669.469 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,386.93 2352.76,386.93 "/>
<polyline clip-path="url(#clip292)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="86.9921,104.392 2352.76,104.392 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1521.01 86.9921,47.2441 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1517.08 105.89,1517.08 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,1234.55 105.89,1234.55 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,952.008 105.89,952.008 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,669.469 105.89,669.469 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,386.93 105.89,386.93 "/>
<polyline clip-path="url(#clip290)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="86.9921,104.392 105.89,104.392 "/>
<path clip-path="url(#clip290)" d="M-9.72514 1517.54 L19.9506 1517.54 L19.9506 1521.47 L-9.72514 1521.47 L-9.72514 1517.54 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M30.0895 1499.8 L48.4458 1499.8 L48.4458 1503.74 L34.3718 1503.74 L34.3718 1512.21 Q35.3904 1511.86 36.4089 1511.7 Q37.4274 1511.52 38.4459 1511.52 Q44.2329 1511.52 47.6125 1514.69 Q50.9921 1517.86 50.9921 1523.28 Q50.9921 1528.86 47.5199 1531.96 Q44.0477 1535.04 37.7283 1535.04 Q35.5524 1535.04 33.2839 1534.67 Q31.0385 1534.3 28.6311 1533.55 L28.6311 1528.86 Q30.7145 1529.99 32.9367 1530.55 Q35.1589 1531.1 37.6357 1531.1 Q41.6403 1531.1 43.9783 1528.99 Q46.3162 1526.89 46.3162 1523.28 Q46.3162 1519.67 43.9783 1517.56 Q41.6403 1515.45 37.6357 1515.45 Q35.7607 1515.45 33.8857 1515.87 Q32.0339 1516.29 30.0895 1517.17 L30.0895 1499.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M39.0477 1220.34 Q35.4367 1220.34 33.608 1223.91 Q31.8024 1227.45 31.8024 1234.58 Q31.8024 1241.69 33.608 1245.25 Q35.4367 1248.79 39.0477 1248.79 Q42.682 1248.79 44.4875 1245.25 Q46.3162 1241.69 46.3162 1234.58 Q46.3162 1227.45 44.4875 1223.91 Q42.682 1220.34 39.0477 1220.34 M39.0477 1216.64 Q44.8579 1216.64 47.9134 1221.25 Q50.9921 1225.83 50.9921 1234.58 Q50.9921 1243.31 47.9134 1247.91 Q44.8579 1252.5 39.0477 1252.5 Q33.2376 1252.5 30.1589 1247.91 Q27.1034 1243.31 27.1034 1234.58 Q27.1034 1225.83 30.1589 1221.25 Q33.2376 1216.64 39.0477 1216.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M30.0895 934.728 L48.4458 934.728 L48.4458 938.663 L34.3718 938.663 L34.3718 947.135 Q35.3904 946.788 36.4089 946.626 Q37.4274 946.44 38.4459 946.44 Q44.2329 946.44 47.6125 949.612 Q50.9921 952.783 50.9921 958.2 Q50.9921 963.778 47.5199 966.88 Q44.0477 969.959 37.7283 969.959 Q35.5524 969.959 33.2839 969.588 Q31.0385 969.218 28.6311 968.477 L28.6311 963.778 Q30.7145 964.913 32.9367 965.468 Q35.1589 966.024 37.6357 966.024 Q41.6403 966.024 43.9783 963.917 Q46.3162 961.811 46.3162 958.2 Q46.3162 954.589 43.9783 952.482 Q41.6403 950.376 37.6357 950.376 Q35.7607 950.376 33.8857 950.792 Q32.0339 951.209 30.0895 952.089 L30.0895 934.728 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M-0.303895 682.814 L7.33495 682.814 L7.33495 656.448 L-0.975188 658.115 L-0.975188 653.856 L7.28866 652.189 L11.9646 652.189 L11.9646 682.814 L19.6034 682.814 L19.6034 686.749 L-0.303895 686.749 L-0.303895 682.814 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M39.0477 655.268 Q35.4367 655.268 33.608 658.832 Q31.8024 662.374 31.8024 669.504 Q31.8024 676.61 33.608 680.175 Q35.4367 683.717 39.0477 683.717 Q42.682 683.717 44.4875 680.175 Q46.3162 676.61 46.3162 669.504 Q46.3162 662.374 44.4875 658.832 Q42.682 655.268 39.0477 655.268 M39.0477 651.564 Q44.8579 651.564 47.9134 656.17 Q50.9921 660.754 50.9921 669.504 Q50.9921 678.23 47.9134 682.837 Q44.8579 687.42 39.0477 687.42 Q33.2376 687.42 30.1589 682.837 Q27.1034 678.23 27.1034 669.504 Q27.1034 660.754 30.1589 656.17 Q33.2376 651.564 39.0477 651.564 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M0.69147 400.275 L8.33032 400.275 L8.33032 373.91 L0.0201769 375.576 L0.0201769 371.317 L8.28402 369.65 L12.9599 369.65 L12.9599 400.275 L20.5988 400.275 L20.5988 404.21 L0.69147 404.21 L0.69147 400.275 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M30.0895 369.65 L48.4458 369.65 L48.4458 373.585 L34.3718 373.585 L34.3718 382.058 Q35.3904 381.71 36.4089 381.548 Q37.4274 381.363 38.4459 381.363 Q44.2329 381.363 47.6125 384.534 Q50.9921 387.706 50.9921 393.122 Q50.9921 398.701 47.5199 401.803 Q44.0477 404.882 37.7283 404.882 Q35.5524 404.882 33.2839 404.511 Q31.0385 404.141 28.6311 403.4 L28.6311 398.701 Q30.7145 399.835 32.9367 400.391 Q35.1589 400.946 37.6357 400.946 Q41.6403 400.946 43.9783 398.84 Q46.3162 396.733 46.3162 393.122 Q46.3162 389.511 43.9783 387.405 Q41.6403 385.298 37.6357 385.298 Q35.7607 385.298 33.8857 385.715 Q32.0339 386.132 30.0895 387.011 L30.0895 369.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M2.91368 117.737 L19.233 117.737 L19.233 121.672 L-2.71129 121.672 L-2.71129 117.737 Q-0.0492672 114.982 4.53404 110.352 Q9.1405 105.7 10.321 104.357 Q12.5664 101.834 13.446 100.098 Q14.3488 98.3385 14.3488 96.6487 Q14.3488 93.894 12.4044 92.1579 Q10.4831 90.4218 7.38125 90.4218 Q5.18219 90.4218 2.7285 91.1857 Q0.297953 91.9496 -2.47981 93.5005 L-2.47981 88.7783 Q0.344249 87.6441 2.79794 87.0654 Q5.25163 86.4867 7.28866 86.4867 Q12.659 86.4867 15.8534 89.1718 Q19.0479 91.857 19.0479 96.3477 Q19.0479 98.4773 18.2377 100.399 Q17.4506 102.297 15.3442 104.889 Q14.7655 105.561 11.6636 108.778 Q8.5618 111.973 2.91368 117.737 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip290)" d="M39.0477 90.1904 Q35.4367 90.1904 33.608 93.7551 Q31.8024 97.2968 31.8024 104.426 Q31.8024 111.533 33.608 115.098 Q35.4367 118.639 39.0477 118.639 Q42.682 118.639 44.4875 115.098 Q46.3162 111.533 46.3162 104.426 Q46.3162 97.2968 44.4875 93.7551 Q42.682 90.1904 39.0477 90.1904 M39.0477 86.4867 Q44.8579 86.4867 47.9134 91.0931 Q50.9921 95.6764 50.9921 104.426 Q50.9921 113.153 47.9134 117.76 Q44.8579 122.343 39.0477 122.343 Q33.2376 122.343 30.1589 117.76 Q27.1034 113.153 27.1034 104.426 Q27.1034 95.6764 30.1589 91.0931 Q33.2376 86.4867 39.0477 86.4867 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip292)" d="M151.118 1294.14 L222.368 1423.28 L293.618 1479.23 L364.869 1479.3 L436.119 1469.27 L507.37 1461.32 L578.62 1446.42 L649.871 1434.37 L721.121 1427.08 L792.371 1421.94 L863.622 1412.33 L934.872 1403.96 L1006.12 1400.99 L1077.37 1396.01 L1148.62 1387.65 L1219.87 1381.2 L1291.12 1373.01 L1362.37 1368.65 L1433.63 1359.9 L1504.88 1350.22 L1576.13 1340.25 L1647.38 1331.84 L1718.63 1328.62 L1789.88 1320.23 L1861.13 1311.09 L1932.38 1306.33 L2003.63 1309.55 L2074.88 1311.11 L2146.13 1309.68 L2217.38 1306.18 L2288.63 1300.27 L2288.63 961.196 L2217.38 946.403 L2146.13 933.75 L2074.88 918.452 L2003.63 903.259 L1932.38 885.545 L1861.13 861.328 L1789.88 843.483 L1718.63 824.999 L1647.38 804.094 L1576.13 783.865 L1504.88 759.751 L1433.63 737.242 L1362.37 709.941 L1291.12 680.132 L1219.87 646.832 L1148.62 616.091 L1077.37 582.462 L1006.12 542.072 L934.872 509.593 L863.622 470.326 L792.371 426.901 L721.121 380.418 L649.871 334.726 L578.62 286.319 L507.37 234.007 L436.119 177.875 L364.869 125.049 L293.618 88.9544 L222.368 183.22 L151.118 1139.13  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip292)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1209.32 222.368,1240.92 293.618,1278.43 364.869,1284.11 436.119,1285.44 507.37,1279.74 578.62,1273.48 649.871,1272.53 721.121,1274.09 792.371,1273.97 863.622,1274.48 934.872,1273.48 1006.12,1270.46 1077.37,1270.98 1148.62,1268.04 1219.87,1263.36 1291.12,1260.87 1362.37,1258.51 1433.63,1257.82 1504.88,1257.01 1576.13,1259.48 1647.38,1259.57 1718.63,1259.4 1789.88,1259.03 1861.13,1255.08 1932.38,1249.39 2003.63,1252.34 2074.88,1250.57 2146.13,1250.92 2217.38,1248.21 2288.63,1243.83 "/>
<path clip-path="url(#clip292)" d="M151.118 1319.45 L222.368 1251.84 L293.618 1237.51 L364.869 1235.77 L436.119 1235.46 L507.37 1235.59 L578.62 1235.43 L649.871 1235.4 L721.121 1235.66 L792.371 1235.1 L863.622 1235.61 L934.872 1235.71 L1006.12 1235.46 L1077.37 1235.47 L1148.62 1235.37 L1219.87 1235.31 L1291.12 1235.58 L1362.37 1235.46 L1433.63 1235.35 L1504.88 1235.54 L1576.13 1235.27 L1647.38 1235.38 L1718.63 1235.38 L1789.88 1235.35 L1861.13 1235.52 L1932.38 1235.64 L2003.63 1235.67 L2074.88 1235.36 L2146.13 1235.29 L2217.38 1235.66 L2288.63 1235.12 L2288.63 1233.82 L2217.38 1233.55 L2146.13 1233.8 L2074.88 1233.64 L2003.63 1233.6 L1932.38 1233.62 L1861.13 1233.45 L1789.88 1233.45 L1718.63 1233.31 L1647.38 1233.58 L1576.13 1233.8 L1504.88 1233.49 L1433.63 1233.36 L1362.37 1233.78 L1291.12 1233.53 L1219.87 1233.31 L1148.62 1233.33 L1077.37 1233.53 L1006.12 1233.69 L934.872 1233.88 L863.622 1233.53 L792.371 1233.7 L721.121 1233.64 L649.871 1233.8 L578.62 1233.55 L507.37 1233.67 L436.119 1233.64 L364.869 1233.11 L293.618 1230.83 L222.368 1215.89 L151.118 1142.31  Z" fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip292)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="151.118,1251.64 222.368,1237.97 293.618,1235.14 364.869,1234.62 436.119,1234.58 507.37,1234.54 578.62,1234.5 649.871,1234.43 721.121,1234.79 792.371,1234.6 863.622,1234.47 934.872,1234.72 1006.12,1234.56 1077.37,1234.69 1148.62,1234.48 1219.87,1234.65 1291.12,1234.49 1362.37,1234.58 1433.63,1234.56 1504.88,1234.76 1576.13,1234.59 1647.38,1234.51 1718.63,1234.5 1789.88,1234.38 1861.13,1234.44 1932.38,1234.53 2003.63,1234.49 2074.88,1234.46 2146.13,1234.61 2217.38,1234.57 2288.63,1234.49 "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">52.95634262127259</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([-134.66011098255447, -804.5412260238836], [-10.318976769476192 -0.6004513601009279; -32.62246795300444 -6.193679589454225], [-1.9494198098494964 -0.019819358553679372; -9.186546611776127 -0.10210531603730538;;; -0.019819358553679372 -0.010679655810144647; -0.10210531603730538 -0.12592467306892424], [22.808873567881133; -315.34348332180826;;], [88.75222774905063, -32.317604979840695], [1.4730294248867724 0.9403270151882589; -3.8792518509001965 0.5944780919208923], [-0.6126734767085841 0.07277935128566071; -0.4962599592326801 0.04175184125331087;;; 0.07277935128566071 0.011398015065903157; 0.04175184125331087 -0.004065124520260468], [-0.8554052061306299 -1.1240344593509706 … 0.4502373362387497 -0.004132901306142583])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Saturday 18 March 2023 08:33">Saturday 18 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
