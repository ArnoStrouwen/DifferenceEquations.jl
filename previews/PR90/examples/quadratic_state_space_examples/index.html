<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, 0.002485989145404232]
 [0.01527988472207301, -0.009435158942066844]
 [-0.04379164264523903, -0.009608254017759898]
 [-0.10093460373768962, -0.005706958607241901]
 [-0.13121046652266516, 0.00030776687284996733]
 [-0.12282593153194762, -0.022524916845700963]
 [-0.2546459895755144, -0.00794309728096118]
 [-0.2909175318370035, 0.009956083057952104]
 [-0.21462580757089, 0.01100938967099805]
 ⋮
 [0.0012646927571146392, 0.0024012662301845697]
 [0.01602905061320904, -0.014675976051594286]
 [-0.07518223727591329, -0.003525147687530289]
 [-0.09330127063501882, -0.009991261666094922]
 [-0.15028567218120079, 0.0012427601756851256]
 [-0.13515709102181636, 0.005084211099780089]
 [-0.09692519494568504, 0.005380916106499347]
 [-0.05874262176259978, -0.0038680852323334843]
 [-0.07980405002957201, 0.01043143534851323]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip390">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip390)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip391">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip390)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip392">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip390)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1503.25 2352.76,1503.25 
  "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1071.03 2352.76,1071.03 
  "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,638.805 2352.76,638.805 
  "/>
<polyline clip-path="url(#clip392)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,206.582 2352.76,206.582 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1503.25 105.89,1503.25 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1071.03 105.89,1071.03 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,638.805 105.89,638.805 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,206.582 105.89,206.582 
  "/>
<path clip-path="url(#clip390)" d="M-55.3036 1503.7 L-25.6278 1503.7 L-25.6278 1507.64 L-55.3036 1507.64 L-55.3036 1503.7 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-5.53535 1489.05 Q-9.14644 1489.05 -10.9751 1492.62 Q-12.7807 1496.16 -12.7807 1503.29 Q-12.7807 1510.39 -10.9751 1513.96 Q-9.14644 1517.5 -5.53535 1517.5 Q-1.90111 1517.5 -0.0955632 1513.96 Q1.73313 1510.39 1.73313 1503.29 Q1.73313 1496.16 -0.0955632 1492.62 Q-1.90111 1489.05 -5.53535 1489.05 M-5.53535 1485.35 Q0.274805 1485.35 3.33034 1489.95 Q6.40903 1494.54 6.40903 1503.29 Q6.40903 1512.01 3.33034 1516.62 Q0.274805 1521.2 -5.53535 1521.2 Q-11.3455 1521.2 -14.4242 1516.62 Q-17.4797 1512.01 -17.4797 1503.29 Q-17.4797 1494.54 -14.4242 1489.95 Q-11.3455 1485.35 -5.53535 1485.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M14.6266 1514.65 L19.5108 1514.65 L19.5108 1520.53 L14.6266 1520.53 L14.6266 1514.65 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M43.8625 1501.9 Q47.219 1502.62 49.094 1504.88 Q50.9921 1507.15 50.9921 1510.49 Q50.9921 1515.6 47.4736 1518.4 Q43.9551 1521.2 37.4737 1521.2 Q35.2978 1521.2 32.983 1520.76 Q30.6913 1520.35 28.2376 1519.49 L28.2376 1514.98 Q30.1821 1516.11 32.4969 1516.69 Q34.8117 1517.27 37.3348 1517.27 Q41.7329 1517.27 44.0246 1515.53 Q46.3394 1513.8 46.3394 1510.49 Q46.3394 1507.43 44.1866 1505.72 Q42.057 1503.98 38.2376 1503.98 L34.2098 1503.98 L34.2098 1500.14 L38.4227 1500.14 Q41.8718 1500.14 43.7005 1498.77 Q45.5292 1497.38 45.5292 1494.79 Q45.5292 1492.13 43.6311 1490.72 Q41.7561 1489.28 38.2376 1489.28 Q36.3163 1489.28 34.1172 1489.7 Q31.9182 1490.12 29.2793 1490.99 L29.2793 1486.83 Q31.9413 1486.09 34.2561 1485.72 Q36.5941 1485.35 38.6542 1485.35 Q43.9783 1485.35 47.0801 1487.78 Q50.1819 1490.18 50.1819 1494.31 Q50.1819 1497.18 48.5384 1499.17 Q46.8949 1501.13 43.8625 1501.9 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-54.3545 1071.48 L-24.6788 1071.48 L-24.6788 1075.41 L-54.3545 1075.41 L-54.3545 1071.48 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-4.58628 1056.83 Q-8.19737 1056.83 -10.0261 1060.39 Q-11.8316 1063.93 -11.8316 1071.06 Q-11.8316 1078.17 -10.0261 1081.73 Q-8.19737 1085.28 -4.58628 1085.28 Q-0.95204 1085.28 0.853506 1081.73 Q2.6822 1078.17 2.6822 1071.06 Q2.6822 1063.93 0.853506 1060.39 Q-0.95204 1056.83 -4.58628 1056.83 M-4.58628 1053.12 Q1.22387 1053.12 4.27941 1057.73 Q7.3581 1062.31 7.3581 1071.06 Q7.3581 1079.79 4.27941 1084.4 Q1.22387 1088.98 -4.58628 1088.98 Q-10.3964 1088.98 -13.4751 1084.4 Q-16.5307 1079.79 -16.5307 1071.06 Q-16.5307 1062.31 -13.4751 1057.73 Q-10.3964 1053.12 -4.58628 1053.12 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M15.5756 1082.43 L20.4599 1082.43 L20.4599 1088.31 L15.5756 1088.31 L15.5756 1082.43 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M34.6728 1084.37 L50.9921 1084.37 L50.9921 1088.31 L29.0478 1088.31 L29.0478 1084.37 Q31.7098 1081.62 36.2931 1076.99 Q40.8996 1072.34 42.0801 1070.99 Q44.3255 1068.47 45.2051 1066.73 Q46.1079 1064.98 46.1079 1063.29 Q46.1079 1060.53 44.1635 1058.79 Q42.2422 1057.06 39.1403 1057.06 Q36.9413 1057.06 34.4876 1057.82 Q32.057 1058.59 29.2793 1060.14 L29.2793 1055.42 Q32.1033 1054.28 34.557 1053.7 Q37.0107 1053.12 39.0477 1053.12 Q44.4181 1053.12 47.6125 1055.81 Q50.8069 1058.49 50.8069 1062.98 Q50.8069 1065.11 49.9968 1067.04 Q49.2097 1068.93 47.1033 1071.53 Q46.5246 1072.2 43.4227 1075.41 Q40.3209 1078.61 34.6728 1084.37 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-54.7249 639.256 L-25.0491 639.256 L-25.0491 643.192 L-54.7249 643.192 L-54.7249 639.256 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-4.95665 624.604 Q-8.56774 624.604 -10.3964 628.168 Q-12.202 631.71 -12.202 638.84 Q-12.202 645.946 -10.3964 649.511 Q-8.56774 653.053 -4.95665 653.053 Q-1.32241 653.053 0.483137 649.511 Q2.31183 645.946 2.31183 638.84 Q2.31183 631.71 0.483137 628.168 Q-1.32241 624.604 -4.95665 624.604 M-4.95665 620.9 Q0.853506 620.9 3.90904 625.506 Q6.98773 630.09 6.98773 638.84 Q6.98773 647.567 3.90904 652.173 Q0.853506 656.756 -4.95665 656.756 Q-10.7668 656.756 -13.8455 652.173 Q-16.901 647.567 -16.901 638.84 Q-16.901 630.09 -13.8455 625.506 Q-10.7668 620.9 -4.95665 620.9 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M15.2053 650.205 L20.0895 650.205 L20.0895 656.085 L15.2053 656.085 L15.2053 650.205 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M31.0848 652.15 L38.7237 652.15 L38.7237 625.784 L30.4135 627.451 L30.4135 623.192 L38.6774 621.525 L43.3533 621.525 L43.3533 652.15 L50.9921 652.15 L50.9921 656.085 L31.0848 656.085 L31.0848 652.15 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M-6.18349 192.38 Q-9.79459 192.38 -11.6233 195.945 Q-13.4288 199.487 -13.4288 206.616 Q-13.4288 213.723 -11.6233 217.288 Q-9.79459 220.829 -6.18349 220.829 Q-2.54925 220.829 -0.743708 217.288 Q1.08499 213.723 1.08499 206.616 Q1.08499 199.487 -0.743708 195.945 Q-2.54925 192.38 -6.18349 192.38 M-6.18349 188.677 Q-0.37334 188.677 2.6822 193.283 Q5.76089 197.866 5.76089 206.616 Q5.76089 215.343 2.6822 219.95 Q-0.37334 224.533 -6.18349 224.533 Q-11.9936 224.533 -15.0723 219.95 Q-18.1279 215.343 -18.1279 206.616 Q-18.1279 197.866 -15.0723 193.283 Q-11.9936 188.677 -6.18349 188.677 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M13.9784 217.982 L18.8627 217.982 L18.8627 223.862 L13.9784 223.862 L13.9784 217.982 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip390)" d="M39.0477 192.38 Q35.4367 192.38 33.608 195.945 Q31.8024 199.487 31.8024 206.616 Q31.8024 213.723 33.608 217.288 Q35.4367 220.829 39.0477 220.829 Q42.682 220.829 44.4875 217.288 Q46.3162 213.723 46.3162 206.616 Q46.3162 199.487 44.4875 195.945 Q42.682 192.38 39.0477 192.38 M39.0477 188.677 Q44.8579 188.677 47.9134 193.283 Q50.9921 197.866 50.9921 206.616 Q50.9921 215.343 47.9134 219.95 Q44.8579 224.533 39.0477 224.533 Q33.2376 224.533 30.1589 219.95 Q27.1034 215.343 27.1034 206.616 Q27.1034 197.866 30.1589 193.283 Q33.2376 188.677 39.0477 188.677 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip392)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,206.582 162.518,206.92 238.043,140.538 313.569,395.859 389.094,642.845 464.619,773.704 540.145,737.464 615.67,1307.22 691.196,1464 766.721,1134.24 
  842.247,792.268 917.772,504.292 993.298,802.504 1068.82,911.341 1144.35,666.627 1219.87,693.514 1295.4,541.952 1370.92,730.78 1446.45,630.884 1521.98,397.268 
  1597.5,372.524 1673.03,88.5087 1748.55,201.115 1824.08,137.3 1899.6,531.537 1975.13,609.852 2050.65,856.151 2126.18,790.762 2201.7,625.515 2277.23,460.481 
  2352.76,551.513 
  "/>
<polyline clip-path="url(#clip392)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,206.582 162.518,195.837 238.043,247.363 313.569,248.111 389.094,231.248 464.619,205.251 540.145,303.94 615.67,240.914 691.196,163.549 766.721,158.996 
  842.247,164.94 917.772,257.366 993.298,228.977 1068.82,172.809 1144.35,214.589 1219.87,186.03 1295.4,239.845 1370.92,194.641 1446.45,172.367 1521.98,204.073 
  1597.5,162.266 1673.03,223.767 1748.55,196.203 1824.08,270.015 1899.6,221.818 1975.13,249.766 2050.65,201.21 2126.18,184.606 2201.7,183.324 2277.23,223.3 
  2352.76,161.495 
  "/>
<path clip-path="url(#clip390)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip390)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip390)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip390)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip390)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip390)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 0.248599  -0.993236  -0.772122  -0.378531  …  0.436407  -0.494427  1.12051</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip450">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip450)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip451">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip450)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip452">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip450)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1194.68 2352.76,1194.68 
  "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,862.937 2352.76,862.937 
  "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,531.198 2352.76,531.198 
  "/>
<polyline clip-path="url(#clip452)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,199.459 2352.76,199.459 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1194.68 105.89,1194.68 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,862.937 105.89,862.937 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,531.198 105.89,531.198 
  "/>
<polyline clip-path="url(#clip450)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,199.459 105.89,199.459 
  "/>
<path clip-path="url(#clip450)" d="M39.0477 1180.47 Q35.4367 1180.47 33.608 1184.04 Q31.8024 1187.58 31.8024 1194.71 Q31.8024 1201.82 33.608 1205.38 Q35.4367 1208.92 39.0477 1208.92 Q42.682 1208.92 44.4875 1205.38 Q46.3162 1201.82 46.3162 1194.71 Q46.3162 1187.58 44.4875 1184.04 Q42.682 1180.47 39.0477 1180.47 M39.0477 1176.77 Q44.8579 1176.77 47.9134 1181.38 Q50.9921 1185.96 50.9921 1194.71 Q50.9921 1203.44 47.9134 1208.04 Q44.8579 1212.63 39.0477 1212.63 Q33.2376 1212.63 30.1589 1208.04 Q27.1034 1203.44 27.1034 1194.71 Q27.1034 1185.96 30.1589 1181.38 Q33.2376 1176.77 39.0477 1176.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M30.0895 845.657 L48.4458 845.657 L48.4458 849.592 L34.3718 849.592 L34.3718 858.064 Q35.3904 857.717 36.4089 857.555 Q37.4274 857.369 38.4459 857.369 Q44.2329 857.369 47.6125 860.541 Q50.9921 863.712 50.9921 869.129 Q50.9921 874.707 47.5199 877.809 Q44.0477 880.888 37.7283 880.888 Q35.5524 880.888 33.2839 880.518 Q31.0385 880.147 28.6311 879.406 L28.6311 874.707 Q30.7145 875.842 32.9367 876.397 Q35.1589 876.953 37.6357 876.953 Q41.6403 876.953 43.9783 874.846 Q46.3162 872.74 46.3162 869.129 Q46.3162 865.518 43.9783 863.411 Q41.6403 861.305 37.6357 861.305 Q35.7607 861.305 33.8857 861.721 Q32.0339 862.138 30.0895 863.018 L30.0895 845.657 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M-0.303895 544.543 L7.33495 544.543 L7.33495 518.177 L-0.975188 519.844 L-0.975188 515.584 L7.28866 513.918 L11.9646 513.918 L11.9646 544.543 L19.6034 544.543 L19.6034 548.478 L-0.303895 548.478 L-0.303895 544.543 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M39.0477 516.996 Q35.4367 516.996 33.608 520.561 Q31.8024 524.103 31.8024 531.232 Q31.8024 538.339 33.608 541.904 Q35.4367 545.445 39.0477 545.445 Q42.682 545.445 44.4875 541.904 Q46.3162 538.339 46.3162 531.232 Q46.3162 524.103 44.4875 520.561 Q42.682 516.996 39.0477 516.996 M39.0477 513.293 Q44.8579 513.293 47.9134 517.899 Q50.9921 522.482 50.9921 531.232 Q50.9921 539.959 47.9134 544.566 Q44.8579 549.149 39.0477 549.149 Q33.2376 549.149 30.1589 544.566 Q27.1034 539.959 27.1034 531.232 Q27.1034 522.482 30.1589 517.899 Q33.2376 513.293 39.0477 513.293 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M0.69147 212.804 L8.33032 212.804 L8.33032 186.438 L0.0201769 188.105 L0.0201769 183.846 L8.28402 182.179 L12.9599 182.179 L12.9599 212.804 L20.5988 212.804 L20.5988 216.739 L0.69147 216.739 L0.69147 212.804 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip450)" d="M30.0895 182.179 L48.4458 182.179 L48.4458 186.114 L34.3718 186.114 L34.3718 194.586 Q35.3904 194.239 36.4089 194.077 Q37.4274 193.892 38.4459 193.892 Q44.2329 193.892 47.6125 197.063 Q50.9921 200.234 50.9921 205.651 Q50.9921 211.23 47.5199 214.331 Q44.0477 217.41 37.7283 217.41 Q35.5524 217.41 33.2839 217.04 Q31.0385 216.669 28.6311 215.929 L28.6311 211.23 Q30.7145 212.364 32.9367 212.919 Q35.1589 213.475 37.6357 213.475 Q41.6403 213.475 43.9783 211.369 Q46.3162 209.262 46.3162 205.651 Q46.3162 202.04 43.9783 199.933 Q41.6403 197.827 37.6357 197.827 Q35.7607 197.827 33.8857 198.244 Q32.0339 198.66 30.0895 199.54 L30.0895 182.179 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip452)" d="
M151.118 1326.56 L222.368 1408.63 L293.618 1478.85 L364.869 1479.3 L436.119 1471.76 L507.37 1458.44 L578.62 1445.27 L649.871 1438.77 L721.121 1426.54 L792.371 1415.78 
  L863.622 1401.4 L934.872 1394.13 L1006.12 1386.17 L1077.37 1378.49 L1148.62 1369.71 L1219.87 1356.73 L1291.12 1347.85 L1362.37 1337.24 L1433.63 1331.73 L1504.88 1325.01 
  L1576.13 1316.95 L1647.38 1310.97 L1718.63 1308.18 L1789.88 1301.93 L1861.13 1298.26 L1932.38 1290.83 L2003.63 1287.06 L2074.88 1281.76 L2146.13 1275.85 L2217.38 1273.84 
  L2288.63 1271.48 L2288.63 913.965 L2217.38 907.008 L2146.13 890.938 L2074.88 878.114 L2003.63 869.748 L1932.38 851.586 L1861.13 831.739 L1789.88 812.793 L1718.63 794.118 
  L1647.38 773.788 L1576.13 753.587 L1504.88 727.124 L1433.63 701.009 L1362.37 675.36 L1291.12 647.443 L1219.87 614.943 L1148.62 585.239 L1077.37 551.838 L1006.12 516.692 
  L934.872 476.989 L863.622 440.888 L792.371 400.01 L721.121 357.133 L649.871 316.54 L578.62 273.048 L507.37 224.918 L436.119 171.292 L364.869 119.097 L293.618 88.9544 
  L222.368 182.706 L151.118 1065.43  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip452)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1186.18 222.368,1170.34 293.618,1180.01 364.869,1179.06 436.119,1180.55 507.37,1181.66 578.62,1186.99 649.871,1185.4 721.121,1179.71 792.371,1178.5 
  863.622,1180.18 934.872,1184.17 1006.12,1183.59 1077.37,1186.28 1148.62,1189.91 1219.87,1192.39 1291.12,1190.61 1362.37,1189.01 1433.63,1186.94 1504.88,1187.37 
  1576.13,1191.95 1647.38,1190.19 1718.63,1189.79 1789.88,1195.03 1861.13,1195.41 1932.38,1194.32 2003.63,1195.97 2074.88,1199.83 2146.13,1199.12 2217.38,1197.6 
  2288.63,1198.47 
  "/>
<path clip-path="url(#clip452)" d="
M151.118 1301.72 L222.368 1216.42 L293.618 1199.53 L364.869 1196.04 L436.119 1195.86 L507.37 1195.71 L578.62 1195.98 L649.871 1195.46 L721.121 1195.76 L792.371 1195.8 
  L863.622 1195.7 L934.872 1196.25 L1006.12 1195.99 L1077.37 1195.35 L1148.62 1195.25 L1219.87 1195.56 L1291.12 1195.61 L1362.37 1195.65 L1433.63 1195.67 L1504.88 1195.83 
  L1576.13 1195.96 L1647.38 1195.58 L1718.63 1195.36 L1789.88 1195.59 L1861.13 1195.51 L1932.38 1195.62 L2003.63 1195.53 L2074.88 1195.46 L2146.13 1195.85 L2217.38 1195.89 
  L2288.63 1195.64 L2288.63 1193.61 L2217.38 1193.81 L2146.13 1193.82 L2074.88 1193.51 L2003.63 1193.6 L1932.38 1193.61 L1861.13 1193.7 L1789.88 1193.9 L1718.63 1193.63 
  L1647.38 1193.1 L1576.13 1193.72 L1504.88 1193.71 L1433.63 1193.74 L1362.37 1193.94 L1291.12 1193.78 L1219.87 1193.8 L1148.62 1193.39 L1077.37 1193.68 L1006.12 1193.74 
  L934.872 1193.4 L863.622 1193.92 L792.371 1193.74 L721.121 1193.8 L649.871 1193.3 L578.62 1193.61 L507.37 1193.79 L436.119 1193.56 L364.869 1193.91 L293.618 1190.48 
  L222.368 1175.79 L151.118 1099.01  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip452)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1192.41 222.368,1194.25 293.618,1194.47 364.869,1194.74 436.119,1194.8 507.37,1194.64 578.62,1194.74 649.871,1194.86 721.121,1194.7 792.371,1194.57 
  863.622,1194.77 934.872,1194.64 1006.12,1194.74 1077.37,1194.53 1148.62,1194.73 1219.87,1194.71 1291.12,1194.78 1362.37,1194.89 1433.63,1194.85 1504.88,1194.66 
  1576.13,1194.77 1647.38,1194.52 1718.63,1194.49 1789.88,1194.72 1861.13,1194.58 1932.38,1194.77 2003.63,1194.59 2074.88,1194.62 2146.13,1194.79 2217.38,1194.8 
  2288.63,1194.57 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">50.8128733274345</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([148.29207441972775, 1242.6082171016285], [-18.52418902920414 -0.2642539605062481; -124.54506701991069 -2.584549643092697], [2.701244727312221 0.026076838657953065; 15.566812664938592 -0.01232263921184438;;; 0.026076838657953065 0.008936630476545849; -0.01232263921184438 0.13456386725103117], [57.688810865620624; -231.8415873378543;;], [-93.22544615576493, -0.8698104562119431], [7.961117126428261 -1.1010427295507323; -2.33895016487715 0.8736238202772494], [-1.1709806641825364 0.10179764343702531; 0.6277883701382068 -0.12289424810009597;;; 0.10179764343702531 -0.0008866607579190272; -0.12289424810009597 -0.003750910147956202], [-1.4173458658169267 -0.9387304675960995 … -0.17892791029178767 -0.13000856019963986])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 30 October 2022 20:15">Sunday 30 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
