<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quadratic State Space Examples · DifferenceEquations.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://DifferenceEquations.sciml.ai/stable/examples/quadratic_state_space_examples/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DifferenceEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DifferenceEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">DifferenceEquations.jl: Discrete-Time State Space Solution Methods</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../linear_state_space_examples/">Linear State Space Examples</a></li><li class="is-active"><a class="tocitem" href>Quadratic State Space Examples</a><ul class="internal"><li><a class="tocitem" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><span>Simulating a Quadratic (and Time-Invariant) State Space Model</span></a></li><li><a class="tocitem" href="#Joint-Likelihood-with-Noise"><span>Joint Likelihood with Noise</span></a></li></ul></li><li><a class="tocitem" href="../general_state_space_examples/">General State Space Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quadratic State Space Examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/DifferenceEquations.jl/blob/main/docs/src/examples/quadratic_state_space_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quadratic-State-Space-Examples"><a class="docs-heading-anchor" href="#Quadratic-State-Space-Examples">Quadratic State Space Examples</a><a id="Quadratic-State-Space-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Quadratic-State-Space-Examples" title="Permalink"></a></h1><p>Second-order state-space models here have pruning as in <a href="https://www.sas.upenn.edu/~jesusfv/Pruning.pdf">Andreasen, Fernandez-Villaverde, and Rubio-Ramirez (2017)</a>.</p><p>At this point, the package only supports linear time-invariant models without a separate <code>p</code> vector.  The canonical form is</p><p class="math-container">\[u_{n+1} = A_0 + A_1 u_n + u_n^{\top} A_2 u_n + B w_{n+1}\]</p><p>with</p><p class="math-container">\[z_n = C_0 + C_1 u_n + u_n^{\top} C_2 u_n +  v_n\]</p><p>and optionally <span>$v_n \sim N(0, D)$</span> and <span>$w_{n+1} \sim N(0,I)$</span>.  If you pass noise into the solver, it no longer needs to be Gaussian.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Quadratic state-space models do not have the full feature coverage relative to the linear models.  In particular the auto-differentiation rules are only currently implemented for the <code>logpdf</code> required for estimation, and the simulation doesn&#39;t have much flexibility on which model elements can be missing.</p></div></div><h2 id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model"><a class="docs-heading-anchor" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model">Simulating a Quadratic (and Time-Invariant) State Space Model</a><a id="Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-a-Quadratic-(and-Time-Invariant)-State-Space-Model" title="Permalink"></a></h2><p>Creating a <code>QuadraticStateSpaceModel</code> is similar to the Linear version described previously.</p><pre><code class="language-julia hljs">using DifferenceEquations, LinearAlgebra, Distributions, Random, Plots, DataFrames, Zygote, DiffEqBase
A_0 =  [-7.824904812740593e-5, 0.0]
A_1 = [0.95 6.2;
     0.0  0.2]
A_2 = cat([-0.0002 0.0334; 0.0 0.0],
              [0.034 3.129; 0.0 0.0]; dims = 3)
B = [0.0; 0.01;;] # matrix
C_0 = [7.8e-5, 0.0]
C_1 = [0.09 0.67;
     1.00 0.00]
C_2 = cat([-0.00019 0.0026; 0.0 0.0],
    [0.0026 0.313; 0.0 0.0]; dims = 3)
D = [0.01, 0.01] # diagonal observation noise
u0 = zeros(2)
T = 30

prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
sol = solve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: Piecewise constant interpolation
t: 0:30
u: 31-element Vector{Vector{Float64}}:
 [0.0, 0.0]
 [-7.824904812740593e-5, -0.013134682985727513]
 [-0.08104780539722187, 0.008718420149612365]
 [-0.02283080061011229, 0.000386757539834722]
 [-0.019369861111609564, -0.0012440446259327402]
 [-0.02618627352439016, -0.0075136927506593435]
 [-0.07135018881026994, -0.011095624414545379]
 [-0.13621596365351415, 0.0042349663316446]
 [-0.10321334273699653, 0.0026159242628552744]
 [-0.08191124618715838, -0.004645977022556412]
 ⋮
 [-0.07423749665590688, 0.0120193682652579]
 [0.004306501805666681, 0.002420571298741653]
 [0.01903936015468616, 0.01392960051480296]
 [0.10499687966823036, 0.0001024614906965796]
 [0.10030264559596111, -0.0016553463468760917]
 [0.08494166030047028, 0.01809840032325652]
 [0.19395230855462614, -0.009268377128381121]
 [0.12685401328169718, -0.003080100197797881]
 [0.10133707948667875, 0.008710381845558005]</code></pre><p>As in the linear case, this model can be simulated and plotted</p><pre><code class="language-julia hljs">plot(sol)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip340">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip340)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip341">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip340)" d="
M86.9921 1505.26 L2352.76 1505.26 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip342">
    <rect x="86" y="47" width="2267" height="1459"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  842.247,1505.26 842.247,47.2441 
  "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1597.5,1505.26 1597.5,47.2441 
  "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2352.76,1505.26 2352.76,47.2441 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 2352.76,1505.26 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,1486.36 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  842.247,1505.26 842.247,1486.36 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1597.5,1505.26 1597.5,1486.36 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2352.76,1505.26 2352.76,1486.36 
  "/>
<path clip-path="url(#clip340)" d="M86.9921 1536.18 Q83.381 1536.18 81.5523 1539.74 Q79.7468 1543.28 79.7468 1550.41 Q79.7468 1557.52 81.5523 1561.09 Q83.381 1564.63 86.9921 1564.63 Q90.6264 1564.63 92.4319 1561.09 Q94.2606 1557.52 94.2606 1550.41 Q94.2606 1543.28 92.4319 1539.74 Q90.6264 1536.18 86.9921 1536.18 M86.9921 1532.47 Q92.8023 1532.47 95.8578 1537.08 Q98.9365 1541.66 98.9365 1550.41 Q98.9365 1559.14 95.8578 1563.75 Q92.8023 1568.33 86.9921 1568.33 Q81.182 1568.33 78.1033 1563.75 Q75.0477 1559.14 75.0477 1550.41 Q75.0477 1541.66 78.1033 1537.08 Q81.182 1532.47 86.9921 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M816.934 1563.72 L824.573 1563.72 L824.573 1537.36 L816.263 1539.03 L816.263 1534.77 L824.527 1533.1 L829.203 1533.1 L829.203 1563.72 L836.842 1563.72 L836.842 1567.66 L816.934 1567.66 L816.934 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M856.286 1536.18 Q852.675 1536.18 850.846 1539.74 Q849.041 1543.28 849.041 1550.41 Q849.041 1557.52 850.846 1561.09 Q852.675 1564.63 856.286 1564.63 Q859.92 1564.63 861.726 1561.09 Q863.554 1557.52 863.554 1550.41 Q863.554 1543.28 861.726 1539.74 Q859.92 1536.18 856.286 1536.18 M856.286 1532.47 Q862.096 1532.47 865.152 1537.08 Q868.23 1541.66 868.23 1550.41 Q868.23 1559.14 865.152 1563.75 Q862.096 1568.33 856.286 1568.33 Q850.476 1568.33 847.397 1563.75 Q844.342 1559.14 844.342 1550.41 Q844.342 1541.66 847.397 1537.08 Q850.476 1532.47 856.286 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1576.27 1563.72 L1592.59 1563.72 L1592.59 1567.66 L1570.65 1567.66 L1570.65 1563.72 Q1573.31 1560.97 1577.89 1556.34 Q1582.5 1551.69 1583.68 1550.35 Q1585.93 1547.82 1586.81 1546.09 Q1587.71 1544.33 1587.71 1542.64 Q1587.71 1539.88 1585.77 1538.15 Q1583.84 1536.41 1580.74 1536.41 Q1578.54 1536.41 1576.09 1537.17 Q1573.66 1537.94 1570.88 1539.49 L1570.88 1534.77 Q1573.71 1533.63 1576.16 1533.05 Q1578.61 1532.47 1580.65 1532.47 Q1586.02 1532.47 1589.21 1535.16 Q1592.41 1537.85 1592.41 1542.34 Q1592.41 1544.47 1591.6 1546.39 Q1590.81 1548.28 1588.71 1550.88 Q1588.13 1551.55 1585.02 1554.77 Q1581.92 1557.96 1576.27 1563.72 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1612.41 1536.18 Q1608.8 1536.18 1606.97 1539.74 Q1605.16 1543.28 1605.16 1550.41 Q1605.16 1557.52 1606.97 1561.09 Q1608.8 1564.63 1612.41 1564.63 Q1616.04 1564.63 1617.85 1561.09 Q1619.68 1557.52 1619.68 1550.41 Q1619.68 1543.28 1617.85 1539.74 Q1616.04 1536.18 1612.41 1536.18 M1612.41 1532.47 Q1618.22 1532.47 1621.27 1537.08 Q1624.35 1541.66 1624.35 1550.41 Q1624.35 1559.14 1621.27 1563.75 Q1618.22 1568.33 1612.41 1568.33 Q1606.6 1568.33 1603.52 1563.75 Q1600.46 1559.14 1600.46 1550.41 Q1600.46 1541.66 1603.52 1537.08 Q1606.6 1532.47 1612.41 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M2341.6 1549.03 Q2344.96 1549.74 2346.83 1552.01 Q2348.73 1554.28 2348.73 1557.61 Q2348.73 1562.73 2345.21 1565.53 Q2341.69 1568.33 2335.21 1568.33 Q2333.03 1568.33 2330.72 1567.89 Q2328.43 1567.47 2325.97 1566.62 L2325.97 1562.1 Q2327.92 1563.24 2330.23 1563.82 Q2332.55 1564.4 2335.07 1564.4 Q2339.47 1564.4 2341.76 1562.66 Q2344.08 1560.92 2344.08 1557.61 Q2344.08 1554.56 2341.92 1552.85 Q2339.79 1551.11 2335.97 1551.11 L2331.95 1551.11 L2331.95 1547.27 L2336.16 1547.27 Q2339.61 1547.27 2341.44 1545.9 Q2343.27 1544.51 2343.27 1541.92 Q2343.27 1539.26 2341.37 1537.85 Q2339.49 1536.41 2335.97 1536.41 Q2334.05 1536.41 2331.85 1536.83 Q2329.65 1537.24 2327.02 1538.12 L2327.02 1533.96 Q2329.68 1533.22 2331.99 1532.85 Q2334.33 1532.47 2336.39 1532.47 Q2341.71 1532.47 2344.82 1534.91 Q2347.92 1537.31 2347.92 1541.43 Q2347.92 1544.3 2346.27 1546.29 Q2344.63 1548.26 2341.6 1549.03 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M2367.59 1536.18 Q2363.98 1536.18 2362.15 1539.74 Q2360.35 1543.28 2360.35 1550.41 Q2360.35 1557.52 2362.15 1561.09 Q2363.98 1564.63 2367.59 1564.63 Q2371.23 1564.63 2373.03 1561.09 Q2374.86 1557.52 2374.86 1550.41 Q2374.86 1543.28 2373.03 1539.74 Q2371.23 1536.18 2367.59 1536.18 M2367.59 1532.47 Q2373.4 1532.47 2376.46 1537.08 Q2379.54 1541.66 2379.54 1550.41 Q2379.54 1559.14 2376.46 1563.75 Q2373.4 1568.33 2367.59 1568.33 Q2361.78 1568.33 2358.7 1563.75 Q2355.65 1559.14 2355.65 1550.41 Q2355.65 1541.66 2358.7 1537.08 Q2361.78 1532.47 2367.59 1532.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M1218.94 1604.35 L1218.94 1614.48 L1231 1614.48 L1231 1619.03 L1218.94 1619.03 L1218.94 1638.38 Q1218.94 1642.74 1220.11 1643.98 Q1221.32 1645.22 1224.98 1645.22 L1231 1645.22 L1231 1650.12 L1224.98 1650.12 Q1218.2 1650.12 1215.62 1647.61 Q1213.05 1645.06 1213.05 1638.38 L1213.05 1619.03 L1208.75 1619.03 L1208.75 1614.48 L1213.05 1614.48 L1213.05 1604.35 L1218.94 1604.35 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1313.12 2352.76,1313.12 
  "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,896.517 2352.76,896.517 
  "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,479.916 2352.76,479.916 
  "/>
<polyline clip-path="url(#clip342)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,63.3139 2352.76,63.3139 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1505.26 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1313.12 105.89,1313.12 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,896.517 105.89,896.517 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,479.916 105.89,479.916 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,63.3139 105.89,63.3139 
  "/>
<path clip-path="url(#clip340)" d="M-54.7249 1313.57 L-25.0491 1313.57 L-25.0491 1317.51 L-54.7249 1317.51 L-54.7249 1313.57 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M-4.95665 1298.92 Q-8.56774 1298.92 -10.3964 1302.48 Q-12.202 1306.02 -12.202 1313.15 Q-12.202 1320.26 -10.3964 1323.82 Q-8.56774 1327.37 -4.95665 1327.37 Q-1.32241 1327.37 0.483137 1323.82 Q2.31183 1320.26 2.31183 1313.15 Q2.31183 1306.02 0.483137 1302.48 Q-1.32241 1298.92 -4.95665 1298.92 M-4.95665 1295.21 Q0.853506 1295.21 3.90904 1299.82 Q6.98773 1304.4 6.98773 1313.15 Q6.98773 1321.88 3.90904 1326.49 Q0.853506 1331.07 -4.95665 1331.07 Q-10.7668 1331.07 -13.8455 1326.49 Q-16.901 1321.88 -16.901 1313.15 Q-16.901 1304.4 -13.8455 1299.82 Q-10.7668 1295.21 -4.95665 1295.21 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M15.2053 1324.52 L20.0895 1324.52 L20.0895 1330.4 L15.2053 1330.4 L15.2053 1324.52 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M31.0848 1326.46 L38.7237 1326.46 L38.7237 1300.1 L30.4135 1301.76 L30.4135 1297.51 L38.6774 1295.84 L43.3533 1295.84 L43.3533 1326.46 L50.9921 1326.46 L50.9921 1330.4 L31.0848 1330.4 L31.0848 1326.46 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M-6.18349 882.316 Q-9.79459 882.316 -11.6233 885.881 Q-13.4288 889.422 -13.4288 896.552 Q-13.4288 903.658 -11.6233 907.223 Q-9.79459 910.765 -6.18349 910.765 Q-2.54925 910.765 -0.743708 907.223 Q1.08499 903.658 1.08499 896.552 Q1.08499 889.422 -0.743708 885.881 Q-2.54925 882.316 -6.18349 882.316 M-6.18349 878.612 Q-0.37334 878.612 2.6822 883.219 Q5.76089 887.802 5.76089 896.552 Q5.76089 905.279 2.6822 909.885 Q-0.37334 914.469 -6.18349 914.469 Q-11.9936 914.469 -15.0723 909.885 Q-18.1279 905.279 -18.1279 896.552 Q-18.1279 887.802 -15.0723 883.219 Q-11.9936 878.612 -6.18349 878.612 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M13.9784 907.918 L18.8627 907.918 L18.8627 913.797 L13.9784 913.797 L13.9784 907.918 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M39.0477 882.316 Q35.4367 882.316 33.608 885.881 Q31.8024 889.422 31.8024 896.552 Q31.8024 903.658 33.608 907.223 Q35.4367 910.765 39.0477 910.765 Q42.682 910.765 44.4875 907.223 Q46.3162 903.658 46.3162 896.552 Q46.3162 889.422 44.4875 885.881 Q42.682 882.316 39.0477 882.316 M39.0477 878.612 Q44.8579 878.612 47.9134 883.219 Q50.9921 887.802 50.9921 896.552 Q50.9921 905.279 47.9134 909.885 Q44.8579 914.469 39.0477 914.469 Q33.2376 914.469 30.1589 909.885 Q27.1034 905.279 27.1034 896.552 Q27.1034 887.802 30.1589 883.219 Q33.2376 878.612 39.0477 878.612 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M-4.95665 465.714 Q-8.56774 465.714 -10.3964 469.279 Q-12.202 472.821 -12.202 479.95 Q-12.202 487.057 -10.3964 490.622 Q-8.56774 494.163 -4.95665 494.163 Q-1.32241 494.163 0.483137 490.622 Q2.31183 487.057 2.31183 479.95 Q2.31183 472.821 0.483137 469.279 Q-1.32241 465.714 -4.95665 465.714 M-4.95665 462.011 Q0.853506 462.011 3.90904 466.617 Q6.98773 471.2 6.98773 479.95 Q6.98773 488.677 3.90904 493.284 Q0.853506 497.867 -4.95665 497.867 Q-10.7668 497.867 -13.8455 493.284 Q-16.901 488.677 -16.901 479.95 Q-16.901 471.2 -13.8455 466.617 Q-10.7668 462.011 -4.95665 462.011 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M15.2053 491.316 L20.0895 491.316 L20.0895 497.196 L15.2053 497.196 L15.2053 491.316 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M31.0848 493.26 L38.7237 493.26 L38.7237 466.895 L30.4135 468.561 L30.4135 464.302 L38.6774 462.636 L43.3533 462.636 L43.3533 493.26 L50.9921 493.26 L50.9921 497.196 L31.0848 497.196 L31.0848 493.26 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M-4.58628 49.1126 Q-8.19737 49.1126 -10.0261 52.6774 Q-11.8316 56.219 -11.8316 63.3486 Q-11.8316 70.4551 -10.0261 74.0199 Q-8.19737 77.5615 -4.58628 77.5615 Q-0.95204 77.5615 0.853506 74.0199 Q2.6822 70.4551 2.6822 63.3486 Q2.6822 56.219 0.853506 52.6774 Q-0.95204 49.1126 -4.58628 49.1126 M-4.58628 45.4089 Q1.22387 45.4089 4.27941 50.0154 Q7.3581 54.5987 7.3581 63.3486 Q7.3581 72.0754 4.27941 76.6819 Q1.22387 81.2652 -4.58628 81.2652 Q-10.3964 81.2652 -13.4751 76.6819 Q-16.5307 72.0754 -16.5307 63.3486 Q-16.5307 54.5987 -13.4751 50.0154 Q-10.3964 45.4089 -4.58628 45.4089 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M15.5756 74.7143 L20.4599 74.7143 L20.4599 80.5939 L15.5756 80.5939 L15.5756 74.7143 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip340)" d="M34.6728 76.6587 L50.9921 76.6587 L50.9921 80.5939 L29.0478 80.5939 L29.0478 76.6587 Q31.7098 73.9041 36.2931 69.2745 Q40.8996 64.6218 42.0801 63.2792 Q44.3255 60.7561 45.2051 59.0199 Q46.1079 57.2607 46.1079 55.5709 Q46.1079 52.8163 44.1635 51.0802 Q42.2422 49.3441 39.1403 49.3441 Q36.9413 49.3441 34.4876 50.108 Q32.057 50.8718 29.2793 52.4228 L29.2793 47.7006 Q32.1033 46.5663 34.557 45.9876 Q37.0107 45.4089 39.0477 45.4089 Q44.4181 45.4089 47.6125 48.0941 Q50.8069 50.7793 50.8069 55.27 Q50.8069 57.3996 49.9968 59.3209 Q49.2097 61.219 47.1033 63.8116 Q46.5246 64.4829 43.4227 67.7005 Q40.3209 70.8949 34.6728 76.6587 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip342)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,896.517 162.518,896.843 238.043,1234.16 313.569,991.631 389.094,977.212 464.619,1005.61 540.145,1193.76 615.67,1464 691.196,1326.51 766.721,1237.76 
  842.247,1340.64 917.772,1114.81 993.298,744.701 1068.82,960.739 1144.35,880.441 1219.87,880.599 1295.4,991.228 1370.92,1105.13 1446.45,1339.43 1521.98,1369.39 
  1597.5,1155.54 1673.03,1155.37 1748.55,1205.79 1824.08,878.576 1899.6,817.199 1975.13,459.098 2050.65,478.655 2126.18,542.649 2201.7,88.5087 2277.23,368.041 
  2352.76,474.345 
  "/>
<polyline clip-path="url(#clip342)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,896.517 162.518,951.237 238.043,860.196 313.569,894.906 389.094,901.7 464.619,927.819 540.145,942.742 615.67,878.874 691.196,885.619 766.721,915.872 
  842.247,863.712 917.772,838.899 993.298,930.21 1068.82,884.048 1144.35,896.361 1219.87,914.217 1295.4,915.649 1370.92,936.15 1446.45,904.886 1521.98,865.859 
  1597.5,898.529 1673.03,906.703 1748.55,846.444 1824.08,886.433 1899.6,838.486 1975.13,896.09 2050.65,903.413 2126.18,821.119 2201.7,935.129 2277.23,909.349 
  2352.76,860.23 
  "/>
<path clip-path="url(#clip340)" d="
M2002.28 251.365 L2277.23 251.365 L2277.23 95.8446 L2002.28 95.8446  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip340)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2002.28,251.365 2277.23,251.365 2277.23,95.8446 2002.28,95.8446 2002.28,251.365 
  "/>
<polyline clip-path="url(#clip340)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,147.685 2178.51,147.685 
  "/>
<path clip-path="url(#clip340)" d="M2217.09 151.932 Q2211.93 151.932 2209.94 153.113 Q2207.95 154.293 2207.95 157.141 Q2207.95 159.409 2209.43 160.752 Q2210.93 162.071 2213.5 162.071 Q2217.04 162.071 2219.17 159.571 Q2221.32 157.048 2221.32 152.881 L2221.32 151.932 L2217.09 151.932 M2225.58 150.173 L2225.58 164.965 L2221.32 164.965 L2221.32 161.029 Q2219.87 163.391 2217.69 164.525 Q2215.51 165.636 2212.37 165.636 Q2208.38 165.636 2206.02 163.414 Q2203.69 161.168 2203.69 157.418 Q2203.69 153.043 2206.6 150.821 Q2209.54 148.599 2215.35 148.599 L2221.32 148.599 L2221.32 148.182 Q2221.32 145.243 2219.38 143.645 Q2217.46 142.025 2213.96 142.025 Q2211.74 142.025 2209.63 142.557 Q2207.53 143.09 2205.58 144.155 L2205.58 140.219 Q2207.92 139.317 2210.12 138.877 Q2212.32 138.414 2214.4 138.414 Q2220.03 138.414 2222.81 141.33 Q2225.58 144.247 2225.58 150.173 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip340)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2027.46,199.525 2178.51,199.525 
  "/>
<path clip-path="url(#clip340)" d="M2222.46 203.865 Q2222.46 199.166 2220.51 196.504 Q2218.59 193.819 2215.21 193.819 Q2211.83 193.819 2209.89 196.504 Q2207.97 199.166 2207.97 203.865 Q2207.97 208.564 2209.89 211.249 Q2211.83 213.911 2215.21 213.911 Q2218.59 213.911 2220.51 211.249 Q2222.46 208.564 2222.46 203.865 M2207.97 194.814 Q2209.31 192.499 2211.35 191.388 Q2213.41 190.254 2216.26 190.254 Q2220.98 190.254 2223.92 194.004 Q2226.88 197.754 2226.88 203.865 Q2226.88 209.976 2223.92 213.726 Q2220.98 217.476 2216.26 217.476 Q2213.41 217.476 2211.35 216.365 Q2209.31 215.231 2207.97 212.916 L2207.97 216.805 L2203.69 216.805 L2203.69 180.786 L2207.97 180.786 L2207.97 194.814 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /></svg>
<p>And the observables and noise can be stored</p><pre><code class="language-julia hljs">observables = hcat(sol.z...)  # Observables required to be matrix.  Issue #55
observables = observables[:, 2:end] # see note above on likelihood and timing
noise = sol.W</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×30 Matrix{Float64}:
 -1.31347  1.13454  -0.135693  -0.13214  …  -1.28881  -0.122642  0.93264</code></pre><p>Ensembles work as well,</p><pre><code class="language-julia hljs">trajectories = 50
u0_dist = MvNormal([1.0 0.1; 0.1 1.0])  # mean zero initial conditions
prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0_dist, (0, T); C_0, C_1, C_2, observables_noise = D, syms = [:a, :b])
ens_sol = solve(EnsembleProblem(prob), DirectIteration(), EnsembleThreads(); trajectories)
summ = EnsembleSummary(ens_sol)  # calculate summarize statistics such as quantiles
plot(summ)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip400">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip400)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip401">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip400)" d="
M86.9921 1521.01 L2352.76 1521.01 L2352.76 47.2441 L86.9921 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip402">
    <rect x="86" y="47" width="2267" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  151.118,1521.01 151.118,47.2441 
  "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  863.622,1521.01 863.622,47.2441 
  "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1576.13,1521.01 1576.13,47.2441 
  "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2288.63,1521.01 2288.63,47.2441 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 2352.76,1521.01 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  151.118,1521.01 151.118,1502.11 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  863.622,1521.01 863.622,1502.11 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  1576.13,1521.01 1576.13,1502.11 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  2288.63,1521.01 2288.63,1502.11 
  "/>
<path clip-path="url(#clip400)" d="M151.118 1551.93 Q147.506 1551.93 145.678 1555.49 Q143.872 1559.03 143.872 1566.16 Q143.872 1573.27 145.678 1576.83 Q147.506 1580.38 151.118 1580.38 Q154.752 1580.38 156.557 1576.83 Q158.386 1573.27 158.386 1566.16 Q158.386 1559.03 156.557 1555.49 Q154.752 1551.93 151.118 1551.93 M151.118 1548.22 Q156.928 1548.22 159.983 1552.83 Q163.062 1557.41 163.062 1566.16 Q163.062 1574.89 159.983 1579.5 Q156.928 1584.08 151.118 1584.08 Q145.307 1584.08 142.229 1579.5 Q139.173 1574.89 139.173 1566.16 Q139.173 1557.41 142.229 1552.83 Q145.307 1548.22 151.118 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M838.309 1579.47 L845.948 1579.47 L845.948 1553.11 L837.638 1554.77 L837.638 1550.51 L845.902 1548.85 L850.578 1548.85 L850.578 1579.47 L858.217 1579.47 L858.217 1583.41 L838.309 1583.41 L838.309 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M877.661 1551.93 Q874.05 1551.93 872.221 1555.49 Q870.416 1559.03 870.416 1566.16 Q870.416 1573.27 872.221 1576.83 Q874.05 1580.38 877.661 1580.38 Q881.295 1580.38 883.101 1576.83 Q884.93 1573.27 884.93 1566.16 Q884.93 1559.03 883.101 1555.49 Q881.295 1551.93 877.661 1551.93 M877.661 1548.22 Q883.471 1548.22 886.527 1552.83 Q889.606 1557.41 889.606 1566.16 Q889.606 1574.89 886.527 1579.5 Q883.471 1584.08 877.661 1584.08 Q871.851 1584.08 868.772 1579.5 Q865.717 1574.89 865.717 1566.16 Q865.717 1557.41 868.772 1552.83 Q871.851 1548.22 877.661 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M1554.9 1579.47 L1571.22 1579.47 L1571.22 1583.41 L1549.27 1583.41 L1549.27 1579.47 Q1551.94 1576.72 1556.52 1572.09 Q1561.13 1567.44 1562.31 1566.09 Q1564.55 1563.57 1565.43 1561.83 Q1566.33 1560.07 1566.33 1558.38 Q1566.33 1555.63 1564.39 1553.89 Q1562.47 1552.16 1559.37 1552.16 Q1557.17 1552.16 1554.71 1552.92 Q1552.28 1553.69 1549.51 1555.24 L1549.51 1550.51 Q1552.33 1549.38 1554.78 1548.8 Q1557.24 1548.22 1559.27 1548.22 Q1564.64 1548.22 1567.84 1550.91 Q1571.03 1553.59 1571.03 1558.08 Q1571.03 1560.21 1570.22 1562.13 Q1569.44 1564.03 1567.33 1566.63 Q1566.75 1567.3 1563.65 1570.51 Q1560.55 1573.71 1554.9 1579.47 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M1591.03 1551.93 Q1587.42 1551.93 1585.59 1555.49 Q1583.79 1559.03 1583.79 1566.16 Q1583.79 1573.27 1585.59 1576.83 Q1587.42 1580.38 1591.03 1580.38 Q1594.67 1580.38 1596.47 1576.83 Q1598.3 1573.27 1598.3 1566.16 Q1598.3 1559.03 1596.47 1555.49 Q1594.67 1551.93 1591.03 1551.93 M1591.03 1548.22 Q1596.84 1548.22 1599.9 1552.83 Q1602.98 1557.41 1602.98 1566.16 Q1602.98 1574.89 1599.9 1579.5 Q1596.84 1584.08 1591.03 1584.08 Q1585.22 1584.08 1582.14 1579.5 Q1579.09 1574.89 1579.09 1566.16 Q1579.09 1557.41 1582.14 1552.83 Q1585.22 1548.22 1591.03 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M2277.47 1564.77 Q2280.83 1565.49 2282.7 1567.76 Q2284.6 1570.03 2284.6 1573.36 Q2284.6 1578.48 2281.08 1581.28 Q2277.57 1584.08 2271.08 1584.08 Q2268.91 1584.08 2266.59 1583.64 Q2264.3 1583.22 2261.85 1582.37 L2261.85 1577.85 Q2263.79 1578.99 2266.11 1579.57 Q2268.42 1580.14 2270.95 1580.14 Q2275.34 1580.14 2277.64 1578.41 Q2279.95 1576.67 2279.95 1573.36 Q2279.95 1570.31 2277.8 1568.59 Q2275.67 1566.86 2271.85 1566.86 L2267.82 1566.86 L2267.82 1563.01 L2272.03 1563.01 Q2275.48 1563.01 2277.31 1561.65 Q2279.14 1560.26 2279.14 1557.67 Q2279.14 1555.01 2277.24 1553.59 Q2275.37 1552.16 2271.85 1552.16 Q2269.93 1552.16 2267.73 1552.57 Q2265.53 1552.99 2262.89 1553.87 L2262.89 1549.7 Q2265.55 1548.96 2267.87 1548.59 Q2270.2 1548.22 2272.26 1548.22 Q2277.59 1548.22 2280.69 1550.65 Q2283.79 1553.06 2283.79 1557.18 Q2283.79 1560.05 2282.15 1562.04 Q2280.51 1564.01 2277.47 1564.77 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M2303.47 1551.93 Q2299.86 1551.93 2298.03 1555.49 Q2296.22 1559.03 2296.22 1566.16 Q2296.22 1573.27 2298.03 1576.83 Q2299.86 1580.38 2303.47 1580.38 Q2307.1 1580.38 2308.91 1576.83 Q2310.74 1573.27 2310.74 1566.16 Q2310.74 1559.03 2308.91 1555.49 Q2307.1 1551.93 2303.47 1551.93 M2303.47 1548.22 Q2309.28 1548.22 2312.33 1552.83 Q2315.41 1557.41 2315.41 1566.16 Q2315.41 1574.89 2312.33 1579.5 Q2309.28 1584.08 2303.47 1584.08 Q2297.66 1584.08 2294.58 1579.5 Q2291.52 1574.89 2291.52 1566.16 Q2291.52 1557.41 2294.58 1552.83 Q2297.66 1548.22 2303.47 1548.22 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1508.68 2352.76,1508.68 
  "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,1107 2352.76,1107 
  "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,705.325 2352.76,705.325 
  "/>
<polyline clip-path="url(#clip402)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  86.9921,303.646 2352.76,303.646 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1521.01 86.9921,47.2441 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1508.68 105.89,1508.68 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,1107 105.89,1107 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,705.325 105.89,705.325 
  "/>
<polyline clip-path="url(#clip400)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="
  86.9921,303.646 105.89,303.646 
  "/>
<path clip-path="url(#clip400)" d="M-9.72514 1509.14 L19.9506 1509.14 L19.9506 1513.07 L-9.72514 1513.07 L-9.72514 1509.14 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M30.0895 1491.4 L48.4458 1491.4 L48.4458 1495.34 L34.3718 1495.34 L34.3718 1503.81 Q35.3904 1503.46 36.4089 1503.3 Q37.4274 1503.12 38.4459 1503.12 Q44.2329 1503.12 47.6125 1506.29 Q50.9921 1509.46 50.9921 1514.88 Q50.9921 1520.45 47.5199 1523.56 Q44.0477 1526.63 37.7283 1526.63 Q35.5524 1526.63 33.2839 1526.26 Q31.0385 1525.89 28.6311 1525.15 L28.6311 1520.45 Q30.7145 1521.59 32.9367 1522.14 Q35.1589 1522.7 37.6357 1522.7 Q41.6403 1522.7 43.9783 1520.59 Q46.3162 1518.49 46.3162 1514.88 Q46.3162 1511.26 43.9783 1509.16 Q41.6403 1507.05 37.6357 1507.05 Q35.7607 1507.05 33.8857 1507.47 Q32.0339 1507.89 30.0895 1508.76 L30.0895 1491.4 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M39.0477 1092.8 Q35.4367 1092.8 33.608 1096.37 Q31.8024 1099.91 31.8024 1107.04 Q31.8024 1114.15 33.608 1117.71 Q35.4367 1121.25 39.0477 1121.25 Q42.682 1121.25 44.4875 1117.71 Q46.3162 1114.15 46.3162 1107.04 Q46.3162 1099.91 44.4875 1096.37 Q42.682 1092.8 39.0477 1092.8 M39.0477 1089.1 Q44.8579 1089.1 47.9134 1093.71 Q50.9921 1098.29 50.9921 1107.04 Q50.9921 1115.77 47.9134 1120.37 Q44.8579 1124.96 39.0477 1124.96 Q33.2376 1124.96 30.1589 1120.37 Q27.1034 1115.77 27.1034 1107.04 Q27.1034 1098.29 30.1589 1093.71 Q33.2376 1089.1 39.0477 1089.1 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M30.0895 688.045 L48.4458 688.045 L48.4458 691.981 L34.3718 691.981 L34.3718 700.453 Q35.3904 700.105 36.4089 699.943 Q37.4274 699.758 38.4459 699.758 Q44.2329 699.758 47.6125 702.93 Q50.9921 706.101 50.9921 711.517 Q50.9921 717.096 47.5199 720.198 Q44.0477 723.277 37.7283 723.277 Q35.5524 723.277 33.2839 722.906 Q31.0385 722.536 28.6311 721.795 L28.6311 717.096 Q30.7145 718.23 32.9367 718.786 Q35.1589 719.341 37.6357 719.341 Q41.6403 719.341 43.9783 717.235 Q46.3162 715.129 46.3162 711.517 Q46.3162 707.906 43.9783 705.8 Q41.6403 703.693 37.6357 703.693 Q35.7607 703.693 33.8857 704.11 Q32.0339 704.527 30.0895 705.406 L30.0895 688.045 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M-0.303895 316.991 L7.33495 316.991 L7.33495 290.625 L-0.975188 292.292 L-0.975188 288.033 L7.28866 286.366 L11.9646 286.366 L11.9646 316.991 L19.6034 316.991 L19.6034 320.926 L-0.303895 320.926 L-0.303895 316.991 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip400)" d="M39.0477 289.445 Q35.4367 289.445 33.608 293.01 Q31.8024 296.551 31.8024 303.681 Q31.8024 310.787 33.608 314.352 Q35.4367 317.894 39.0477 317.894 Q42.682 317.894 44.4875 314.352 Q46.3162 310.787 46.3162 303.681 Q46.3162 296.551 44.4875 293.01 Q42.682 289.445 39.0477 289.445 M39.0477 285.741 Q44.8579 285.741 47.9134 290.348 Q50.9921 294.931 50.9921 303.681 Q50.9921 312.408 47.9134 317.014 Q44.8579 321.597 39.0477 321.597 Q33.2376 321.597 30.1589 317.014 Q27.1034 312.408 27.1034 303.681 Q27.1034 294.931 30.1589 290.348 Q33.2376 285.741 39.0477 285.741 Z" fill="#000000" fill-rule="evenodd" fill-opacity="1" /><path clip-path="url(#clip402)" d="
M151.118 1228.7 L222.368 1421.14 L293.618 1479.3 L364.869 1475.25 L436.119 1458.28 L507.37 1441.1 L578.62 1423.11 L649.871 1409.06 L721.121 1396.53 L792.371 1386.83 
  L863.622 1380.17 L934.872 1368.49 L1006.12 1357.36 L1077.37 1344.14 L1148.62 1335.63 L1219.87 1324.87 L1291.12 1312.4 L1362.37 1304.11 L1433.63 1297.21 L1504.88 1288.61 
  L1576.13 1273.11 L1647.38 1272.81 L1718.63 1267.41 L1789.88 1260.09 L1861.13 1253.5 L1932.38 1245.91 L2003.63 1237.72 L2074.88 1225.14 L2146.13 1218.4 L2217.38 1218 
  L2288.63 1215.57 L2288.63 851.26 L2217.38 845.5 L2146.13 831.728 L2074.88 813.765 L2003.63 803.039 L1932.38 787.874 L1861.13 766.887 L1789.88 748.145 L1718.63 728.444 
  L1647.38 711.989 L1576.13 689.421 L1504.88 665.217 L1433.63 650.231 L1362.37 627.965 L1291.12 597.61 L1219.87 570.671 L1148.62 540.694 L1077.37 510.142 L1006.12 478.258 
  L934.872 439.801 L863.622 406.552 L792.371 369.429 L721.121 324.359 L649.871 290.322 L578.62 251.669 L507.37 206.794 L436.119 154.628 L364.869 111.794 L293.618 88.9544 
  L222.368 186.895 L151.118 930.787  Z
  " fill="#009af9" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip402)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1096.2 222.368,1119.03 293.618,1157.45 364.869,1169.91 436.119,1168.3 507.37,1163.47 578.62,1158.14 649.871,1159.64 721.121,1152.56 792.371,1139.24 
  863.622,1136.96 934.872,1138.43 1006.12,1139.19 1077.37,1133.28 1148.62,1130.49 1219.87,1127.55 1291.12,1129.04 1362.37,1127.54 1433.63,1132.81 1504.88,1132.53 
  1576.13,1129.41 1647.38,1123.93 1718.63,1124.7 1789.88,1122.14 1861.13,1122.81 1932.38,1124.11 2003.63,1124.84 2074.88,1125.52 2146.13,1123.04 2217.38,1119.75 
  2288.63,1113.42 
  "/>
<path clip-path="url(#clip402)" d="
M151.118 1240.36 L222.368 1133.35 L293.618 1112.39 L364.869 1108.52 L436.119 1108.21 L507.37 1108.41 L578.62 1107.99 L649.871 1108.07 L721.121 1108.2 L792.371 1108.45 
  L863.622 1108.25 L934.872 1107.87 L1006.12 1108.21 L1077.37 1108.28 L1148.62 1108.25 L1219.87 1108.02 L1291.12 1108.32 L1362.37 1108.26 L1433.63 1108.11 L1504.88 1108.21 
  L1576.13 1108.27 L1647.38 1107.99 L1718.63 1108.16 L1789.88 1108.47 L1861.13 1108.79 L1932.38 1108.13 L2003.63 1108.76 L2074.88 1108.49 L2146.13 1108.21 L2217.38 1108.65 
  L2288.63 1108.03 L2288.63 1105.34 L2217.38 1105.92 L2146.13 1105.89 L2074.88 1106.03 L2003.63 1105.92 L1932.38 1105.95 L1861.13 1106.1 L1789.88 1106.06 L1718.63 1105.75 
  L1647.38 1105.6 L1576.13 1105.45 L1504.88 1105.38 L1433.63 1105.74 L1362.37 1106.19 L1291.12 1106.37 L1219.87 1106.05 L1148.62 1105.7 L1077.37 1105.51 L1006.12 1106.01 
  L934.872 1105.63 L863.622 1105.81 L792.371 1105.87 L721.121 1105.08 L649.871 1105.54 L578.62 1105.49 L507.37 1105.95 L436.119 1105.66 L364.869 1105.39 L293.618 1103.2 
  L222.368 1087.56 L151.118 1014.21  Z
  " fill="#e26f46" fill-rule="evenodd" fill-opacity="0.2"/>
<polyline clip-path="url(#clip402)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="
  151.118,1126.85 222.368,1111.83 293.618,1107.98 364.869,1106.88 436.119,1106.84 507.37,1106.77 578.62,1107.19 649.871,1106.85 721.121,1107.07 792.371,1107.08 
  863.622,1106.97 934.872,1106.96 1006.12,1106.91 1077.37,1106.95 1148.62,1106.77 1219.87,1106.98 1291.12,1107.24 1362.37,1107.31 1433.63,1106.98 1504.88,1106.95 
  1576.13,1106.88 1647.38,1107.13 1718.63,1106.98 1789.88,1107.1 1861.13,1107.34 1932.38,1106.98 2003.63,1107.33 2074.88,1107.21 2146.13,1106.95 2217.38,1106.75 
  2288.63,1107.03 
  "/>
</svg>
<h2 id="Joint-Likelihood-with-Noise"><a class="docs-heading-anchor" href="#Joint-Likelihood-with-Noise">Joint Likelihood with Noise</a><a id="Joint-Likelihood-with-Noise-1"></a><a class="docs-heading-anchor-permalink" href="#Joint-Likelihood-with-Noise" title="Permalink"></a></h2><p>To calculate the likelihood, the Kalman Filter is no longer applicable.  However, we can still calculate the joint likelihood we did in the linear examples.  Using the simulated observables and noise,</p><pre><code class="language-julia hljs">function joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)
    prob = QuadraticStateSpaceProblem(A_0, A_1, A_2, B, u0, (0, size(observables,2)); C_0, C_1, C_2, observables, observables_noise = D, noise)
    return solve(prob).logpdf
end
u0 = [0.0, 0.0]
joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">35.607801098772356</code></pre><p>Which, in turn can itself be differentiated.</p><pre><code class="language-julia hljs">gradient((A_0, A_1, A_2, B, C_0, C_1, C_2, noise) -&gt; joint_likelihood_quad(A_0, A_1, A_2, B, C_0, C_1, C_2, D, u0, noise, observables), A_0, A_1, A_2, B, C_0, C_1, C_2, noise)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([108.78135804451067, 727.5105738060892], [0.9305873594330976 -0.6317428237826832; -20.718783414041933 3.5253778765951322], [-0.018655154231666457 0.014019346913156313; 3.0070529927868814 -0.2537508718233757;;; 0.014019346913156313 -0.00043110191955013756; -0.2537508718233757 0.028541342385198627], [24.841199978472257; -370.22764152951345;;], [89.2558535993381, 18.909623783306113], [0.6908097918045236 0.31766716320126825; -3.988746852743867 0.693642801022436], [0.5015830072787876 0.018149791054047917; 0.10431999802038724 0.06049509658208603;;; 0.018149791054047917 0.005352469216881957; 0.06049509658208603 0.01459762195607274], [0.5822772937701679 -0.4994184596967189 … 0.35731558025863863 0.10048404437232127])</code></pre><p>Note that this is calculating the gradient of the likelihood with respect to the underlying canonical representations for the quadratic state space form, but also the entire noise vector.</p><p>As in the linear case, this likelihood calculation can nested such that a separate differentiable function could generate the quadratic state space model and the gradients could be over a smaller set of structural parameters.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_state_space_examples/">« Linear State Space Examples</a><a class="docs-footer-nextpage" href="../general_state_space_examples/">General State Space Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 30 October 2022 20:30">Sunday 30 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
